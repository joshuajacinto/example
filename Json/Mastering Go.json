{"title":"Mastering Go","authors":["Mihalis Tsoukalos"],"publisher":"packt","version":1,"chapters":[{"title":"Preface","author":"","block":"k6pz2432","number":0,"contents":[{"block_type":"element","block":"k6pz2gz6","search_text":"Mastering Go","text_count":12,"tag_name":"h2","attributes":{"id":"maintitle"},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"element","block":"k6pz2gz7","search_text":"Create Golang production applications using network libraries, concurrency, and advanced Go data structures","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Create Golang production applications using network libraries, concurrency, and advanced Go data structures"}]},{"block_type":"element","block":"k6pz2gz8","search_text":"Mihalis Tsoukalos","text_count":17,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Mihalis Tsoukalos"}]},{"block_type":"element","block":"k6pz2gz9","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000030.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2gza","search_text":"BIRMINGHAM - MUMBAI","text_count":19,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"BIRMINGHAM - MUMBAI"}]}]}]},{"block_type":"element","block":"k6pz2gzb","search_text":"Copyright © 2018 Packt Publishing","text_count":33,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Copyright &copy; 2018 Packt Publishing"}]},{"block_type":"element","block":"k6pz2gzc","search_text":"All rights reserved. No part of this book may be reproduced, stored in a retrieval system, or transmitted in any form or by any means, without the prior written permission of the publisher, except in the case of brief quotations embedded in critical articles or reviews.","text_count":270,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All rights reserved. No part of this book may be reproduced, stored in a retrieval system, or transmitted in any form or by any means, without the prior written permission of the publisher, except in the case of brief quotations embedded in critical articles or reviews."}]},{"block_type":"element","block":"k6pz2gzd","search_text":"Every effort has been made in the preparation of this book to ensure the accuracy of the information presented. However, the information contained in this book is sold without warranty, either express or implied. Neither the author, nor Packt Publishing or its dealers and distributors, will be held liable for any damages caused or alleged to have been caused directly or indirectly by this book.","text_count":397,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Every effort has been made in the preparation of this book to ensure the accuracy of the information presented. However, the information contained in this book is sold without warranty, either express or implied. Neither the author, nor Packt Publishing or its dealers and distributors, will be held liable for any damages caused or alleged to have been caused directly or indirectly by this book."}]},{"block_type":"element","block":"k6pz2gze","search_text":"Packt Publishing has endeavored to provide trademark information about all of the companies and products mentioned in this book by the appropriate use of capitals. However, Packt Publishing cannot guarantee the accuracy of this information.","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Packt Publishing has endeavored to provide trademark information about all of the companies and products mentioned in this book by the appropriate use of capitals. However, Packt Publishing cannot guarantee the accuracy of this information."}]},{"block_type":"element","block":"k6pz2gzf","search_text":"Acquisition Editors : Frank Pohlmann, Suresh Jain Project Editor : Kishor Rit Content Development Editor : Gary Schwarts Technical Editors : Gaurav Gavas, Nidhisha Shetty Proofreader : Tom Jacob Indexer : Mariammal Chettiyar Graphics : Tom Scaria Production Coordinator : Shantanu Zagade","text_count":287,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Acquisition Editors"}]},{"block_type":"text","content":":&nbsp;Frank Pohlmann, Suresh Jain"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Project Editor"}]},{"block_type":"text","content":":&nbsp;Kishor Rit"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Content Development Editor"}]},{"block_type":"text","content":":&nbsp;Gary Schwarts"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Technical Editors"}]},{"block_type":"text","content":":&nbsp;Gaurav Gavas, Nidhisha Shetty"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Proofreader"}]},{"block_type":"text","content":":&nbsp;Tom Jacob"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Indexer"}]},{"block_type":"text","content":": Mariammal Chettiyar"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Graphics"}]},{"block_type":"text","content":": Tom Scaria"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Production Coordinator"}]},{"block_type":"text","content":": Shantanu Zagade"}]},{"block_type":"element","block":"k6pz2gzg","search_text":"First published: April 2018","text_count":27,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First published: April 2018"}]},{"block_type":"element","block":"k6pz2gzh","search_text":"Production reference: 1270418","text_count":29,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Production reference: 1270418"}]},{"block_type":"element","block":"k6pz2gzi","search_text":"Published by Packt Publishing Ltd. Livery Place 35 Livery Street Birmingham B3 2PB, UK.","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Published by Packt Publishing Ltd."},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"Livery Place"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"35 Livery Street"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"Birmingham"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"B3 2PB, UK."}]},{"block_type":"element","block":"k6pz2gzj","search_text":"ISBN 978-1-78862-654-5","text_count":22,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"ISBN 978-1-78862-654-5"}]},{"block_type":"element","block":"k6pz2gzk","search_text":"www.packtpub.com","text_count":16,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.packtpub.com","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"www.packtpub.com"}]}]},{"block_type":"element","block":"k6pz2gzl","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000028.jpg","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2gzm","search_text":"mapt.io","text_count":7,"tag_name":"a","attributes":{"href":"https://mapt.io/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"mapt.io"}]},{"block_type":"element","block":"k6pz2gzn","search_text":"Mapt is an online digital library that gives you full access to over 5,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. For more information, please visit our website.","text_count":242,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Mapt is an online digital library that gives you full access to over 5,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. For more information, please visit our website."}]},{"block_type":"element","block":"k6pz2gzo","search_text":"Contributors","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Contributors"}]},{"block_type":"element","block":"k6pz2gzp","search_text":"About the author","text_count":16,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About the author"}]},{"block_type":"element","block":"k6pz2gzq","search_text":"Mihalis Tsoukalos is a technical author, a Unix administrator, a developer, and a mathematician , who enjoys learning new things. He has written more than 250 technical articles for many publications, including Sys Admin , MacTech , Linux User and Developer , Usenix ;login: , Linux Format , and Linux Journal .","text_count":311,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Mihalis Tsoukalos"}]},{"block_type":"text","content":"is a technical author, a Unix administrator, a developer, and a mathematician"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":","}]},{"block_type":"text","content":"who enjoys learning new things. He has written more than 250 technical articles for many publications, including"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Sys Admin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"MacTech"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Linux User and Developer"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Usenix ;login:"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Linux Format"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Linux Journal"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2gzr","search_text":"Mihalis is also the author of Go Systems Programming , by Packt Publishing , 2017 and the technical editor for MongoDB in Action , Second Edition , by Manning . Mihalis' research interests include databases, operating systems, and statistics. You can reach him at http://www.mtsoukalos.eu/ and @mactsouk . He is also a photographer ( http://www.highiso.net/ ).","text_count":360,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Mihalis is also the author of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming"}]},{"block_type":"text","content":", by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Packt Publishing"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"2017"}]},{"block_type":"text","content":"and the technical editor for"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"MongoDB in Action"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Second Edition"}]},{"block_type":"text","content":", by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Manning"}]},{"block_type":"text","content":". Mihalis' research interests include databases, operating systems, and statistics. You can reach him at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.mtsoukalos.eu/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://www.mtsoukalos.eu/"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"@mactsouk"}]},{"block_type":"text","content":". He is also a photographer ("},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.highiso.net/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://www.highiso.net/"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2gzs","search_text":"I would like to thank the people at Packt Publishing for helping me write this book, including Frank Pohlmann and Gary Schwartz, my technical reviewer, Mat Ryer, Radhika Atitkar, for her encouragement and trust, and Kishor Rit, for answering all my questions and encouraging me during the whole process. For all people everywhere: You will never change your life until you change something you do daily! ","text_count":404,"tag_name":"blockquote","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I would like to thank the people at Packt Publishing for helping me write this book, including Frank Pohlmann and Gary Schwartz, my technical reviewer, Mat Ryer, Radhika Atitkar, for her encouragement and trust, and Kishor Rit, for answering all my questions and encouraging me during the whole process."},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"For all people everywhere: You will never change your life until you change something you do daily!"}]}]},{"block_type":"element","block":"k6pz2gzt","search_text":"About the reviewer","text_count":18,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About the reviewer"}]},{"block_type":"element","block":"k6pz2gzu","search_text":"Mat Ryer has been programming computers since he was 6 years old. He would build games and programs, first in BASIC on a ZX Spectrum and then in AmigaBASIC and AMOS on Commodore Amiga with his father. Many hours were spent on manually copying the code from the Amiga Format magazine and tweaking variables or moving GOTO statements around to see what might happen. The same spirit of exploration and obsession with programming led Mat to starting work with a local agency in Mansfield, England, when he was 18, where he started to build websites and other online services.","text_count":572,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Mat Ryer"}]},{"block_type":"text","content":"has been programming computers since he was 6 years old. He would build games and programs, first in BASIC on a ZX Spectrum and then in AmigaBASIC and AMOS on Commodore Amiga with his father. Many hours were spent on manually copying the code from the Amiga Format magazine and tweaking variables or moving GOTO statements around to see what might happen. The same spirit of exploration and obsession with programming led Mat to starting work with a local agency in Mansfield, England, when he was 18, where he started to build websites and other online services."}]},{"block_type":"element","block":"k6pz2gzv","search_text":"After several years of working with various technologies and industries in London and around the world, Mat noticed a new systems language called Go that Google was pioneering. Since it addressed very pertinent and relevant modern technical challenges, Mat started using it to solve problems while the language was still in the beta stage. He has used it ever since. Mat contributes to open-source projects and founded Go packages, including Testify, Moq, Silk, and Is, as well as a macOS developer tool called BitBar.","text_count":518,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After several years of working with various technologies and industries in London and around the world, Mat noticed a new systems language called Go that Google was pioneering. Since it addressed very pertinent and relevant modern technical challenges, Mat started using it to solve problems while the language was still in the beta stage. He has used it ever since. Mat contributes to open-source projects and founded Go packages, including Testify, Moq, Silk, and Is, as well as a macOS developer tool called BitBar."}]},{"block_type":"element","block":"k6pz2gzw","search_text":"In 2018, Mat co-founded Machine Box and still spends a lot of time speaking at conferences, writing about Go on his blog, and is an active member of the Go community.","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In 2018, Mat co-founded Machine Box and still spends a lot of time speaking at conferences, writing about Go on his blog, and is an active member of the Go community."}]},{"block_type":"element","block":"k6pz2gzx","search_text":"Packt is searching for authors like you","text_count":39,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Packt is searching for authors like you"}]},{"block_type":"element","block":"k6pz2gzy","search_text":"If you're interested in becoming an author for Packt, please visit authors.packtpub.com and apply today. We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community. You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea.","text_count":382,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you're interested in becoming an author for Packt, please visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://authors.packtpub.com","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"authors.packtpub.com"}]},{"block_type":"text","content":"and apply today. We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community. You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea."}]},{"block_type":"element","block":"k6pz2gzz","search_text":"Preface","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Preface"}]},{"block_type":"element","block":"k6pz2h00","search_text":"The book you are reading right now is called Mastering Go and is all about helping you become a better Go developer!","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The book you are reading right now is called"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":"and is all about helping you become a better Go developer!"}]},{"block_type":"element","block":"k6pz2h01","search_text":"I tried to include the right amount of theory and hands on practice, but only you, the reader, can tell if I succeeded or not! Additionally, all presented examples are self-contained, which means that they can be used on their own or as templates for creating more complex applications.","text_count":286,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I tried to include the right amount of theory and hands on practice, but only you, the reader, can tell if I succeeded or not! Additionally, all presented examples are self-contained, which means that they can be used on their own or as templates for creating more complex applications."}]},{"block_type":"element","block":"k6pz2h02","search_text":"Please try to do the exercises located at the end of each chapter and do not hesitate to contact me with ways to make any future editions of this book even better!","text_count":163,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please try to do the exercises located at the end of each chapter and do not hesitate to contact me with ways to make any future editions of this book even better!"}]},{"block_type":"element","block":"k6pz2h03","search_text":"Who this book is for","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Who this book is for"}]},{"block_type":"element","block":"k6pz2h04","search_text":"This book is for amateur and intermediate Go programmers who want to take their Go knowledge to the next level as well as for experienced developers in other programming languages who want to learn Go without learning again how a for loop works.","text_count":245,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This book is for amateur and intermediate Go programmers who want to take their Go knowledge to the next level as well as for experienced developers in other programming languages who want to learn Go without learning again how a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop works."}]},{"block_type":"element","block":"k6pz2h05","search_text":"Some of the information found in this book can be also found in my other book, Go Systems Programming by Packt Publishing . The main difference between these two books is that Go Systems Programming is about developing system tools using the capabilities of Go, whereas Mastering Go is about explaining the capabilities and the internals of Go in order to become a better Go developer. Both books can be used as a reference after reading them for the first or the second time.","text_count":476,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Some of the information found in this book can be also found in my other book,&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming"}]},{"block_type":"text","content":"&nbsp;by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Packt Publishing"}]},{"block_type":"text","content":". The main difference between these two books is that"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming"}]},{"block_type":"text","content":"is about developing system tools using the capabilities of Go, whereas"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":"is about explaining the capabilities and the internals of Go in order to become a better Go developer. Both books can be used as a reference after reading them for the first or the second time."}]},{"block_type":"element","block":"k6pz2h06","search_text":"What this book covers","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"What this book covers"}]},{"block_type":"element","block":"k6pz2h07","search_text":"Chapter 1, Go and the Operating System , begins by talking about the history of Go and the advantages of Go before describing the godoc utility and explaining how you can compile and execute Go programs. After that, it talks about printing the output and getting user input, working with the command-line arguments of a program, and using log files. The last topic of the first chapter is error handling, which plays a key role in Go.","text_count":434,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 1,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go and the Operating System"}]},{"block_type":"text","content":", begins by talking about the history of Go and the advantages of Go before describing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility and explaining how you can compile and execute Go programs. After that, it talks about printing the output and getting user input, working with the command-line arguments of a program, and using log files. The last topic of the first chapter is error handling, which plays a key role in Go."}]},{"block_type":"element","block":"k6pz2h08","search_text":"Chapter 2, Understanding Go Internals , discusses the Go garbage collector and the way it operates. Then it talks about unsafe code and the unsafe package, how to call C code from a Go program, and how to call Go code from a C program. After that, it showcases the use of the defer keyword and presents the strace(1) and dtrace(1) utilities. In the remaining sections of the chapter, you will learn how to find information about your Go environment and the use of the Go assembler.","text_count":481,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 2,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Understanding Go Internals"}]},{"block_type":"text","content":", discusses the Go garbage collector and the way it operates. Then it talks about unsafe code and the unsafe package, how to call C code from a Go program, and how to call Go code from a C program. After that, it showcases the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword and presents the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"utilities. In the remaining sections of the chapter, you will learn how to find information about your Go environment and the use of the Go assembler."}]},{"block_type":"element","block":"k6pz2h09","search_text":"Chapter 3, Working with Basic Go Data Types , talks about the data types offered by Go, which includes arrays, slices, and maps as well as Go pointers, constants, loops, and working with dates and times. You would not want to miss this chapter!","text_count":244,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 3,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Working with Basic Go Data Types"}]},{"block_type":"text","content":", talks about the data types offered by Go, which includes arrays, slices, and maps as well as Go pointers, constants, loops, and working with dates and times. You would not want to miss this chapter!"}]},{"block_type":"element","block":"k6pz2h0a","search_text":"Chapter 4, The Uses of Composite Types , begins by teaching you about Go structures and the struct keyword before discussing tuples, strings, runes, byte slices, and string literals. The rest of the chapter talks about regular expressions and pattern matching, the switch statement, the strings package, the math/big package, and about developing a key-value store in Go.","text_count":371,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":", begins by teaching you about Go structures and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"keyword before discussing tuples, strings, runes, byte slices, and string literals. The rest of the chapter talks about regular expressions and pattern matching, the switch statement, the strings package, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"package, and about developing a key-value store in Go."}]},{"block_type":"element","block":"k6pz2h0b","search_text":"Chapter 5, Enhancing Go Code with Data Structures , is about developing your own data structures when the structures offered by Go do not fit a particular problem. This includes developing binary trees, linked lists, hash tables, stacks, and queues and learning about their advantages. This chapter also showcases the use of the structures found in the container standard Go package. The last topic of this chapter is random number generation.","text_count":443,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 5,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Enhancing Go Code with Data Structures"}]},{"block_type":"text","content":", is about developing your own data structures when the structures offered by Go do not fit a particular problem. This includes developing binary trees, linked lists, hash tables, stacks, and queues and learning about their advantages. This chapter also showcases the use of the structures found in the container standard Go package. The last topic of this chapter is random number generation."}]},{"block_type":"element","block":"k6pz2h0c","search_text":"Chapter 6, W hat You Might Not Know About Go Packages , is all about packages and functions, which also includes the use of the init() function, the syscall standard Go package, and the text/template and html/template packages. This chapter will definitely make you a better Go developer!","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 6, W"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"hat You Might Not Know About Go Packages"}]},{"block_type":"text","content":", is all about packages and functions, which also includes the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"packages. This chapter will definitely make you a better Go developer!"}]},{"block_type":"element","block":"k6pz2h0d","search_text":"Chapter 7, Reflection and Interfaces for All Seasons , discusses three advanced Go concepts: reflection, interfaces, and type methods. The last part of the chapter is about object oriented programming in Go!","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 7,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Reflection and Interfaces for All Seasons"}]},{"block_type":"text","content":", discusses three advanced Go concepts: reflection, interfaces, and type methods. The last part of the chapter is about object oriented programming in Go!"}]},{"block_type":"element","block":"k6pz2h0e","search_text":"Chapter 8, Telling a Unix System What to Do , is about systems programming in Go, which includes subjects such as the flag package for working with command-line arguments, handling Unix signals, file input and output, the bytes package, and the io.Reader and io.Writer interfaces. As I told you before, if you are really into systems programming in Go, then getting Go Systems Programming after reading Mastering Go is highly recommended!","text_count":438,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":", is about systems programming in Go, which includes subjects such as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package for working with command-line arguments, handling Unix signals, file input and output, the bytes package, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interfaces. As I told you before, if you are really into systems programming in Go, then getting"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming"}]},{"block_type":"text","content":"after reading"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":"is highly recommended!"}]},{"block_type":"element","block":"k6pz2h0f","search_text":"Chapter 9, Concurrency in Go – Goroutines, Channels, and Pipelines , discusses goroutines, channels and pipelines, which is the Go way of achieving concurrency. You will also learn about the differences between processes, threads, and goroutines, and the sync package and the way the Go scheduler operates.","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Concurrency in Go &ndash; Goroutines, Channels, and Pipelines"}]},{"block_type":"text","content":", discusses goroutines, channels and pipelines, which is the Go way of achieving concurrency. You will also learn about the differences between processes, threads, and goroutines, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package and the way the Go scheduler operates."}]},{"block_type":"element","block":"k6pz2h0g","search_text":"Chapter 10, Concurrency in Go – Advanced Topics , will continue from the point where the previous chapter left off and make you a master of goroutines and channels! You will learn more about the Go scheduler, the use of the powerful select keyword and the various types of Go channels as well as shared memory, mutexes, the sync.Mutex type, and the sync.RWMutex type. The last part of the chapter will talk about the context package, worker pools, and how to detect race conditions.","text_count":482,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Concurrency in Go &ndash; Advanced Topics"}]},{"block_type":"text","content":", will continue from the point where the previous chapter left off and make you a master of goroutines and channels! You will learn more about the Go scheduler, the use of the powerful"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword and the various types of Go channels as well as shared memory, mutexes, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"type, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"type. The last part of the chapter will talk about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package, worker pools, and how to detect race conditions."}]},{"block_type":"element","block":"k6pz2h0h","search_text":"Chapter 11, Code Testing, Optimization, and Profiling , discusses code testing, code optimization, and code profiling as well as about cross compilation, creating documentation, benchmarking Go code, creating example function, and finding unreachable Go code.","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization, and Profiling"}]},{"block_type":"text","content":", discusses code testing, code optimization, and code profiling as well as about cross compilation, creating documentation, benchmarking Go code, creating example function, and finding unreachable Go code."}]},{"block_type":"element","block":"k6pz2h0i","search_text":"Chapter 12, The Foundations of Network Programming in Go , is all about the net/http package and how you can develop web clients and web servers in Go. This also includes the use of the http.Response , http.Request and http.Transport structures and the http.NewServeMux type. You will even learn how to develop an entire website in Go! Furthermore, in this chapter, you will learn how to read the configuration of your network interfaces and how to perform DNS lookups in Go.","text_count":475,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Foundations of Network Programming in Go"}]},{"block_type":"text","content":", is all about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"package and how you can develop web clients and web servers in Go. This also includes the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"&nbsp;and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structures and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":"type. You will even learn how to develop an entire website in Go! Furthermore, in this chapter, you will learn how to read the configuration of your network interfaces and how to perform DNS lookups in Go."}]},{"block_type":"element","block":"k6pz2h0j","search_text":"Chapter 13, Network Programming – Building Your Own Servers and Clients , talks about creating UDP and TCP servers and clients in Go, using the functionality offered by the net package. Other topics included in this chapter are how to create RPC clients and servers as well as develop a concurrent TCP server in Go and read raw network packages!","text_count":345,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming &ndash; Building Your Own Servers and Clients"}]},{"block_type":"text","content":", talks about creating UDP and TCP servers and clients in Go, using the functionality offered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package. Other topics included in this chapter are how to create RPC clients and servers as well as develop a concurrent TCP server in Go and read raw network packages!"}]},{"block_type":"element","block":"k6pz2h0k","search_text":"To get the most out of this book","text_count":32,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"To get the most out of this book"}]},{"block_type":"element","block":"k6pz2h0l","search_text":"This book requires any Unix machine with a relatively recent Go version installed, which includes any machine running Mac OS X, macOS or Linux. Most of the presented code will also work on Microsoft Windows machines.","text_count":216,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This book requires any Unix machine with a relatively recent Go version installed, which includes any machine running Mac OS X, macOS or Linux. Most of the presented code will also work on Microsoft Windows machines."}]},{"block_type":"element","block":"k6pz2h0m","search_text":"To get the most out of this book, you should try to apply the knowledge of each chapter in your own programs as soon as possible, and see what works and what does not! As I told you before, try to solve the exercises found at the end of each chapter, or create your own programming problems.","text_count":291,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"To get the most out of this book, you should try to apply the knowledge of each chapter in your own programs as soon as possible, and see what works and what does not! As I told you before, try to solve the exercises found at the end of each chapter, or create your own programming problems."}]},{"block_type":"element","block":"k6pz2h0n","search_text":"Download the example code files","text_count":31,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Download the example code files"}]},{"block_type":"element","block":"k6pz2h0o","search_text":"You can download the example code files for this book from your account at www.packtpub.com . If you purchased this book elsewhere, you can visit www.packtpub.com/support and register to have the files emailed directly to you.","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can download the example code files for this book from your account at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.packtpub.com","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"www.packtpub.com"}]},{"block_type":"text","content":". If you purchased this book elsewhere, you can visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.packtpub.com/support","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"www.packtpub.com/support"}]},{"block_type":"text","content":"and register to have the files emailed directly to you."}]},{"block_type":"element","block":"k6pz2h0p","search_text":"You can download the code files by following these steps:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can download the code files by following these steps:"}]},{"block_type":"element","block":"k6pz2h0q","search_text":"Log in or register at www.packtpub.com . Select the SUPPORT tab. Click on Code Downloads & Errata. Enter the name of the book in the Search box and follow the onscreen instructions. ","text_count":182,"tag_name":"ol","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Log in or register at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.packtpub.com/support","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"www.packtpub.com"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Select the SUPPORT tab."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Click on Code Downloads &amp; Errata."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Enter the name of the book in the Search box and follow the onscreen instructions."}]}]},{"block_type":"element","block":"k6pz2h0r","search_text":"Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:"}]},{"block_type":"element","block":"k6pz2h0s","search_text":"WinRAR/7-Zip for Windows Zipeg/iZip/UnRarX for Mac 7-Zip/PeaZip for Linux ","text_count":74,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"WinRAR/7-Zip for Windows"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Zipeg/iZip/UnRarX for Mac"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"7-Zip/PeaZip for Linux"}]}]},{"block_type":"element","block":"k6pz2h0t","search_text":"The code bundle for the book is also hosted on GitHub at https://github.com/PacktPublishing/Mastering-Go . In case there's an update to the code, it will be updated on the existing GitHub repository.","text_count":199,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code bundle for the book is also hosted on GitHub at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/PacktPublishing/Mastering-Go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/PacktPublishing/Mastering-Go"}]},{"block_type":"text","content":".&nbsp;In case there's an update to the code, it will be updated on the existing GitHub repository."}]},{"block_type":"element","block":"k6pz2h0u","search_text":"We also have other code bundles from our rich catalog of books and videos available at https://github.com/PacktPublishing/ . Check them out!","text_count":140,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We also have other code bundles from our rich catalog of books and videos available at&nbsp;"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/PacktPublishing/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/PacktPublishing/"}]}]},{"block_type":"text","content":". Check them out!"}]},{"block_type":"element","block":"k6pz2h0v","search_text":"Download the color images","text_count":25,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Download the color images"}]},{"block_type":"element","block":"k6pz2h0w","search_text":"We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here: https://www.packtpub.com/sites/default/files/downloads/MasteringGo_ColorImages.pdf .","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here:"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.packtpub.com/sites/default/files/downloads/MasteringGo_ColorImages.pdf"},"children":[{"block_type":"text","content":"https://www.packtpub.com/sites/default/files/downloads/MasteringGo_ColorImages.pdf"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h0x","search_text":"Conventions used","text_count":16,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Conventions used"}]},{"block_type":"element","block":"k6pz2h0y","search_text":"There are a number of text conventions used throughout this book.","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are a number of text conventions used throughout this book."}]},{"block_type":"element","block":"k6pz2h0z","search_text":"CodeInText : Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: \"The first way is similar to using the man(1) command, but for Go functions and packages.\"","text_count":273,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CodeInText"}]},{"block_type":"text","content":": Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: \"The first way is similar to using the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"man(1)"}]},{"block_type":"text","content":"&nbsp;command, but for Go functions and packages.\""}]},{"block_type":"element","block":"k6pz2h10","search_text":"A block of code is set as follows:","text_count":34,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A block of code is set as follows:"}]},{"block_type":"element","block":"k6pz2h11","search_text":"package main import ( \"fmt\" ) func main() { fmt.Println(\"This is a sample Go program!\") } ","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    fmt.Println(\"This is a sample Go program!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h12","search_text":"When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:"}]},{"block_type":"element","block":"k6pz2h13","search_text":"package main import ( \"fmt\" ) func main() { fmt.Println(\"This is a sample Go program!\") } ","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    fmt.Println(\"This is a sample Go program!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h14","search_text":"Any command-line input or output is written as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Any command-line input or output is written as follows:"}]},{"block_type":"element","block":"k6pz2h15","search_text":"$ date Sat Oct 21 20:09:20 EEST 2017 $ go version go version go1.9.1 darwin/amd64 ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ date\nSat Oct 21 20:09:20 EEST 2017\n$ go version\ngo version go1.9.1 darwin/amd64"}]}]},{"block_type":"element","block":"k6pz2h16","search_text":"Bold : Indicates a new term, an important word, or words that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: \"Select System info from the Administration panel.\"","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Bold"}]},{"block_type":"text","content":": Indicates a new term, an important word, or words that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: \"Select System info from the Administration panel.\""}]},{"block_type":"element","block":"k6pz2h17","search_text":"Note Warnings or important notes appear like this. ","text_count":51,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Warnings or important notes appear like this."}]}]},{"block_type":"element","block":"k6pz2h18","search_text":"Tip Tips and tricks appear like this. ","text_count":38,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Tips and tricks appear like this."}]}]},{"block_type":"element","block":"k6pz2h19","search_text":"Get in touch","text_count":12,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Get in touch"}]},{"block_type":"element","block":"k6pz2h1a","search_text":"Feedback from our readers is always welcome.","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Feedback from our readers is always welcome."}]},{"block_type":"element","block":"k6pz2h1b","search_text":"General feedback : Email feedback@packtpub.com and mention the book title in the subject of your message. If you have questions about any aspect of this book, please email us at questions@packtpub.com .","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"General feedback"}]},{"block_type":"text","content":": Email"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"feedback@packtpub.com"}]},{"block_type":"text","content":"and mention the book title in the subject of your message. If you have questions about any aspect of this book, please email us at"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"questions@packtpub.com"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h1c","search_text":"Errata : Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit www.packtpub.com/submit-errata , selecting your book, clicking on the Errata Submission Form link, and entering the details.","text_count":334,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Errata"}]},{"block_type":"text","content":": Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.packtpub.com/submit-errata","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"www.packtpub.com/submit-errata"}]},{"block_type":"text","content":", selecting your book, clicking on the Errata Submission Form link, and entering the details."}]},{"block_type":"element","block":"k6pz2h1d","search_text":"Piracy : If you come across any illegal copies of our works in any form on the Internet, we would be grateful if you would provide us with the location address or website name. Please contact us at copyright@packtpub.com with a link to the material.","text_count":249,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Piracy"}]},{"block_type":"text","content":": If you come across any illegal copies of our works in any form on the Internet, we would be grateful if you would provide us with the location address or website name. Please contact us at"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copyright@packtpub.com"}]},{"block_type":"text","content":"with a link to the material."}]},{"block_type":"element","block":"k6pz2h1e","search_text":"If you are interested in becoming an author : If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit authors.packtpub.com .","text_count":196,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"If you are interested in becoming an author"}]},{"block_type":"text","content":": If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://authors.packtpub.com/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"authors.packtpub.com"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h1f","search_text":"Reviews","text_count":7,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reviews"}]},{"block_type":"element","block":"k6pz2h1g","search_text":"Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you!","text_count":339,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you!"}]},{"block_type":"element","block":"k6pz2h1h","search_text":"For more information about Packt, please visit packtpub.com .","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For more information about Packt, please visit&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.packtpub.com/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"packtpub.com"}]},{"block_type":"text","content":"."}]}]},{"title":"Go and the Operating System","author":"Mihalis Tsoukalos","block":"k6pz2460","number":1,"contents":[{"block_type":"element","block":"k6pz2h1i","search_text":"This chapter will serve as an introduction to various Go topics that may appear slightly ingenuous and naïve at first. The topics contained in this chapter, however, will be used throughout the entire book, so you'll need to make sure that you completely understand them. As happens with most practical subjects, the best way to understand something is to experiment with it. In this case, experimenting means writing Go code on your own, making your own mistakes, and learning from them! Just don't let the error messages discourage you.","text_count":538,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter will serve as an introduction to various Go topics that may appear slightly ingenuous and na&iuml;ve at first. The topics contained in this chapter, however, will be used throughout the entire book, so you'll need to make sure that you completely understand them. As happens with most practical subjects, the best way to understand something is to experiment with it. In this case, experimenting means writing Go code on your own, making your own mistakes, and learning from them! Just don't let the error messages discourage you."}]},{"block_type":"element","block":"k6pz2h1j","search_text":"In the first chapter, you will learn the following topics:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the first chapter, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2h1k","search_text":"The history of the Go programming language ","text_count":43,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The history of the Go programming language"}]}]},{"block_type":"element","block":"k6pz2h1l","search_text":"The reasons that Go is a good choice for developing your applications ","text_count":70,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The reasons that Go is a good choice for developing your applications"}]}]},{"block_type":"element","block":"k6pz2h1m","search_text":"Compiling Go code ","text_count":18,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Compiling Go code"}]}]},{"block_type":"element","block":"k6pz2h1n","search_text":"Executing Go code ","text_count":18,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Executing Go code"}]}]},{"block_type":"element","block":"k6pz2h1o","search_text":"Downloading and using external Go packages ","text_count":43,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Downloading and using external Go packages"}]}]},{"block_type":"element","block":"k6pz2h1p","search_text":"Unix standard input, output, and error ","text_count":39,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Unix standard input, output, and error"}]}]},{"block_type":"element","block":"k6pz2h1q","search_text":"Printing data on the screen ","text_count":28,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Printing data on the screen"}]}]},{"block_type":"element","block":"k6pz2h1r","search_text":"Getting user input ","text_count":19,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Getting user input"}]}]},{"block_type":"element","block":"k6pz2h1s","search_text":"Printing data to standard error ","text_count":32,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Printing data to standard error"}]}]},{"block_type":"element","block":"k6pz2h1t","search_text":"Working with log files ","text_count":23,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Working with log files"}]}]},{"block_type":"element","block":"k6pz2h1u","search_text":"Dealing with error handling in Go ","text_count":34,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Dealing with error handling in Go"}]}]},{"block_type":"element","block":"k6pz2h1v","search_text":"The structure of the book","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The structure of the book"}]},{"block_type":"element","block":"k6pz2h1w","search_text":"Mastering Go can be divided into three logical parts. The first part consists of four chapters, and it takes a sophisticated look at some important Go concepts, including user input and output, downloading external Go packages, compiling Go code, calling C code from Go, as well as using Go basic types and Go composite types.","text_count":326,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":"can be divided into three logical parts. The first part consists of four chapters, and it takes a sophisticated look at some important Go concepts, including user input and output, downloading external Go packages, compiling Go code, calling C code from Go, as well as using Go basic types and Go composite types."}]},{"block_type":"element","block":"k6pz2h1x","search_text":"The second part consists of three chapters that deal with Go code organization, the design of Go projects, and some advanced features of Go, respectively.","text_count":154,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part consists of three chapters that deal with Go code organization, the design of Go projects, and some advanced features of Go, respectively."}]},{"block_type":"element","block":"k6pz2h1y","search_text":"The third part includes the remaining six chapters and deals with the more practical Go topics, including systems programming in Go, concurrency in Go, code testing, optimization, and profiling. The last two chapters of this book will also talk about network programming in Go.","text_count":277,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part includes the remaining six chapters and deals with the more practical Go topics, including systems programming in Go, concurrency in Go, code testing, optimization, and profiling. The last two chapters of this book will also talk about network programming in Go."}]},{"block_type":"element","block":"k6pz2h1z","search_text":"The book will present relatively small, yet complete Go programs that illustrate the concepts presented. This has two main advantages: first, you do not have to look at an endless code listing when trying to learn a single technique, and second, you can use this code as a starting point when creating your own applications and utilities.","text_count":338,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The book will present relatively small, yet complete Go programs that illustrate the concepts presented. This has two main advantages: first, you do not have to look at an endless code listing when trying to learn a single technique, and second, you can use this code as a starting point when creating your own applications and utilities."}]},{"block_type":"element","block":"k6pz2h20","search_text":"Note that the focus of this book is machines that run a variant of the Unix operating system; this does not mean that the Go code presented will not run on Microsoft Windows machines—after all Go is portable! It just means that the included Go code has been tested on various Unix variants, mainly on macOS High Sierra and Debian Linux .","text_count":337,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the focus of this book is machines that run a variant of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unix"}]},{"block_type":"text","content":"operating system; this does not mean that the Go code presented will not run on Microsoft Windows machines&mdash;after all Go is portable! It just means that the included Go code has been tested on various Unix variants, mainly on"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"macOS"}]},{"block_type":"text","content":"High Sierra and Debian"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Linux"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h21","search_text":"The history of Go","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The history of Go"}]},{"block_type":"element","block":"k6pz2h22","search_text":"Go is a modern, generic purpose open-source programming language that was officially announced at the end of 2009. It began as an internal Google project, which means that it was started as an experiment, and it is inspired by many other programming languages, including C , Pascal , Alef , and Oberon . Its spiritual fathers are Robert Griesemer , Ken Thomson , and Rob Pike , who are professional programmers who designed Go as a language for professional programmers who want to build reliable, robust, and efficient software. Apart from its syntax and its standard functions, Go comes with a pretty rich standard library.","text_count":625,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go is a modern, generic purpose open-source programming language that was officially announced at the end of 2009. It began as an internal Google project, which means that it was started as an experiment, and it is inspired by many other programming languages, including"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pascal"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Alef"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Oberon"}]},{"block_type":"text","content":". Its spiritual fathers are"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Robert Griesemer"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Ken Thomson"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Rob Pike"}]},{"block_type":"text","content":", who are professional programmers who&nbsp;designed Go as a language for professional programmers who want to build reliable, robust, and efficient software. Apart from its syntax and its standard functions, Go comes with a pretty rich standard library."}]},{"block_type":"element","block":"k6pz2h23","search_text":"At the time of writing this chapter, the current stable Go version is 1.9.1, but version 1.9.2 is on its way:","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the time of writing this chapter, the current stable Go version is 1.9.1, but version 1.9.2 is on its way:"}]},{"block_type":"element","block":"k6pz2h24","search_text":"$ date Sat Oct 21 20:09:20 EEST 2017 $ go version go version go1.9.1 darwin/amd64 ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ date\nSat Oct 21 20:09:20 EEST 2017\n$ go version\ngo version go1.9.1 darwin/amd64"}]}]},{"block_type":"element","block":"k6pz2h25","search_text":"I am pretty confident that by the time this book is published, the output of the go version command will be different! The good news is that due to the way that Go progresses, this book will remain relevant for many years!","text_count":222,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I am pretty confident that by the time this book is published, the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go version"}]},{"block_type":"text","content":"command will be different! The good news is that due to the way that Go progresses, this book will remain relevant for many years!"}]},{"block_type":"element","block":"k6pz2h26","search_text":"If you are installing Go for the first time, you can start by visiting https://golang.org/dl/ . However, there is a good chance that your Unix variant already has a ready-to-install package for the Go programming language, so you might want to get Go, using your favorite package manager.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are installing Go for the first time, you can start by visiting"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/dl/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/dl/"}]},{"block_type":"text","content":". However, there is a good chance that your Unix variant already has a ready-to-install package for the Go programming language, so you might want to get Go, using your favorite package manager."}]},{"block_type":"element","block":"k6pz2h27","search_text":"Why learn Go?","text_count":13,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Why learn Go?"}]},{"block_type":"element","block":"k6pz2h28","search_text":"Go is a modern programming language that allows you to write safe code without silly bugs—do not worry, you can still create complex bugs! Most of all, though, Go wants to have happy developers; therefore, by design, Go code looks attractive and familiar, and it is easy to write.","text_count":280,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go is a modern programming language that allows you to write safe code without silly bugs&mdash;do not worry, you can still create complex bugs! Most of all, though, Go wants to have happy developers; therefore, by design, Go code looks attractive and familiar, and it is easy to write."}]},{"block_type":"element","block":"k6pz2h29","search_text":"The next section talks more analytically about the advantages of Go.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next section talks more analytically about the advantages of Go."}]},{"block_type":"element","block":"k6pz2h2a","search_text":"Go advantages","text_count":13,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go advantages"}]},{"block_type":"element","block":"k6pz2h2b","search_text":"Go has many advantages—some of them are unique to Go, while others are shared with other programming languages.","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go has many advantages&mdash;some of them are unique to Go, while others are shared with other programming languages."}]},{"block_type":"element","block":"k6pz2h2c","search_text":"The most significant Go advantages and features are as follows:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The most significant Go advantages and features are as follows:"}]},{"block_type":"element","block":"k6pz2h2d","search_text":"Go is a modern programming language that was created by experienced developers. ","text_count":80,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go is a modern programming language that was created by experienced developers."}]}]},{"block_type":"element","block":"k6pz2h2e","search_text":"Go release candidates are used first by Google staff for production use! ","text_count":73,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go release candidates are used first by Google staff for production use!"}]}]},{"block_type":"element","block":"k6pz2h2f","search_text":"Go code is easy to read and easy to understand. ","text_count":48,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go code is easy to read and easy to understand."}]}]},{"block_type":"element","block":"k6pz2h2g","search_text":"Go wants happy developers, because a happy developer writes better code! ","text_count":73,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go wants happy developers, because a happy developer writes better code!"}]}]},{"block_type":"element","block":"k6pz2h2h","search_text":"The Go compiler prints practical warning and error messages that help you solve the actual problem. Put simply, the Go compiler is here to help you, and not to make your life miserable by printing pointless output! ","text_count":215,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The Go compiler prints practical warning and error messages that help you solve the actual problem. Put simply, the Go compiler is here to help you, and not to make your life miserable by printing pointless output!"}]}]},{"block_type":"element","block":"k6pz2h2i","search_text":"Go code is portable, especially between Unix machines. ","text_count":55,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go code is portable, especially between Unix machines."}]}]},{"block_type":"element","block":"k6pz2h2j","search_text":"Go has support for procedural, concurrent, and distributed programming. ","text_count":72,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go has support for procedural, concurrent, and distributed programming."}]}]},{"block_type":"element","block":"k6pz2h2k","search_text":"Go supports Garbage Collection , so you do not have to deal with memory allocation and deallocation. ","text_count":101,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go supports"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Garbage Collection"}]},{"block_type":"text","content":", so you do not have to deal with memory allocation and deallocation."}]}]},{"block_type":"element","block":"k6pz2h2l","search_text":"Go does not have a preprocessor . It does high-speed compilation. As a consequence, Go can also be used as a scripting language. ","text_count":129,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go does not have a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"preprocessor"}]},{"block_type":"text","content":". It does high-speed compilation. As a consequence, Go can also be used as a scripting language."}]}]},{"block_type":"element","block":"k6pz2h2m","search_text":"Go can build web applications, and it provides a simple web server for testing purposes. ","text_count":89,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go can build web applications, and it provides a simple web server for testing purposes."}]}]},{"block_type":"element","block":"k6pz2h2n","search_text":"The standard Go library offers many packages that simplify the work of the developer. Additionally, the functions found in the standard Go library are tested and debugged in advance by the people who develop Go, which means that most of the time these functions come without bugs. ","text_count":281,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The standard Go library offers many packages that simplify the work of the developer. Additionally, the functions found in the standard Go library are tested and debugged in advance by the people who develop Go, which means that most of the time these functions come without bugs."}]}]},{"block_type":"element","block":"k6pz2h2o","search_text":"Go uses static linking by default, which means that the binary files produced can be easily transferred to other machines with the same OS. As a consequence, once a Go program is compiled successfully and an executable file is generated, the developer does not need to worry about libraries, dependencies, and different library versions anymore. ","text_count":346,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go uses"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"static linking"}]},{"block_type":"text","content":"by default, which means that the binary files produced can be easily transferred to other machines with the same OS. As a consequence, once a Go program is compiled successfully and an executable file is generated, the developer does not need to worry about libraries, dependencies, and different library versions anymore."}]}]},{"block_type":"element","block":"k6pz2h2p","search_text":"You will not need a GUI for developing, debugging, and testing Go applications, as Go can be used from the command-line, which many Unix people prefer. ","text_count":152,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You will not need a GUI for developing, debugging, and testing Go applications, as Go can be used from the command-line, which many Unix people prefer."}]}]},{"block_type":"element","block":"k6pz2h2q","search_text":"Go supports Unicode , which means that you do not need any extra code for printing characters from multiple human languages. ","text_count":125,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go supports"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unicode"}]},{"block_type":"text","content":", which means that you do not need any extra code for printing characters from multiple human languages."}]}]},{"block_type":"element","block":"k6pz2h2r","search_text":"Go keeps concepts orthogonal, because a few orthogonal features work better than many overlapping ones. ","text_count":104,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go keeps concepts orthogonal, because a few orthogonal features work better than many overlapping ones."}]}]},{"block_type":"element","block":"k6pz2h2s","search_text":"Is Go perfect?","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Is Go perfect?"}]},{"block_type":"element","block":"k6pz2h2t","search_text":"There is no such thing as the perfect programming language, and Go is no exception to this rule. However, some programming languages are better at some areas of programming, or we just like them more than other programming languages. Personally, I do not like Java, and while I used to like C++, I do not like it anymore. This is mainly because I find the look of Java and C++ code to be unpleasant.","text_count":399,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is no such thing as the perfect programming language, and Go is no exception to this rule. However, some programming languages are better at some areas of programming, or we just like them more than other programming languages. Personally, I do not like Java, and while I used to like C++, I do not like it anymore. This is mainly because I find the look of Java and C++ code to be unpleasant."}]},{"block_type":"element","block":"k6pz2h2u","search_text":"Some of the disadvantages of Go are as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Some of the disadvantages of Go are as follows:"}]},{"block_type":"element","block":"k6pz2h2v","search_text":"Go does not have direct support for object-oriented programming ( OOP ), which can be a problem for programmers who are used to writing code in an object-oriented manner. Nevertheless, you can use composition in Go to mimic inheritance. ","text_count":237,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go does not have direct support for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"object-oriented programming"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"OOP"}]},{"block_type":"text","content":"), which can be a problem for programmers who are used to writing code in an object-oriented manner. Nevertheless, you can use composition in Go to mimic inheritance."}]}]},{"block_type":"element","block":"k6pz2h2w","search_text":"For some people who still prefer C, Go will never replace C! ","text_count":61,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"For some people who still prefer C, Go will never replace C!"}]}]},{"block_type":"element","block":"k6pz2h2x","search_text":"C is still faster than any other programming language for systems programming, mainly because Unix is written in C. ","text_count":116,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"C is still faster than any other programming language for systems programming, mainly because Unix is written in C."}]}]},{"block_type":"element","block":"k6pz2h2y","search_text":"Nevertheless, Go is a pretty decent and modern programming language that will not disappoint if you find the time to learn it and program in it.","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Nevertheless, Go is a pretty decent and modern programming language that will not disappoint if you find the time to learn it and program in it."}]},{"block_type":"element","block":"k6pz2h2z","search_text":"What is a preprocessor?","text_count":23,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"What is a preprocessor?"}]},{"block_type":"element","block":"k6pz2h30","search_text":"Earlier, I said that Go does not have a preprocessor, and that this is a good thing. A preprocessor is a program that processes your input data and generates output that will be used as the input to another program. In the context of programming languages, the input of a preprocessor is source code that will be processed by the preprocessor before given as input to the compiler of the programming language. The biggest disadvantage of a preprocessor is that it knows nothing about the underlying language or its syntax!","text_count":522,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Earlier, I said that Go does not have a preprocessor, and that this is a good thing. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"preprocessor"}]},{"block_type":"text","content":"is a program that processes your input data and generates output that will be used as the input to another program. In the context of programming languages, the input of a preprocessor is source code that will be processed by the preprocessor before given as input to the compiler of the programming language. The biggest disadvantage of a preprocessor is that it knows nothing about the underlying language or its syntax!"}]},{"block_type":"element","block":"k6pz2h31","search_text":"Put simply, this means that when a preprocessor is used, you cannot be certain that the final version of your code will do what you really want it to do because the preprocessor might alter the logic as well as the semantics of your original code!","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Put simply, this means that when a preprocessor is used, you cannot be certain that the final version of your code will do what you really want it to do because the preprocessor might alter the logic as well as the semantics of your original code!"}]},{"block_type":"element","block":"k6pz2h32","search_text":"The list of programming languages with a preprocessor includes, but is not limited to C, C++, Ada, and PL/SQL. The infamous C preprocessor processes lines that begin with # and are called directives or pragmas . Directives and pragmas are not part of the C programming language!","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The list of programming languages with a preprocessor includes, but is not limited to C, C++, Ada, and PL/SQL. The infamous C preprocessor processes lines that begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"#"}]},{"block_type":"text","content":"and are called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"directives"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pragmas"}]},{"block_type":"text","content":". Directives and pragmas are not part of the C programming language!"}]},{"block_type":"element","block":"k6pz2h33","search_text":"The godoc utility","text_count":17,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The godoc utility"}]},{"block_type":"element","block":"k6pz2h34","search_text":"The Go distribution comes with a plethora of tools that can simplify your life as a programmer. One of these tools is the godoc utility, which allows you to see the documentation of existing Go functions and packages without needing an internet connection.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go distribution comes with a plethora of tools that can simplify your life as a programmer. One of these tools is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility, which allows you to see the documentation of existing Go functions and packages without needing an internet connection."}]},{"block_type":"element","block":"k6pz2h35","search_text":"The godoc utility can be executed either as a normal command-line application that displays its output on a Terminal window, or as a command-line application that starts a web server. In the latter case, you will need a web browser to look at the Go documentation.","text_count":264,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility can be executed either as a normal command-line application that displays its output on a Terminal window, or as a command-line application that starts a web server. In the latter case, you will need a web browser to look at the Go documentation."}]},{"block_type":"element","block":"k6pz2h36","search_text":"Tip If you type godoc without any command-line parameters, you will get the list of the command-line options supported by godoc . ","text_count":130,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"without any command-line parameters, you will get the list of the command-line options supported by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h37","search_text":"The first way of executing godoc is similar to using the man(1) command, but for Go functions and packages. So, in order to find out information about the Printf() function of the fmt package, you should execute the following command:","text_count":234,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first way of executing godoc is similar to using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"man(1)"}]},{"block_type":"text","content":"command, but for Go functions and packages. So, in order to find out information about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Printf()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package, you should execute the following command:"}]},{"block_type":"element","block":"k6pz2h38","search_text":"$ godoc fmt Printf ","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc fmt Printf"}]}]},{"block_type":"element","block":"k6pz2h39","search_text":"Similarly, you can find out information about the entire fmt package by running the next command:","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, you can find out information about the entire"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package by running the next command:"}]},{"block_type":"element","block":"k6pz2h3a","search_text":"$ godoc cmd/fmt","text_count":15,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc cmd/fmt"}]}]},{"block_type":"element","block":"k6pz2h3b","search_text":"The second way requires executing godoc with the -http parameter:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second way requires executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-http"}]},{"block_type":"text","content":"parameter:"}]},{"block_type":"element","block":"k6pz2h3c","search_text":"$ godoc -http=:8001","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc -http=:8001"}]}]},{"block_type":"element","block":"k6pz2h3d","search_text":"The numeric value used in the preceding command, 8001 , is the port number to which the HTTP server will listen. You can choose any port number that is available provided that you have the right privileges. However, note that port numbers 0-1023 are restricted and can only be used by the root user. Thus, it is better to avoid choosing one of them and to pick something else provided that it is not already in use by a different process.","text_count":438,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The numeric value used in the preceding command,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"8001"}]},{"block_type":"text","content":", is the port number to which the HTTP server will listen. You can choose any port number that is available provided that you have the right privileges. However, note that port numbers"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0-1023"}]},{"block_type":"text","content":"are restricted and can only be used by the root user. Thus, it is better to avoid choosing one of them and to pick something else provided that it is not already in use by a different process."}]},{"block_type":"element","block":"k6pz2h3e","search_text":"You can omit the equal sign in the command presented and put a space character in its place. So, the next command is the complete equivalent of the previous one:","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can omit the equal sign in the command presented and put a space character in its place. So, the next command is the complete equivalent of the previous one:"}]},{"block_type":"element","block":"k6pz2h3f","search_text":"$ godoc -http :8001","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc -http :8001"}]}]},{"block_type":"element","block":"k6pz2h3g","search_text":"After that, you should point your web browser to the http://localhost:8001/pkg/ URL in order to get the list of the available Go packages and to browse their documentation.","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you should point your web browser to the"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://localhost:8001/pkg/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://localhost:8001/pkg/"}]},{"block_type":"text","content":"URL in order to get the list of the available Go packages and to browse their documentation."}]},{"block_type":"element","block":"k6pz2h3h","search_text":"Compiling Go code","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Compiling Go code"}]},{"block_type":"element","block":"k6pz2h3i","search_text":"In this section, you will learn how to compile Go code. The good news is that you can compile your Go code from the command-line without needing a graphical application.","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to compile Go code. The good news is that you can compile your Go code from the command-line without needing a graphical application."}]},{"block_type":"element","block":"k6pz2h3j","search_text":"Furthermore, Go does not care about the name of the source file of an autonomous program as long as the package name is main and there is a single main() function in it, because the main() function is where the program execution begins. As a result, you cannot have multiple main() functions in the files of a single project.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Furthermore, Go does not care about the name of the source file of an autonomous program as long as the package name is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"and there is a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function in it, because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function is where the program execution begins. As a result, you cannot have multiple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"functions in the files of a single project."}]},{"block_type":"element","block":"k6pz2h3k","search_text":"We will start our first Go program compilation with a program named aSourceFile.go that contains the next Go code:","text_count":114,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We will start our first Go program compilation with a program named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSourceFile.go"}]},{"block_type":"text","content":"that contains the next Go code:"}]},{"block_type":"element","block":"k6pz2h3l","search_text":"package main import ( \"fmt\" ) func main() { fmt.Println(\"This is a sample Go program!\") } ","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    fmt.Println(\"This is a sample Go program!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h3m","search_text":"So, in order to compile aSourceFile.go and create a statically linked executable file, you will need to execute this command:","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, in order to compile"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSourceFile.go"}]},{"block_type":"text","content":"and create a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"statically linked"}]},{"block_type":"text","content":"executable file, you will need to execute this command:"}]},{"block_type":"element","block":"k6pz2h3n","search_text":"$ go build aSourceFile.go","text_count":25,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build aSourceFile.go"}]}]},{"block_type":"element","block":"k6pz2h3o","search_text":"After that, you will have a new executable file named aSourceFile :","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you will have a new executable file named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSourceFile"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h3p","search_text":"$ file aSourceFile aSourceFile: Mach-O 64-bit executable x86_64 $ ls -l aSourceFile -rwxr-xr-x 1 mtsouk staff 1933104 Oct 14 21:50 aSourceFile $ ./aSourceFile This is a sample Go program!","text_count":187,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ file aSourceFile\naSourceFile: Mach-O 64-bit executable x86_64\n$ ls -l aSourceFile\n-rwxr-xr-x  1 mtsouk  staff  1933104 Oct 14 21:50 aSourceFile\n$ ./aSourceFile\nThis is a sample Go program!"}]}]},{"block_type":"element","block":"k6pz2h3q","search_text":"The main reason that aSourceFile is that big is because it is statically linked, which means that it does not require any external libraries in order to run.","text_count":157,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main reason that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSourceFile"}]},{"block_type":"text","content":"is that big is because it is statically linked, which means that it does not require any external libraries in order to run."}]},{"block_type":"element","block":"k6pz2h3r","search_text":"Executing Go code","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Executing Go code"}]},{"block_type":"element","block":"k6pz2h3s","search_text":"There is another way to execute your Go code that does not create any permanent executable files—it just generates some intermediate files that are automatically deleted afterwards.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is another way to execute your Go code that does not create any permanent executable files&mdash;it just generates some intermediate files that are automatically deleted afterwards."}]},{"block_type":"element","block":"k6pz2h3t","search_text":"Tip The method presented in this chapter allows you to use Go as if it were a scripting language like Python , Ruby , and Perl . ","text_count":129,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The method presented in this chapter allows you to use Go as if it were a scripting language like"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Python"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Ruby"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Perl"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h3u","search_text":"In order to run aSourceFile.go without creating an executable file, you will need to execute the next command:","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to run"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSourceFile.go"}]},{"block_type":"text","content":"without creating an executable file, you will need to execute the next command:"}]},{"block_type":"element","block":"k6pz2h3v","search_text":"$ go run aSourceFile.go This is a sample Go program!","text_count":52,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run aSourceFile.go\nThis is a sample Go program!"}]}]},{"block_type":"element","block":"k6pz2h3w","search_text":"As you can see, the output of the preceding command is exactly the same as before.","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the output of the preceding command is exactly the same as before."}]},{"block_type":"element","block":"k6pz2h3x","search_text":"Tip With go run , the Go compiler still needs to create an executable file. The fact that you will not see it, that it is automatically executed, and that it is automatically deleted after the program has finished might make you think that there is no need for an executable file! ","text_count":281,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"With"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":", the Go compiler still needs to create an executable file. The fact that you will not see it, that it is automatically executed, and that it is automatically deleted after the program has finished might make you think that there is no need for an executable file!"}]}]},{"block_type":"element","block":"k6pz2h3y","search_text":"This book mainly uses go run to execute the example code, primarily because it is simpler than running go build and then running the executable file. Additionally, go run does not leave any files on your hard drive after the program has finished its execution.","text_count":260,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This book mainly uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"to execute the example code, primarily because it is simpler than running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"and then running the executable file. Additionally,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"does not leave any files on your hard drive after the program has finished its execution."}]},{"block_type":"element","block":"k6pz2h3z","search_text":"Two Go rules","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Two Go rules"}]},{"block_type":"element","block":"k6pz2h40","search_text":"Go has strict coding rules that are there to help you avoid silly errors and bugs in your code, as well as to make your code easier to read among the Go community. This section will present two such Go rules that you need to know.","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go has strict coding rules that are there to help you avoid silly errors and bugs in your code, as well as to make your code easier to read among the Go community. This section will present two such Go rules that you need to know."}]},{"block_type":"element","block":"k6pz2h41","search_text":"Please remember that the Go compiler is here to help and not make your life miserable. As a result, the main purpose of the Go compiler is to compile and increase the quality of your Go code.","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please remember that the Go compiler is here to help and not make your life miserable. As a result, the main purpose of the Go compiler is to compile and increase the quality of your Go code."}]},{"block_type":"element","block":"k6pz2h42","search_text":"You either use a Go package or do not include it","text_count":48,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"You either use a Go package or do not include it"}]},{"block_type":"element","block":"k6pz2h43","search_text":"Go has strict rules about package usage. Therefore, you cannot just include any package that you might think you will need and not use it afterwards. You will learn more about Go packages in Chapter 6, What You Might Not Know About Go Packages .","text_count":245,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go has strict rules about package usage. Therefore, you cannot just include any package that you might think you will need and not use it afterwards. You will learn more about Go packages in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h44","search_text":"Look at the following naïve program, which is saved as packageNotUsed.go :","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the following na&iuml;ve program, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"packageNotUsed.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h45","search_text":"package main import ( \"fmt\" \"os\" ) func main() { fmt.Println(\"Hello there!\") } ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n) \n \nfunc main() { \n    fmt.Println(\"Hello there!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h46","search_text":"Tip In this book, you are going to see lots of error messages, error situations, and warnings. I believe that examining code that fails to compile is useful and sometimes even more valuable than just looking at Go code that compiles without any errors. The Go compiler usually displays useful error messages and warnings that will most likely help you resolve an erroneous situation, so do not underestimate these error messages and warnings. ","text_count":443,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this book, you are going to see lots of error messages, error situations, and warnings. I believe that examining code that fails to compile is useful and sometimes even more valuable than just looking at Go code that compiles without any errors. The Go compiler usually displays useful error messages and warnings that will most likely help you resolve an erroneous situation, so do not underestimate these error messages and warnings."}]}]},{"block_type":"element","block":"k6pz2h47","search_text":"If you execute packageNotUsed.go , you will get the next error message from Go and the program will not be executed:","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"packageNotUsed.go"}]},{"block_type":"text","content":", you will get the next error message from Go and the program will not be executed:"}]},{"block_type":"element","block":"k6pz2h48","search_text":"$ go run packageNotUsed.go # command-line-arguments ./packageNotUsed.go:5:2: imported and not used: \"os\"","text_count":104,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run packageNotUsed.go\n# command-line-arguments\n./packageNotUsed.go:5:2: imported and not used: \"os\""}]}]},{"block_type":"element","block":"k6pz2h49","search_text":"If you remove the os package from the import list of the program, packageNotUsed.go will compile just fine—try it on your own.","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you remove the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package from the import list of the program,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"packageNotUsed.go"}]},{"block_type":"text","content":"will compile just fine&mdash;try it on your own."}]},{"block_type":"element","block":"k6pz2h4a","search_text":"Although, this is not the perfect time to start talking about breaking Go rules, there is a way to bypass this restriction, which is showcased in the next Go code listing that is saved in the packageNotUsedUnderscore.go file:","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although, this is not the perfect time to start talking about breaking Go rules, there is a way to bypass this restriction, which is showcased in the next Go code listing that is saved in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"packageNotUsedUnderscore.go"}]},{"block_type":"text","content":"file:"}]},{"block_type":"element","block":"k6pz2h4b","search_text":"package main import ( \"fmt\" _ \"os\" ) func main() { fmt.Println(\"Hello there!\") } ","text_count":81,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    _ \"os\" \n) \n \nfunc main() { \n    fmt.Println(\"Hello there!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h4c","search_text":"Using an underscore character in front of a package name in the import list will not create an error message in the compilation process, even if that package is not used in the program:","text_count":185,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using an underscore character in front of a package name in the import list will not create an error message in the compilation process, even if that package is not used in the program:"}]},{"block_type":"element","block":"k6pz2h4d","search_text":"$ go run packageNotUsedUnderscore.go Hello there!","text_count":49,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run packageNotUsedUnderscore.go\nHello there!"}]}]},{"block_type":"element","block":"k6pz2h4e","search_text":"Tip The reason that Go allows you to bypass this rule will become more evident in Chapter 6, What You Might Not Know About Go Packages . ","text_count":137,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason that Go allows you to bypass this rule will become more evident in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h4f","search_text":"There is only one way to format curly braces","text_count":44,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"There is only one way to format curly braces"}]},{"block_type":"element","block":"k6pz2h4g","search_text":"Look at the next Go program, which is named curly.go :","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the next Go program, which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"curly.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h4h","search_text":"package main import ( \"fmt\" ) func main() { fmt.Println(\"Go has strict rules for curly braces!\") }","text_count":98,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() \n{ \n    fmt.Println(\"Go has strict rules for curly braces!\") \n}"}]}]},{"block_type":"element","block":"k6pz2h4i","search_text":"Although it looks just fine, if you try to execute it, you will be fairly disappointed because you will get the next syntax error message, and the code will not compile and therefore not run:","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although it looks just fine, if you try to execute it, you will be fairly disappointed because you will get the next"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"syntax error"}]},{"block_type":"text","content":"message, and the code will not compile and therefore not run:"}]},{"block_type":"element","block":"k6pz2h4j","search_text":"$ go run curly.go # command-line-arguments ./curly.go:7:6: missing function body for \"main\" ./curly.go:8:1: syntax error: unexpected semicolon or newline before {","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run curly.go\n# command-line-arguments\n./curly.go:7:6: missing function body for \"main\"\n./curly.go:8:1: syntax error: unexpected semicolon or newline before \n{"}]}]},{"block_type":"element","block":"k6pz2h4k","search_text":"The official explanation for this error message is that Go requires the use of semicolons as statement terminators in many contexts, and the compiler automatically inserts the required semicolons when it thinks that they are necessary. Therefore, putting the opening brace ( { ) in its own line will make the Go compiler insert a semicolon at the end of the previous line ( func main() ), which produces the error message.","text_count":422,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The official explanation for this error message is that Go requires the use of semicolons as statement terminators in many contexts, and the compiler automatically inserts the required semicolons when it thinks that they are necessary. Therefore, putting the opening brace ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{"}]},{"block_type":"text","content":") in its own line will make the Go compiler insert a semicolon at the end of the previous line ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"func main()"}]},{"block_type":"text","content":"), which produces the error message."}]},{"block_type":"element","block":"k6pz2h4l","search_text":"Downloading Go packages","text_count":23,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Downloading Go packages"}]},{"block_type":"element","block":"k6pz2h4m","search_text":"Although the standard Go library is very rich, there are times when you will need to download external Go packages in order to use their functionality. This section will teach you how to download an external package and where it will be placed on your Unix machine.","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the standard Go library is very rich, there are times when you will need to download external Go packages in order to use their functionality. This section will teach you how to download an external package and where it will be placed on your Unix machine."}]},{"block_type":"element","block":"k6pz2h4n","search_text":"Look at the next simple Go program that is saved as getPackage.go :","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the next simple Go program that is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPackage.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h4o","search_text":"package main import ( \"fmt\" \"github.com/mactsouk/go/simpleGitHub\" ) func main() { fmt.Println(simpleGitHub. AddTwo (5, 6)) } ","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"github.com/mactsouk/go/simpleGitHub\" \n) \n \nfunc main() { \n    fmt.Println(simpleGitHub. AddTwo (5, 6)) \n}"}]}]},{"block_type":"element","block":"k6pz2h4p","search_text":"This program uses an external package, because one of the import commands uses an internet address. In this case, the external package is called simpleGitHub and is located at https://github.com/mactsouk/go .","text_count":208,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This program uses an external package, because one of the import commands uses an internet address. In this case, the external package is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleGitHub"}]},{"block_type":"text","content":"&nbsp;and is located at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/mactsouk/go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/mactsouk/go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h4q","search_text":"If you try to execute getPackage.go right away, you will be disappointed:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPackage.go"}]},{"block_type":"text","content":"right away, you will be disappointed:"}]},{"block_type":"element","block":"k6pz2h4r","search_text":"$ go run getPackage.go getPackage.go:5:2: cannot find package \"github.com/mactsouk/go/simpleGitHub\" in any of: /usr/local/Cellar/go/1.9.1/libexec/src/github.com/ mactsouk/go/simpleGitHub (from $GOROOT) /Users/mtsouk/go/src/github.com/mactsouk/go/ simpleGitHub (from $GOPATH)","text_count":274,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run getPackage.go\ngetPackage.go:5:2: cannot find package \"github.com/mactsouk/go/simpleGitHub\" in any of:\n    /usr/local/Cellar/go/1.9.1/libexec/src/github.com/\nmactsouk/go/simpleGitHub (from $GOROOT)\n    /Users/mtsouk/go/src/github.com/mactsouk/go/\nsimpleGitHub (from $GOPATH)"}]}]},{"block_type":"element","block":"k6pz2h4s","search_text":"The thing is that you will need to get the missing package onto your computer. In order to download it, you will need to execute the following command:","text_count":151,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The thing is that you will need to get the missing package onto your computer. In order to download it, you will need to execute the following command:"}]},{"block_type":"element","block":"k6pz2h4t","search_text":"$ go get -v github.com/mactsouk/go/simpleGitHub github.com/mactsouk/go (download) github.com/mactsouk/go/simpleGitHub","text_count":117,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go get -v github.com/mactsouk/go/simpleGitHub\ngithub.com/mactsouk/go (download)\ngithub.com/mactsouk/go/simpleGitHub"}]}]},{"block_type":"element","block":"k6pz2h4u","search_text":"After that, you can find the downloaded files at the following directory:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you can find the downloaded files at the following directory:"}]},{"block_type":"element","block":"k6pz2h4v","search_text":"$ ls -l ~/go/src/github.com/mactsouk/go/simpleGitHub/ total 8 -rw-r--r-- 1 mtsouk staff 66 Oct 17 21:47 simpleGitHub.go","text_count":119,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l ~/go/src/github.com/mactsouk/go/simpleGitHub/\ntotal 8\n-rw-r--r--  1 mtsouk  staff  66 Oct 17 21:47 simpleGitHub.go"}]}]},{"block_type":"element","block":"k6pz2h4w","search_text":"However, the go get command also compiles the package. The relevant files can be found at the following place:","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go get"}]},{"block_type":"text","content":"command also compiles the package. The relevant files can be found at the following place:"}]},{"block_type":"element","block":"k6pz2h4x","search_text":"$ ls -l ~/go/pkg/darwin_amd64/github.com/mactsouk/go/simpleGitHub.a -rw-r--r-- 1 mtsouk staff 1050 Oct 17 21:47 /Users/mtsouk/go/pkg/ darwin_amd64/github.com/mactsouk/go/simpleGitHub.a","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l ~/go/pkg/darwin_amd64/github.com/mactsouk/go/simpleGitHub.a\n-rw-r--r--  1 mtsouk  staff  1050 Oct 17 21:47 /Users/mtsouk/go/pkg/\ndarwin_amd64/github.com/mactsouk/go/simpleGitHub.a"}]}]},{"block_type":"element","block":"k6pz2h4y","search_text":"You are now ready to execute getPackage.go without any problems:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You are now ready to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPackage.go"}]},{"block_type":"text","content":"without any problems:"}]},{"block_type":"element","block":"k6pz2h4z","search_text":"$ go run getPackage.go 11","text_count":25,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run getPackage.go\n11"}]}]},{"block_type":"element","block":"k6pz2h50","search_text":"You can delete the intermediate files of a downloaded Go package as follows:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can delete the intermediate files of a downloaded Go package as follows:"}]},{"block_type":"element","block":"k6pz2h51","search_text":"$ go clean -i -v -x github.com/mactsouk/go/simpleGitHub cd /Users/mtsouk/go/src/github.com/mactsouk/go/simpleGitHub rm -f simpleGitHub.test simpleGitHub.test.exe rm -f /Users/mtsouk/go/pkg/darwin_amd64/github.com/mactsouk/ go/simpleGitHub.a","text_count":240,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go clean -i -v -x github.com/mactsouk/go/simpleGitHub\ncd /Users/mtsouk/go/src/github.com/mactsouk/go/simpleGitHub\nrm -f simpleGitHub.test simpleGitHub.test.exe\nrm -f /Users/mtsouk/go/pkg/darwin_amd64/github.com/mactsouk/\ngo/simpleGitHub.a"}]}]},{"block_type":"element","block":"k6pz2h52","search_text":"Similarly, you can delete an entire Go package that you have downloaded locally using the rm(1) Unix command to delete its Go source after using go clean :","text_count":155,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, you can delete an entire Go package that you have downloaded locally using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rm(1)"}]},{"block_type":"text","content":"Unix command to delete its Go source after using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go clean"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h53","search_text":"$ go clean -i -v -x github.com/mactsouk/go/simpleGitHub $ rm -rf ~/go/src/github.com/mactsouk/go/simpleGitHub","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go clean -i -v -x github.com/mactsouk/go/simpleGitHub\n$ rm -rf ~/go/src/github.com/mactsouk/go/simpleGitHub"}]}]},{"block_type":"element","block":"k6pz2h54","search_text":"After executing the former commands, you will need to download the Go package again.","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After executing the former commands, you will need to download the Go package again."}]},{"block_type":"element","block":"k6pz2h55","search_text":"You will learn a lot more about Go packages in Chapter 6, What You Might Not Know About Go Packages .","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn a lot more about Go packages in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h56","search_text":"Unix stdin, stdout, and stderr","text_count":30,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Unix stdin, stdout, and stderr"}]},{"block_type":"element","block":"k6pz2h57","search_text":"Every Unix operating system has three files open all the time for its processes. As you know, Unix considers everything a file, even a printer or your mouse. Unix uses file descriptors , which are positive integer values, as an internal representation for accessing all of its open files, which is much more convenient than using long paths.","text_count":341,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Every Unix operating system has three files open all the time for its processes. As you know, Unix considers everything a file, even a printer or your mouse. Unix uses"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"file descriptors"}]},{"block_type":"text","content":", which are positive integer values, as an internal representation for accessing all of its open files, which is much more convenient than using long paths."}]},{"block_type":"element","block":"k6pz2h58","search_text":"By default, all Unix systems support three special and standard filenames: /dev/stdin , /dev/stdout , and /dev/stderr , which can also be accessed using file descriptors 0, 1, and 2, respectively. These three file descriptors are also called standard input , standard output , and standard error , respectively. Additionally, file descriptor 0 can be accessed as /dev/fd/0 on a macOS machine and as both /dev/fd/0 and /dev/pts/0 on a Debian Linux machine.","text_count":455,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"By default, all Unix systems support three special and standard filenames:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stdin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stdout"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stderr"}]},{"block_type":"text","content":", which can also be accessed using file descriptors 0, 1, and 2, respectively. These three file descriptors are also called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"standard input"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"standard output"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"standard error"}]},{"block_type":"text","content":", respectively. Additionally, file descriptor 0 can be accessed as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/fd/0"}]},{"block_type":"text","content":"on a macOS machine and as both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/fd/0"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/pts/0"}]},{"block_type":"text","content":"on a Debian Linux machine."}]},{"block_type":"element","block":"k6pz2h59","search_text":"Go uses os.Stdin for accessing standard input, os.Stdout for accessing standard output, and os.Stderr for accessing standard error. Although you can still use /dev/stdin , /dev/stdout , and /dev/stderr , or the related file descriptor values for accessing the same devices, it is better, safer, and more portable to stick with the os.Stdin , os.Stdout , and os.Stderr standard filenames that Go offers.","text_count":402,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdin"}]},{"block_type":"text","content":"for accessing standard input,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":"for accessing standard output, and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stderr"}]},{"block_type":"text","content":"for accessing standard error. Although you can still use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stdin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stdout"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/stderr"}]},{"block_type":"text","content":", or the related file descriptor values for accessing the same devices, it is better, safer, and more portable to stick with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stderr"}]},{"block_type":"text","content":"standard filenames that Go offers."}]},{"block_type":"element","block":"k6pz2h5a","search_text":"About printing output","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About printing output"}]},{"block_type":"element","block":"k6pz2h5b","search_text":"As is the case with Unix and C, Go also offers a variety of ways for printing your output on the screen. All of the printing functions in this section require the use of the fmt Go standard package and are illustrated in the printing.go program, which will be presented in two parts.","text_count":283,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As is the case with Unix and C, Go also offers a variety of ways for printing your output on the screen. All of the printing functions in this section require the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"Go standard package and are illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printing.go"}]},{"block_type":"text","content":"program, which will be presented in two parts."}]},{"block_type":"element","block":"k6pz2h5c","search_text":"The simplest way to print something in Go is by using the fmt.Println() and fmt.Printf() functions. The fmt.Printf() function has many similarities to the C printf(3) function. You can also use the fmt.Print() function instead of fmt.Println() . The main difference between fmt.Print() and fmt.Println() is that the latter automatically adds a newline character each time you call it, whereas the biggest difference between fmt.Println() and fmt.Printf() is that the latter requires a format specifier for each thing that you want to print, just like the C printf(3) function, which means that you have better control over what you are doing, though you have to write more code. Go calls these format specifiers verbs . You can find more information about verbs at https://golang.org/pkg/fmt/ . If you have to perform any formatting before printing something, or you have to arrange multiple variables, then using fmt.Printf() might be a better choice. However, if you only have to print a single variable, then you might need to choose either fmt.Print() or fmt.Println() , depending on whether you need the newline character or not.","text_count":1134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The simplest way to print something in Go is by using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"functions. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"function has many similarities to the C"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printf(3)"}]},{"block_type":"text","content":"function. You can also use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"function instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":". The main difference between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"is that the latter automatically adds a newline character each time you call it, whereas the biggest difference between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"is that the latter requires a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"format specifier"}]},{"block_type":"text","content":"for each"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"thing"}]},{"block_type":"text","content":"that you want to print, just like the C"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printf(3)"}]},{"block_type":"text","content":"function, which means that you have better control over what you are doing, though you have to write more code. Go calls these format specifiers"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"verbs"}]},{"block_type":"text","content":". You can find more information about verbs at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/fmt/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/fmt/"}]},{"block_type":"text","content":". If you have to perform any formatting before printing something, or you have to arrange multiple variables, then using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"might be a better choice. However, if you only have to print a single variable, then you might need to choose either"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":", depending on whether you need the newline character or not."}]},{"block_type":"element","block":"k6pz2h5d","search_text":"The first part of printing.go contains the next Go code:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printing.go"}]},{"block_type":"text","content":"contains the next Go code:"}]},{"block_type":"element","block":"k6pz2h5e","search_text":"package main import ( \"fmt\" ) func main() { v1 := \"123\" v2 := 123 v3 := \"Have a nice day\\n\" v4 := \"abc\" ","text_count":104,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    v1 := \"123\" \n    v2 := 123 \n    v3 := \"Have a nice day\\n\" \n    v4 := \"abc\""}]}]},{"block_type":"element","block":"k6pz2h5f","search_text":"In this part, you can see the import of the fmt package and the definition of four Go variables. The \\n used in v3 is the line break character-if you just want to insert a line break in your output, however, you can call fmt.Println() without any arguments instead of using something like fmt.Print(\"\\n\") .","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you can see the import of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package and the definition of four Go variables. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\\n"}]},{"block_type":"text","content":"used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v3"}]},{"block_type":"text","content":"is the line break character-if you just want to insert a line break in your output, however, you can call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"without any arguments instead of using something like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print(\"\\n\")"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h5g","search_text":"The second part follows:","text_count":24,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part follows:"}]},{"block_type":"element","block":"k6pz2h5h","search_text":"fmt.Print(v1, v2, v3, v4) fmt.Println() fmt.Println(v1, v2, v3, v4) fmt.Print(v1, \" \", v2, \" \", v3, \" \", v4, \"\\n\") fmt.Printf(\"%s%d %s %s\\n\", v1, v2, v3, v4) } ","text_count":160,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Print(v1, v2, v3, v4) \n    fmt.Println() \n    fmt.Println(v1, v2, v3, v4) \n    fmt.Print(v1, \" \", v2, \" \", v3, \" \", v4, \"\\n\") \n    fmt.Printf(\"%s%d %s %s\\n\", v1, v2, v3, v4) \n}"}]}]},{"block_type":"element","block":"k6pz2h5i","search_text":"In this part, you print the four variables using fmt.Println() , fmt.Print() , and fmt.Printf() in order to understand their differences better.","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you print the four variables using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"in order to understand their differences better."}]},{"block_type":"element","block":"k6pz2h5j","search_text":"If you execute printing.go , you will get the following output:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printing.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2h5k","search_text":"$ go run printing.go 123123Have a nice day abc 123 123 Have a nice day abc 123 123 Have a nice day abc 123123 Have a nice day abc","text_count":129,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run printing.go\n123123Have a nice day\nabc\n123 123 Have a nice day\nabc\n123 123 Have a nice day\nabc\n123123 Have a nice day\nabc"}]}]},{"block_type":"element","block":"k6pz2h5l","search_text":"As you can see in the preceding output, the fmt.Println() function also adds a space character between its parameters, which is not the case with fmt.Print() . As a result, a statement like fmt.Println(v1, v2) is equivalent to fmt.Print(v1, \" \", v2, \"\\n\") .","text_count":257,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see in the preceding output, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"function also adds a space character between its parameters, which is not the case with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":". As a result, a statement like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(v1, v2)"}]},{"block_type":"text","content":"is equivalent to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print(v1, \" \", v2, \"\\n\")"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h5m","search_text":"Apart from fmt.Println() , fmt.Print() , and fmt.Printf() , which are the simplest functions that can be used for generating output on the screen, there is also the S family of functions that includes fmt.Sprintln() , fmt.Sprint() , and fmt.Sprintf() , which are used for creating strings based on the given format and the F family of functions. This includes fmt.Fprintln() , fmt.Fprint() and fmt.Fprintf() , which are used for writing to files using an io.Writer .","text_count":466,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":", which are the simplest functions that can be used for generating output on the screen, there is also the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"S"}]},{"block_type":"text","content":"family of functions that includes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Sprintln()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Sprint()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Sprintf()"}]},{"block_type":"text","content":", which are used for creating strings based on the given format and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"F"}]},{"block_type":"text","content":"family of functions. This includes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintln()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprint()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintf()"}]},{"block_type":"text","content":", which are used for writing to files using an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h5n","search_text":"Tip You will learn more about the io.Writer and io.Reader interfaces in Chapter 8, Telling a Unix System What to Do . ","text_count":118,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"interfaces in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h5o","search_text":"The next section will teach you how to print your data using standard output, which is pretty common in the Unix world.","text_count":119,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next section will teach you how to print your data using standard output, which is pretty common in the Unix world."}]},{"block_type":"element","block":"k6pz2h5p","search_text":"Using standard output","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Using standard output"}]},{"block_type":"element","block":"k6pz2h5q","search_text":"Standard output is more or less equivalent to printing on the screen. However, using standard output might require the use of functions that do not belong to the fmt package, which is why it is presented in its own section.","text_count":223,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Standard output is more or less equivalent to printing on the screen. However, using"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"standard output"}]},{"block_type":"text","content":"might require the use of functions that do not belong to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package, which is why it is presented in its own section."}]},{"block_type":"element","block":"k6pz2h5r","search_text":"The relevant technique will be illustrated in stdOUT.go , which will be offered in three parts. The first part of the program follows:","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The relevant technique will be illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":", which will be offered in three parts. The first part of the program follows:"}]},{"block_type":"element","block":"k6pz2h5s","search_text":"package main import ( \"io\" \"os\" ) ","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"io\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2h5t","search_text":"Here stdOUT.go uses the io package instead of the fmt package. The os package is used for reading the command-line arguments of the program and for accessing os.Stdout .","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io"}]},{"block_type":"text","content":"package instead of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package is used for reading the command-line arguments of the program and for accessing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h5u","search_text":"The second portion of stdOUT.go contains the next Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"contains the next Go code:"}]},{"block_type":"element","block":"k6pz2h5v","search_text":"func main() { myString := \"\" arguments := os.Args if len(arguments) == 1 { myString = \"Please give me one argument!\" } else { myString = arguments[1] } ","text_count":152,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    myString := \"\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        myString = \"Please give me one argument!\" \n    } else { \n        myString = arguments[1] \n    }"}]}]},{"block_type":"element","block":"k6pz2h5w","search_text":"The myString variable holds the text that will be printed on the screen, which is either the first command-line argument of the program or, if the program was executed without any command-line arguments, a hard-coded text message.","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myString"}]},{"block_type":"text","content":"variable holds the text that will be printed on the screen, which is either the first command-line argument of the program or, if the program was executed without any command-line arguments, a hard-coded text message."}]},{"block_type":"element","block":"k6pz2h5x","search_text":"The third part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2h5y","search_text":"io.WriteString(os.Stdout, myString) io.WriteString(os.Stdout, \"\\n\") } ","text_count":70,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"io.WriteString(os.Stdout, myString) \n    io.WriteString(os.Stdout, \"\\n\") \n}"}]}]},{"block_type":"element","block":"k6pz2h5z","search_text":"In this case, the io.WriteString() function works in the same way as the fmt.Print() function; however, it takes only two parameters. The first parameter is the file to which you want to write, which in this case is os.Stdout , and the second parameter is a string variable.","text_count":274,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriteString()"}]},{"block_type":"text","content":"function works in the same way as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"function; however, it takes only two parameters. The first parameter is the file to which you want to write, which in this case is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":", and the second parameter is a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2h60","search_text":"Tip NOTE: Strictly speaking, the type of the first parameter of the io.WriteString() function should be an io.Writer interface, which requires a slice of bytes as the second parameter. However, in this case, a string does the job just fine. You will learn more about slices in Chapter 3, Working with Basic Go Data Types . ","text_count":323,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"NOTE: Strictly speaking, the type of the first parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriteString()"}]},{"block_type":"text","content":"function should be an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interface, which requires a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slice"}]},{"block_type":"text","content":"of bytes as the second parameter. However, in this case, a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"does the job just fine. You will learn more about slices in Chapter 3,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Working with Basic Go Data Types"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h61","search_text":"Executing stdOUT.go will produce the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2h62","search_text":"$ go run stdOUT.go Please give me one argument! $ go run stdOUT.go 123 12 123 ","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdOUT.go\nPlease give me one argument!\n$ go run stdOUT.go 123 12\n123"}]}]},{"block_type":"element","block":"k6pz2h63","search_text":"The preceding output verifies that the io.WriteString() function sends the contents of its second parameter on the screen when its first parameter is os.Stdout .","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output verifies that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriteString()"}]},{"block_type":"text","content":"function sends the contents of its second parameter on the screen when its first parameter is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h64","search_text":"Getting user input","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Getting user input"}]},{"block_type":"element","block":"k6pz2h65","search_text":"There are three main ways to acquire user input:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are three main ways to acquire user input:"}]},{"block_type":"element","block":"k6pz2h66","search_text":"By reading the command-line arguments of a program ","text_count":51,"tag_name":"ol","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"By reading the command-line arguments of a program"}]}]},{"block_type":"element","block":"k6pz2h67","search_text":"By asking the user for input ","text_count":29,"tag_name":"ol","attributes":{"start":"2"},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"By asking the user for input"}]}]},{"block_type":"element","block":"k6pz2h68","search_text":"By reading external files ","text_count":26,"tag_name":"ol","attributes":{"start":"3"},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"By reading external files"}]}]},{"block_type":"element","block":"k6pz2h69","search_text":"This section will present the first two ways. Should you wish to learn how to read an external file, visit Chapter 8, Telling a Unix System What to Do .","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present the first two ways. Should you wish to learn how to read an external file, visit Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h6a","search_text":"About := and =","text_count":14,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About := and ="}]},{"block_type":"element","block":"k6pz2h6b","search_text":"Before continuing, it would be very useful to talk about the use of := and how it differs from = . The official name for := is the short assignment statement . The short assignment statement can be used in place of a var declaration with an implicit type.","text_count":255,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Before continuing, it would be very useful to talk about the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"and how it differs from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"="}]},{"block_type":"text","content":". The official name for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"is the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"short assignment statement"}]},{"block_type":"text","content":". The short assignment statement can be used in place of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"var"}]},{"block_type":"text","content":"declaration with an implicit type."}]},{"block_type":"element","block":"k6pz2h6c","search_text":"Tip The var keyword is mostly used for declaring global variables in Go programs as well as for declaring variables without an initial value. The reason for the former is that every statement that exists outside of the code of a function must begin with a keyword, such as func or var . This means that the short assignment statement cannot be used outside of a function because it is not available there. ","text_count":406,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"var"}]},{"block_type":"text","content":"keyword is mostly used for declaring global variables in Go programs as well as for declaring variables without an initial value. The reason for the former is that every statement that exists outside of the code of a function must begin with a keyword, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"func"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"var"}]},{"block_type":"text","content":". This means that the short assignment statement cannot be used outside of a function because it is not available there."}]}]},{"block_type":"element","block":"k6pz2h6d","search_text":"The := operator works as follows:","text_count":33,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"operator works as follows:"}]},{"block_type":"element","block":"k6pz2h6e","search_text":"m := 123 ","text_count":9,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"m := 123"}]}]},{"block_type":"element","block":"k6pz2h6f","search_text":"The result of the preceding statement is a new integer variable named m with a value of 123 .","text_count":93,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The result of the preceding statement is a new integer variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m"}]},{"block_type":"text","content":"with a value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"123"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h6g","search_text":"However, if you try to use := on an already declared variable, the compilation will fail with the next error message, which will make perfect sense:","text_count":148,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, if you try to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"on an already declared variable, the compilation will fail with the next error message, which will make perfect sense:"}]},{"block_type":"element","block":"k6pz2h6h","search_text":"$ go run test.go # command-line-arguments ./test.go:5:4: no new variables on left side of :=","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run test.go\n# command-line-arguments\n./test.go:5:4: no new variables on left side of :="}]}]},{"block_type":"element","block":"k6pz2h6i","search_text":"Now you might ask what will happen if you are expecting two or more values from a function, and you want to use an existing variable for one of them. Should you use := or = ? The answer is simple: you should use := as shown in the next code example:","text_count":249,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now you might ask what will happen if you are expecting two or more values from a function, and you want to use an existing variable for one of them. Should you use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"="}]},{"block_type":"text","content":"? The answer is simple: you should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"as shown in the next code example:"}]},{"block_type":"element","block":"k6pz2h6j","search_text":"i, k := 3, 4 j, k := 1, 2 ","text_count":26,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"i, k := 3, 4 \nj, k := 1, 2"}]}]},{"block_type":"element","block":"k6pz2h6k","search_text":"As the j variable is used for the first time in the second statement, you should use := even though k has already been defined in the first statement.","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"variable is used for the first time in the second statement, you should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":":="}]},{"block_type":"text","content":"even though"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"has already been defined in the first statement."}]},{"block_type":"element","block":"k6pz2h6l","search_text":"Although it seems boring to talk about such insignificant things, knowing them will save you from various types of errors in the long run!","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although it seems boring to talk about such insignificant things, knowing them will save you from various types of errors in the long run!"}]},{"block_type":"element","block":"k6pz2h6m","search_text":"Reading from standard input","text_count":27,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading from standard input"}]},{"block_type":"element","block":"k6pz2h6n","search_text":"The reading of data from the standard input will be illustrated in stdIN.go , which you will see in two parts. The first part follows:","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reading of data from the standard input will be illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdIN.go"}]},{"block_type":"text","content":", which you will see in two parts. The first part follows:"}]},{"block_type":"element","block":"k6pz2h6o","search_text":"package main import ( \"bufio\" \"fmt\" \"os\" ) ","text_count":43,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2h6p","search_text":"In the preceding code, you see the use of the bufio package for the first time in this book.","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you see the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package for the first time in this book."}]},{"block_type":"element","block":"k6pz2h6q","search_text":"Tip You will learn more about the bufio package, which is related to file input and output, in Chapter 8, Telling a Unix System What to Do . ","text_count":141,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package, which is related to file input and output, in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2h6r","search_text":"Although the bufio package is mostly used for file input and output, you will keep seeing the os package all of the time in this book because it contains many handy functions. Its most common functionality is that it provides you with a way to access the command-line arguments of a Go program ( os.Args ). The official description of the os package tells us that it offers functions that perform operating system operations. This includes functions for creating, deleting, and renaming files and directories, as well as functions for learning the Unix permissions and other characteristics of files and directories. The main advantage of the os package is that it is platform independent. Put simply, its functions will work on both Unix and Microsoft Windows machines!","text_count":770,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package is mostly used for file input and output, you will keep seeing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package all of the time in this book because it contains many handy functions. Its most common functionality is that it provides you with a way to access the command-line arguments of a Go program ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":"). The official description of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package tells us that it offers functions that perform operating system operations. This includes functions for creating, deleting, and renaming files and directories, as well as functions for learning the Unix permissions and other characteristics of files and directories. The main advantage of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package is that it is platform independent. Put simply, its functions will work on both Unix and Microsoft Windows machines!"}]},{"block_type":"element","block":"k6pz2h6s","search_text":"The second part of stdIN.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdIN.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2h6t","search_text":"func main() { var f *os.File f = os.Stdin defer f.Close() scanner := bufio.NewScanner(f) for scanner.Scan() { fmt.Println(\">\", scanner.Text()) } } ","text_count":147,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var f *os.File \n    f = os.Stdin \n    defer f.Close() \n \n    scanner := bufio.NewScanner(f) \n    for scanner.Scan() { \n        fmt.Println(\"&gt;\", scanner.Text()) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2h6u","search_text":"Here there is a call to bufio.NewScanner() using standard input ( os.Stdin ) as its parameter. This call returns a bufio.Scanner variable, which is then used with the Scan() function for reading from os.Stdin line by line. Each line that is read is printed on the screen before getting the next one. Note that each line printed by the program begins with the > character.","text_count":371,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here there is a call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.NewScanner()"}]},{"block_type":"text","content":"using standard input ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdin"}]},{"block_type":"text","content":") as its parameter. This call returns a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.Scanner"}]},{"block_type":"text","content":"variable, which is then used with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Scan()"}]},{"block_type":"text","content":"function for reading from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdin"}]},{"block_type":"text","content":"line by line. Each line that is read is printed on the screen before getting the next one. Note that each line printed by the program begins with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&gt;"}]},{"block_type":"text","content":"character."}]},{"block_type":"element","block":"k6pz2h6v","search_text":"The execution of stdIN.go will produce the following type of output:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdIN.go"}]},{"block_type":"text","content":"will produce the following type of output:"}]},{"block_type":"element","block":"k6pz2h6w","search_text":"$ go run stdIN.go 21 > 21 This is Mihalis! > This is Mihalis!","text_count":61,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdIN.go\n21\n&gt; 21\nThis is Mihalis!\n&gt; This is Mihalis!"}]}]},{"block_type":"element","block":"k6pz2h6x","search_text":"In Unix, you can tell a program to stop reading data from standard input by pressing Ctrl + D .","text_count":95,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Unix, you can tell a program to stop reading data from standard input by pressing"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Ctrl"}]},{"block_type":"text","content":"+"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"D"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h6y","search_text":"Tip The Go code of stdIN.go and stdOUT.go will be very useful when we talk about Unix pipes in Chapter 8, Telling a Unix System What to Do , so do not underestimate their simplicity. ","text_count":183,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdIN.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"will be very useful when we talk about Unix"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pipes"}]},{"block_type":"text","content":"in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":", so do not underestimate their simplicity."}]}]},{"block_type":"element","block":"k6pz2h6z","search_text":"Working with command-line arguments","text_count":35,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Working with command-line arguments"}]},{"block_type":"element","block":"k6pz2h70","search_text":"The technique covered in this section will be illustrated by using the Go code of cla.go , which will be presented in three parts. The program will find the minimum and the maximum of its command-line arguments.","text_count":211,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique covered in this section will be illustrated by using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":", which will be presented in three parts. The program will find the minimum and the maximum of its command-line arguments."}]},{"block_type":"element","block":"k6pz2h71","search_text":"The first part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2h72","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" ) ","text_count":45,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n)"}]}]},{"block_type":"element","block":"k6pz2h73","search_text":"What is important here is to realize that obtaining the command-line arguments requires the use of the os package. Additionally, you need another package, named strconv , in order to be able to convert a command-line argument, which is given as a string, into an arithmetical data type.","text_count":286,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What is important here is to realize that obtaining the command-line arguments requires the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package. Additionally, you need another package, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv"}]},{"block_type":"text","content":", in order to be able to convert a command-line argument, which is given as a string, into an arithmetical data type."}]},{"block_type":"element","block":"k6pz2h74","search_text":"The second part of the program is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2h75","search_text":"func main() { if len(os.Args) == 1 { fmt.Println(\"Please give one or more floats.\") os.Exit(1) } arguments := os.Args min, _ := strconv.ParseFloat(arguments[1], 64) max, _ := strconv.ParseFloat(arguments[1], 64) ","text_count":212,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) == 1 { \n        fmt.Println(\"Please give one or more floats.\") \n        os.Exit(1) \n    } \n \n    arguments := os.Args \n    min, _ := strconv.ParseFloat(arguments[1], 64) \n    max, _ := strconv.ParseFloat(arguments[1], 64)"}]}]},{"block_type":"element","block":"k6pz2h76","search_text":"Here, cla.go checks whether you have any command-line arguments or not by examining the length of os.Args , because the program needs at least one command-line argument to operate. Note that os.Args is a Go slice with string values. The first element in the slice is the name of the executable program. Therefore, in order to initialize the min and max variables, you will need to use the second element of the os.Args string slice that has an index value of 1 .","text_count":462,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":"checks whether you have any command-line arguments or not by examining the length of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":", because the program needs at least one command-line argument to operate. Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":"is a Go slice with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"values. The first element in the slice is the name of the executable program. Therefore, in order to initialize the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"min"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"max"}]},{"block_type":"text","content":"variables, you will need to use the second element of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":"string slice that has an index value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h77","search_text":"The important point here is that the fact that you are expecting one or more floats does not necessarily mean that the user will give you valid floats, either by accident or on purpose. However, as we have not talked about error handling in Go so far, cla.go assumes that all command-line arguments are in the right format and therefore will be acceptable. As a result, cla.go ignores the error value returned by the strconv.ParseFloat() function using the following statement:","text_count":477,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The important point here is that the fact that you are expecting one or more floats does not necessarily mean that the user will give you valid floats, either by accident or on purpose. However, as we have not talked about error handling in Go so far,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":"assumes that all command-line arguments are in the right format and therefore will be acceptable. As a result,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":"ignores the error value returned by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseFloat()"}]},{"block_type":"text","content":"function using the following statement:"}]},{"block_type":"element","block":"k6pz2h78","search_text":"n, _ := strconv.ParseFloat(arguments[i], 64) ","text_count":45,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"n, _ := strconv.ParseFloat(arguments[i], 64)"}]}]},{"block_type":"element","block":"k6pz2h79","search_text":"The preceding statement tells Go that you only want to get the first value returned by strconv.ParseFloat() and that you are not interested in the second value, which in this case is an error variable by assigning it to the underscore character. The underscore character, which is called a blank identifier , is the Go way of discarding a value. If a Go function returns multiple values, you can use the blank identifier multiple times.","text_count":436,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding statement tells Go that you only want to get the first value returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseFloat()"}]},{"block_type":"text","content":"and that you are not interested in the second value, which in this case is an error variable by assigning it to the underscore character. The underscore character, which is called a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"blank identifier"}]},{"block_type":"text","content":", is the Go way of discarding a value. If a Go function returns multiple values, you can use the blank identifier multiple times."}]},{"block_type":"element","block":"k6pz2h7a","search_text":"Tip WARNING: Ignoring all or some of the return values of a Go function, especially the error values, is a very dangerous practice that should not be used in production code! ","text_count":175,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"WARNING: Ignoring all or some of the return values of a Go function, especially the error values, is a very dangerous practice that should not be used in production code!"}]}]},{"block_type":"element","block":"k6pz2h7b","search_text":"The third part comes with the following Go code:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part comes with the following Go code:"}]},{"block_type":"element","block":"k6pz2h7c","search_text":"for i := 2; i < len(arguments); i++ { n, _ := strconv.ParseFloat(arguments[i], 64) if n < min { min = n } if n > max { max = n } } fmt.Println(\"Min:\", min) fmt.Println(\"Max:\", max) } ","text_count":183,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 2; i &lt; len(arguments); i++ { \n        n, _ := strconv.ParseFloat(arguments[i], 64) \n        if n &lt; min { \n            min = n \n        } \n        if n &gt; max { \n            max = n \n        } \n    } \n \n    fmt.Println(\"Min:\", min) \n    fmt.Println(\"Max:\", max) \n}"}]}]},{"block_type":"element","block":"k6pz2h7d","search_text":"Here you use a for loop that will help you visit all of the elements of the os.Args slice, which was previously assigned to the arguments variable.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that will help you visit all of the elements of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":"slice, which was previously assigned to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arguments"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2h7e","search_text":"Executing cla.go will create the next type of output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":"will create the next type of output:"}]},{"block_type":"element","block":"k6pz2h7f","search_text":"$ go run cla.go -10 0 1 Min: -10 Max: 1 $ go run cla.go -10 Min: -10 Max: -10 ","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cla.go -10 0 1\nMin: -10\nMax: 1\n$ go run cla.go -10\nMin: -10\nMax: -10"}]}]},{"block_type":"element","block":"k6pz2h7g","search_text":"As you might expect, the program does not behave well when it receives erroneous input. Worst of all, the program does not generate any warnings to inform the user that there were one or more errors while processing the command-line arguments:","text_count":243,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you might expect, the program does not behave well when it receives erroneous input. Worst of all, the program does not generate any warnings to inform the user that there were one or more errors while processing the command-line arguments:"}]},{"block_type":"element","block":"k6pz2h7h","search_text":"$ go run cla.go a b c 10 Min: 0 Max: 10 ","text_count":40,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cla.go a b c 10\nMin: 0\nMax: 10"}]}]},{"block_type":"element","block":"k6pz2h7i","search_text":"About error output","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About error output"}]},{"block_type":"element","block":"k6pz2h7j","search_text":"This section presents a technique for sending data to Unix standard error , which is the Unix way of differentiating between actual values and error output.","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section presents a technique for sending data to"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unix standard error"}]},{"block_type":"text","content":", which is the Unix way of differentiating between actual values and error output."}]},{"block_type":"element","block":"k6pz2h7k","search_text":"The Go code for illustrating the use of standard error in Go is included in stdERR.go and will be presented in two parts. As writing to standard error requires the use of the file descriptor related to standard error, the Go code of stdERR.go will be based on the Go code of stdOUT.go .","text_count":286,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code for illustrating the use of standard error in Go is included in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdERR.go"}]},{"block_type":"text","content":"and will be presented in two parts. As writing to standard error requires the use of the file descriptor related to standard error, the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdERR.go"}]},{"block_type":"text","content":"will be based on the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h7l","search_text":"The first part of the program follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program follows:"}]},{"block_type":"element","block":"k6pz2h7m","search_text":"package main import ( \"io\" \"os\" ) func main() { myString := \"\" arguments := os.Args if len(arguments) == 1 { myString = \"Please give me one argument!\" } else { myString = arguments[1] } ","text_count":186,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"io\" \n    \"os\" \n) \nfunc main() { \n    myString := \"\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        myString = \"Please give me one argument!\" \n    } else { \n        myString = arguments[1] \n    }"}]}]},{"block_type":"element","block":"k6pz2h7n","search_text":"So far, stdERR.go is almost identical to stdOUT.go .","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So far,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdERR.go"}]},{"block_type":"text","content":"is almost identical to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h7o","search_text":"The second part of the program, stdERR.go , is as follows:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdERR.go"}]},{"block_type":"text","content":", is as follows:"}]},{"block_type":"element","block":"k6pz2h7p","search_text":"io.WriteString(os.Stdout, \"This is Standard output\\n\") io.WriteString(os.Stderr, myString) io.WriteString(os.Stderr, \"\\n\") ","text_count":123,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"io.WriteString(os.Stdout, \"This is Standard output\\n\") \n    io.WriteString(os.Stderr, myString) \n    io.WriteString(os.Stderr, \"\\n\")"}]}]},{"block_type":"element","block":"k6pz2h7q","search_text":"Here you call io.WriteString() two times to write to standard error ( os.Stderr ) and one more time to write to standard output ( os.Stdout ).","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriteString()"}]},{"block_type":"text","content":"two times to write to standard error ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stderr"}]},{"block_type":"text","content":") and one more time to write to standard output ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2h7r","search_text":"Executing stdERR.go will create the following output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdERR.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2h7s","search_text":"$ go run stdERR.go This is Standard output Please give me one argument!","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdERR.go\nThis is Standard output\nPlease give me one argument!"}]}]},{"block_type":"element","block":"k6pz2h7t","search_text":"The preceding output cannot help you differentiate between data written to standard output and data written to standard error, which could be very useful at times. However, if you are using the bash(1) shell, there is a trick that you can use in order to distinguish between standard output data and standard error data. Almost all Unix shells offer this functionality in their own way.","text_count":386,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output cannot help you differentiate between data written to standard output and data written to standard error, which could be very useful at times. However, if you are using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bash(1)"}]},{"block_type":"text","content":"shell, there is a trick that you can use in order to distinguish between standard output data and standard error data. Almost all Unix shells offer this functionality in their own way."}]},{"block_type":"element","block":"k6pz2h7u","search_text":"Thus, when using bash(1) , you can redirect the standard error output to a file as follows:","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, when using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bash(1)"}]},{"block_type":"text","content":", you can redirect the standard error output to a file as follows:"}]},{"block_type":"element","block":"k6pz2h7v","search_text":"$ go run stdERR.go 2>/tmp/stdError This is Standard output $ cat /tmp/stdError Please give me one argument! ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdERR.go 2&gt;/tmp/stdError\nThis is Standard output\n$ cat /tmp/stdError\nPlease give me one argument!"}]}]},{"block_type":"element","block":"k6pz2h7w","search_text":"Tip The number after the name of a Unix program or system call refers to the section of the manual to which its page belongs. Although most names can be found only once in the manual pages, which means that indicating the section number is not required, there are names that can be located in multiple sections because they have multiple meanings, such as crontab(1) and crontab(5) . Therefore, if you try to retrieve the manual page of a name with multiple meanings without stating its section number, you will get the entry that has the smallest section number. ","text_count":564,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The number after the name of a Unix program or system call refers to the section of the manual to which its page belongs. Although most names can be found only once in the manual pages, which means that indicating the section number is not required, there are names that can be located in multiple sections because they have multiple meanings, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"crontab(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"crontab(5)"}]},{"block_type":"text","content":". Therefore, if you try to retrieve the manual page of a name with multiple meanings without stating its section number, you will get the entry that has the smallest section number."}]}]},{"block_type":"element","block":"k6pz2h7x","search_text":"Similarly, you can discard error output by redirecting it to the /dev/null device, which is like telling Unix to ignore it completely:","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, you can discard error output by redirecting it to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/null"}]},{"block_type":"text","content":"device, which is like telling Unix to ignore it completely:"}]},{"block_type":"element","block":"k6pz2h7y","search_text":"$ go run stdERR.go 2>/dev/null This is Standard output ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdERR.go 2&gt;/dev/null\nThis is Standard output"}]}]},{"block_type":"element","block":"k6pz2h7z","search_text":"What we did in the two preceding examples is to redirect the file descriptor of standard error into a file and /dev/null , respectively. If you want to save both standard output and standard error to the same file, you can redirect the file descriptor of standard error ( 2 ) to the file descriptor of standard output ( 1 )! The following command shows this technique, which is pretty common in Unix systems:","text_count":408,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What we did in the two preceding examples is to redirect the file descriptor of standard error into a file and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/null"}]},{"block_type":"text","content":", respectively. If you want to save both standard output and standard error to the same file, you can redirect the file descriptor of standard error ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2"}]},{"block_type":"text","content":") to the file descriptor of standard output ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":")! The following command shows this technique, which is pretty common in Unix systems:"}]},{"block_type":"element","block":"k6pz2h80","search_text":"$ go run stdERR.go >/tmp/output 2>&1 $ cat /tmp/output This is Standard output Please give me one argument! ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdERR.go &gt;/tmp/output 2&gt;&amp;1\n$ cat /tmp/output\nThis is Standard output\nPlease give me one argument!"}]}]},{"block_type":"element","block":"k6pz2h81","search_text":"Last, you can send both standard output and standard error to /dev/null as follows:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, you can send both standard output and standard error to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/null"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2h82","search_text":"$ go run stdERR.go >/dev/null 2>&1 ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stdERR.go &gt;/dev/null 2&gt;&amp;1"}]}]},{"block_type":"element","block":"k6pz2h83","search_text":"Writing to log files","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Writing to log files"}]},{"block_type":"element","block":"k6pz2h84","search_text":"The log package allows you to send log messages to the system logging service of your Unix machine, whereas the syslog Go package, which is part of the log package, allows you to define the logging level and the logging facility that your Go program will use.","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"package allows you to send log messages to the system logging service of your Unix machine, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog"}]},{"block_type":"text","content":"Go package, which is part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"package, allows you to define the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"logging level"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"logging facility"}]},{"block_type":"text","content":"that your Go program will use."}]},{"block_type":"element","block":"k6pz2h85","search_text":"Usually, most system log files on a Unix operating system can be found under the /var/log directory. However, the log files of many popular services, such as Apache and Nginx, can be found elsewhere, depending on their configuration.","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Usually, most system log files on a Unix operating system can be found under the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log"}]},{"block_type":"text","content":"directory. However, the log files of many popular services, such as Apache and Nginx, can be found elsewhere, depending on their configuration."}]},{"block_type":"element","block":"k6pz2h86","search_text":"Generally speaking, using a log file to write some information is considered a better practice than writing the same output on the screen for two reasons:","text_count":154,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, using a log file to write some information is considered a better practice than writing the same output on the screen for two reasons:"}]},{"block_type":"element","block":"k6pz2h87","search_text":"The output does not get lost as it is stored in a file ","text_count":55,"tag_name":"ol","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The output does not get lost as it is stored in a file"}]}]},{"block_type":"element","block":"k6pz2h88","search_text":"You can search and process log files using Unix tools such as grep(1) , awk(1) , and sed(1) , which cannot be done when messages are printed on a Terminal window ","text_count":162,"tag_name":"ol","attributes":{"start":"2"},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can search and process log files using Unix tools such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grep(1)"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"awk(1)"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sed(1)"}]},{"block_type":"text","content":", which cannot be done when messages are printed on a Terminal window"}]}]},{"block_type":"element","block":"k6pz2h89","search_text":"The log package offers many functions for sending output to the syslog server of a Unix machine. The list of function includes log.Printf() , log.Print() , log.Println() , log.Fatalf() , log.Fatalln() , log.Panic() , log.Panicln() , and log.Panicf() .","text_count":251,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"package offers many functions for sending output to the syslog server of a Unix machine. The list of function includes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Printf()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Print()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Println()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatalf()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatalln()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panic()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panicln()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panicf()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h8a","search_text":"Tip Logging functions can be extremely handy for debugging your programs, especially server processes written in Go, so you should not undervalue their power. ","text_count":159,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Logging functions can be extremely handy for debugging your programs, especially server processes written in Go, so you should not undervalue their power."}]}]},{"block_type":"element","block":"k6pz2h8b","search_text":"Logging levels","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Logging levels"}]},{"block_type":"element","block":"k6pz2h8c","search_text":"The logging level is a value that specifies the severity of the log entry. Various logging levels exist including debug , info , notice , warning , err , crit , alert , and emerg (in reverse order of severity).","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"logging level"}]},{"block_type":"text","content":"is a value that specifies the severity of the log entry. Various logging levels exist including"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"debug"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"info"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"notice"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"warning"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"err"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"crit"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"alert"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"emerg"}]},{"block_type":"text","content":"(in reverse order of severity)."}]},{"block_type":"element","block":"k6pz2h8d","search_text":"Logging facilities","text_count":18,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Logging facilities"}]},{"block_type":"element","block":"k6pz2h8e","search_text":"A logging facility is a category used for logging information. The value of the logging facility part can be one of auth , authpriv , cron , daemon , kern , lpr , mail , mark , news , syslog , user , UUCP , local0 , local1 , local2 , local3 , local4 , local5 , local6 , and local7 . It is defined inside /etc/syslog.conf , /etc/rsyslog.conf , or another appropriate file depending on the server process used for system logging on your Unix machine. This means that if a logging facility is not defined and thus handled, the log messages you send to it might get ignored and therefore lost.","text_count":589,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"logging facility"}]},{"block_type":"text","content":"is a category used for logging information. The value of the logging facility part can be one of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"auth"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"authpriv"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cron"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"daemon"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kern"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lpr"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mail"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mark"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"news"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"user"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UUCP"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local0"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local1"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local2"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local3"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local4"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local5"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local6"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local7"}]},{"block_type":"text","content":". It is defined inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/syslog.conf"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/rsyslog.conf"}]},{"block_type":"text","content":", or another appropriate file depending on the server process used for system logging on your Unix machine. This means that if a logging facility is not defined and thus handled, the log messages you send to it might get ignored and therefore lost."}]},{"block_type":"element","block":"k6pz2h8f","search_text":"Log servers","text_count":11,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Log servers"}]},{"block_type":"element","block":"k6pz2h8g","search_text":"All Unix machines have a separate server process that is responsible for receiving logging data and writing it to log files. Various log servers exist that work on Unix machines; however, only two of them are used on most Unix variants: syslogd(8) and rsyslogd(8) .","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All Unix machines have a separate server process that is responsible for receiving logging data and writing it to log files. Various log servers exist that work on Unix machines; however, only two of them are used on most Unix variants:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslogd(8)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rsyslogd(8)"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h8h","search_text":"On macOS machines, the name of the process is syslogd(8) . On the other hard, most Linux machines use rsyslogd(8) , which is an improved and more reliable version of syslogd(8) , which was the original Unix system utility for message logging.","text_count":242,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On macOS machines, the name of the process is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslogd(8)"}]},{"block_type":"text","content":". On the other hard, most Linux machines use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rsyslogd(8)"}]},{"block_type":"text","content":", which is an improved and more reliable version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslogd(8)"}]},{"block_type":"text","content":", which was the original Unix system utility for message logging."}]},{"block_type":"element","block":"k6pz2h8i","search_text":"However, despite the Unix variant you are using or the name of the server process used for logging, logging works the same way on every Unix machine and therefore does not affect the Go code that you will write.","text_count":211,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, despite the Unix variant you are using or the name of the server process used for logging, logging works the same way on every Unix machine and therefore does not affect the Go code that you will write."}]},{"block_type":"element","block":"k6pz2h8j","search_text":"The configuration file of rsyslogd(8) is usually named rsyslog.conf and is located in /etc . The contents of a rsyslog.conf configuration file, without the lines with comments and lines starting with $ , might look like the following:","text_count":234,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The configuration file of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rsyslogd(8)"}]},{"block_type":"text","content":"is usually named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rsyslog.conf"}]},{"block_type":"text","content":"and is located in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc"}]},{"block_type":"text","content":". The contents of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rsyslog.conf"}]},{"block_type":"text","content":"configuration file, without the lines with comments and lines starting with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"$"}]},{"block_type":"text","content":", might look like the following:"}]},{"block_type":"element","block":"k6pz2h8k","search_text":"$ grep -v '^#' /etc/rsyslog.conf | grep -v '^$' | grep -v '^\\$' auth,authpriv.* /var/log/auth.log *.*;auth,authpriv.none -/var/log/syslog daemon.* -/var/log/daemon.log kern.* -/var/log/kern.log lpr.* -/var/log/lpr.log mail.* -/var/log/mail.log user.* -/var/log/user.log mail.info -/var/log/mail.info mail.warn -/var/log/mail.warn mail.err /var/log/mail.err news.crit /var/log/news/news.crit news.err /var/log/news/news.err news.notice -/var/log/news/news.notice *.=debug;\\ auth,authpriv.none;\\ news.none;mail.none -/var/log/debug *.=info;*.=notice;*.=warn;\\ auth,authpriv.none;\\ cron,daemon.none;\\ mail,news.none -/var/log/messages *.emerg :omusrmsg:* daemon.*;mail.*;\\ news.err;\\ *.=debug;*.=info;\\ *.=notice;*.=warn |/dev/xconsole local7.* /var/log/cisco.log","text_count":760,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep -v '^#' /etc/rsyslog.conf | grep -v '^$' | grep -v '^\\$'\nauth,authpriv.*                /var/log/auth.log\n*.*;auth,authpriv.none        -/var/log/syslog\ndaemon.*                      -/var/log/daemon.log\nkern.*                        -/var/log/kern.log\nlpr.*                         -/var/log/lpr.log\nmail.*                        -/var/log/mail.log\nuser.*                        -/var/log/user.log\nmail.info                     -/var/log/mail.info\nmail.warn                     -/var/log/mail.warn\nmail.err                       /var/log/mail.err\nnews.crit                      /var/log/news/news.crit\nnews.err                       /var/log/news/news.err\nnews.notice                   -/var/log/news/news.notice\n*.=debug;\\\n    auth,authpriv.none;\\\n    news.none;mail.none       -/var/log/debug\n*.=info;*.=notice;*.=warn;\\\n    auth,authpriv.none;\\\n    cron,daemon.none;\\\n    mail,news.none        -/var/log/messages\n*.emerg                :omusrmsg:*\ndaemon.*;mail.*;\\\n    news.err;\\\n    *.=debug;*.=info;\\\n    *.=notice;*.=warn    |/dev/xconsole\nlocal7.* /var/log/cisco.log"}]}]},{"block_type":"element","block":"k6pz2h8l","search_text":"In order to send your logging information to /var/log/cisco.log , you will need to use the local7 logging facility. The star character after the name of the facility tells the logging server to catch every logging level that goes to the local7 logging facility and write it to /var/log/cisco.log .","text_count":297,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to send your logging information to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/cisco.log"}]},{"block_type":"text","content":", you will need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local7"}]},{"block_type":"text","content":"logging facility. The star character after the name of the facility tells the logging server to catch every logging level that goes to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local7"}]},{"block_type":"text","content":"logging facility and write it to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/cisco.log"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h8m","search_text":"The syslogd(8) server has a pretty similar configuration file that is usually /etc/syslog.conf . On macOS High Sierra, the /etc/syslog.conf file is almost empty and has been replaced by /etc/asl.conf . Nevertheless, the logic behind the configuration of /etc/syslog.conf , /etc/rsyslog.conf , and /etc/asl.conf is the same.","text_count":323,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslogd(8)"}]},{"block_type":"text","content":"server has a pretty similar configuration file that is usually"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/syslog.conf"}]},{"block_type":"text","content":". On macOS High Sierra, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/syslog.conf"}]},{"block_type":"text","content":"file is almost empty and has been replaced by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/asl.conf"}]},{"block_type":"text","content":". Nevertheless, the logic behind the configuration of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/syslog.conf"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/rsyslog.conf"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/asl.conf"}]},{"block_type":"text","content":"is the same."}]},{"block_type":"element","block":"k6pz2h8n","search_text":"A Go program that sends information to log files","text_count":48,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A Go program that sends information to log files"}]},{"block_type":"element","block":"k6pz2h8o","search_text":"The Go code of logFiles.go will explain the use of the log and log/syslog packages.","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFiles.go"}]},{"block_type":"text","content":"will explain the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"packages."}]},{"block_type":"element","block":"k6pz2h8p","search_text":"Tip The log/syslog package is not implemented on the Microsoft Windows version of Go. ","text_count":86,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"package is not implemented on the Microsoft Windows version of Go."}]}]},{"block_type":"element","block":"k6pz2h8q","search_text":"The first part of logFiles.go follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFiles.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2h8r","search_text":"package main import ( \"fmt\" \"log\" \"log/syslog\" \"os\" \"path/filepath\" ) func main() { programName := filepath.Base(os.Args[0]) sysLog, err := syslog.New(syslog.LOG_INFO|syslog.LOG_LOCAL7, programName) ","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"log\" \n    \"log/syslog\" \n    \"os\" \n    \"path/filepath\" \n) \n \nfunc main() { \n \n    programName := filepath.Base(os.Args[0]) \n    sysLog, err := syslog.New(syslog.LOG_INFO|syslog.LOG_LOCAL7, \n programName)"}]}]},{"block_type":"element","block":"k6pz2h8s","search_text":"The first parameter of the syslog.New() function is the priority, which is a combination of the logging facility and the logging level. Therefore, a priority of LOG_NOTICE | LOG_MAIL , which is mentioned as an example, will send notice logging-level messages to the MAIL logging facility.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.New()"}]},{"block_type":"text","content":"function is the priority, which is a combination of the logging facility and the logging level. Therefore, a priority of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"LOG_NOTICE | LOG_MAIL"}]},{"block_type":"text","content":", which is mentioned as an example, will send notice logging-level messages to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MAIL"}]},{"block_type":"text","content":"logging facility."}]},{"block_type":"element","block":"k6pz2h8t","search_text":"As a result, the preceding code sets the default logging to the local7 logging facility using the info logging level. The second parameter of the syslog.New() function is the name of the process that will appear on the logs as the sender of the message. Generally speaking, it is considered a good practice to use the real name of the executable in order to be able to find the information you want easily in the log files at another time.","text_count":439,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As a result, the preceding code sets the default logging to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"local7"}]},{"block_type":"text","content":"logging facility using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"info"}]},{"block_type":"text","content":"logging level. The second parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.New()"}]},{"block_type":"text","content":"function is the name of the process that will appear on the logs as the sender of the message. Generally speaking, it is considered a good practice to use the real name of the executable in order to be able to find the information you want easily in the log files at another time."}]},{"block_type":"element","block":"k6pz2h8u","search_text":"The second part of the program contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2h8v","search_text":"if err != nil { log.Fatal(err) } else { log.SetOutput(sysLog) } log.Println(\"LOG_INFO + LOG_LOCAL7: Logging in Go!\") ","text_count":117,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if err != nil { \n        log.Fatal(err) \n    } else { \n        log.SetOutput(sysLog) \n    } \n    log.Println(\"LOG_INFO + LOG_LOCAL7: Logging in Go!\")"}]}]},{"block_type":"element","block":"k6pz2h8w","search_text":"After the call to syslog.New() , you will have to check the error variable that it returns so that you can make sure that everything is fine. If everything is OK, which means that the value of the error variable is equal to nil , you call the log.SetOutput() function. This sets the output destination of the default logger, which in this case is the logger you created earlier on ( sysLog ). Then you can use log.Println() to send information to the log server.","text_count":462,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After the call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.New()"}]},{"block_type":"text","content":", you will have to check the error variable that it returns so that you can make sure that everything is fine. If everything is OK, which means that the value of the error variable is equal to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", you call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.SetOutput()"}]},{"block_type":"text","content":"function. This sets the output destination of the default logger, which in this case is the logger you created earlier on ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sysLog"}]},{"block_type":"text","content":"). Then you can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Println()"}]},{"block_type":"text","content":"to send information to the log server."}]},{"block_type":"element","block":"k6pz2h8x","search_text":"The third part of logFiles.go comes with the following code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFiles.go"}]},{"block_type":"text","content":"comes with the following code:"}]},{"block_type":"element","block":"k6pz2h8y","search_text":"sysLog, err = syslog.New(syslog.LOG_MAIL, \"Some program!\") if err != nil { log.Fatal(err) } else { log.SetOutput(sysLog) } log.Println(\"LOG_MAIL: Logging in Go!\") fmt.Println(\"Will you see this?\") } ","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sysLog, err = syslog.New(syslog.LOG_MAIL, \"Some program!\") \n    if err != nil { \n        log.Fatal(err) \n    } else { \n        log.SetOutput(sysLog) \n    } \n \n    log.Println(\"LOG_MAIL: Logging in Go!\") \n    fmt.Println(\"Will you see this?\") \n}"}]}]},{"block_type":"element","block":"k6pz2h8z","search_text":"The last part shows that you can change the logging configuration in your programs as many times as you want, and that you can still use fmt.Println() for printing output on the screen.","text_count":185,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part shows that you can change the logging configuration in your programs as many times as you want, and that you can still use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"for printing output on the screen."}]},{"block_type":"element","block":"k6pz2h90","search_text":"The execution of logFiles.go will create the following output on the screen on a Debian Linux machine:","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFiles.go"}]},{"block_type":"text","content":"will create the following output on the screen on a Debian Linux machine:"}]},{"block_type":"element","block":"k6pz2h91","search_text":"$ go run logFiles.go Broadcast message from systemd-journald@mail (Tue 2017-10-17 20:06:08 EEST): logFiles[23688]: Some program![23688]: 2017/10/17 20:06:08 LOG_MAIL: Logging in Go! Message from syslogd@mail at Oct 17 20:06:08 ... Some program![23688]: 2017/10/17 20:06:08 LOG_MAIL: Logging in Go! Will you see this? ","text_count":317,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run logFiles.go\n  \nBroadcast message from systemd-journald@mail (Tue 2017-10-17 20:06:08 \nEEST):\n    \nlogFiles[23688]: Some program![23688]: 2017/10/17 20:06:08 LOG_MAIL: \nLogging in Go!\n    \nMessage from syslogd@mail at Oct 17 20:06:08 ...\nSome program![23688]: 2017/10/17 20:06:08 LOG_MAIL: Logging in Go!\nWill you see this?"}]}]},{"block_type":"element","block":"k6pz2h92","search_text":"Executing the same Go code on a macOS High Sierra machine generated the following output:","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the same Go code on a macOS High Sierra machine generated the following output:"}]},{"block_type":"element","block":"k6pz2h93","search_text":"$ go run logFiles.go Will you see this? ","text_count":40,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run logFiles.go\nWill you see this?"}]}]},{"block_type":"element","block":"k6pz2h94","search_text":"Keep in mind that most Unix machines store logging information in more than one log file, which is also the case with the Debian Linux machine used in this section. As a result, logFiles.go sends its output to multiple log files, which can be verified by the output of the following shell commands:","text_count":298,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Keep in mind that most Unix machines store logging information in more than one log file, which is also the case with the Debian Linux machine used in this section. As a result,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFiles.go"}]},{"block_type":"text","content":"sends its output to multiple log files, which can be verified by the output of the following shell commands:"}]},{"block_type":"element","block":"k6pz2h95","search_text":"$ grep LOG_MAIL /var/log/mail.log Oct 17 20:06:08 mail Some program![23688]: 2017/10/17 20:06:08 LOG_MAIL: Logging in Go! $ grep LOG_LOCAL7 /var/log/cisco.log Oct 17 20:06:08 mail logFiles[23688]: 2017/10/17 20:06:08 LOG_INFO + LOG_LOCAL7: Logging in Go! $ grep LOG_ /var/log/syslog Oct 17 20:06:08 mail logFiles[23688]: 2017/10/17 20:06:08 LOG_INFO + LOG_LOCAL7: Logging in Go! Oct 17 20:06:08 mail Some program![23688]: 2017/10/17 20:06:08 LOG_MAIL: Logging in Go! ","text_count":467,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep LOG_MAIL /var/log/mail.log\nOct 17 20:06:08 mail Some program![23688]: 2017/10/17 20:06:08 \nLOG_MAIL: Logging in Go!\n$ grep LOG_LOCAL7 /var/log/cisco.log\nOct 17 20:06:08 mail logFiles[23688]: 2017/10/17 20:06:08 LOG_INFO + LOG_LOCAL7: Logging in Go!\n$ grep LOG_ /var/log/syslog\nOct 17 20:06:08 mail logFiles[23688]: 2017/10/17 20:06:08 LOG_INFO + LOG_LOCAL7: Logging in Go!\nOct 17 20:06:08 mail Some program![23688]: 2017/10/17 20:06:08 \nLOG_MAIL: Logging in Go!"}]}]},{"block_type":"element","block":"k6pz2h96","search_text":"The preceding output shows that the message of the log.Println(\"LOG_INFO + LOG_LOCAL7: Logging in Go!\") statement was written on both /var/log/cisco.log and /var/log/syslog , whereas the message of the log.Println(\"LOG_MAIL: Logging in Go!\") statement was written on both /var/log/syslog and /var/log/mail.log .","text_count":311,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output shows that the message of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Println(\"LOG_INFO + LOG_LOCAL7: Logging in Go!\")"}]},{"block_type":"text","content":"statement was written on both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/cisco.log"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/syslog"}]},{"block_type":"text","content":", whereas the message of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Println(\"LOG_MAIL: Logging in Go!\")"}]},{"block_type":"text","content":"statement was written on both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/syslog"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/mail.log"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h97","search_text":"The important thing to remember from this section is that if the logging server of a Unix machine is not configured to catch all logging facilities, some of the log entries that you send to it might get discarded without any warnings.","text_count":234,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The important thing to remember from this section is that if the logging server of a Unix machine is not configured to catch all logging facilities, some of the log entries that you send to it might get discarded without any warnings."}]},{"block_type":"element","block":"k6pz2h98","search_text":"About log.Fatal()","text_count":17,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About log.Fatal()"}]},{"block_type":"element","block":"k6pz2h99","search_text":"In this section, you will see the log.Fatal() function in action. The log.Fatal() function is used when something really bad has happened, and you just want to exit your program as fast as possible after reporting the bad situation. The use of log.Fatal() is illustrated in the logFatal.go program, which contains the following Go code:","text_count":336,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"function in action. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"function is used when something really bad has happened, and you just want to exit your program as fast as possible after reporting the bad situation. The use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"is illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logFatal.go"}]},{"block_type":"text","content":"program, which contains the following Go code:"}]},{"block_type":"element","block":"k6pz2h9a","search_text":"package main import ( \"fmt\" \"log\" \"log/syslog\" ) func main() { sysLog, err := syslog.New(syslog.LOG_ALERT|syslog.LOG_MAIL, \"Some program!\") if err != nil { log.Fatal(err) } else { log.SetOutput(sysLog) } log.Fatal(sysLog) fmt.Println(\"Will you see this?\") } ","text_count":258,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"log\" \n    \"log/syslog\" \n) \n \nfunc main() { \n    sysLog, err := syslog.New(syslog.LOG_ALERT|syslog.LOG_MAIL, \n \"Some program!\") \n    if err != nil { \n        log.Fatal(err) \n    } else { \n        log.SetOutput(sysLog) \n    } \n \n    log.Fatal(sysLog) \n    fmt.Println(\"Will you see this?\") \n}"}]}]},{"block_type":"element","block":"k6pz2h9b","search_text":"Executing log.Fatal() will create the following output:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2h9c","search_text":"$ go run logFatal.go exit status 1 ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run logFatal.go\nexit status 1"}]}]},{"block_type":"element","block":"k6pz2h9d","search_text":"As you can easily understand, the use of log.Fatal() terminates a Go program at the point where log.Fatal() was called, which is the reason that you did not see the output from the fmt.Println(\"Will you see this?\") statement.","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can easily understand, the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"terminates a Go program at the point where"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"was called, which is the reason that you did not see the output from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(\"Will you see this?\")"}]},{"block_type":"text","content":"statement."}]},{"block_type":"element","block":"k6pz2h9e","search_text":"However, because of the parameters of the syslog.New() call, a log entry has been added to the log file that is related to mail, which is /var/log/mail.log :","text_count":157,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, because of the parameters of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.New()"}]},{"block_type":"text","content":"call, a log entry has been added to the log file that is related to mail, which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/var/log/mail.log"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2h9f","search_text":"$ grep \"Some program\" /var/log/mail.log Oct 17 20:20:29 iMac Some program![4663]: 2017/10/17 20:20:29 &{17 Some program! iMac.local {0 0} 0xc42000c220}","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep \"Some program\" /var/log/mail.log\nOct 17 20:20:29 iMac Some program![4663]: 2017/10/17 20:20:29 &amp;{17 \nSome program! iMac.local   {0 0} 0xc42000c220}"}]}]},{"block_type":"element","block":"k6pz2h9g","search_text":"About log.Panic()","text_count":17,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About log.Panic()"}]},{"block_type":"element","block":"k6pz2h9h","search_text":"There are situations where a program will fail for good, and you want to have as much information about the failure as possible. In such difficult circumstances, you might consider using log.Panic() , which is the logging function that is illustrated in this section using the Go code of logPanic.go .","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are situations where a program will fail for good, and you want to have as much information about the failure as possible. In such difficult circumstances, you might consider using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panic()"}]},{"block_type":"text","content":", which is the logging function that is illustrated in this section using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logPanic.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2h9i","search_text":"The Go code of logPanic.go follows:","text_count":35,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logPanic.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2h9j","search_text":"package main import ( \"fmt\" \"log\" \"log/syslog\" ) func main() { sysLog, err := syslog.New(syslog.LOG_ALERT|syslog.LOG_MAIL, \"Some program!\") if err != nil { log.Fatal(err) } else { log.SetOutput(sysLog) } log.Panic(sysLog) fmt.Println(\"Will you see this?\") } ","text_count":258,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"log\" \n    \"log/syslog\" \n) \n \nfunc main() { \n    sysLog, err := syslog.New(syslog.LOG_ALERT|syslog.LOG_MAIL, \n \"Some program!\") \n    if err != nil { \n        log.Fatal(err) \n    } else { \n        log.SetOutput(sysLog) \n    } \n \n    log.Panic(sysLog) \n    fmt.Println(\"Will you see this?\") \n}"}]}]},{"block_type":"element","block":"k6pz2h9k","search_text":"Executing logPanic.go on macOS High Sierra will produce the following output:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"logPanic.go"}]},{"block_type":"text","content":"on macOS High Sierra will produce the following output:"}]},{"block_type":"element","block":"k6pz2h9l","search_text":"$ go run logPanic.go panic: &{17 Some program! iMac.local {0 0} 0xc42000c220} goroutine 1 [running]: log.Panic(0xc42004ff50, 0x1, 0x1) /usr/local/Cellar/go/1.9.1/libexec/src/log/log.go:330 +0xc0 main.main() /Users/mtsouk/Desktop/masterGo/ch/ch1/code/logPanic.go:17 +0xea exit status 2","text_count":284,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run logPanic.go\npanic: &amp;{17 Some program! iMac.local   {0 0} 0xc42000c220}\n  \ngoroutine 1 [running]:\nlog.Panic(0xc42004ff50, 0x1, 0x1)\n    /usr/local/Cellar/go/1.9.1/libexec/src/log/log.go:330 +0xc0\nmain.main()\n    /Users/mtsouk/Desktop/masterGo/ch/ch1/code/logPanic.go:17 +0xea\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2h9m","search_text":"Running the same program on a Debian Linux machine with Go version 1.3.3 will generate the following output:","text_count":108,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running the same program on a Debian Linux machine with Go version 1.3.3 will generate the following output:"}]},{"block_type":"element","block":"k6pz2h9n","search_text":"$ go run logPanic.go panic: &{17 Some program! mail {0 0} 0xc2080400e0} goroutine 16 [running]: runtime.panic(0x4ec360, 0xc208000320) /usr/lib/go/src/pkg/runtime/panic.c:279 +0xf5 log.Panic(0xc208055f20, 0x1, 0x1) /usr/lib/go/src/pkg/log/log.go:307 +0xb6 main.main() /home/mtsouk/Desktop/masterGo/ch/ch1/code/logPanic.go:17 +0x169 goroutine 17 [runnable]: runtime.MHeap_Scavenger() /usr/lib/go/src/pkg/runtime/mheap.c:507 runtime.goexit() /usr/lib/go/src/pkg/runtime/proc.c:1445 goroutine 18 [runnable]: bgsweep() /usr/lib/go/src/pkg/runtime/mgc0.c:1976 runtime.goexit() /usr/lib/go/src/pkg/runtime/proc.c:1445 goroutine 19 [runnable]: runfinq() /usr/lib/go/src/pkg/runtime/mgc0.c:2606 runtime.goexit() /usr/lib/go/src/pkg/runtime/proc.c:1445 exit status 2","text_count":756,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run logPanic.go\npanic: &amp;{17 Some program! mail   {0 0} 0xc2080400e0}\n    \ngoroutine 16 [running]:\nruntime.panic(0x4ec360, 0xc208000320)\n    /usr/lib/go/src/pkg/runtime/panic.c:279 +0xf5\nlog.Panic(0xc208055f20, 0x1, 0x1)\n    /usr/lib/go/src/pkg/log/log.go:307 +0xb6\nmain.main()\n    /home/mtsouk/Desktop/masterGo/ch/ch1/code/logPanic.go:17 +0x169\n  \ngoroutine 17 [runnable]:\nruntime.MHeap_Scavenger()\n    /usr/lib/go/src/pkg/runtime/mheap.c:507\nruntime.goexit()\n    /usr/lib/go/src/pkg/runtime/proc.c:1445\n    \ngoroutine 18 [runnable]:\nbgsweep()\n    /usr/lib/go/src/pkg/runtime/mgc0.c:1976\nruntime.goexit()\n    /usr/lib/go/src/pkg/runtime/proc.c:1445\n    \ngoroutine 19 [runnable]:\nrunfinq()\n    /usr/lib/go/src/pkg/runtime/mgc0.c:2606\nruntime.goexit()\n    /usr/lib/go/src/pkg/runtime/proc.c:1445\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2h9o","search_text":"The output of log.Panic() includes additional low-level information that will hopefully help you resolve difficult and rare situations that happen in your Go code.","text_count":163,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panic()"}]},{"block_type":"text","content":"includes additional low-level information that will hopefully help you resolve difficult and rare situations that happen in your Go code."}]},{"block_type":"element","block":"k6pz2h9p","search_text":"Analogous to the log.Fatal() function, the use of the log.Panic() function will add an entry to the proper log file and will immediately terminate the Go program.","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Analogous to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Fatal()"}]},{"block_type":"text","content":"function, the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log.Panic()"}]},{"block_type":"text","content":"function will add an entry to the proper log file and will immediately terminate the Go program."}]},{"block_type":"element","block":"k6pz2h9q","search_text":"Error handling in Go","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Error handling in Go"}]},{"block_type":"element","block":"k6pz2h9r","search_text":"Errors and error handling are two very important Go topics. Go likes error messages so much that it has a separate data type for errors, named error ! This also means that you can easily create your own error messages if you find that what Go gives you is inadequate. You will most likely need to create and handle your own errors when you are developing your own Go packages.","text_count":376,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Errors and error handling are two very important Go topics. Go likes error messages so much that it has a separate data type for errors, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"! This also means that you can easily create your own"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"error messages"}]},{"block_type":"text","content":"if you find that what Go gives you is inadequate. You will most likely need to create and handle your own errors when you are developing your own Go packages."}]},{"block_type":"element","block":"k6pz2h9s","search_text":"Note that having an error condition is one thing, while deciding how to react to an error condition is a totally different thing. Put simply, not all error conditions are created equal, which means that some error conditions might require that you immediately stop the execution of a program, whereas other error situations might require printing a warning message for the user and continuing with the execution of the program. It is up to the developer to use common sense and decide what to do with each error value that the program might get.","text_count":545,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that having an error condition is one thing, while deciding how to react to an error condition is a totally different thing. Put simply, not all error conditions are created equal, which means that some error conditions might require that you immediately stop the execution of a program, whereas other error situations might require printing a warning message for the user and continuing with the execution of the program. It is up to the developer to use common sense and decide what to do with each"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value that the program might get."}]},{"block_type":"element","block":"k6pz2h9t","search_text":"The error data type","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The error data type"}]},{"block_type":"element","block":"k6pz2h9u","search_text":"Many occasions exist where you might end up having to deal with a new error case while developing your own Go application. The error data type is here to help you define your own errors.","text_count":186,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Many occasions exist where you might end up having to deal with a new error case while developing your own Go application. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"data type is here to help you define your own errors."}]},{"block_type":"element","block":"k6pz2h9v","search_text":"This subsection will teach you how to create your own error variables. As you will see in a while, in order to create a new error variable, you will need to call the New() function of the errors standard Go package.","text_count":215,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will teach you how to create your own"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variables. As you will see in a while, in order to create a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable, you will need to call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"New()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2h9w","search_text":"The example Go code illustrating this process can be found in newError.go , and it will be presented in two parts. The first part of the program follows next:","text_count":158,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The example Go code illustrating this process can be found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"newError.go"}]},{"block_type":"text","content":", and it will be presented in two parts. The first part of the program follows next:"}]},{"block_type":"element","block":"k6pz2h9x","search_text":"package main import ( \"errors\" \"fmt\" ) func returnError(a, b int) error { if a == b { err := errors.New(\"Error in returnError() function!\") return err } else { return nil } } ","text_count":175,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"errors\" \n    \"fmt\" \n) \n \nfunc returnError(a, b int) error { \n    if a == b { \n        err := errors.New(\"Error in returnError() function!\") \n        return err \n    } else { \n        return nil \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2h9y","search_text":"There are many interesting things happening here. First of all, you can see the definition of a Go function other than main() for the first time in this book. The name of this new unsophisticated function is returnError() . Additionally, you can see the errors.New() function in action, which takes a string value as its parameter. Last, if a function should return an error variable but there is no error to report, it returns nil instead.","text_count":440,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are many interesting things happening here. First of all, you can see the definition of a Go function other than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"for the first time in this book. The name of this new unsophisticated function is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnError()"}]},{"block_type":"text","content":". Additionally, you can see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.New()"}]},{"block_type":"text","content":"function in action, which takes a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"value as its parameter. Last, if a function should return an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable but there is no error to report, it returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"instead."}]},{"block_type":"element","block":"k6pz2h9z","search_text":"Tip You will learn more about the various types of Go functions in Chapter 6, What You Might Not Know About Go Packages . ","text_count":122,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about the various types of Go functions in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2ha0","search_text":"The second part of newError.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"newError.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ha1","search_text":"func main() { err := returnError(1, 2) if err == nil { fmt.Println(\"returnError() ended normally!\") } else { fmt.Println(err) } err = returnError(10, 10) if err == nil { fmt.Println(\"returnError() ended normally!\") } else { fmt.Println(err) } if err.Error() == \"Error in returnError() function!\" { fmt.Println(\"!!\") } } ","text_count":320,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    err := returnError(1, 2) \n    if err == nil { \n        fmt.Println(\"returnError() ended normally!\") \n    } else { \n        fmt.Println(err) \n    } \n \n    err = returnError(10, 10) \n    if err == nil { \n        fmt.Println(\"returnError() ended normally!\") \n    } else { \n        fmt.Println(err) \n    } \n \n    if err.Error() == \"Error in returnError() function!\" { \n        fmt.Println(\"!!\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ha2","search_text":"As the code illustrates, most of the time, you need to check whether an error variable is equal to nil or not and then act accordingly. Also presented here is the use of the err.Error() method, which allows you to convert an error variable into a string variable. This function lets you compare an error variable with a string .","text_count":328,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the code illustrates, most of the time, you need to check whether an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable is equal to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"or not and then act accordingly. Also presented here is the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"err.Error()"}]},{"block_type":"text","content":"method, which allows you to convert an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable into a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variable. This function lets you compare an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable with a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ha3","search_text":"Tip Sending your error messages to the logging service of your Unix machine, especially when a Go program is a server or some other critical application. However, the code presented in this book will not follow this principle everywhere in order to avoid filling your log files with unnecessary data. ","text_count":301,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Sending your error messages to the logging service of your Unix machine, especially when a Go program is a server or some other critical application. However, the code presented in this book will not follow this principle everywhere in order to avoid filling your log files with unnecessary data."}]}]},{"block_type":"element","block":"k6pz2ha4","search_text":"Executing newError.go will produce the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"newError.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2ha5","search_text":"$ go run newError.go returnError() ended normally! Error in returnError() function! !! ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run newError.go\nreturnError() ended normally!\nError in returnError() function!\n!!"}]}]},{"block_type":"element","block":"k6pz2ha6","search_text":"If you try to compare an error variable with a string variable without converting the error variable to a string first, the Go compiler will create the following error message:","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to compare an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable with a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variable without converting the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"first, the Go compiler will create the following error message:"}]},{"block_type":"element","block":"k6pz2ha7","search_text":"# command-line-arguments ./newError.go:33:9: invalid operation: err == \"Error in returnError() function!\" (mismatched types error and string)","text_count":141,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"# command-line-arguments\n./newError.go:33:9: invalid operation: err == \"Error in returnError() \nfunction!\" (mismatched types error and string)"}]}]},{"block_type":"element","block":"k6pz2ha8","search_text":"Error handling","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Error handling"}]},{"block_type":"element","block":"k6pz2ha9","search_text":"Error handling is a very important feature of Go because almost all Go functions return an error message or nil , which is the Go way of saying whether there was an error condition while executing a function or not. You will most likely get tired of seeing the following Go code, not only in this book but also in every other Go program you can find on the Internet:","text_count":366,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Error handling"}]},{"block_type":"text","content":"is a very important feature of Go because almost all Go functions return an error message or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", which is the Go way of saying whether there was an error condition while executing a function or not. You will most likely get tired of seeing the following Go code, not only in this book but also in every other Go program you can find on the Internet:"}]},{"block_type":"element","block":"k6pz2haa","search_text":"if err != nil { fmt.Println(err) os.Exit(10) } ","text_count":47,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if err != nil { \n    fmt.Println(err) \n    os.Exit(10) \n}"}]}]},{"block_type":"element","block":"k6pz2hab","search_text":"Tip Do not confuse error handling with printing to error output, because they are two totally different things. The former has to do with Go code that handles error conditions, whereas the latter has to do with writing something to the standard error file descriptor. ","text_count":268,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Do not confuse error handling with printing to error output, because they are two totally different things. The former has to do with Go code that handles error conditions, whereas the latter has to do with writing something to the standard error file descriptor."}]}]},{"block_type":"element","block":"k6pz2hac","search_text":"The preceding code prints the error message on the screen and exits using os.Exit() . Should you wish to send the error message to the logging service instead of the screen, use the following variation of the preceding Go code:","text_count":227,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code prints the error message on the screen and exits using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Exit()"}]},{"block_type":"text","content":". Should you wish to send the error message to the logging service instead of the screen, use the following variation of the preceding Go code:"}]},{"block_type":"element","block":"k6pz2had","search_text":"if err != nil { log.Println(err) os.Exit(10) } ","text_count":47,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if err != nil { \n    log.Println(err) \n    os.Exit(10) \n}"}]}]},{"block_type":"element","block":"k6pz2hae","search_text":"Last, there is another variation of the preceding code that is used when something really bad has happened and you want to terminate the program:","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, there is another variation of the preceding code that is used when something really bad has happened and you want to terminate the program:"}]},{"block_type":"element","block":"k6pz2haf","search_text":"if err != nil { panic(err) os.Exit(10) } ","text_count":41,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if err != nil { \n    panic(err) \n    os.Exit(10) \n}"}]}]},{"block_type":"element","block":"k6pz2hag","search_text":"The panic function is a built-in Go function that stops the execution of a program and starts panicking! If you find yourself using panic too often, you might want to reconsider your Go implementation. As you will see in Chapter 2, Understanding Go Internals , Go also offers the recover function, which might be able to save you when you're in some bad situations. For now, you will need to wait for the next chapter to learn more about the power of the panic and recover function pair.","text_count":487,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic"}]},{"block_type":"text","content":"function is a built-in Go function that stops the execution of a program and starts panicking! If you find yourself using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic"}]},{"block_type":"text","content":"too often, you might want to reconsider your Go implementation. As you will see in Chapter 2,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Understanding Go Internals"}]},{"block_type":"text","content":", Go also offers the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover"}]},{"block_type":"text","content":"function, which might be able to save you when you're in some bad situations. For now, you will need to wait for the next chapter to learn more about the power of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover"}]},{"block_type":"text","content":"function pair."}]},{"block_type":"element","block":"k6pz2hah","search_text":"It's now time to see a Go program that not only handles error messages generated by standard Go functions, but one that also defines its own error message. The name of the program is errors.go , and it will be presented to you in five parts. As you will see, the errors.go utility tries to improve the functionality of the cla.go program that you saw earlier in this chapter by examining whether its command-line arguments are acceptable floats or not.","text_count":452,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It's now time to see a Go program that not only handles error messages generated by standard Go functions, but one that also defines its own error message. The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":", and it will be presented to you in five parts. As you will see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":"utility tries to improve the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cla.go"}]},{"block_type":"text","content":"program that you saw earlier in this chapter by examining whether its command-line arguments are acceptable floats or not."}]},{"block_type":"element","block":"k6pz2hai","search_text":"The first part of the program follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program follows:"}]},{"block_type":"element","block":"k6pz2haj","search_text":"package main import ( \"errors\" \"fmt\" \"os\" \"strconv\" ) ","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"errors\" \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n)"}]}]},{"block_type":"element","block":"k6pz2hak","search_text":"This part of errors.go contains the expected import statements.","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":"contains the expected"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"statements."}]},{"block_type":"element","block":"k6pz2hal","search_text":"The second portion of errors.go comes with the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":"comes with the following Go code:"}]},{"block_type":"element","block":"k6pz2ham","search_text":"func main() { if len(os.Args) == 1 { fmt.Println(\"Please give one or more floats.\") os.Exit(1) } arguments := os.Args var err error = errors.New(\"An error\") k := 1 var n float64 ","text_count":178,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) == 1 { \n        fmt.Println(\"Please give one or more floats.\") \n        os.Exit(1) \n    } \n \n    arguments := os.Args \n    var err error = errors.New(\"An error\") \n    k := 1 \n    var n float64"}]}]},{"block_type":"element","block":"k6pz2han","search_text":"Here you create a new error variable named err in order to initialize it with your own value.","text_count":93,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you create a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"err"}]},{"block_type":"text","content":"in order to initialize it with your own value."}]},{"block_type":"element","block":"k6pz2hao","search_text":"The third part of the program comes next:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the program comes next:"}]},{"block_type":"element","block":"k6pz2hap","search_text":"for err != nil { if k >= len(arguments) { fmt.Println(\"None of the arguments is a float!\") return } n, err = strconv.ParseFloat(arguments[k], 64) k++ } min, max := n, n ","text_count":169,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for err != nil { \n        if k &gt;= len(arguments) { \n            fmt.Println(\"None of the arguments is a float!\") \n            return \n        } \n        n, err = strconv.ParseFloat(arguments[k], 64) \n        k++ \n    } \n \n    min, max := n, n"}]}]},{"block_type":"element","block":"k6pz2haq","search_text":"This is the trickiest part of the program because, if the first command-line argument is not a proper float, you will need to check the next one and keep checking until you find a suitable command-line argument. If none of the command-line arguments are in the correct format, errors.go will terminate and print a message on the screen. All this checking happens by examining the error value that is returned by strconv.ParseFloat() . All of this code is there just for the accurate initialization of the min and max variables.","text_count":527,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is the trickiest part of the program because, if the first command-line argument is not a proper float, you will need to check the next one and keep checking until you find a suitable command-line argument. If none of the command-line arguments are in the correct format,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":"will terminate and print a message on the screen. All this checking happens by examining the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value that is returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseFloat()"}]},{"block_type":"text","content":". All of this code is there just for the accurate initialization of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"min"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"max"}]},{"block_type":"text","content":"variables."}]},{"block_type":"element","block":"k6pz2har","search_text":"The fourth part of the program comes with the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of the program comes with the following Go code:"}]},{"block_type":"element","block":"k6pz2has","search_text":"for i := 2; i < len(arguments); i++ { n, err := strconv.ParseFloat(arguments[i], 64) if err == nil { if n < min { min = n } if n > max { max = n } } } ","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 2; i &lt; len(arguments); i++ { \n        n, err := strconv.ParseFloat(arguments[i], 64) \n        if err == nil { \n            if n &lt; min { \n                min = n \n            } \n            if n &gt; max { \n                max = n \n            } \n        } \n    }"}]}]},{"block_type":"element","block":"k6pz2hat","search_text":"Here you just process all of the right command-line arguments in order to find the minimum and maximum floats among them.","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you just process all of the right command-line arguments in order to find the minimum and maximum floats among them."}]},{"block_type":"element","block":"k6pz2hau","search_text":"Finally, the last code portion of the program just deals with printing out the current values of the min and max variables:","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the last code portion of the program just deals with printing out the current values of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"min"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"max"}]},{"block_type":"text","content":"variables:"}]},{"block_type":"element","block":"k6pz2hav","search_text":"fmt.Println(\"Min:\", min) fmt.Println(\"Max:\", max) } ","text_count":52,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Min:\", min) \n    fmt.Println(\"Max:\", max) \n}"}]}]},{"block_type":"element","block":"k6pz2haw","search_text":"As you can see from the Go code in errors.go , the biggest part of the code is about error handling than about the actual functionality of the program. Unfortunately, this is the case for software developed in most modern programming languages, and Go is no exception.","text_count":268,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the Go code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":", the biggest part of the code is about error handling than about the actual functionality of the program. Unfortunately, this is the case for software developed in most modern programming languages, and Go is no exception."}]},{"block_type":"element","block":"k6pz2hax","search_text":"If you execute errors.go , you will get the following output:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"errors.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hay","search_text":"$ go run errors.go a b c None of the arguments is a float! $ go run errors.go b c 1 2 3 c -1 100 -200 a Min: -200 Max: 100 ","text_count":123,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run errors.go a b c\nNone of the arguments is a float!\n$ go run errors.go b c 1 2 3 c -1 100 -200 a\nMin: -200\nMax: 100"}]}]},{"block_type":"element","block":"k6pz2haz","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2hb0","search_text":"Have a look at the following resources:","text_count":39,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Have a look at the following resources:"}]},{"block_type":"element","block":"k6pz2hb1","search_text":"Visit the Go website at https://golang.org/ Browse the Go documentation site at https://golang.org/doc/ ","text_count":104,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the Go website at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Browse the Go documentation site at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/doc/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/doc/"}]}]}]},{"block_type":"element","block":"k6pz2hb2","search_text":"Visit the documentation page of the log package at https://golang.org/pkg/log/ ","text_count":79,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/log/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/log/"}]}]}]},{"block_type":"element","block":"k6pz2hb3","search_text":"Visit the documentation of the log/syslog package at https://golang.org/pkg/log/syslog/ ","text_count":88,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/log/syslog/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/log/syslog/"}]}]}]},{"block_type":"element","block":"k6pz2hb4","search_text":"Visit the documentation page of the os package at https://golang.org/pkg/os/ ","text_count":77,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/os/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/os/"}]}]}]},{"block_type":"element","block":"k6pz2hb5","search_text":"Have a look at https://golang.org/cmd/gofmt/ , which is the documentation page of the gofmt tool that is used for formatting Go code ","text_count":133,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Have a look at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/cmd/gofmt/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/cmd/gofmt/"}]},{"block_type":"text","content":", which is the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gofmt"}]},{"block_type":"text","content":"tool that is used for formatting Go code"}]}]},{"block_type":"element","block":"k6pz2hb6","search_text":"If you are working on a Mac, check the TextMate editor at http://macromates.com/ as well as BBEdit at https://www.barebones.com/products/bbedit/ ","text_count":145,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are working on a Mac, check the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"TextMate"}]},{"block_type":"text","content":"editor at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://macromates.com/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://macromates.com/"}]},{"block_type":"text","content":"as well as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"BBEdit"}]},{"block_type":"text","content":"at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.barebones.com/products/bbedit/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://www.barebones.com/products/bbedit/"}]}]}]},{"block_type":"element","block":"k6pz2hb7","search_text":"Visit the documentation page of the fmt package at https://golang.org/pkg/fmt/ to learn more about Go verbs and the available functions ","text_count":136,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/fmt/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/fmt/"}]},{"block_type":"text","content":"to learn more about Go verbs and the available functions"}]}]},{"block_type":"element","block":"k6pz2hb8","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2hb9","search_text":"Write a Go program that finds the sum of all of its numeric command-line arguments Write a Go program that finds the average value of all of its float command-line arguments Write a Go program that keeps reading integers until it gets the word STOP as input ","text_count":258,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program that finds the sum of all of its numeric command-line arguments"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program that finds the average value of all of its float command-line arguments"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program that keeps reading integers until it gets the word STOP as input"}]}]},{"block_type":"element","block":"k6pz2hba","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2hbb","search_text":"This chapter addressed many interesting Go topics including compiling Go code, working with standard input, accessing standard output and standard error in Go, processing command-line arguments, printing on the screen, and using the logging service of a Unix system as well as error handling and some general information about Go. You should consider all of these topics as foundational information about Go.","text_count":408,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter addressed many interesting Go topics including compiling Go code, working with standard input, accessing standard output and standard error in Go, processing command-line arguments, printing on the screen, and using the logging service of a Unix system as well as error handling and some general information about Go. You should consider all of these topics as foundational information about Go."}]},{"block_type":"element","block":"k6pz2hbc","search_text":"The next chapter is all about the internals of Go, which includes learning about Garbage Collection , working with the Go compiler, calling C code from Go, using the defer keyword, and working with the Go assembler as well as the panic and recover function pair.","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next chapter is all about the internals of Go, which includes learning about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Garbage Collection"}]},{"block_type":"text","content":", working with the Go compiler, calling C code from Go, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword, and working with the Go assembler as well as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover"}]},{"block_type":"text","content":"function pair."}]}]},{"title":"Understanding Go Internals","author":"Mihalis Tsoukalos","block":"k6pz249l","number":2,"contents":[{"block_type":"element","block":"k6pz2hbd","search_text":"All of the Go features that you learned in the previous chapter are extremely handy, and you will be using them all the time. However, there is nothing more rewarding than being able to see and understand what is going on in the background and how Go operates behind the scenes.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of the Go features that you learned in the previous chapter are extremely handy, and you will be using them all the time. However, there is nothing more rewarding than being able to see and understand what is going on in the background and how Go operates behind the scenes."}]},{"block_type":"element","block":"k6pz2hbe","search_text":"In this chapter, you will learn about the Go garbage collector and how it works. Additionally, you will find out how to call C code from your Go programs, which you might find indispensable in certain situations. However, you will not need to use this capability too often, because Go is a very capable programming language. Likewise, you will also understand how to call Go code from your C programs and how to use the panic() and recover() functions and the defer keyword.","text_count":474,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn about the Go garbage collector and how it works. Additionally, you will find out how to call C code from your Go programs, which you might find indispensable in certain situations. However, you will not need to use this capability too often, because Go is a very capable programming language. Likewise, you will also understand how to call Go code from your C programs and how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword."}]},{"block_type":"element","block":"k6pz2hbf","search_text":"In this chapter of Mastering Go, you will learn the following topics:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of Mastering Go, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2hbg","search_text":"The Go compiler How garbage collection works in Go How to check the operation of the garbage collector Calling C code from your Go programs Calling Go code from a C program The panic() and recover() functions The unsafe package The handy, yet tricky defer keyword The strace(1) Linux utility The dtrace(1) utility that can be found in FreeBSD systems including macOS High Sierra Finding out information about your Go environment Node trees The Go assembler ","text_count":457,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The Go compiler"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"How garbage collection works in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"How to check the operation of the garbage collector"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Calling C code from your Go programs"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Calling Go code from a C program"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The handy, yet tricky"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"Linux utility"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"utility that can be found in FreeBSD systems including macOS High Sierra"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Finding out information about your Go environment"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Node trees"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The Go assembler"}]}]},{"block_type":"element","block":"k6pz2hbh","search_text":"The Go compiler","text_count":15,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The Go compiler"}]},{"block_type":"element","block":"k6pz2hbi","search_text":"The Go compiler is executed with the help of the go tool. This tool does many more things than just generating executable files.","text_count":128,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go compiler"}]},{"block_type":"text","content":"is executed with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"tool. This tool does many more things than just generating executable files."}]},{"block_type":"element","block":"k6pz2hbj","search_text":"Tip The unsafe.go file used in this section does not contain any special code-the commands presented will work on every valid Go source file. You will see the contents of unsafe.go in a short while. ","text_count":199,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":"file used in this section does not contain any special code-the commands presented will work on every valid Go source file. You will see the contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":"in a short while."}]}]},{"block_type":"element","block":"k6pz2hbk","search_text":"You can compile a Go source file using the go tool compile command. What you will get is an object file , which is a file with the .o file extension. This is illustrated in the output of the following commands, which were executed on a macOS High Sierra machine:","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can compile a Go source file using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile"}]},{"block_type":"text","content":"command. What you will get is an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"object file"}]},{"block_type":"text","content":", which is a file with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":".o"}]},{"block_type":"text","content":"file extension. This is illustrated in the output of the following commands, which were executed on a macOS High Sierra machine:"}]},{"block_type":"element","block":"k6pz2hbl","search_text":"$ go tool compile unsafe.go $ ls -l unsafe.o -rw-r--r-- 1 mtsouk staff 5495 Oct 30 19:51 unsafe.o $ file unsafe.o unsafe.o: data","text_count":128,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile unsafe.go\n$ ls -l unsafe.o\n-rw-r--r--  1 mtsouk  staff  5495 Oct 30 19:51 unsafe.o\n$ file unsafe.o\nunsafe.o: data"}]}]},{"block_type":"element","block":"k6pz2hbm","search_text":"An object file is a binary file that contains object code , which is machine code in a relocatable format that, most of the time is not directly executable. The biggest advantage of the relocatable format is that it requires as little memory as possible during the linking phase.","text_count":279,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An object file is a binary file that contains"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"object code"}]},{"block_type":"text","content":", which is machine code in a relocatable format that, most of the time is not directly executable. The biggest advantage of the relocatable format is that it requires as little memory as possible during the linking phase."}]},{"block_type":"element","block":"k6pz2hbn","search_text":"If you use the -pack command-line flag when executing go tool compile , you will get an archive file instead of an object file:","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-pack"}]},{"block_type":"text","content":"command-line flag when executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile"}]},{"block_type":"text","content":", you will get an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"archive file"}]},{"block_type":"text","content":"instead of an object file:"}]},{"block_type":"element","block":"k6pz2hbo","search_text":"$ go tool compile -pack unsafe.go $ ls -l unsafe.a -rw-r--r-- 1 mtsouk staff 5680 Oct 30 19:52 unsafe.a $ file unsafe.a unsafe.a: current ar archive","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -pack unsafe.go\n$ ls -l unsafe.a\n-rw-r--r--  1 mtsouk  staff  5680 Oct 30 19:52 unsafe.a\n$ file unsafe.a\nunsafe.a: current ar archive"}]}]},{"block_type":"element","block":"k6pz2hbp","search_text":"An archive file is a binary file that contains one or more files that is primarily used for grouping multiple files into a single file. The archive format used by Go is called ar .","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An archive file is a binary file that contains one or more files that is primarily used for grouping multiple files into a single file. The archive format used by Go is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"ar"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hbq","search_text":"You can list the contents of an .a archive file as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can list the contents of an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":".a"}]},{"block_type":"text","content":"archive file as follows:"}]},{"block_type":"element","block":"k6pz2hbr","search_text":"$ ar t unsafe.a __.PKGDEF _go_.o","text_count":32,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ar t unsafe.a\n__.PKGDEF\n_go_.o"}]}]},{"block_type":"element","block":"k6pz2hbs","search_text":"Another truly valuable command-line flag of the go tool compile command is -race , which allows you to detect race conditions . You will learn more about race conditions and why you want to avoid them in Chapter 10, Go Concurrency – Advanced Topics .","text_count":250,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Another truly valuable command-line flag of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile"}]},{"block_type":"text","content":"command is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-race"}]},{"block_type":"text","content":", which allows you to detect"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"race conditions"}]},{"block_type":"text","content":". You will learn more about race conditions and why you want to avoid them in Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency&nbsp;&ndash; Advanced Topics"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hbt","search_text":"You will learn the additional uses of the go tool compile command toward the end of this chapter, when we talk about assembly language and node trees. However, in order to tease you a little, try executing the following command:","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn the&nbsp;additional uses of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile"}]},{"block_type":"text","content":"command toward the end of this chapter, when we talk about assembly language and node trees. However, in order to tease you a little, try executing the following command:"}]},{"block_type":"element","block":"k6pz2hbu","search_text":"$ go tool compile -S unsafe.go","text_count":30,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -S unsafe.go"}]}]},{"block_type":"element","block":"k6pz2hbv","search_text":"The preceding command generates lots of output that you might find difficult to understand, which means that Go does a pretty good job on hiding any unnecessary complexities, unless you ask for them!","text_count":199,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding command generates lots of output that you might find difficult to understand, which means that Go does a pretty good job on hiding any unnecessary complexities, unless you ask for them!"}]},{"block_type":"element","block":"k6pz2hbw","search_text":"Garbage Collection","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Garbage Collection"}]},{"block_type":"element","block":"k6pz2hbx","search_text":"Garbage Collection is the process of freeing memory space that is not being used. In other words, the garbage collector sees which objects are out of scope and can no longer be referenced, and it frees the memory space they consume. This process happens in a concurrent manner while a Go program is running, not before or after the execution of a Go program. The documentation of the Go garbage collector implementation states the following:","text_count":441,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Garbage Collection"}]},{"block_type":"text","content":"is the process of freeing memory space that is not being used. In other words, the garbage collector sees which objects are out of scope and can no longer be referenced, and it frees the memory space they consume. This process happens in a concurrent manner while a Go program is running, not before or after the execution of a Go program. The documentation of the Go garbage collector implementation states the following:"}]},{"block_type":"element","block":"k6pz2hby","search_text":"The GC runs concurrently with mutator threads, is type accurate (aka precise), allows multiple GC threads to run in parallel. It is a concurrent mark and sweep that uses a write barrier. It is non-generational and non-compacting. Allocation is done using size segregated per P allocation areas to minimize fragmentation while eliminating locks in the common case.","text_count":363,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The GC runs concurrently with mutator threads, is type accurate (aka precise), allows multiple GC threads to run in parallel. It is a concurrent mark and sweep that uses a write barrier. It is non-generational and non-compacting. Allocation is done using size segregated per P allocation areas to minimize fragmentation while eliminating locks in the common case."}]}]},{"block_type":"element","block":"k6pz2hbz","search_text":"There is a lot of terminology here that I will explain in a while. First, however, I will show you a way to look at some parameters of the garbage collection process. Fortunately, the Go standard library offers functions that allow you to study the operation of the garbage collector and learn more about what the garbage collector does secretly. The relevant code is saved as gColl.go , and it will be presented in three parts.","text_count":428,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is a lot of terminology here that I will explain in a while. First, however, I will show you a way to look at some parameters of the garbage collection process. Fortunately, the Go standard library offers functions that allow you to study the operation of the garbage collector and learn more about what the garbage collector does secretly. The relevant code is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2hc0","search_text":"The first code segment of gColl.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hc1","search_text":"package main import ( \"fmt\" \"runtime\" \"time\" ) func printStats(mem runtime.MemStats) { runtime.ReadMemStats(&mem) fmt.Println(\"mem.Alloc:\", mem.Alloc) fmt.Println(\"mem.TotalAlloc:\", mem.TotalAlloc) fmt.Println(\"mem.HeapAlloc:\", mem.HeapAlloc) fmt.Println(\"mem.NumGC:\", mem.NumGC) fmt.Println(\"-----\") }","text_count":302,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n \nimport (\n   \"fmt\"\n   \"runtime\"\n   \"time\"\n)\n\nfunc printStats(mem runtime.MemStats) {\n   runtime.ReadMemStats(&amp;mem)\n   fmt.Println(\"mem.Alloc:\", mem.Alloc)\n   fmt.Println(\"mem.TotalAlloc:\", mem.TotalAlloc)\n   fmt.Println(\"mem.HeapAlloc:\", mem.HeapAlloc)\n   fmt.Println(\"mem.NumGC:\", mem.NumGC)\n   fmt.Println(\"-----\")\n}"}]}]},{"block_type":"element","block":"k6pz2hc2","search_text":"Note that each time that you need to retrieve the more recent garbage collections statistics, you will need to call the runtime.ReadMemStats() function. The purpose of the printStats() function is to avoid writing the same Go code all of the time.","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that each time that you need to retrieve the more recent garbage collections statistics, you will need to call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime.ReadMemStats()"}]},{"block_type":"text","content":"function. The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printStats()"}]},{"block_type":"text","content":"function is to avoid writing the same Go code all of the time."}]},{"block_type":"element","block":"k6pz2hc3","search_text":"The second part of the program is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hc4","search_text":"func main() { var mem runtime.MemStats printStats(mem) for i := 0; i < 10; i++ { s := make([]byte, 50000000) if s == nil { fmt.Println(\"Operation failed!\") } } printStats(mem)","text_count":175,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   var mem runtime.MemStats\n   printStats(mem)\n\n   for i := 0; i &lt; 10; i++ {\n         s := make([]byte, 50000000)\n         if s == nil {\n               fmt.Println(\"Operation failed!\")\n         }\n   }\n   printStats(mem)"}]}]},{"block_type":"element","block":"k6pz2hc5","search_text":"The for loop creates multiple, big Go slices in order to allocate large amounts of memory and trigger the garbage collector.","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop creates multiple, big Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slices"}]},{"block_type":"text","content":"in order to allocate large amounts of memory and trigger the garbage collector."}]},{"block_type":"element","block":"k6pz2hc6","search_text":"The last part of gColl.go has the following Go code, which does more memory allocations using Go slices:","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":"has the following Go code, which does more memory allocations using Go slices:"}]},{"block_type":"element","block":"k6pz2hc7","search_text":"for i := 0; i < 10; i++ { s := make([]byte, 100000000) if s == nil { fmt.Println(\"Operation failed!\") } time.Sleep(5 * time.Second) } printStats(mem) }","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; 10; i++ {\n         s := make([]byte, 100000000)\n         if s == nil {\n               fmt.Println(\"Operation failed!\")\n         }\n         time.Sleep(5 * time.Second)\n   }\n   printStats(mem)\n}"}]}]},{"block_type":"element","block":"k6pz2hc8","search_text":"The output of gColl.go on a macOS High Sierra machine is as follows:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine is as follows:"}]},{"block_type":"element","block":"k6pz2hc9","search_text":"$ go run gColl.go mem.Alloc: 66024 mem.TotalAlloc: 66024 mem.HeapAlloc: 66024 mem.NumGC: 0 ----- mem.Alloc: 50078496 mem.TotalAlloc: 500117056 mem.HeapAlloc: 50078496 mem.NumGC: 10 ----- mem.Alloc: 76712 mem.TotalAlloc: 1500199904 mem.HeapAlloc: 76712 mem.NumGC: 20 -----","text_count":271,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run gColl.go\nmem.Alloc: 66024\nmem.TotalAlloc: 66024\nmem.HeapAlloc: 66024\nmem.NumGC: 0\n-----\nmem.Alloc: 50078496\nmem.TotalAlloc: 500117056\nmem.HeapAlloc: 50078496\nmem.NumGC: 10\n-----\nmem.Alloc: 76712\nmem.TotalAlloc: 1500199904\nmem.HeapAlloc: 76712\nmem.NumGC: 20\n-----"}]}]},{"block_type":"element","block":"k6pz2hca","search_text":"Although you will not examine the operation of the Go garbage collector all of the time, being able to watch the way the Go garbage collector operates on a slow application can save you a lot of time in the long run—I can assure you that you will not regret the time you spend learning about garbage collection in general and, more specifically, about the way the Go garbage collector works.","text_count":391,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you will not examine the operation of the Go garbage collector all of the time, being able to watch the way the Go garbage collector operates on a slow application can save you a lot of time in the long run&mdash;I can assure you that you will not regret the time you spend learning about garbage collection in general and, more specifically, about the way the Go garbage collector works."}]},{"block_type":"element","block":"k6pz2hcb","search_text":"There is a trick that allows you to get even more detailed output about the way the Go garbage collector operates, which is illustrated by the next command:","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is a trick that allows you to get even more detailed output about the way the Go garbage collector operates, which is illustrated by the next command:"}]},{"block_type":"element","block":"k6pz2hcc","search_text":"$ GODEBUG=gctrace=1 go run gColl.go","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ GODEBUG=gctrace=1 go run gColl.go"}]}]},{"block_type":"element","block":"k6pz2hcd","search_text":"So, if you put GODEBUG=gctrace=1 in front of any go run command, Go will print analytical data about the operation of the garbage collector. The generated data will have the following format:","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, if you put"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GODEBUG=gctrace=1"}]},{"block_type":"text","content":"in front of any"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"command, Go will print analytical data about the operation of the garbage collector. The generated data will have the following format:"}]},{"block_type":"element","block":"k6pz2hce","search_text":"gc 4 @0.025s 0%: 0.002+0.065+0.018 ms clock, 0.021+0.040/0.057/0.003+0.14 ms cpu, 47->47->0 MB, 48 MB goal, 8 P gc 17 @30.103s 0%: 0.004+0.080+0.019 ms clock, 0.033+0/0.076/0.071+0.15 ms cpu, 95->95->0 MB, 96 MB goal, 8 P","text_count":221,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"gc 4 @0.025s 0%: 0.002+0.065+0.018 ms clock, 0.021+0.040/0.057/0.003+0.14 ms cpu, 47-&gt;47-&gt;0 MB, 48 MB goal, 8 P\ngc 17 @30.103s 0%: 0.004+0.080+0.019 ms clock, 0.033+0/0.076/0.071+0.15 ms cpu, 95-&gt;95-&gt;0 MB, 96 MB goal, 8 P"}]}]},{"block_type":"element","block":"k6pz2hcf","search_text":"The preceding output gives you more information about the heap sizes during the garbage collection process. Let's take the 47->47->0 MB trinity of values as an example. The first number is the heap size when the garbage collector is about to run. The second value is the heap size when the garbage collector ends its operation. The last value is the size of the live heap.","text_count":372,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output gives you more information about the heap sizes during the garbage collection process. Let's take the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"47-&gt;47-&gt;0 MB"}]},{"block_type":"text","content":"trinity of values as an example. The first number is the heap size when the garbage collector is about to run. The second value is the heap size when the garbage collector ends its operation. The last value is the size of the live heap."}]},{"block_type":"element","block":"k6pz2hcg","search_text":"The Tricolor algorithm","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The Tricolor algorithm"}]},{"block_type":"element","block":"k6pz2hch","search_text":"The operation of the Go garbage collector is based on the tricolor algorithm , which is the subject of this subsection.","text_count":119,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The operation of the Go garbage collector is based on the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tricolor algorithm"}]},{"block_type":"text","content":", which is the subject of this subsection."}]},{"block_type":"element","block":"k6pz2hci","search_text":"Note The tricolor algorithm is not unique to Go, and it can be used in other programming languages as well. ","text_count":108,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The tricolor algorithm is not unique to Go, and it can be used in other programming languages as well."}]}]},{"block_type":"element","block":"k6pz2hcj","search_text":"Strictly speaking, the official name for the algorithm used in Go is the tricolor mark-and-sweep algorithm . It can work concurrently with the program and uses a write barrier . This means that when a Go program runs, the Go scheduler is responsible for the scheduling of the application and the garbage collector as if the Go scheduler had to deal with a regular application with multiple goroutines ! You will learn more about goroutines and the Go scheduler in Chapter 9, Go Concurrency – Goroutines, Channels , and Pipelines .","text_count":530,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, the official name for the algorithm used in Go is the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tricolor mark-and-sweep algorithm"}]},{"block_type":"text","content":". It can work concurrently with the program and uses a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"write barrier"}]},{"block_type":"text","content":". This means that when a Go program runs, the Go scheduler is responsible for the scheduling of the application and the garbage collector as if the Go scheduler had to deal with a regular application with multiple"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutines"}]},{"block_type":"text","content":"! You will learn more about goroutines and the Go scheduler in Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Goroutines, Channels"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"and Pipelines"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hck","search_text":"The core idea behind this algorithm is that of Edsger W. Dijkstra , Leslie Lamport , A. J. Martin , C. S. Scholten , and E. F. M. Steffens . It was first illustrated on a paper, On-the-fly Garbage Collection: An Exercise in Cooperation . The primary principle behind the tricolor mark-and-sweep algorithm is that it divides the objects of the heap into three different sets according to their color, which is assigned by the algorithm. I will address the mark-and-sweep algorithm further in the More about the operation of the Go Garbage Collector section of this chapter.","text_count":572,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The core idea behind this algorithm is that of&nbsp;"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Edsger W. Dijkstra"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Leslie Lamport"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"A. J. Martin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C. S. Scholten"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"E. F. M. Steffens"}]},{"block_type":"text","content":". It was first illustrated on a paper,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"On-the-fly Garbage Collection: An Exercise in Cooperation"}]},{"block_type":"text","content":". The primary principle behind the tricolor mark-and-sweep algorithm is that it divides the objects of the heap into three different sets according to their color, which is assigned by the algorithm. I will address the mark-and-sweep algorithm further in the&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"More about the operation of the Go Garbage Collector"}]},{"block_type":"text","content":"&nbsp;section of this chapter."}]},{"block_type":"element","block":"k6pz2hcl","search_text":"Now let's talk about the meaning of each color set. The objects of the black set are guaranteed to have no pointers to any object of the white set. However, an object in the white set can have a pointer to an object of the black set, because this has no effect on the operation of the garbage collector! The objects of the grey set might have pointers to some objects of the white set. Also, the objects of the white set are candidates for garbage collection.","text_count":459,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's talk about the meaning of each color set. The objects of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"black set"}]},{"block_type":"text","content":"are guaranteed to have no pointers to any object of the white set. However, an object in the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"white set"}]},{"block_type":"text","content":"can have a pointer to an object of the black set, because this has no effect on the operation of the garbage collector! The objects of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"grey set"}]},{"block_type":"text","content":"might have pointers to some objects of the white set. Also, the objects of the white set are candidates for garbage collection."}]},{"block_type":"element","block":"k6pz2hcm","search_text":"Note that no object can go directly from the black set to the white set, which allows the algorithm to operate and be able to clear the objects in the white set. Additionally, no object of the black set can directly point to an object of the white set.","text_count":252,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that no object can go directly from the black set to the white set, which allows the algorithm to operate and be able to clear the objects in the white set. Additionally, no object of the black set can directly point to an object of the white set."}]},{"block_type":"element","block":"k6pz2hcn","search_text":"When the garbage collection begins, all objects are white and the garbage collector visits all of the root objects and colors them grey. The roots are the objects that can be directly accessed by the application, which includes global variables and other things on the stack. These objects mostly depend on the Go code of a particular program. After this, the garbage collector picks a grey object, makes it black, and starts searching to determine if that object has pointers to other objects of the white set. This means that when a grey object is being scanned for pointers to other objects, it is colored black. If that scan discovers that this particular object has one or more pointers to a white object, it puts that white object in the grey set. This process keeps going for as long as objects exist in the grey set. After that, the objects in the white set are unreachable and their memory space can be reused. Therefore, at this point, the elements of the white set are said to be garbage collected.","text_count":1009,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When the garbage collection begins, all objects are white and the garbage collector visits all of the root objects and colors them grey. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"roots"}]},{"block_type":"text","content":"are the objects that can be directly accessed by the application, which includes global variables and other things on the stack. These objects mostly depend on the Go code of a particular program. After this, the garbage collector picks a grey object, makes it black, and starts searching to determine if that object has pointers to other objects of the white set. This means that when a grey object is being scanned for pointers to other objects, it is colored black. If that scan discovers that this particular object has one or more pointers to a white object, it puts that white object in the grey set. This process keeps going for as long as objects exist in the grey set. After that, the objects in the white set are unreachable and their memory space can be reused. Therefore, at this point, the elements of the white set are said to be garbage collected."}]},{"block_type":"element","block":"k6pz2hco","search_text":"Note If an object of the grey set becomes unreachable at some point in a garbage collection cycle, it will not be collected in that garbage collection cycle but rather in the next one! Although this is not an optimal situation, it is not that bad. ","text_count":248,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If an object of the grey set becomes unreachable at some point in a garbage collection cycle, it will not be collected in that garbage collection cycle but rather in the next one! Although this is not an optimal situation, it is not that bad."}]}]},{"block_type":"element","block":"k6pz2hcp","search_text":"During this process, the running application is called the mutator . The mutator runs a small function named write barrier that is executed each time a pointer in the heap is modified. If the pointer of an object in the heap is modified, which means that this object is now reachable, the write barrier colors it grey and puts it in the grey set.","text_count":346,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"During this process, the running application is called the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"mutator"}]},{"block_type":"text","content":". The mutator runs a small function named"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"write barrier"}]},{"block_type":"text","content":"that is executed each time a pointer in the heap is modified. If the pointer of an object in the heap is modified, which means that this object is now reachable, the write barrier colors it grey and puts it in the grey set."}]},{"block_type":"element","block":"k6pz2hcq","search_text":"Tip The mutator is responsible for the invariant that no element of the black set has a pointer to an element of the white set. This is accomplished with the help of the write barrier function. Failing to accomplish this invariant will ruin the garbage collection process, and it will most likely crash your program in an ugly and undesired way. ","text_count":346,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The mutator is responsible for the invariant that no element of the black set has a pointer to an element of the white set. This is accomplished with the help of the write barrier function. Failing to accomplish this invariant will ruin the garbage collection process, and it will most likely crash your program in an ugly and undesired way."}]}]},{"block_type":"element","block":"k6pz2hcr","search_text":"As a result, the heap can be viewed as a graph of connected objects, as shown in the following diagram, which demonstrates a single phase of a garbage collection cycle:","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As a result, the heap can be viewed as a graph of connected objects, as shown in the following diagram, which demonstrates a single phase of a garbage collection cycle:"}]},{"block_type":"element","block":"k6pz2hcs","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000012.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2hct","search_text":"The Go garbage collector represents the heap of a program as a graph","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go garbage collector represents the heap of a program as a graph"}]},{"block_type":"element","block":"k6pz2hcu","search_text":"Thus, there are three different colors: black, white, and grey. When the algorithm begins, all objects are colored white. As the algorithm continues, white objects are moved into one of the other two sets. The objects that are left in the white set are the ones that will be cleared at some point.","text_count":297,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, there are three different colors: black, white, and grey. When the algorithm begins, all objects are colored white. As the algorithm continues, white objects are moved into one of the other two sets. The objects that are left in the white set are the ones that will be cleared at some point."}]},{"block_type":"element","block":"k6pz2hcv","search_text":"In the preceding graph, you can see that while object E, which is in the white set, can access object F, it cannot be accessed by any other object because no other object points to object E, which makes it a perfect candidate for garbage collection! Additionally, objects A, B, and C are root objects and are always reachable and therefore cannot be garbage collected.","text_count":368,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding graph, you can see that while object E, which is in the white set, can access object F, it cannot be accessed by any other object because no other object points to object E, which makes it a perfect candidate for garbage collection! Additionally, objects A, B, and C are root objects and are always reachable and therefore cannot be garbage collected."}]},{"block_type":"element","block":"k6pz2hcw","search_text":"Can you guess what will happen next in that graph? Well, it is not that difficult to fathom that the algorithm will have to process the remaining elements of the grey set, which means that objects A and F will go into the black set. Object A will go into the black set because it is a root element, and F will go into the black set because it does not point to any other object while it is in the grey set. After object A is garbage collected, object F will become unreachable and will be garbage collected in the next cycle of the garbage collector, as an unreachable object cannot magically become reachable in the next iteration of the garbage collection cycle.","text_count":664,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Can you guess what will happen next in that graph? Well, it is not that difficult to fathom that the algorithm will have to process the remaining elements of the grey set, which means that objects A and F will go into the black set. Object A will go into the black set because it is a root element, and F will go into the black set because it does not point to any other object while it is in the grey set. After object A is garbage collected, object F will become unreachable and will be garbage collected in the next cycle of the garbage collector, as an unreachable object cannot magically become reachable in the next iteration of the garbage collection cycle."}]},{"block_type":"element","block":"k6pz2hcx","search_text":"The Go garbage collection can also be applied to variables such as channels ! When the garbage collector finds out that a channel is unreachable and that the channel variable can no longer be accessed, it will free its resources even if the channel has not been closed! You will learn more about channels in Chapter 9, Go Concurrency – Goroutines, Channels and Pipelines .","text_count":372,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go garbage collection can also be applied to variables such as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"channels"}]},{"block_type":"text","content":"! When the garbage collector finds out that a channel is unreachable and that the channel variable can no longer be accessed, it will free its resources even if the channel has not been closed! You will learn more about channels in Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Goroutines, Channels and Pipelines"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hcy","search_text":"Go allows you to initiate a garbage collection manually by putting a runtime.GC() statement in your Go code. However, keep in mind that runtime.GC() will block the caller, and it might block the entire program, especially if you are running a very busy Go program with many objects. This happens mainly because you cannot perform garbage collections while everything else is rapidly changing, as this will not give the garbage collector the opportunity to identify clearly the members of the white, black, and grey sets! This garbage collection status is also called the garbage collection safe-point .","text_count":602,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go allows you to initiate a garbage collection manually by putting a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime.GC()"}]},{"block_type":"text","content":"statement in your Go code. However, keep in mind that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime.GC()"}]},{"block_type":"text","content":"will block the caller, and it might block the entire program, especially if you are running a very busy Go program with many objects. This happens mainly because you cannot perform garbage collections while everything else is rapidly changing, as this will not give the garbage collector the opportunity to identify clearly the members of the white, black, and grey sets! This garbage collection status is also called the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"garbage collection safe-point"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hcz","search_text":"You can find the long and relatively advanced Go code of the garbage collector at https://github.com/golang/go/blob/master/src/runtime/mgc.go . You can study this if you want to learn even more about the garbage collection operation. You can even make changes to that code if you are brave enough!","text_count":297,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the long and relatively advanced Go code of the garbage collector at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://github.com/golang/go/blob/master/src/runtime/mgc.go"},"children":[{"block_type":"text","content":"https://github.com/golang/go/blob/master/src/runtime/mgc.go"}]},{"block_type":"text","content":". You can study this if you want to learn even more about the garbage collection operation. You can even make changes to that code if you are brave enough!"}]},{"block_type":"element","block":"k6pz2hd0","search_text":"Note The Go garbage collector is always being improved by the Go team, mainly by trying to make it faster by lowering the number of scans it needs to perform over the data of the three sets . However, despite the various optimizations, the general idea behind the algorithm remains the same. ","text_count":292,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go garbage collector is always being improved by the Go team, mainly by trying to make it faster by lowering the number of scans it needs to perform over the data of the three sets . However, despite the various optimizations, the general idea behind the algorithm remains the same."}]}]},{"block_type":"element","block":"k6pz2hd1","search_text":"More about the operation of the Go Garbage Collector","text_count":52,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"More about the operation of the Go Garbage Collector"}]},{"block_type":"element","block":"k6pz2hd2","search_text":"This section will explore the Go garbage collector further and present additional information about its activities.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will explore the Go garbage collector further and present additional information about its activities."}]},{"block_type":"element","block":"k6pz2hd3","search_text":"The main concern of the Go garbage collector is low latency, which basically means short pauses in its operation in order to have a real-time operation. On the other hand, what a program does all the time is to create new objects and manipulate existing objects with pointers. This process can end up creating objects that cannot be accessed any longer because no pointers exist that point to these objects. Such objects are now garbage waiting for the garbage collector to clean them up and free their memory space. After that, the memory space that has been freed is ready to be used again.","text_count":592,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main concern of the Go garbage collector is low latency, which basically means short pauses in its operation in order to have a real-time operation. On the other hand, what a program does all the time is to create new objects and manipulate existing objects with pointers. This process can end up creating objects that cannot be accessed any longer because no pointers exist that point to these objects. Such objects are now garbage waiting for the garbage collector to clean them up and free their memory space. After that, the memory space that has been freed is ready to be used again."}]},{"block_type":"element","block":"k6pz2hd4","search_text":"The classic algorithm for garbage collection is called mark-and-sweep, and it is the simplest algorithm in use. The way that the mark-and-sweep algorithm works is pretty simple and easy to understand: the algorithm stops the program execution ( stop-the-world garbage collector ) in order to visit all of the accessible objects of the heap of a program and marks them. After that, it sweeps the inaccessible objects. During the mark phase of the algorithm, each object is marked as white, grey, or black. The children of a grey object are colored grey, whereas the original grey object is now colored black. The sweep phase begins when there are no more grey objects to examine. This technique works because there are no pointers from the black set to the white set, which is a fundamental invariant of the algorithm.","text_count":817,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The classic algorithm for garbage collection is called mark-and-sweep, and it is the simplest algorithm in use. The way that the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"mark-and-sweep algorithm"}]},{"block_type":"text","content":"works is pretty simple and easy to understand: the algorithm stops the program execution ("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"stop-the-world garbage collector"}]},{"block_type":"text","content":") in order to visit all of the accessible objects of the heap of a program and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"marks"}]},{"block_type":"text","content":"them. After that, it"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"sweeps"}]},{"block_type":"text","content":"the inaccessible objects. During the mark phase of the algorithm, each object is marked as white, grey, or black. The children of a grey object are colored grey, whereas the original grey object is now colored black. The sweep phase begins when there are no more grey objects to examine. This technique works because there are no pointers from the black set to the white set, which is a fundamental invariant of the algorithm."}]},{"block_type":"element","block":"k6pz2hd5","search_text":"Although the mark-and-sweep algorithm is simple, it suspends the execution of the program while it is running, which means that it adds latency to the actual process. Go tries to lower that particular latency by running the garbage collector as a concurrent process and using the tricolor algorithm described in the previous section. However, other processes can move pointers or create new objects while the garbage collector runs concurrently. This fact can make things pretty difficult for the garbage collector. As a result, the principal point that allows the tricolor algorithm to run concurrently is to be able to maintain the fundamental invariant of the mark-and-sweep algorithm-no object of the black set can point to an object of the white set.","text_count":755,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the mark-and-sweep algorithm is simple, it suspends the execution of the program while it is running, which means that it adds"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"latency"}]},{"block_type":"text","content":"to the actual process. Go tries to lower that particular latency by running the garbage collector as a concurrent process and using the tricolor algorithm described in the previous section. However, other processes can move pointers or create new objects while the garbage collector runs concurrently. This fact can make things pretty difficult for the garbage collector. As a result, the principal point that allows the tricolor algorithm to run concurrently is to be able to maintain the fundamental invariant of the mark-and-sweep algorithm-no object of the black set can point to an object of the white set."}]},{"block_type":"element","block":"k6pz2hd6","search_text":"The solution to this problem is to fix all of the cases that can cause a problem for the algorithm! Therefore, new objects must go to the grey set, because this way the fundamental invariant of the mark-and-sweep algorithm cannot be altered. Additionally, when a pointer of the program is moved, you color the object to which the pointer points as grey. You can say that the grey set acts like a barrier between the white set and the black set. Last, each time a pointer is moved, some Go code gets automatically executed, which is the write barrier mentioned earlier that does some recoloring.","text_count":594,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The solution to this problem is to fix all of the cases that can cause a problem for the algorithm! Therefore, new objects must go to the grey set, because this way the fundamental invariant of the mark-and-sweep algorithm cannot be altered. Additionally, when a pointer of the program is moved, you color the object to which the pointer points as grey. You can say that the grey set acts like a barrier between the white set and the black set. Last, each time a pointer is moved, some Go code gets automatically executed, which is the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"write barrier"}]},{"block_type":"text","content":"mentioned earlier that does some recoloring."}]},{"block_type":"element","block":"k6pz2hd7","search_text":"The latency introduced by the execution of the write barrier code is the price you have to pay for being able to run the garbage collector concurrently.","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"latency"}]},{"block_type":"text","content":"introduced by the execution of the write barrier code is the price you have to pay for being able to run the garbage collector concurrently."}]},{"block_type":"element","block":"k6pz2hd8","search_text":"Note that the Java programming language has many garbage collectors that are highly configurable with the help of multiple parameters. One of these Java garbage collectors is called G1, and it is recommended for low-latency applications.","text_count":237,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Java"}]},{"block_type":"text","content":"programming language has many garbage collectors that are highly configurable with the help of multiple parameters. One of these Java garbage collectors is called G1, and it is recommended for low-latency applications."}]},{"block_type":"element","block":"k6pz2hd9","search_text":"Tip It is really important to remember that the Go garbage collector is a real-time garbage collector, which runs concurrently with the other goroutines of a Go program and only optimizes for low latency. ","text_count":205,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is really important to remember that the Go garbage collector is a real-time garbage collector, which runs concurrently with the other"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutines"}]},{"block_type":"text","content":"of a Go program and only optimizes for low latency."}]}]},{"block_type":"element","block":"k6pz2hda","search_text":"In Chapter 11, Code Testing, Optimization and Profiling , you will learn how to represent graphically the performance of a program. This chapter also includes information about the operations of the Go garbage collector.","text_count":220,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization and Profiling"}]},{"block_type":"text","content":",&nbsp;you will learn how to represent graphically the performance of a program. This chapter also includes information about the operations of the Go garbage collector."}]},{"block_type":"element","block":"k6pz2hdb","search_text":"That's enough about garbage collection. The next topic covered will be unsafe code and the unsafe standard Go package.","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"That's enough about garbage collection. The next topic covered will be"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"unsafe code"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2hdc","search_text":"Unsafe code","text_count":11,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Unsafe code"}]},{"block_type":"element","block":"k6pz2hdd","search_text":"Unsafe code is Go code that bypasses the type safety and the memory security of Go. Most of the time, unsafe code is related to pointers. However, keep in mind that using unsafe code can be dangerous for your programs, so if you are not completely sure that you need to use unsafe code in one of your programs, do not use it!","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unsafe code"}]},{"block_type":"text","content":"is Go code that bypasses the type safety and the memory security of Go. Most of the time, unsafe code is related to pointers. However, keep in mind that using unsafe code can be dangerous for your programs, so if you are not completely sure that you need to use unsafe code in one of your programs, do not use it!"}]},{"block_type":"element","block":"k6pz2hde","search_text":"The use of unsafe code will be illustrated in the unsafe.go program, which is presented in three parts.","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The use of unsafe code will be illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":"program, which is presented in three parts."}]},{"block_type":"element","block":"k6pz2hdf","search_text":"The first part of unsafe.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":"&nbsp;is as follows:"}]},{"block_type":"element","block":"k6pz2hdg","search_text":"package main import ( \"fmt\" \"unsafe\" )","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n   \"unsafe\"\n)"}]}]},{"block_type":"element","block":"k6pz2hdh","search_text":"Note that in order to use unsafe code, you will need to import the unsafe standard Go package.","text_count":94,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that in order to use unsafe code, you will need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2hdi","search_text":"The second part of the program occurs with the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program occurs with the following Go code:"}]},{"block_type":"element","block":"k6pz2hdj","search_text":"func main() { var value int64 = 5 var p1 = &value var p2 = (*int32)(unsafe.Pointer(p1))","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   var value int64 = 5\n   var p1 = &amp;value\n   var p2 = (*int32)(unsafe.Pointer(p1))"}]}]},{"block_type":"element","block":"k6pz2hdk","search_text":"Note the use of the unsafe.Pointer() function here which allows you, at your own risk, to create a int32 pointer named p2 that points to a int64 variable named value , which is accessed using the p1 pointer. Any Go pointer can be converted to unsafe.Pointer .","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Pointer()"}]},{"block_type":"text","content":"function here which allows you, at your own risk, to create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int32"}]},{"block_type":"text","content":"pointer named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2"}]},{"block_type":"text","content":"that points to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int64"}]},{"block_type":"text","content":"variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"value"}]},{"block_type":"text","content":", which is accessed using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p1"}]},{"block_type":"text","content":"pointer. Any Go pointer can be converted to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Pointer"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hdl","search_text":"Note A pointer of the unsafe.Pointer type can override the type system of Go. This is unquestionably fast, but it can also be dangerous if used incorrectly or carelessly. Additionally, it gives developers more control over data. ","text_count":229,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A pointer of the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Pointer"}]},{"block_type":"text","content":"&nbsp;type&nbsp;can override the type system of Go. This is unquestionably fast, but it can also be dangerous if used incorrectly or carelessly. Additionally, it gives developers more control over data."}]}]},{"block_type":"element","block":"k6pz2hdm","search_text":"The last part of unsafe.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hdn","search_text":"fmt.Println(\"*p1: \", *p1) fmt.Println(\"*p2: \", *p2) *p1 = 5434123412312431212 fmt.Println(value) fmt.Println(\"*p2: \", *p2) *p1 = 54341234 fmt.Println(value) fmt.Println(\"*p2: \", *p2) }","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"*p1: \", *p1)\n   fmt.Println(\"*p2: \", *p2)\n   *p1 = 5434123412312431212\n   fmt.Println(value)\n   fmt.Println(\"*p2: \", *p2)\n   *p1 = 54341234\n   fmt.Println(value)\n   fmt.Println(\"*p2: \", *p2)\n}"}]}]},{"block_type":"element","block":"k6pz2hdo","search_text":"Tip You can dereference a pointer and get, use, or set its value using the star character ( * ). ","text_count":97,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"dereference a pointer"}]},{"block_type":"text","content":"and get, use, or set its value using the star character ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*"}]},{"block_type":"text","content":")."}]}]},{"block_type":"element","block":"k6pz2hdp","search_text":"If you execute unsafe.go , you will get the following output:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hdq","search_text":"$ go run unsafe.go *p1: 5 *p2: 5 5434123412312431212 *p2: -930866580 54341234 *p2: 54341234 ","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run unsafe.go\n*p1:  5\n*p2:  5\n5434123412312431212\n*p2:  -930866580\n54341234\n*p2:  54341234"}]}]},{"block_type":"element","block":"k6pz2hdr","search_text":"What does this output tell us? It tells us that a 32-bit pointer cannot store a 64-bit integer!","text_count":95,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What does this output tell us? It tells us that a 32-bit pointer cannot store a 64-bit integer!"}]},{"block_type":"element","block":"k6pz2hds","search_text":"As you will see in the next section, the functions of the unsafe package can do many more interesting things with memory.","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see in the next section, the functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package can do many more interesting things with memory."}]},{"block_type":"element","block":"k6pz2hdt","search_text":"About the unsafe package","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About the unsafe package"}]},{"block_type":"element","block":"k6pz2hdu","search_text":"Now that you have seen the unsafe package in action, it's a good time to talk about what makes it a special kind of a package!","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you have seen the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package in action, it's a good time to talk about what makes it a special kind of a package!"}]},{"block_type":"element","block":"k6pz2hdv","search_text":"First of all, if you look at the source code of the unsafe package, you might be a little surprised. On a macOS High Sierra system with Go version 1.9.1 that is installed using Homebrew ( https://brew.sh/ ), the source code of the unsafe package is located at /usr/local/Cellar/go/1.9.1/libexec/src/unsafe/unsafe.go and its contents without the comments are as follows:","text_count":369,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First of all, if you look at the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package, you might be a little surprised. On a macOS High Sierra system with Go version 1.9.1 that is installed using Homebrew ("},{"block_type":"element","tag_name":"a","attributes":{"href":"https://brew.sh/"},"children":[{"block_type":"text","content":"https://brew.sh/"}]},{"block_type":"text","content":"), the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package is located at"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/usr/local/Cellar/go/1.9.1/libexec/src/unsafe/unsafe.go"}]},{"block_type":"text","content":"and its contents without the comments are as follows:"}]},{"block_type":"element","block":"k6pz2hdw","search_text":"$ cd /usr/local/Cellar/go/1.9.1/libexec/src/unsafe/ $ grep -v '^//' unsafe.go | grep -v '^$' package unsafe type ArbitraryType int type Pointer *ArbitraryType func Sizeof(x ArbitraryType) uintptr func Offsetof(x ArbitraryType) uintptr func Alignof(x ArbitraryType) uintptr ","text_count":273,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cd /usr/local/Cellar/go/1.9.1/libexec/src/unsafe/\n$ grep  -v '^//' unsafe.go | grep -v '^$'\npackage unsafe\ntype ArbitraryType int\ntype Pointer *ArbitraryType\nfunc Sizeof(x ArbitraryType) uintptr\nfunc Offsetof(x ArbitraryType) uintptr\nfunc Alignof(x ArbitraryType) uintptr"}]}]},{"block_type":"element","block":"k6pz2hdx","search_text":"OK. Where is the rest of the Go code of the unsafe package? The answer to that question is relatively simple: the Go compiler implements the unsafe package when you import it into your programs.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"OK. Where is the rest of the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package? The answer to that question is relatively simple: the Go compiler implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package when you import it into your programs."}]},{"block_type":"element","block":"k6pz2hdy","search_text":"Note Many low-level packages such as runtime , syscall , and os constantly use the unsafe package. ","text_count":99,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Many low-level packages such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"constantly use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package."}]}]},{"block_type":"element","block":"k6pz2hdz","search_text":"Another example of the unsafe package","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Another example of the unsafe package"}]},{"block_type":"element","block":"k6pz2he0","search_text":"In this subsection, you will learn more about the unsafe package and its capabilities with the help of another small Go program named moreUnsafe.go . This program will be presented in three parts. What moreUnsafe.go does is to access all the elements of an array using pointers.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package and its capabilities with the help of another small Go program named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"moreUnsafe.go"}]},{"block_type":"text","content":". This program will be presented in three parts. What"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"moreUnsafe.go"}]},{"block_type":"text","content":"does is to access all the elements of an array using pointers."}]},{"block_type":"element","block":"k6pz2he1","search_text":"The first part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2he2","search_text":"package main import ( \"fmt\" \"unsafe\" )","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n   \"unsafe\"\n)"}]}]},{"block_type":"element","block":"k6pz2he3","search_text":"The second part of moreUnsafe.go comes with the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"moreUnsafe.go"}]},{"block_type":"text","content":"comes with the following Go code:"}]},{"block_type":"element","block":"k6pz2he4","search_text":"func main() { array := [...]int{0, 1, -2, 3, 4} pointer := &array[0] fmt.Print(*pointer, \" \") memoryAddress := uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0]) for i := 0; i < len(array)-1; i++ { pointer = (*int)(unsafe.Pointer(memoryAddress)) fmt.Print(*pointer, \" \") memoryAddress = uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0]) }","text_count":355,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   array := [...]int{0, 1, -2, 3, 4}\n   pointer := &amp;array[0]\n   fmt.Print(*pointer, \" \")\n   memoryAddress := uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0])\n\n   for i := 0; i &lt; len(array)-1; i++ {\n         pointer = (*int)(unsafe.Pointer(memoryAddress))\n         fmt.Print(*pointer, \" \")\n         memoryAddress = uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0])\n   }"}]}]},{"block_type":"element","block":"k6pz2he5","search_text":"At first, the pointer variable points to the memory address of array[0] , which is the first element of the array of integers. Next, the pointer variable that points to an integer value is converted to an unsafe.Pointer() function and then to uintptr . The result is stored in memoryAddress .","text_count":292,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At first, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointer"}]},{"block_type":"text","content":"variable points to the memory address of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"array[0]"}]},{"block_type":"text","content":", which is the first element of the array of integers. Next, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointer"}]},{"block_type":"text","content":"variable that points to an integer value is converted to an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Pointer()"}]},{"block_type":"text","content":"&nbsp;function and then to&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"uintptr"}]},{"block_type":"text","content":". The result is stored in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"memoryAddress"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2he6","search_text":"The value of unsafe.Sizeof(array[0]) is what gets you to the next element of the array, because this is the memory occupied by each array element. This value is added to the memoryAddress variable in each iteration of the for loop, which allows you to get the memory address of the next array element. The *pointer notation dereferences the pointer and returns the stored integer value.","text_count":386,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Sizeof(array[0])"}]},{"block_type":"text","content":"is what gets you to the next element of the array, because this is the memory occupied by each array element. This value is added to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"memoryAddress"}]},{"block_type":"text","content":"variable in each iteration of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, which allows you to get the memory address of the next array element. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*pointer"}]},{"block_type":"text","content":"notation dereferences the pointer and returns the stored integer value."}]},{"block_type":"element","block":"k6pz2he7","search_text":"The third part is as follows:","text_count":29,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part is as follows:"}]},{"block_type":"element","block":"k6pz2he8","search_text":"fmt.Println() pointer = (*int)(unsafe.Pointer(memoryAddress)) fmt.Print(\"One more: \", *pointer, \" \") memoryAddress = uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0]) fmt.Println() }","text_count":191,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println()\n   pointer = (*int)(unsafe.Pointer(memoryAddress))\n   fmt.Print(\"One more: \", *pointer, \" \")\n   memoryAddress = uintptr(unsafe.Pointer(pointer)) + unsafe.Sizeof(array[0])\n   fmt.Println()\n}"}]}]},{"block_type":"element","block":"k6pz2he9","search_text":"In the last part, you are trying to access an element of the array that does not exist using pointers and memory addresses. The Go compiler cannot catch such a logical error due to the use of the unsafe package and therefore will return something inaccurate.","text_count":258,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the last part, you are trying to access an element of the array that does not exist using pointers and memory addresses. The Go compiler cannot catch such a logical error due to the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package and therefore will return something inaccurate."}]},{"block_type":"element","block":"k6pz2hea","search_text":"Executing moreUnsafe.go will create the following output:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"moreUnsafe.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2heb","search_text":"$ go run moreUnsafe.go 0 1 -2 3 4 One more: 842350722816","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run moreUnsafe.go\n0 1 -2 3 4\nOne more: 842350722816"}]}]},{"block_type":"element","block":"k6pz2hec","search_text":"You have now accessed all of the elements of a Go array using pointers! However, the real problem here is that when you tried to access an invalid array element, the program did not complain and returned a random number instead.","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You have now accessed all of the elements of a Go array using pointers! However, the real problem here is that when you tried to access an invalid array element, the program did not complain and returned a random number instead."}]},{"block_type":"element","block":"k6pz2hed","search_text":"Calling C code from Go","text_count":22,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Calling C code from Go"}]},{"block_type":"element","block":"k6pz2hee","search_text":"Although the intention of Go is to make your programming experience better and save you from having to deal with the quirks of C, C remains a very capable programming language that is still useful. This means that there are situations, such as using a database or a device driver written in C, which still require the use of C. This means that you will need to work with C code in your Go projects.","text_count":398,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the intention of Go is to make your programming experience better and save you from having to deal with the quirks of C, C remains a very capable programming language that is still useful. This means that there are situations, such as using a database or a device driver written in C, which still require the use of C. This means that you will need to work with C code in your Go projects."}]},{"block_type":"element","block":"k6pz2hef","search_text":"Note If you find yourselves using this capability several times in the same project, you might need to reconsider your approach or your choice of programming language! ","text_count":168,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you find yourselves using this capability several times in the same project, you might need to reconsider your approach or your choice of programming language!"}]}]},{"block_type":"element","block":"k6pz2heg","search_text":"Calling C code from Go using the same file","text_count":42,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Calling C code from Go using the same file"}]},{"block_type":"element","block":"k6pz2heh","search_text":"The simplest way to call C code from a Go program is to include the C code in your Go source file. This requires a special treatment, but it is pretty fast and not that difficult to do.","text_count":185,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The simplest way to call C code from a Go program is to include the C code in your Go source file. This requires a special treatment, but it is pretty fast and not that difficult to do."}]},{"block_type":"element","block":"k6pz2hei","search_text":"The name of the Go source file that contains both C and Go code will be cGo.go , and it will be presented in three parts.","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go source file that contains both C and Go code will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cGo.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2hej","search_text":"The first part of the Go source file is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the Go source file is as follows:"}]},{"block_type":"element","block":"k6pz2hek","search_text":"package main //#include <stdio.h> //void callC() { // printf(\"Calling C code!\\n\"); //} import \"C\"","text_count":97,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\n//#include &lt;stdio.h&gt;\n//void callC() {\n//    printf(\"Calling C code!\\n\");\n//}\nimport \"C\""}]}]},{"block_type":"element","block":"k6pz2hel","search_text":"Note As you can see, the C code is included in the comments of the Go program. However, the go tool knows what to do with these kinds of comments because of the use of the C Go package. ","text_count":186,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the C code is included in the comments of the Go program. However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"tool knows what to do with these kinds of comments because of the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"Go package."}]}]},{"block_type":"element","block":"k6pz2hem","search_text":"The second part of the program contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hen","search_text":"import \"fmt\" func main() {","text_count":26,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"import \"fmt\"\n\nfunc main() {"}]}]},{"block_type":"element","block":"k6pz2heo","search_text":"All of the other packages should be imported separately.","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of the other packages should be imported separately."}]},{"block_type":"element","block":"k6pz2hep","search_text":"The last part of cGo.go contains the following code:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cGo.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2heq","search_text":"fmt.Println(\"A Go statement!\") C.callC() fmt.Println(\"Another Go statement!\") }","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"A Go statement!\")\n    C.callC()\n    fmt.Println(\"Another Go statement!\")\n}"}]}]},{"block_type":"element","block":"k6pz2her","search_text":"Thus, in order to execute the callC() C function, you will need to call it as C.callC() .","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, in order to execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC()"}]},{"block_type":"text","content":"C function, you will need to call it as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C.callC()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hes","search_text":"Executing cGo.go will create the following output:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cGo.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2het","search_text":"$ go run cGo.go A Go statement! Calling C code! Another Go statement! ","text_count":70,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cGo.go\nA Go statement!\nCalling C code!\nAnother Go statement!"}]}]},{"block_type":"element","block":"k6pz2heu","search_text":"Calling C code from Go using separate files","text_count":43,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Calling C code from Go using separate files"}]},{"block_type":"element","block":"k6pz2hev","search_text":"Now let's continue learning how to call C code from a Go program when the C code is located in a separate file.","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's continue learning how to call C code from a Go program when the C code is located in a separate file."}]},{"block_type":"element","block":"k6pz2hew","search_text":"First, let me explain the imaginary problem that we will solve with our program. We will need to use two C functions that we have implemented in the past and that we do not want or cannot rewrite in Go.","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, let me explain the imaginary problem that we will solve with our program. We will need to use two C functions that we have implemented in the past and that we do not want or cannot rewrite in Go."}]},{"block_type":"element","block":"k6pz2hex","search_text":"The C code","text_count":10,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The C code"}]},{"block_type":"element","block":"k6pz2hey","search_text":"This subsection will present the C code for the example which comes in two files: callC.h and callC.c . The include file ( callC.h ) contains the following code:","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will present the C code for the example which comes in two files:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.h"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.c"}]},{"block_type":"text","content":". The include file ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.h"}]},{"block_type":"text","content":") contains the following code:"}]},{"block_type":"element","block":"k6pz2hez","search_text":"#ifndef CALLC_H #define CALLC_H void cHello(); void printMessage(char* message); #endif","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"#ifndef CALLC_H\n#define CALLC_H\n\nvoid cHello();\nvoid printMessage(char* message);\n\n#endif"}]}]},{"block_type":"element","block":"k6pz2hf0","search_text":"The C source file ( callC.c ) contains the following C code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The C source file ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.c"}]},{"block_type":"text","content":") contains the following C code:"}]},{"block_type":"element","block":"k6pz2hf1","search_text":"#include <stdio.h> #include \"callC.h\" void cHello() { printf(\"Hello from C!\\n\"); } void printMessage(char* message) { printf(\"Go send me %s\\n\", message); }","text_count":155,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"#include &lt;stdio.h&gt;\n#include \"callC.h\"\n\nvoid cHello() {\n    printf(\"Hello from C!\\n\");\n}\n\nvoid printMessage(char* message) {\n    printf(\"Go send me %s\\n\", message);\n}"}]}]},{"block_type":"element","block":"k6pz2hf2","search_text":"Both the callC.c and callC.h files are stored in a separate directory, which in this case is callClib . You can use any directory name you want, however.","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.c"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.h"}]},{"block_type":"text","content":"files are stored in a separate directory, which in this case is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callClib"}]},{"block_type":"text","content":". You can use any directory name you want, however."}]},{"block_type":"element","block":"k6pz2hf3","search_text":"Tip The actual C code is not important as long as you call the right C functions with the correct type and number of parameters. There is nothing in the C code that tells you that it will be used from a Go program. You should look at the Go code for the juicy part. ","text_count":266,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The actual C code is not important as long as you call the right C functions with the correct type and number of parameters. There is nothing in the C code that tells you that it will be used from a Go program. You should look at the Go code for the juicy part."}]}]},{"block_type":"element","block":"k6pz2hf4","search_text":"The Go code","text_count":11,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The Go code"}]},{"block_type":"element","block":"k6pz2hf5","search_text":"This subsection will address the Go source code of the example, which will be called callC.go and will be presented in three parts.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will address the Go source code of the example, which will be called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"and will be presented in three parts."}]},{"block_type":"element","block":"k6pz2hf6","search_text":"The first part of callC.go includes the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"includes the following Go code:"}]},{"block_type":"element","block":"k6pz2hf7","search_text":"package main // #cgo CFLAGS: -I${SRCDIR}/callClib // #cgo LDFLAGS: ${SRCDIR}/callC.a // #include <stdlib.h> // #include <callC.h> import \"C\"","text_count":140,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\n// #cgo CFLAGS: -I${SRCDIR}/callClib\n// #cgo LDFLAGS: ${SRCDIR}/callC.a\n// #include &lt;stdlib.h&gt;\n// #include &lt;callC.h&gt;\nimport \"C\""}]}]},{"block_type":"element","block":"k6pz2hf8","search_text":"The single most important Go statement of the entire Go source file is the inclusion of the C package using a separate import statement. However, C is a virtual Go package that just tells go build to preprocess its input file using the cgo tool before the Go compiler processes the file! You can still see that you need to use comments to inform the Go program about the C code. In this case, you tell callC.go where to find the callC.h file as well as where to find the callC.a library file that we will create in a little while—such lines begin with #cgo .","text_count":558,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The single most important Go statement of the entire Go source file is the inclusion of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"package using a separate"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"statement. However,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"is a virtual Go package that just tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"to preprocess its input file using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cgo"}]},{"block_type":"text","content":"tool before the Go compiler processes the file! You can still see that you need to use comments to inform the Go program about the C code. In this case, you tell"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"where to find the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.h"}]},{"block_type":"text","content":"file as well as where to find the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.a"}]},{"block_type":"text","content":"library file that we will create in a little while&mdash;such lines begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"#cgo"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hf9","search_text":"The second part of the program is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hfa","search_text":"import ( \"fmt\" \"unsafe\" ) func main() { fmt.Println(\"Going to call a C function!\") C.cHello()","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"import (\n   \"fmt\"\n   \"unsafe\"\n)\n \nfunc main() {\n   fmt.Println(\"Going to call a C function!\")\n   C.cHello()"}]}]},{"block_type":"element","block":"k6pz2hfb","search_text":"The last part of callC.go follows:","text_count":34,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2hfc","search_text":"fmt.Println(\"Going to call another C function!\") myMessage := C.CString(\"This is Mihalis!\") defer C.free(unsafe.Pointer(myMessage)) C.printMessage(myMessage) fmt.Println(\"All perfectly done!\") }","text_count":194,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Going to call another C function!\")\n   myMessage := C.CString(\"This is Mihalis!\")\n   defer C.free(unsafe.Pointer(myMessage))\n   C.printMessage(myMessage)\n \n   fmt.Println(\"All perfectly done!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hfd","search_text":"In order to pass a string to a C function from Go, you will need to create a C string using C.CString() . Additionally, you will need a defer statement in order to free the memory space of the C string when it is no longer needed. The defer statement includes a call to C.free() and another one to unsafe.Pointer() .","text_count":316,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to pass a string to a C function from Go, you will need to create a C string using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C.CString()"}]},{"block_type":"text","content":". Additionally, you will need a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"statement in order to free the memory space of the C string when it is no longer needed. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"statement includes a call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C.free()"}]},{"block_type":"text","content":"and another one to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe.Pointer()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hfe","search_text":"In the next section, you will see how to compile and execute callC.go .","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next section, you will see how to compile and execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hff","search_text":"Mixing Go and C code","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Mixing Go and C code"}]},{"block_type":"element","block":"k6pz2hfg","search_text":"Now that you have the C and the Go code, it is time to learn what to do next in order to execute the Go file that calls the C code.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you have the C and the Go code, it is time to learn what to do next in order to execute the Go file that calls the C code."}]},{"block_type":"element","block":"k6pz2hfh","search_text":"The good news is that you do not need to do anything particularly difficult because all of the critical information is contained in the Go file. The only critical thing that you will need to do is to compile the C code in order to create a library, which requires the execution of the following commands:","text_count":304,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good news is that you do not need to do anything particularly difficult because all of the critical information is contained in the Go file. The only critical thing that you will need to do is to compile the C code in order to create a library, which requires the execution of the following commands:"}]},{"block_type":"element","block":"k6pz2hfi","search_text":"$ ls -l callClib/ total 16 -rw-r--r--@ 1 mtsouk staff 162 Oct 31 18:14 callC.c -rw-r--r--@ 1 mtsouk staff 89 Oct 31 18:14 callC.h $ gcc -c callClib/*.c $ ls -l callC.o -rw-r--r-- 1 mtsouk staff 944 Oct 31 18:14 callC.o $ file callC.o callC.o: Mach-O 64-bit object x86_64 $ ar rs callC.a *.o ar: creating archive callC.a $ ls -l callC.a -rw-r--r-- 1 mtsouk staff 1152 Oct 31 18:15 callC.a $ file callC.a callC.a: current ar archive random library $ rm callC.o","text_count":458,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l callClib/\ntotal 16\n-rw-r--r--@ 1 mtsouk  staff  162 Oct 31 18:14 callC.c\n-rw-r--r--@ 1 mtsouk  staff   89 Oct 31 18:14 callC.h\n$ gcc -c callClib/*.c\n$ ls -l callC.o\n-rw-r--r--  1 mtsouk  staff  944 Oct 31 18:14 callC.o\n$ file callC.o\ncallC.o: Mach-O 64-bit object x86_64\n$ ar rs callC.a *.o\nar: creating archive callC.a\n$ ls -l callC.a\n-rw-r--r--  1 mtsouk  staff  1152 Oct 31 18:15 callC.a\n$ file callC.a\ncallC.a: current ar archive random library\n$ rm callC.o"}]}]},{"block_type":"element","block":"k6pz2hfj","search_text":"After that, you will have a file named callC.a located in the same directory as the callC.go file. The gcc executable is the name of the C compiler .","text_count":149,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you will have a file named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.a"}]},{"block_type":"text","content":"located in the same directory as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC.go"}]},{"block_type":"text","content":"file. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gcc"}]},{"block_type":"text","content":"executable is the name of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C compiler"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hfk","search_text":"Now you are ready to compile the file with the Go code and create a new executable file:","text_count":88,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now you are ready to compile the file with the Go code and create a new executable file:"}]},{"block_type":"element","block":"k6pz2hfl","search_text":"$ go build callC.go $ ls -l callC -rwxr-xr-x 1 mtsouk staff 2322000 Oct 31 18:16 callC $ file callC callC: Mach-O 64-bit executable x86_64","text_count":138,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build callC.go\n$ ls -l callC\n-rwxr-xr-x  1 mtsouk  staff  2322000 Oct 31 18:16 callC\n$ file callC\ncallC: Mach-O 64-bit executable x86_64"}]}]},{"block_type":"element","block":"k6pz2hfm","search_text":"Executing the callC executable file will create the following output:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"callC"}]},{"block_type":"text","content":"executable file will create the following output:"}]},{"block_type":"element","block":"k6pz2hfn","search_text":"$ ./callC Going to call a C function! Hello from C! Going to call another C function! Go send me This is Mihalis! All perfectly done!","text_count":133,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ./callC\nGoing to call a C function!\nHello from C!\nGoing to call another C function!\nGo send me This is Mihalis!\nAll perfectly done!"}]}]},{"block_type":"element","block":"k6pz2hfo","search_text":"Tip If you will call a small amount of C code, then using a single Go file for both the C and Go code is highly recommended because of its simplicity. However, if you will do something more complex and advanced, creating a static C library should be your preferred method. ","text_count":273,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you will call a small amount of C code, then using a single Go file for both the C and Go code is highly recommended because of its simplicity. However, if you will do something more complex and advanced, creating a static C library should be your preferred method."}]}]},{"block_type":"element","block":"k6pz2hfp","search_text":"Calling Go functions from C code","text_count":32,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Calling Go functions from C code"}]},{"block_type":"element","block":"k6pz2hfq","search_text":"It is also possible to call a Go function from your C code. Therefore, this section will present a small example where two Go functions will be called from a C program. The Go package will be converted into a C shared library that will be used in the C program.","text_count":261,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is also possible to call a Go function from your C code. Therefore, this section will present a small example where two Go functions will be called from a C program. The Go package will be converted into a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C shared library"}]},{"block_type":"text","content":"that will be used in the C program."}]},{"block_type":"element","block":"k6pz2hfr","search_text":"The Go package","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The Go package"}]},{"block_type":"element","block":"k6pz2hfs","search_text":"This subsection will present you with the code of the Go package that will be used in a C program. The name of the Go package needs to be main , but its filename can be anything you want. In this case, the filename will be usedByC.go , and it will be presented in three parts.","text_count":276,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will present you with the code of the Go package that will be used in a C program. The name of the Go package needs to be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":", but its filename can be anything you want. In this case, the filename will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2hft","search_text":"Note You will learn more about Go packages in Chapter 6, What You Might Not Know About Go Packages . ","text_count":101,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about Go packages in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hfu","search_text":"The first part of the code of the Go package is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the code of the Go package is as follows:"}]},{"block_type":"element","block":"k6pz2hfv","search_text":"package main import \"C\" import ( \"fmt\" )","text_count":40,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport \"C\"\n\nimport (\n   \"fmt\"\n)"}]}]},{"block_type":"element","block":"k6pz2hfw","search_text":"As I mentioned before, it is mandatory that you name the Go package as main . You will also need to import the C package in your Go code.","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As I mentioned before, it is mandatory that you name the Go package as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":". You will also need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"package in your Go code."}]},{"block_type":"element","block":"k6pz2hfx","search_text":"The second part of the program contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hfy","search_text":"//export PrintMessage func PrintMessage() { fmt.Println(\"A Go function!\") }","text_count":75,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"//export PrintMessage\nfunc PrintMessage() {\n   fmt.Println(\"A Go function!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hfz","search_text":"Each Go function that will be called by the C code needs to be exported first. This means that you should put a comment line starting with //export before its implementation. After //export , you will need to put the name of the function because this is what the C code will use.","text_count":279,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each Go function that will be called by the C code needs to be exported first. This means that you should put a comment line starting with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"//export"}]},{"block_type":"text","content":"before its implementation. After"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"//export"}]},{"block_type":"text","content":", you will need to put the name of the function because this is what the C code will use."}]},{"block_type":"element","block":"k6pz2hg0","search_text":"The last part of usedByC.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.go"}]},{"block_type":"text","content":"&nbsp;is as follows:"}]},{"block_type":"element","block":"k6pz2hg1","search_text":"//export Multiply func Multiply(a, b int) int { return a * b } func main() { }","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"//export Multiply\nfunc Multiply(a, b int) int {\n   return a * b\n}\n\nfunc main() {\n}"}]}]},{"block_type":"element","block":"k6pz2hg2","search_text":"The main() function of usedByC.go needs no code because it will not be exported and therefore used by the C program. Additionally, as you also want to export the Multiply() function, you will need to put //export Multiply before its implementation.","text_count":248,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.go"}]},{"block_type":"text","content":"needs no code because it will not be exported and therefore used by the C program. Additionally, as you also want to export the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Multiply()"}]},{"block_type":"text","content":"function, you will need to put"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"//export Multiply"}]},{"block_type":"text","content":"before its implementation."}]},{"block_type":"element","block":"k6pz2hg3","search_text":"After this, you will need to generate a C shared library from the Go code by executing the following command:","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After this, you will need to generate a C shared library from the Go code by executing the following command:"}]},{"block_type":"element","block":"k6pz2hg4","search_text":"$ go build -o usedByC.o -buildmode=c-shared usedByC.go","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build -o usedByC.o -buildmode=c-shared usedByC.go"}]}]},{"block_type":"element","block":"k6pz2hg5","search_text":"The preceding command will generate two files named usedByC.h and usedByC.o :","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding command will generate two files named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.h"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.o"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2hg6","search_text":"$ ls -l usedByC.* -rw-r--r--@ 1 mtsouk staff 204 Oct 31 20:37 usedByC.go -rw-r--r-- 1 mtsouk staff 1365 Oct 31 20:40 usedByC.h -rw-r--r-- 1 mtsouk staff 2329472 Oct 31 20:40 usedByC.o $ file usedByC.o usedByC.o: Mach-O 64-bit dynamically linked shared library x86_64","text_count":266,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l usedByC.*\n-rw-r--r--@ 1 mtsouk  staff      204 Oct 31 20:37 usedByC.go\n-rw-r--r--  1 mtsouk  staff     1365 Oct 31 20:40 usedByC.h\n-rw-r--r--  1 mtsouk  staff  2329472 Oct 31 20:40 usedByC.o\n$ file usedByC.o\nusedByC.o: Mach-O 64-bit dynamically linked shared library x86_64"}]}]},{"block_type":"element","block":"k6pz2hg7","search_text":"You should not make any changes to usedByC.h .","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should not make any changes to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.h"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hg8","search_text":"The C code","text_count":10,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The C code"}]},{"block_type":"element","block":"k6pz2hg9","search_text":"The relevant C code can be found in the willUseGo.c source file, which will be presented in two parts. The first part of willUseGo.c is as follows:","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The relevant C code can be found in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"willUseGo.c"}]},{"block_type":"text","content":"source file, which will be presented in two parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"willUseGo.c"}]},{"block_type":"text","content":"&nbsp;is as follows:"}]},{"block_type":"element","block":"k6pz2hga","search_text":"#include <stdio.h> #include \"usedByC.h\" int main(int argc, char **argv) { GoInt x = 12; GoInt y = 23; printf(\"About to call a Go function!\\n\"); PrintMessage();","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"#include &lt;stdio.h&gt;\n#include \"usedByC.h\"\n\nint main(int argc, char **argv) {\n   GoInt x = 12;\n   GoInt y = 23;\n\n   printf(\"About to call a Go function!\\n\");\n   PrintMessage();"}]}]},{"block_type":"element","block":"k6pz2hgb","search_text":"If you already know C, you should understand why you need to include usedByC.h . This is the way that the C code knows about the available functions of a library.","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you already know C, you should understand why you need to include"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usedByC.h"}]},{"block_type":"text","content":". This is the way that the C code knows about the available functions of a library."}]},{"block_type":"element","block":"k6pz2hgc","search_text":"The second part of the C program follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the C program follows next:"}]},{"block_type":"element","block":"k6pz2hgd","search_text":"GoInt p = Multiply(x,y); printf(\"Product: %d\\n\",(int)p); printf(\"It worked!\\n\"); return 0; }","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"GoInt p = Multiply(x,y);\n   printf(\"Product: %d\\n\",(int)p);\n   printf(\"It worked!\\n\");\n   return 0;\n}"}]}]},{"block_type":"element","block":"k6pz2hge","search_text":"The GoInt p variable is needed for getting an integer value from a Go function, which is converted to a C integer using the (int) p notation.","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GoInt p"}]},{"block_type":"text","content":"variable is needed for getting an integer value from a Go function, which is converted to a C integer using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"(int) p"}]},{"block_type":"text","content":"notation."}]},{"block_type":"element","block":"k6pz2hgf","search_text":"Compiling and executing willUseGo.c on a macOS High Sierra machine will create the following output:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Compiling and executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"willUseGo.c"}]},{"block_type":"text","content":"on a macOS High Sierra machine will create the following output:"}]},{"block_type":"element","block":"k6pz2hgg","search_text":"$ gcc -o willUseGo willUseGo.c ./usedByC.o $ ./willUseGo About to call a Go function! A Go function! Product: 276 It worked!","text_count":124,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ gcc -o willUseGo willUseGo.c ./usedByC.o\n$ ./willUseGo\nAbout to call a Go function!\nA Go function!\nProduct: 276\nIt worked!"}]}]},{"block_type":"element","block":"k6pz2hgh","search_text":"The defer keyword","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The defer keyword"}]},{"block_type":"element","block":"k6pz2hgi","search_text":"The defer keyword postpones the execution of a function until the surrounding function returns. It is widely used in file input and output operations because it saves you from having to remember when to close an opened file: the defer keyword allows you to put the function call that closes an opened file near to the function call that opened it. As you will learn about the use of defer in file-related operations in Chapter 8, Telling a Unix System What to Do , this section will present a different usage of defer . You will also see defer in action in the section that talks about the panic() and recover() built-in Go functions.","text_count":634,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword postpones the execution of a function until the surrounding function returns. It is widely used in file input and output operations because it saves you from having to remember when to close an opened file: the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword allows you to put the function call that closes an opened file near to the function call that opened it. As you will learn about the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"in file-related operations in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":", this section will present a different usage of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":". You will also see"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"in action in the section that talks about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"built-in Go functions."}]},{"block_type":"element","block":"k6pz2hgj","search_text":"It is very important to remember that deferred functions are executed in Last In First Out ( LIFO ) order after the return of the surrounding function. Put simply, this means that if you defer function f1() first, function f2() second, and function f3() third in the same surrounding function, when the surrounding function is about to return, function f3() will be executed first, function f2() will be executed second, and function f1() will be the last one to get executed.","text_count":476,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is very important to remember that"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"deferred functions"}]},{"block_type":"text","content":"are executed in"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Last In First Out"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"LIFO"}]},{"block_type":"text","content":") order after the return of the surrounding function. Put simply, this means that if you"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"first, function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"second, and function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f3()"}]},{"block_type":"text","content":"third in the same surrounding function, when the surrounding function is about to return, function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f3()"}]},{"block_type":"text","content":"will be executed first, function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"will be executed second, and function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"will be the last one to get executed."}]},{"block_type":"element","block":"k6pz2hgk","search_text":"As this definition of defer is a little unclear, I think that you will understand the use of defer a little better by looking at the Go code and the output of the defer.go program, which will be presented in three parts.","text_count":220,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As this definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"is a little unclear, I think that you will understand the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"a little better by looking at the Go code and the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer.go"}]},{"block_type":"text","content":"program, which will be presented in three parts."}]},{"block_type":"element","block":"k6pz2hgl","search_text":"The first part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hgm","search_text":"package main import ( \"fmt\" ) func d1() { for i := 3; i > 0; i-- { defer fmt.Print(i, \" \") } }","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n)\n\nfunc d1() {\n   for i := 3; i &gt; 0; i-- {\n         defer fmt.Print(i, \" \")\n   }\n}"}]}]},{"block_type":"element","block":"k6pz2hgn","search_text":"Apart from the import block, the preceding Go code implements a function named d1() with a for loop and a defer statement that will be executed three times.","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"block, the preceding Go code implements a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":"with a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"statement that will be executed three times."}]},{"block_type":"element","block":"k6pz2hgo","search_text":"The second part of defer.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hgp","search_text":"func d2() { for i := 3; i > 0; i-- { defer func() { fmt.Print(i, \" \") }() } fmt.Println() }","text_count":91,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func d2() {\n   for i := 3; i &gt; 0; i-- {\n         defer func() {\n               fmt.Print(i, \" \")\n         }()\n   }\n   fmt.Println()\n}"}]}]},{"block_type":"element","block":"k6pz2hgq","search_text":"In this part of the code, you can see the implementation of another function that is named d2() . The d2() function also contains a for loop and a defer statement that will be also executed three times. However, this time the defer keyword is applied to an anonymous function instead of a single fmt.Print() statement. Additionally, the anonymous function takes no parameters.","text_count":376,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the code, you can see the implementation of another function that is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d2()"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d2()"}]},{"block_type":"text","content":"function also contains a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"statement that will be also executed three times. However, this time the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword is applied to an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"anonymous function"}]},{"block_type":"text","content":"instead of a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"statement. Additionally, the anonymous function takes no parameters."}]},{"block_type":"element","block":"k6pz2hgr","search_text":"The last part of the Go code is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the Go code is as follows:"}]},{"block_type":"element","block":"k6pz2hgs","search_text":"func d3() { for i := 3; i > 0; i-- { defer func(n int) { fmt.Print(n, \" \") }(i) } } func main() { d1() d2() fmt.Println() d3() fmt.Println() }","text_count":142,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func d3() {\n   for i := 3; i &gt; 0; i-- {\n         defer func(n int) {\n               fmt.Print(n, \" \")\n         }(i)\n   }\n}\n\nfunc main() {\n   d1()\n   d2()\n   fmt.Println()\n   d3()\n   fmt.Println()\n}"}]}]},{"block_type":"element","block":"k6pz2hgt","search_text":"Apart from the main() function that calls the d1() , d2() , and d3() functions, you can also see the implementation of the d3() function, which has a for loop that uses the defer keyword on an anonymous function. However, this time the anonymous function requires one integer parameter named n . The Go code tells us that the n parameter takes its value from the i variable used in the for loop.","text_count":395,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function that calls the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d2()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d3()"}]},{"block_type":"text","content":"functions, you can also see the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d3()"}]},{"block_type":"text","content":"function, which has a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword on an anonymous function. However, this time the anonymous function requires one integer parameter named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":". The Go code tells us that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"parameter takes its value from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"variable used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2hgu","search_text":"Executing defer.go will create the following output:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hgv","search_text":"$ go run defer.go 1 2 3 0 0 0 1 2 3","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run defer.go\n1 2 3\n0 0 0\n1 2 3"}]}]},{"block_type":"element","block":"k6pz2hgw","search_text":"You will most likely find the generated output complicated and challenging to understand. This underscores the fact that the operation and the results of the use of defer can be tricky if your code is not clear and unambiguous.","text_count":227,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will most likely find the generated output complicated and challenging to understand. This underscores the fact that the operation and the results of the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"can be tricky if your code is not clear and unambiguous."}]},{"block_type":"element","block":"k6pz2hgx","search_text":"Let's examine the results in order to get a better idea of how tricky defer can be if you do not pay close attention to your code. We will start with the first line of the output ( 1 2 3 ), which is generated by the d1() function. The values of i in d1() are 3 , 2 , and 1 in that order. The function that is deferred in d1() is the fmt.Print() statement. As a result, when the d1() function is about to return, you get the three values of the i variable of the for loop in reverse order because deferred functions are executed in LIFO order.","text_count":542,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Let's examine the results in order to get a better idea of how tricky"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"can be if you do not pay close attention to your code. We will start with the first line of the output ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1 2 3"}]},{"block_type":"text","content":"), which is generated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":"function. The values of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":"are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"3"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":"in that order. The function that is deferred in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":"is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"statement. As a result, when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d1()"}]},{"block_type":"text","content":"function is about to return, you get the three values of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"variable of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop in reverse order because deferred functions are executed in LIFO order."}]},{"block_type":"element","block":"k6pz2hgy","search_text":"Now, let's inspect the second line of the output that is produced by the d2() function. It is really strange that we got three zeros instead of 1 2 3 in the output. The reason for this, however, is relatively simple. After the for loop has ended, the value of i is 0 , because it is that value of i that made the for loop terminate. However, the tricky part here is that the deferred anonymous function is evaluated after the for loop ends, because it has no parameters. This means that is evaluated three times for an i value of 0 , hence the generated output! This kind of confusing code is what might lead to the creation of nasty bugs in your projects, so try to avoid it!","text_count":676,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now, let's inspect the second line of the output that is produced by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d2()"}]},{"block_type":"text","content":"function. It is really strange that we got three zeros instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1 2 3"}]},{"block_type":"text","content":"in the output. The reason for this, however, is relatively simple. After the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop has ended, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":", because it is that value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"that made the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop terminate. However, the tricky part here is that the deferred anonymous function is evaluated after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop ends, because it has no parameters. This means that is evaluated three times for an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":", hence the generated output! This kind of confusing code is what might lead to the creation of nasty bugs in your projects, so try to avoid it!"}]},{"block_type":"element","block":"k6pz2hgz","search_text":"Also, we will talk about the third line of the output, which is generated by the d3() function. Due to the parameter of the anonymous function, each time the anonymous function is deferred, it gets and uses the current value of i . As a result, each execution of the anonymous function has a different value to process, thus the generated output.","text_count":346,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Also, we will talk about the third line of the output, which is generated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d3()"}]},{"block_type":"text","content":"function. Due to the parameter of the anonymous function, each time the anonymous function is deferred, it gets and uses the current value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":". As a result, each execution of the anonymous function has a different value to process, thus the generated output."}]},{"block_type":"element","block":"k6pz2hh0","search_text":"After this, it should be clear that the best approach to the use of defer is the third one, which is exhibited in the d3() function. This is so because you intentionally pass the desired variable in the anonymous function in an easy to understand way.","text_count":251,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After this, it should be clear that the best approach to the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"is the third one, which is exhibited in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"d3()"}]},{"block_type":"text","content":"function. This is so because you intentionally pass the desired variable in the anonymous function in an easy to understand way."}]},{"block_type":"element","block":"k6pz2hh1","search_text":"Panic and Recover","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Panic and Recover"}]},{"block_type":"element","block":"k6pz2hh2","search_text":"This section will present you with a tricky technique that was first mentioned in Chapter 1, Go and the Operating System . This technique involves the use of the panic() and recover() functions, and it will be presented in panicRecover.go , which you will review in three parts.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present you with a tricky technique that was first mentioned in Chapter 1,&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go and the Operating System"}]},{"block_type":"text","content":". This technique involves the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions, and it will be presented in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panicRecover.go"}]},{"block_type":"text","content":", which you will review in three parts."}]},{"block_type":"element","block":"k6pz2hh3","search_text":"Strictly speaking, panic() is a built-in Go function that terminates the current flow of a Go program and starts panicking! On the other hand, the recover() function, which is also a built-in Go function, allows you to take back the control of a goroutine that just panicked using panic() .","text_count":290,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"is a built-in Go function that terminates the current flow of a Go program and starts panicking! On the other hand, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"function, which is also a built-in Go function, allows you to take back the control of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutine"}]},{"block_type":"text","content":"that just panicked using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hh4","search_text":"The first part of the program follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program follows:"}]},{"block_type":"element","block":"k6pz2hh5","search_text":"package main import ( \"fmt\" ) func a() { fmt.Println(\"Inside a()\") defer func() { if c := recover(); c != nil { fmt.Println(\"Recover inside a()!\") } }() fmt.Println(\"About to call b()\") b() fmt.Println(\"b() exited!\") fmt.Println(\"Exiting a()\") }","text_count":245,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n)\n\nfunc a() {\n   fmt.Println(\"Inside a()\")\n   defer func() {\n         if c := recover(); c != nil {\n               fmt.Println(\"Recover inside a()!\")\n         }\n   }()\n   fmt.Println(\"About to call b()\")\n   b()\n   fmt.Println(\"b() exited!\")\n   fmt.Println(\"Exiting a()\")\n}"}]}]},{"block_type":"element","block":"k6pz2hh6","search_text":"Apart from the import block, this part includes the implementation of the a() function. The most important part of the a() function is the defer block of code, which implements an anonymous function that will be called when there is a call to panic() .","text_count":252,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"block, this part includes the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a()"}]},{"block_type":"text","content":"function. The most important part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a()"}]},{"block_type":"text","content":"function is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"block of code, which implements an anonymous function that will be called when there is a call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hh7","search_text":"The second code segment of panicRecover.go follows next:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panicRecover.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hh8","search_text":"func b() { fmt.Println(\"Inside b()\") panic(\"Panic in b()!\") fmt.Println(\"Exiting b()\") }","text_count":88,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func b() {\n   fmt.Println(\"Inside b()\")\n   panic(\"Panic in b()!\")\n   fmt.Println(\"Exiting b()\")\n}"}]}]},{"block_type":"element","block":"k6pz2hh9","search_text":"The last part of the program, which illustrates the panic() and recover() functions, is as follows:","text_count":99,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program, which illustrates the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions, is as follows:"}]},{"block_type":"element","block":"k6pz2hha","search_text":"func main() { a() fmt.Println(\"main() ended!\") }","text_count":48,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   a()\n   fmt.Println(\"main() ended!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hhb","search_text":"Executing panicRecover.go will create the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panicRecover.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hhc","search_text":"$ go run panicRecover.go Inside a() About to call b() Inside b() Recover inside a()! main() ended!","text_count":98,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run panicRecover.go\nInside a()\nAbout to call b()\nInside b()\nRecover inside a()!\nmain() ended!"}]}]},{"block_type":"element","block":"k6pz2hhd","search_text":"What just happened here is really impressive! However, as you can see from the output, the a() function did not end normally, because its last two statements did not get executed:","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What just happened here is really impressive! However, as you can see from the output, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a()"}]},{"block_type":"text","content":"function did not end normally, because its last two statements did not get executed:"}]},{"block_type":"element","block":"k6pz2hhe","search_text":"fmt.Println(\"b() exited!\") fmt.Println(\"Exiting a()\")","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"b() exited!\")\n   fmt.Println(\"Exiting a()\")"}]}]},{"block_type":"element","block":"k6pz2hhf","search_text":"Nevertheless, the good thing is that panicRecover.go ended according to our will without panicking because the anonymous function used in defer took control of the situation! Also note that function b() knows nothing about function a() . However, function a() contains Go code that handles the panic condition of the b() function!","text_count":330,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Nevertheless, the good thing is that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panicRecover.go"}]},{"block_type":"text","content":"ended according to our will without panicking because the anonymous function used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"took control of the situation! Also note that function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b()"}]},{"block_type":"text","content":"knows nothing about function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a()"}]},{"block_type":"text","content":". However, function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a()"}]},{"block_type":"text","content":"contains Go code that handles the panic condition of the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b()"}]},{"block_type":"text","content":"&nbsp;function!"}]},{"block_type":"element","block":"k6pz2hhg","search_text":"Using the panic function on its own","text_count":35,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using the panic function on its own"}]},{"block_type":"element","block":"k6pz2hhh","search_text":"You can also use the panic() function on its own without any attempt to recover , and this subsection will show you its results using the Go code of justPanic.go , which will be presented in two parts.","text_count":201,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can also use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function on its own without any attempt to"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"recover"}]},{"block_type":"text","content":", and this subsection will show you its results using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"justPanic.go"}]},{"block_type":"text","content":", which will be presented in two parts."}]},{"block_type":"element","block":"k6pz2hhi","search_text":"The first part of justPanic.go follows next:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"justPanic.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hhj","search_text":"package main import ( \"fmt\" \"os\" )","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n   \"os\"\n)"}]}]},{"block_type":"element","block":"k6pz2hhk","search_text":"As you can see, the use of panic() does not require any extra Go packages.","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"does not require any extra Go packages."}]},{"block_type":"element","block":"k6pz2hhl","search_text":"The second part of justPanic.go is shown in the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"justPanic.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hhm","search_text":"func main() { if len(os.Args) == 1 { panic(\"Not enough arguments!\") } fmt.Println(\"Thanks for the argument(s)!\") }","text_count":114,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   if len(os.Args) == 1 {\n         panic(\"Not enough arguments!\")\n   }\n\n   fmt.Println(\"Thanks for the argument(s)!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hhn","search_text":"If your Go program does not have at least one command-line argument, it will call the panic() function. The panic() function takes one parameter, which is the error message that you want to print on the screen.","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If your Go program does not have at least one command-line argument, it will call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function takes one parameter, which is the error message that you want to print on the screen."}]},{"block_type":"element","block":"k6pz2hho","search_text":"Executing justPanic.go on a macOS High Sierra machine will create the following output:","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"justPanic.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine will create the following output:"}]},{"block_type":"element","block":"k6pz2hhp","search_text":"$ go run justPanic.go panic: Not enough arguments! goroutine 1 [running]: main.main() /Users/mtsouk/ch2/code/justPanic.go:10 +0x9e exit status 2","text_count":144,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run justPanic.go\npanic: Not enough arguments!\n    \ngoroutine 1 [running]:\nmain.main()\n      /Users/mtsouk/ch2/code/justPanic.go:10 +0x9e\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2hhq","search_text":"Thus, using the panic() function on its own will terminate the Go program without giving you the opportunity to recover! Therefore use of the panic() and recover() pair is much more practical and professional than just using panic() alone.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function on its own will terminate the Go program without giving you the opportunity to recover! Therefore use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"pair is much more practical and professional than just using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"alone."}]},{"block_type":"element","block":"k6pz2hhr","search_text":"Note The output of the panic() function looks like the output of the Panic() function from the log package. However, the panic() function sends nothing to the logging service of your Unix machine. ","text_count":197,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function looks like the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Panic()"}]},{"block_type":"text","content":"function from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log"}]},{"block_type":"text","content":"package. However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"function sends nothing to the logging service of your Unix machine."}]}]},{"block_type":"element","block":"k6pz2hhs","search_text":"Two handy Unix utilities","text_count":24,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Two handy Unix utilities"}]},{"block_type":"element","block":"k6pz2hht","search_text":"There are times that a Unix program fails for some unknown reason or does not perform well, and you want to find out why without having to rewrite your code and add a plethora of debugging statements.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are times that a Unix program fails for some unknown reason or does not perform well, and you want to find out why without having to rewrite your code and add a plethora of debugging statements."}]},{"block_type":"element","block":"k6pz2hhu","search_text":"Consequently, this section presents two command-line utilities that allow you to see the C system calls executed by an executable file. The names of the two tools are strace(1) and dtrace(1) , and they allow you to inspect the operation of a program.","text_count":250,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Consequently, this section presents two command-line utilities that allow you to see the C system calls executed by an executable file. The names of the two tools are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":", and they allow you to inspect the operation of a program."}]},{"block_type":"element","block":"k6pz2hhv","search_text":"Tip Remember that, at the end of the day, all programs that work on Unix machines end up using C system calls to communicate with the Unix kernel and perform most of their tasks. ","text_count":179,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Remember that, at the end of the day, all programs that work on Unix machines end up using C system calls to communicate with the Unix kernel and perform most of their tasks."}]}]},{"block_type":"element","block":"k6pz2hhw","search_text":"Although both tools can work with the go run command, you will get less unrelated output if you first create an executable file using go build and use that file. This occurs mainly because, as you already know, go run creates various temporary files before actually running your Go code, and both tools will see that and try to display information about the temporary files, which is not what you want.","text_count":402,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although both tools can work with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"command, you will get less unrelated output if you first create an executable file using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"and use that file. This occurs mainly because, as you already know,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"creates various temporary files before actually running your Go code, and both tools will see that and try to display information about the temporary files, which is not what you want."}]},{"block_type":"element","block":"k6pz2hhx","search_text":"The strace tool","text_count":15,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The strace tool"}]},{"block_type":"element","block":"k6pz2hhy","search_text":"The strace(1) command-line utility allows you to trace system calls and signals. As strace(1) is not available on macOS, this section will use a Debian Linux machine to showcase strace(1) .","text_count":189,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"command-line utility allows you to trace system calls and signals. As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"is not available on macOS, this section will use a Debian Linux machine to showcase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hhz","search_text":"Note The strace(1) tool only works on Linux machines. ","text_count":54,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"tool only works on Linux machines."}]}]},{"block_type":"element","block":"k6pz2hi0","search_text":"The output that strace(1) generates looks like the following:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"generates looks like the following:"}]},{"block_type":"element","block":"k6pz2hi1","search_text":"$ strace ls execve(\"/bin/ls\", [\"ls\"], [/* 15 vars */]) = 0 brk(0) = 0x186c000 fstat(3, {st_mode=S_IFREG|0644, st_size=35288, ...}) = 0","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ strace ls\nexecve(\"/bin/ls\", [\"ls\"], [/* 15 vars */]) = 0\nbrk(0)                                  = 0x186c000\nfstat(3, {st_mode=S_IFREG|0644, st_size=35288, ...}) = 0"}]}]},{"block_type":"element","block":"k6pz2hi2","search_text":"The strace(1) output displays each system call with its parameters as well as its return value. Note that in the Unix world, a return value of 0 is a good thing!","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"output displays each system call with its parameters as well as its return value. Note that in the Unix world, a return value of 0 is a good thing!"}]},{"block_type":"element","block":"k6pz2hi3","search_text":"In order to process a binary file, you will need to put the strace(1) command in front of the executable that you want to process. However, you will need to interpret the output on your own in order to use it to make useful conclusions. The good thing is that tools like grep(1) can get you the output that you are actually seeking:","text_count":332,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to process a binary file, you will need to put the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"command in front of the executable that you want to process. However, you will need to interpret the output on your own in order to use it to make useful conclusions. The good thing is that tools like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grep(1)"}]},{"block_type":"text","content":"can get you the output that you are actually seeking:"}]},{"block_type":"element","block":"k6pz2hi4","search_text":"$ strace find /usr 2>&1 | grep ioctl ioctl(0, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, 0x7ffe3bc59c50) = -1 ENOTTY (Inappropriate ioctl for device) ioctl(1, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, 0x7ffe3bc59be0) = -1 ENOTTY (Inappropriate ioctl for device)","text_count":304,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ strace find /usr 2&gt;&amp;1 | grep ioctl\nioctl(0, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, 0x7ffe3bc59c50) = -1 ENOTTY (Inappropriate ioctl for device)\nioctl(1, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, 0x7ffe3bc59be0) = -1 ENOTTY (Inappropriate ioctl for device)"}]}]},{"block_type":"element","block":"k6pz2hi5","search_text":"The strace(1) tool can count time, calls, and errors for each system call when used with the -c command-line option:","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"tool can count time, calls, and errors for each system call when used with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-c"}]},{"block_type":"text","content":"command-line option:"}]},{"block_type":"element","block":"k6pz2hi6","search_text":"$ strace -c find /usr 1>/dev/null % time seconds usecs/call calls errors syscall ------ ----------- ----------- --------- --------- ------------- 82.88 0.063223 2 39228 getdents 16.60 0.012664 1 19587 newfstatat 0.16 0.000119 0 19618 13 open","text_count":241,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ strace -c find /usr 1&gt;/dev/null\n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- -------------\n 82.88    0.063223           2     39228           getdents\n 16.60    0.012664           1     19587           newfstatat\n  0.16    0.000119           0     19618        13 open"}]}]},{"block_type":"element","block":"k6pz2hi7","search_text":"As the normal program output is printed in standard output form, and the output of strace(1) is printed in standard error form, the previous command discards the output of the command that is examined and shows the output of strace(1) . As you can see from the last line of the output, the open(2) system call was called 19,618 times, generated 13 errors, and took about 0.16% percent of the execution time of the entire command, or about 0.000119 seconds.","text_count":456,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the normal program output is printed in standard output form, and the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"is printed in standard error form, the previous command discards the output of the command that is examined and shows the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":". As you can see from the last line of the output, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"open(2)"}]},{"block_type":"text","content":"system call was called 19,618 times, generated 13 errors, and took about 0.16% percent of the execution time of the entire command, or about 0.000119 seconds."}]},{"block_type":"element","block":"k6pz2hi8","search_text":"The dtrace tool","text_count":15,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The dtrace tool"}]},{"block_type":"element","block":"k6pz2hi9","search_text":"Although debugging utilities such as strace(1) and truss(1) can trace system calls produced by a process, they can be slow and therefore not appropriate for solving performance problems on busy Unix systems. Another tool named DTrace allows you to see what happens behind the scenes on a system-wide basis without the need to modify or recompile anything. It also allows you to work on production systems and watch running programs or server processes dynamically without introducing a big overhead.","text_count":499,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although debugging utilities such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"truss(1)"}]},{"block_type":"text","content":"can trace system calls produced by a process, they can be slow and therefore not appropriate for solving performance problems on busy Unix systems. Another tool named"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"DTrace"}]},{"block_type":"text","content":"allows you to see what happens behind the scenes on a system-wide basis without the need to modify or recompile anything. It also allows you to work on production systems and watch running programs or server processes dynamically without introducing a big overhead."}]},{"block_type":"element","block":"k6pz2hia","search_text":"Note Although there is a version of dtrace(1) that works on Linux, the dtrace(1) tool works best on macOS and the other FreeBSD variants. ","text_count":138,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although there is a version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"that works on Linux, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"tool works best on macOS and the other FreeBSD variants."}]}]},{"block_type":"element","block":"k6pz2hib","search_text":"This subsection will use the dtruss(1) command-line utility that comes with macOS, which is just a dtrace(1) script that shows the system calls of a process and saves you from having to write dtrace(1) code. Note that both dtrace(1) and dtruss(1) need root privileges to run.","text_count":275,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"command-line utility that comes with macOS, which is just a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"script that shows the system calls of a process and saves you from having to write"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"code. Note that both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"need root privileges to run."}]},{"block_type":"element","block":"k6pz2hic","search_text":"The output that dtruss(1) generates looks like the following:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"generates looks like the following:"}]},{"block_type":"element","block":"k6pz2hid","search_text":"$ sudo dtruss godoc ioctl(0x3, 0x80086804, 0x7FFEEFBFEC20) = 0 0 close(0x3) = 0 0 access(\"/AppleInternal/XBS/.isChrooted\\0\", 0x0, 0x0) = -1 Err#2 thread_selfid(0x0, 0x0, 0x0) = 1895378 0 geteuid(0x0, 0x0, 0x0) = 0 0 getegid(0x0, 0x0, 0x0) = 0 0","text_count":244,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sudo dtruss godoc\nioctl(0x3, 0x80086804, 0x7FFEEFBFEC20)           = 0 0\nclose(0x3)         = 0 0\naccess(\"/AppleInternal/XBS/.isChrooted\\0\", 0x0, 0x0)   = -1 Err#2\nthread_selfid(0x0, 0x0, 0x0)         = 1895378 0\ngeteuid(0x0, 0x0, 0x0)         = 0 0\ngetegid(0x0, 0x0, 0x0)         = 0 0"}]}]},{"block_type":"element","block":"k6pz2hie","search_text":"So, dtruss(1) works in the same way as the strace(1) utility. Analogously to strace(1) , dtruss(1) will print system call counts when used with the -c parameter:","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"works in the same way as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"utility. Analogously to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"will print system call counts when used with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-c"}]},{"block_type":"text","content":"parameter:"}]},{"block_type":"element","block":"k6pz2hif","search_text":"$ sudo dtruss -c go run unsafe.go 2>&1 CALL COUNT access 1 bsdthread_register 1 getuid 1 ioctl 1 issetugid 1 kqueue 1 write 1 read 244 kevent 474 fcntl 479 lstat64 553","text_count":167,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sudo dtruss -c go run unsafe.go 2&gt;&amp;1\n    \nCALL                                        COUNT\naccess                                          1\nbsdthread_register                              1\ngetuid                                          1\nioctl                                           1\nissetugid                                       1\nkqueue                                          1\nwrite                                           1\nread                                          244\nkevent                                        474\nfcntl                                         479\nlstat64                                       553"}]}]},{"block_type":"element","block":"k6pz2hig","search_text":"The preceding output will quickly inform you about potential bottlenecks in your Go code or allow you to compare the performance of two different command-line programs.","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output will quickly inform you about potential bottlenecks in your Go code or allow you to compare the performance of two different command-line programs."}]},{"block_type":"element","block":"k6pz2hih","search_text":"Note You need to get used to using utilities such as strace(1) , dtrace(1) , and dtruss(1) , but such tools can make your lives so much easier and better. I strongly suggest that you start learning at least one such tool right now! ","text_count":232,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You need to get used to using utilities such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":", but such tools can make your lives so much easier and better. I strongly suggest that you start learning at least one such tool right now!"}]}]},{"block_type":"element","block":"k6pz2hii","search_text":"You can learn more about the dtrace(1) utility by reading DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X and FreeBSD by Brendan Gregg and Jim Mauro (Prentice Hall, 2011) and by visiting http://dtrace.org/ . Please bear in mind that dtrace(1) is much more powerful than strace(1) because it has its own programming language. However, strace(1) is more versatile when all you want to do is to watch the system calls of an executable file.","text_count":441,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"utility by reading"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X and FreeBSD"}]},{"block_type":"text","content":"by"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Brendan Gregg"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Jim Mauro"}]},{"block_type":"text","content":"(Prentice Hall, 2011) and by visiting"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://dtrace.org/"},"children":[{"block_type":"text","content":"http://dtrace.org/"}]},{"block_type":"text","content":". Please bear in mind that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":"is much more powerful than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"because it has its own programming language. However,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"is more versatile when all you want to do is to watch the system calls of an executable file."}]},{"block_type":"element","block":"k6pz2hij","search_text":"Your Go environment","text_count":19,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Your Go environment"}]},{"block_type":"element","block":"k6pz2hik","search_text":"This section will help you find out information about your current Go environment using the functions and properties of the runtime package. The name of the program that will be developed in this section is goEnv.go , and it will be presented in two parts.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will help you find out information about your current Go environment using the functions and properties of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime"}]},{"block_type":"text","content":"package. The name of the program that will be developed in this section is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":", and it will be presented in two parts."}]},{"block_type":"element","block":"k6pz2hil","search_text":"The first part of goEnv.go follows:","text_count":35,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2him","search_text":"package main import ( \"fmt\" \"runtime\" )","text_count":39,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n   \"runtime\"\n)"}]}]},{"block_type":"element","block":"k6pz2hin","search_text":"As you will see shortly, the runtime package contains functions and properties that will reveal the desired information. The second portion of the code of goEnv.go contains the implementation of the main() function:","text_count":215,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see shortly, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime"}]},{"block_type":"text","content":"package contains functions and properties that will reveal the desired information. The second portion of the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":"contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2hio","search_text":"func main() { fmt.Print(\"You are using \", runtime.Compiler, \" \") fmt.Println(\"on a\", runtime.GOARCH, \"machine\") fmt.Println(\"Using Go version\", runtime.Version()) fmt.Println(\"Number of CPUs:\", runtime.NumCPU()) fmt.Println(\"Number of Goroutines:\", runtime.NumGoroutine()) }","text_count":274,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() {\n   fmt.Print(\"You are using \", runtime.Compiler, \" \")\n   fmt.Println(\"on a\", runtime.GOARCH, \"machine\")\n   fmt.Println(\"Using Go version\", runtime.Version())\n   fmt.Println(\"Number of CPUs:\", runtime.NumCPU())\n   fmt.Println(\"Number of Goroutines:\", runtime.NumGoroutine())\n}"}]}]},{"block_type":"element","block":"k6pz2hip","search_text":"Executing goEnv.go on a macOS High Sierra machine with Go version 1.9.2 will create the following output:","text_count":105,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine with Go version 1.9.2 will create the following output:"}]},{"block_type":"element","block":"k6pz2hiq","search_text":"$ go run goEnv.go You are using gc on a amd64 machine Using Go version go1.9.2 Number of CPUs: 8 Number of Goroutines: 1","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run goEnv.go\nYou are using gc on a amd64 machine\nUsing Go version go1.9.2\nNumber of CPUs: 8\nNumber of Goroutines: 1"}]}]},{"block_type":"element","block":"k6pz2hir","search_text":"The same program generates the following output on a Debian Linux machine with Go version 1.3.3:","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The same program generates the following output on a Debian Linux machine with Go version 1.3.3:"}]},{"block_type":"element","block":"k6pz2his","search_text":"$ go run goEnv.go You are using gc on a amd64 machine Using Go version go1.3.3 Number of CPUs: 1 Number of Goroutines: 4","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run goEnv.go\nYou are using gc on a amd64 machine\nUsing Go version go1.3.3\nNumber of CPUs: 1\nNumber of Goroutines: 4"}]}]},{"block_type":"element","block":"k6pz2hit","search_text":"The real benefit you can get from being able to find information about your Go environment, however, is illustrated in the next program, named requiredVersion.go , which tells you if you are using Go version 1.8 or higher:","text_count":222,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The real benefit you can get from being able to find information about your Go environment, however, is illustrated in the next program, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"requiredVersion.go"}]},{"block_type":"text","content":", which tells you if you are using Go version 1.8 or higher:"}]},{"block_type":"element","block":"k6pz2hiu","search_text":"package main import ( \"fmt\" \"runtime\" \"strconv\" \"strings\" ) func main() { myVersion := runtime.Version() major := strings.Split(myVersion, \".\")[0][2] minor := strings.Split(myVersion, \".\")[1] m1, _ := strconv.Atoi(string(major)) m2, _ := strconv.Atoi(minor) if m1 == 1 && m2 < 8 { fmt.Println(\"Need Go version 1.8 or higher!\") return } fmt.Println(\"You are using Go version 1.8 or higher!\") }","text_count":392,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n   \"runtime\"\n   \"strconv\"\n   \"strings\"\n)\n\nfunc main() {\n   myVersion := runtime.Version()\n   major := strings.Split(myVersion, \".\")[0][2]\n   minor := strings.Split(myVersion, \".\")[1]\n   m1, _ := strconv.Atoi(string(major))\n   m2, _ := strconv.Atoi(minor)\n\n   if m1 == 1 &amp;&amp; m2 &lt; 8 {\n         fmt.Println(\"Need Go version 1.8 or higher!\")\n         return\n   }\n\n   fmt.Println(\"You are using Go version 1.8 or higher!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hiv","search_text":"The strings Go standard package is used for splitting the Go version string you get from runtime.Version() in order to get its first two parts, whereas the strconv.Atoi() function is used for converting a string to an integer.","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"Go standard package is used for splitting the Go version string you get from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime.Version()"}]},{"block_type":"text","content":"in order to get its first two parts, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Atoi()"}]},{"block_type":"text","content":"function is used for converting a string to an integer."}]},{"block_type":"element","block":"k6pz2hiw","search_text":"Executing requiredVersion.go on the macOS High Sierra machine will create the following output:","text_count":95,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"requiredVersion.go"}]},{"block_type":"text","content":"on the macOS High Sierra machine will create the following output:"}]},{"block_type":"element","block":"k6pz2hix","search_text":"$ go run requiredVersion.go You are using Go version 1.8 or higher!","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run requiredVersion.go\nYou are using Go version 1.8 or higher!"}]}]},{"block_type":"element","block":"k6pz2hiy","search_text":"If you run requiredVersion.go on the Debian Linux machine, however, it will generate the following output:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you run"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"requiredVersion.go"}]},{"block_type":"text","content":"on the Debian Linux machine, however, it will generate the following output:"}]},{"block_type":"element","block":"k6pz2hiz","search_text":"$ go run requiredVersion.go Need Go version 1.8 or higher!","text_count":58,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run requiredVersion.go\nNeed Go version 1.8 or higher!"}]}]},{"block_type":"element","block":"k6pz2hj0","search_text":"Thus using the Go code of requiredVersion.go , you will be able to identify whether your Unix machine has the required Go version or not.","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"requiredVersion.go"}]},{"block_type":"text","content":", you will be able to identify whether your Unix machine has the required Go version or not."}]},{"block_type":"element","block":"k6pz2hj1","search_text":"The Go Assembler","text_count":16,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The Go Assembler"}]},{"block_type":"element","block":"k6pz2hj2","search_text":"This section will briefly talk about the assembly language and the Go assembler , which is a Go tool that allows you to see the assembly language used by the Go compiler.","text_count":170,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will briefly talk about the assembly language and the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go assembler"}]},{"block_type":"text","content":", which is a Go tool that allows you to see the assembly language used by the Go compiler."}]},{"block_type":"element","block":"k6pz2hj3","search_text":"As an example, you can see the assembly language of the goEnv.go program from the previous section by executing the following command:","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As an example, you can see the assembly language of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":"program from the previous section by executing the following command:"}]},{"block_type":"element","block":"k6pz2hj4","search_text":"$ GOOS=darwin GOARCH=amd64 go tool compile -S goEnv.go","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ GOOS=darwin GOARCH=amd64 go tool compile -S goEnv.go"}]}]},{"block_type":"element","block":"k6pz2hj5","search_text":"The value of the GOOS variable defines the name of the target operating system, whereas the value of the GOARCH variable defines the compilation architecture. The preceding command was executed on a macOS High Sierra machine, hence the use of the darwin value for the GOOS variable.","text_count":282,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"variable defines the name of the target operating system, whereas the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"variable defines the compilation architecture. The preceding command was executed on a macOS High Sierra machine, hence the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"darwin"}]},{"block_type":"text","content":"value for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2hj6","search_text":"The output of the preceding command is pretty large, even for a small program such as goEnv.go . Some of the output is shown next:","text_count":130,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the preceding command is pretty large, even for a small program such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goEnv.go"}]},{"block_type":"text","content":". Some of the output is shown next:"}]},{"block_type":"element","block":"k6pz2hj7","search_text":"\"\".main STEXT size=859 args=0x0 locals=0x118 0x0000 00000 (goEnv.go:8) TEXT \"\".main(SB), $280-0 0x00be 00190 (goEnv.go:9) PCDATA $0, $1 0x0308 00776 (goEnv.go:13) PCDATA $0, $5 0x0308 00776 (goEnv.go:13) CALL runtime.convT2E64(SB) \"\".init STEXT size=96 args=0x0 locals=0x8 0x0000 00000 (<autogenerated>:1) TEXT \"\".init(SB), $8-0 0x0000 00000 (<autogenerated>:1) MOVQ (TLS), CX 0x001d 00029 (<autogenerated>:1) FUNCDATA $0, gclocals d4dc2f11db048877dbc0f60a22b4adb3(SB)","text_count":468,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"\"\".main STEXT size=859 args=0x0 locals=0x118\n   0x0000 00000 (goEnv.go:8)       TEXT    \"\".main(SB), $280-0\n   0x00be 00190 (goEnv.go:9)       PCDATA  $0, $1\n   0x0308 00776 (goEnv.go:13)      PCDATA  $0, $5\n   0x0308 00776 (goEnv.go:13)      CALL    runtime.convT2E64(SB)\n\"\".init STEXT size=96 args=0x0 locals=0x8\n   0x0000 00000 (&lt;autogenerated&gt;:1) TEXT    \"\".init(SB), $8-0\n   0x0000 00000 (&lt;autogenerated&gt;:1) MOVQ    (TLS), CX\n   0x001d 00029 (&lt;autogenerated&gt;:1) FUNCDATA        $0, gclocals d4dc2f11db048877dbc0f60a22b4adb3(SB)"}]}]},{"block_type":"element","block":"k6pz2hj8","search_text":"0x001d 00029 (<autogenerated>:1) FUNCDATA $1, gclocals 33cdeccccebe80329f1fdbee7f5874cb(SB) ","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"0x001d 00029 (&lt;autogenerated&gt;:1) FUNCDATA        $1, gclocals 33cdeccccebe80329f1fdbee7f5874cb(SB)"}]}]},{"block_type":"element","block":"k6pz2hj9","search_text":"The lines that contain the FUNCDATA and PCDATA directives are read and used by the Go garbage collector and are automatically generated by the Go compiler.","text_count":155,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The lines that contain the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FUNCDATA"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PCDATA"}]},{"block_type":"text","content":"directives are read and used by the Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"garbage collector"}]},{"block_type":"text","content":"and are automatically generated by the Go compiler."}]},{"block_type":"element","block":"k6pz2hja","search_text":"An equivalent variant of the preceding command follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An equivalent variant of the preceding command follows:"}]},{"block_type":"element","block":"k6pz2hjb","search_text":"$ GOOS=darwin GOARCH=amd64 go build -gcflags -S goEnv.go","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ GOOS=darwin GOARCH=amd64 go build -gcflags -S goEnv.go"}]}]},{"block_type":"element","block":"k6pz2hjc","search_text":"The list of valid GOOS values includes android , darwin , dragonfly , freebsd , linux , nacl , netbsd , openbsd , plan9 , solaris , windows , and zos . On the other hand, the list of valid GOARCH values includes 386 , amd64 , amd64p32 , arm , armbe , arm64 , arm64be , ppc64 , ppc64le , mips , mipsle , mips64 , mips64le , mips64p32 , mips64p32le , ppc , s390 , s390x , sparc , and sparc64 .","text_count":391,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The list of valid"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"values includes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"android"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"darwin"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dragonfly"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"freebsd"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linux"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nacl"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netbsd"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"openbsd"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"plan9"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"solaris"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"windows"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"zos"}]},{"block_type":"text","content":". On the other hand, the list of valid"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"values includes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"386"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"amd64"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"amd64p32"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arm"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"armbe"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arm64"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arm64be"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ppc64"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ppc64le"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mips"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mipsle"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mips64"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mips64le"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mips64p32"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mips64p32le"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ppc"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s390"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s390x"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sparc"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sparc64"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hjd","search_text":"Tip If you are really interested in the Go assembler and you want to learn more, visit https://golang.org/doc/asm . ","text_count":116,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are really interested in the Go assembler and you want to learn more, visit"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/doc/asm"},"children":[{"block_type":"text","content":"https://golang.org/doc/asm"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hje","search_text":"Node Trees","text_count":10,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Node Trees"}]},{"block_type":"element","block":"k6pz2hjf","search_text":"Now it's time for something completely different and low level. You are free to skip this section if you like, but I bet that you are not reading this book for its easy topics but for the difficult ones, such as node trees !","text_count":224,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now it's time for something completely different and low level. You are free to skip this section if you like, but I bet that you are not reading this book for its easy topics but for the difficult ones, such as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"node trees"}]},{"block_type":"text","content":"!"}]},{"block_type":"element","block":"k6pz2hjg","search_text":"Note The go tool 6g -W test.go command does not work on newer Go versions. You should use go tool compile -W test.go instead. ","text_count":126,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool 6g -W test.go"}]},{"block_type":"text","content":"command does not work on newer Go versions. You should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile -W test.go"}]},{"block_type":"text","content":"instead."}]}]},{"block_type":"element","block":"k6pz2hjh","search_text":"A Go node is a struct with a large number of properties. You will learn more about defining and using Go structures in Chapter 4, The Uses of Composite Types . Everything in a Go program is being parsed and analyzed by the modules of the Go compiler according to the grammar of the Go programming language. The final product of this analysis is a tree that is specific to the provided Go code, and it represents the program in a different way that is suited for the compiler rather than for the developer.","text_count":505,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go node is a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"with a large number of properties. You will learn more about defining and using Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"structures"}]},{"block_type":"text","content":"in Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":". Everything in a Go program is being parsed and analyzed by the modules of the Go compiler according to the grammar of the Go programming language. The final product of this analysis is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tree"}]},{"block_type":"text","content":"that is specific to the provided Go code, and it represents the program in a different way that is suited for the compiler rather than for the developer."}]},{"block_type":"element","block":"k6pz2hji","search_text":"This section will start with the following Go code, which is saved as nodeTree.go . It is presented here as an example of the kind of low-level information that the go tool can provide:","text_count":185,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will start with the following Go code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":". It is presented here as an example of the kind of low-level information that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"tool can provide:"}]},{"block_type":"element","block":"k6pz2hjj","search_text":"package main import ( \"fmt\" ) func main() { fmt.Println(\"Hello there!\") }","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n)\n\nfunc main() {\n   fmt.Println(\"Hello there!\")\n}"}]}]},{"block_type":"element","block":"k6pz2hjk","search_text":"The Go code of nodeTree.go is pretty easy to understand, so you will not be surprised by its output, which comes next:","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":"is pretty easy to understand, so you will not be surprised by its output, which comes next:"}]},{"block_type":"element","block":"k6pz2hjl","search_text":"$ go run nodeTree.go Hello there!","text_count":33,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run nodeTree.go\nHello there!"}]}]},{"block_type":"element","block":"k6pz2hjm","search_text":"Now it's time to see some of the internal workings of Go by executing the following command:","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now it's time to see some of the internal workings of Go by executing the following command:"}]},{"block_type":"element","block":"k6pz2hjn","search_text":"$ go tool compile -W nodeTree.go before main . CALLFUNC l(8) tc(1) STRUCT-(int, error) . . NAME-fmt.Println a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func(...interface {}) (int, error) . . DDDARG l(8) esc(no) PTR64-*[1]interface {} . CALLFUNC-list . . CONVIFACE l(8) esc(h) tc(1) implicit(true) INTER-interface {} . . . NAME-main.statictmp_0 a(true) l(8) x(0) class(PEXTERN) f(1) tc(1) used string . VARKILL l(8) tc(1) . . NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) used ARRAY-[1]interface {} after walk main . CALLFUNC-init . . AS l(8) tc(1) . . . NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {} . . AS l(8) tc(1) . . . NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {} . . . ADDR l(8) tc(1) PTR64-*[1]interface {} . . . . NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {} . . BLOCK l(8) . . BLOCK-list . . . AS l(8) tc(1) hascall . . . . INDEX l(8) tc(1) assigned bounded hascall INTER-interface {} . . . . . IND l(8) tc(1) implicit(true) assigned hascall ARRAY-[1]interface {} . . . . . . NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {} . . . . . LITERAL-0 a(true) l(8) tc(1) int . . . . EFACE l(8) tc(1) INTER-interface {} . . . . . ADDR a(true) l(8) tc(1) PTR64-*uint8 . . . . . . NAME-type.string a(true) x(0) class(PEXTERN) tc(1) uint8 . . . . . ADDR l(8) tc(1) PTR64-*string . . . . . . NAME-main.statictmp_0 a(true) l(8) x(0) class(PEXTERN) f(1) tc(1) addrtaken used string . . BLOCK l(8) . . BLOCK-list . . . AS l(8) tc(1) hascall . . . . NAME-main..autotmp_1 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used SLICE-[]interface {} . . . . SLICEARR l(8) tc(1) hascall SLICE-[]interface {} . . . . . NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {} . CALLFUNC l(8) tc(1) hascall STRUCT-(int, error) . . NAME-fmt.Println a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func(...interface {}) (int, error) . . DDDARG l(8) esc(no) PTR64-*[1]interface {} . CALLFUNC-list . . AS l(8) tc(1) . . . INDREGSP-SP a(true) l(8) x(0) tc(1) addrtaken main.__ SLICE-[]interface {} . . . NAME-main..autotmp_1 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used SLICE-[]interface {} . VARKILL l(8) tc(1) . . NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {} before init . IF l(1) tc(1) . . GT l(1) tc(1) bool . . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . . LITERAL-1 a(true) l(1) tc(1) uint8 . IF-body . . RETURN l(1) tc(1) . IF l(1) tc(1) . . EQ l(1) tc(1) bool . . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . . LITERAL-1 a(true) l(1) tc(1) uint8 . IF-body . . CALLFUNC l(1) tc(1) . . . NAME-runtime.throwinit a(true) x(0) class(PFUNC) tc(1) used FUNC-func() . AS l(1) tc(1) . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . LITERAL-1 a(true) l(1) tc(1) uint8 . CALLFUNC l(1) tc(1) . . NAME-fmt.init a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func() . AS l(1) tc(1) . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . LITERAL-2 a(true) l(1) tc(1) uint8 . RETURN l(1) tc(1) after walk init . IF l(1) tc(1) . . GT l(1) tc(1) bool . . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . . LITERAL-1 a(true) l(1) tc(1) uint8 . IF-body . . RETURN l(1) tc(1) . IF l(1) tc(1) . . EQ l(1) tc(1) bool . . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . . LITERAL-1 a(true) l(1) tc(1) uint8 . IF-body . . CALLFUNC l(1) tc(1) hascall . . . NAME-runtime.throwinit a(true) x(0) class(PFUNC) tc(1) used FUNC-func() . AS l(1) tc(1) . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . LITERAL-1 a(true) l(1) tc(1) uint8 . CALLFUNC l(1) tc(1) hascall . . NAME-fmt.init a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func() . AS l(1) tc(1) . . NAME-main.initdone a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8 . . LITERAL-2 a(true) l(1) tc(1) uint8 . RETURN l(1) tc(1)","text_count":4289,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -W nodeTree.go\nbefore main\n.   CALLFUNC l(8) tc(1) STRUCT-(int, error)\n.   .   NAME-fmt.Println a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func(...interface {}) (int, error)\n.   .   DDDARG l(8) esc(no) PTR64-*[1]interface {}\n.   CALLFUNC-list\n.   .   CONVIFACE l(8) esc(h) tc(1) implicit(true) INTER-interface {}\n.   .   .   NAME-main.statictmp_0 a(true) l(8) x(0) class(PEXTERN) f(1) tc(1) used string\n    \n.   VARKILL l(8) tc(1)\n.   .   NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) used ARRAY-[1]interface {}\nafter walk main\n.   CALLFUNC-init\n.   .   AS l(8) tc(1)\n.   .   .   NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {}\n    \n.   .   AS l(8) tc(1)\n.   .   .   NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {}\n.   .   .   ADDR l(8) tc(1) PTR64-*[1]interface {}\n.   .   .   .   NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {}\n    \n.   .   BLOCK l(8)\n.   .   BLOCK-list\n.   .   .   AS l(8) tc(1) hascall\n.   .   .   .   INDEX l(8) tc(1) assigned bounded hascall INTER-interface {}\n.   .   .   .   .   IND l(8) tc(1) implicit(true) assigned hascall ARRAY-[1]interface {}\n.   .   .   .   .   .   NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {}\n.   .   .   .   .   LITERAL-0 a(true) l(8) tc(1) int\n.   .   .   .   EFACE l(8) tc(1) INTER-interface {}\n.   .   .   .   .   ADDR a(true) l(8) tc(1) PTR64-*uint8\n.   .   .   .   .   .   NAME-type.string a(true) x(0) class(PEXTERN) tc(1) uint8\n.   .   .   .   .   ADDR l(8) tc(1) PTR64-*string\n.   .   .   .   .   .   NAME-main.statictmp_0 a(true) l(8) x(0) class(PEXTERN) f(1) tc(1) addrtaken used string\n    \n.   .   BLOCK l(8)\n.   .   BLOCK-list\n.   .   .   AS l(8) tc(1) hascall\n.   .   .   .   NAME-main..autotmp_1 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used SLICE-[]interface {}\n.   .   .   .   SLICEARR l(8) tc(1) hascall SLICE-[]interface {}\n.   .   .   .   .   NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used PTR64-*[1]interface {}\n.   CALLFUNC l(8) tc(1) hascall STRUCT-(int, error)\n.   .   NAME-fmt.Println a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func(...interface {}) (int, error)\n.   .   DDDARG l(8) esc(no) PTR64-*[1]interface {}\n.   CALLFUNC-list\n.   .   AS l(8) tc(1)\n.   .   .   INDREGSP-SP a(true) l(8) x(0) tc(1) addrtaken main.__ SLICE-[]interface {}\n.   .   .   NAME-main..autotmp_1 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used SLICE-[]interface {}\n    \n.   VARKILL l(8) tc(1)\n.   .   NAME-main..autotmp_0 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) addrtaken assigned used ARRAY-[1]interface {}\n    \nbefore init\n.   IF l(1) tc(1)\n.   .   GT l(1) tc(1) bool\n.   .   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   .   LITERAL-1 a(true) l(1) tc(1) uint8\n.   IF-body\n.   .   RETURN l(1) tc(1)\n    \n.   IF l(1) tc(1)\n.   .   EQ l(1) tc(1) bool\n.   .   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   .   LITERAL-1 a(true) l(1) tc(1) uint8\n.   IF-body\n.   .   CALLFUNC l(1) tc(1)\n.   .   .   NAME-runtime.throwinit a(true) x(0) class(PFUNC) tc(1) used FUNC-func()\n    \n.   AS l(1) tc(1)\n.   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   LITERAL-1 a(true) l(1) tc(1) uint8\n    \n.   CALLFUNC l(1) tc(1)\n.   .   NAME-fmt.init a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func()\n    \n.   AS l(1) tc(1)\n.   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   LITERAL-2 a(true) l(1) tc(1) uint8\n    \n.   RETURN l(1) tc(1)\nafter walk init\n.   IF l(1) tc(1)\n.   .   GT l(1) tc(1) bool\n.   .   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   .   LITERAL-1 a(true) l(1) tc(1) uint8\n.   IF-body\n.   .   RETURN l(1) tc(1)\n    \n.   IF l(1) tc(1)\n.   .   EQ l(1) tc(1) bool\n.   .   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   .   LITERAL-1 a(true) l(1) tc(1) uint8\n.   IF-body\n.   .   CALLFUNC l(1) tc(1) hascall\n.   .   .   NAME-runtime.throwinit a(true) x(0) class(PFUNC) tc(1) used FUNC-func()\n    \n.   AS l(1) tc(1)\n.   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   LITERAL-1 a(true) l(1) tc(1) uint8\n    \n.   CALLFUNC l(1) tc(1) hascall\n.   .   NAME-fmt.init a(true) l(4) x(0) class(PFUNC) tc(1) used FUNC-func()\n    \n.   AS l(1) tc(1)\n.   .   NAME-main.initdone  a(true) l(1) x(0) class(PEXTERN) tc(1) assigned used uint8\n.   .   LITERAL-2 a(true) l(1) tc(1) uint8\n    \n.   RETURN l(1) tc(1)"}]}]},{"block_type":"element","block":"k6pz2hjo","search_text":"As you can appreciate, the Go compiler and its tools do many things behind the scenes, even for a small program such as nodeTree.go .","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can appreciate, the Go compiler and its tools do many things behind the scenes, even for a small program such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hjp","search_text":"Note The -W parameter tells the go tool compile command to print the debug parse tree after the type checking. ","text_count":111,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-W"}]},{"block_type":"text","content":"parameter tells the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile"}]},{"block_type":"text","content":"command to print the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"debug parse tree"}]},{"block_type":"text","content":"after the type checking."}]}]},{"block_type":"element","block":"k6pz2hjq","search_text":"Look at the output of the next two commands:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the output of the next two commands:"}]},{"block_type":"element","block":"k6pz2hjr","search_text":"$ go tool compile -W nodeTree.go | grep before before main before init $ go tool compile -W nodeTree.go | grep after after walk main after walk init","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -W nodeTree.go | grep before\nbefore main\nbefore init\n$ go tool compile -W nodeTree.go | grep after\nafter walk main\nafter walk init"}]}]},{"block_type":"element","block":"k6pz2hjs","search_text":"As you can see, the before keyword is about the beginning of the execution of a function. If your program had more functions, you would have gotten more output. This is illustrated in the following example:","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"before"}]},{"block_type":"text","content":"keyword is about the beginning of the execution of a function. If your program had more functions, you would have gotten more output. This is illustrated in the following example:"}]},{"block_type":"element","block":"k6pz2hjt","search_text":"$ go tool compile -W defer.go | grep before before d1 before d2 before d3 before main before d2.func1 before d3.func1 before init before type..hash.[2]interface {} before type..eq.[2]interface {}","text_count":195,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -W defer.go | grep before\nbefore d1\nbefore d2\nbefore d3\nbefore main\nbefore d2.func1\nbefore d3.func1\nbefore init\nbefore type..hash.[2]interface {}\nbefore type..eq.[2]interface {}"}]}]},{"block_type":"element","block":"k6pz2hju","search_text":"The preceding example uses the Go code of defer.go , which is much more complicated than nodeTree.go . However, it should be obvious than the init() function is automatically created by Go as it exists in both examples ( nodeTree.go and defer.go ).","text_count":248,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding example uses the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer.go"}]},{"block_type":"text","content":", which is much more complicated than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":". However, it should be obvious than the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function is automatically created by Go as it exists in both examples ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer.go"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2hjv","search_text":"I will now present you with a juicier version of nodeTree.go , named nodeTreeMore.go :","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I will now present you with a juicier version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTree.go"}]},{"block_type":"text","content":", named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTreeMore.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2hjw","search_text":"package main import ( \"fmt\" ) func functionOne(x int) { fmt.Println(x) } func main() { varOne := 1 varTwo := 2 fmt.Println(\"Hello there!\") functionOne(varOne) functionOne(varTwo) }","text_count":180,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main\n\nimport (\n   \"fmt\"\n)\n\nfunc functionOne(x int) {\n   fmt.Println(x)\n}\n\nfunc main() {\n   varOne := 1\n   varTwo := 2\n   fmt.Println(\"Hello there!\")\n   functionOne(varOne)\n   functionOne(varTwo)\n}"}]}]},{"block_type":"element","block":"k6pz2hjx","search_text":"The nodeTreeMore.go program has two variables, named varOne and varTwo , and one additional function named functionOne . Searching the output of go tool compile -W for varOne , varTwo , and functionOne reveals the following information:","text_count":236,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTreeMore.go"}]},{"block_type":"text","content":"program has two variables, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varOne"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varTwo"}]},{"block_type":"text","content":", and one additional function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functionOne"}]},{"block_type":"text","content":". Searching the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool compile -W"}]},{"block_type":"text","content":"for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varOne"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varTwo"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functionOne"}]},{"block_type":"text","content":"reveals the following information:"}]},{"block_type":"element","block":"k6pz2hjy","search_text":"$ go tool compile -W nodeTreeMore.go | grep functionOne | uniq before functionOne after walk functionOne . . NAME-main.functionOne a(true) l(7) x(0) class(PFUNC) tc(1) used FUNC-func(int) $ go tool compile -W nodeTreeMore.go | grep varTwo | uniq . . NAME-main.varTwo a(true) g(2) l(13) x(0) class(PAUTO) f(1) tc(1) used int . . . NAME-main.varTwo a(true) g(2) l(13) x(0) class(PAUTO) f(1) tc(1) used int $ go tool compile -W nodeTreeMore.go | grep varOne | uniq . . NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int . . . NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int ","text_count":620,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile -W nodeTreeMore.go  | grep functionOne | uniq\nbefore functionOne\nafter walk functionOne\n.   .   NAME-main.functionOne a(true) l(7) x(0) class(PFUNC) tc(1) used FUNC-func(int)\n$ go tool compile -W nodeTreeMore.go  | grep varTwo | uniq\n.   .   NAME-main.varTwo a(true) g(2) l(13) x(0) class(PAUTO) f(1) tc(1) used int\n.   .   .   NAME-main.varTwo a(true) g(2) l(13) x(0) class(PAUTO) f(1) tc(1) used int\n$ go tool compile -W nodeTreeMore.go  | grep varOne | uniq\n.   .   NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int\n.   .   .   NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int"}]}]},{"block_type":"element","block":"k6pz2hjz","search_text":"Thus, varOne is represented as NAME-main.varOne while varTwo is indicated by NAME-main.varTwo . The functionOne() function is referenced as NAME-main.functionOne . Consequently, the main() function is referenced as NAME-main .","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varOne"}]},{"block_type":"text","content":"is represented as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main.varOne"}]},{"block_type":"text","content":"while"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"varTwo"}]},{"block_type":"text","content":"is indicated by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main.varTwo"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functionOne()"}]},{"block_type":"text","content":"function is referenced as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main.functionOne"}]},{"block_type":"text","content":". Consequently, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function is referenced as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hk0","search_text":"Now let's examine the following code of the debug parse tree of nodeTreeMore.go :","text_count":81,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's examine the following code of the debug parse tree of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nodeTreeMore.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2hk1","search_text":"before functionOne . AS l(8) tc(1) . . NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used int . . NAME-main.x a(true) g(1) l(7) x(0) class(PPARAM) f(1) tc(1) used int","text_count":194,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"before functionOne\n.   AS l(8) tc(1)\n.   .   NAME-main..autotmp_2 a(true) l(8) x(0) class(PAUTO) esc(N) tc(1) assigned used int\n.   .   NAME-main.x a(true) g(1) l(7) x(0) class(PPARAM) f(1) tc(1) used int"}]}]},{"block_type":"element","block":"k6pz2hk2","search_text":"This data is related to the definition of functionOne() . The l(8) string tells us that the definition of this node can be found in line 8; that is, after reading line 7. The NAME-main..autotmp_2 integer variable is automatically generated by the compiler.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This data is related to the definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functionOne()"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"l(8)"}]},{"block_type":"text","content":"string tells us that the definition of this node can be found in line 8; that is, after reading line 7. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main..autotmp_2"}]},{"block_type":"text","content":"integer variable is automatically generated by the compiler."}]},{"block_type":"element","block":"k6pz2hk3","search_text":"The next part of the debug parse tree output that I will explain below follows:","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next part of the debug parse tree output that I will explain below follows:"}]},{"block_type":"element","block":"k6pz2hk4","search_text":". CALLFUNC l(15) tc(1) . . NAME-main.functionOne a(true) l(7) x(0) class(PFUNC) tc(1) used FUNC-func(int) . CALLFUNC-list . . NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":".   CALLFUNC l(15) tc(1)\n.   .   NAME-main.functionOne a(true) l(7) x(0) class(PFUNC) tc(1) used FUNC-func(int)\n.   CALLFUNC-list\n.   .   NAME-main.varOne a(true) g(1) l(12) x(0) class(PAUTO) f(1) tc(1) used int"}]}]},{"block_type":"element","block":"k6pz2hk5","search_text":"The first line says that in line 15 of the program, which is specified by l(15) , you will call NAME-main.functionOne , which is defined in line 7 of the program, as specified by l(7) , which is a function that requires a single integer parameter, as specified by FUNC-func(int) . The function list of parameters, which is specified after CALLFUNC-list , includes the NAME-main.varOne variable that is defined in line 12 of the program as l(12) shows.","text_count":451,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first line says that in line 15 of the program, which is specified by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"l(15)"}]},{"block_type":"text","content":", you will call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main.functionOne"}]},{"block_type":"text","content":", which is defined in line 7 of the program, as specified by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"l(7)"}]},{"block_type":"text","content":", which is a function that requires a single integer parameter, as specified by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FUNC-func(int)"}]},{"block_type":"text","content":". The function list of parameters, which is specified after"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CALLFUNC-list"}]},{"block_type":"text","content":", includes the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NAME-main.varOne"}]},{"block_type":"text","content":"variable that is defined in line 12 of the program as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"l(12)"}]},{"block_type":"text","content":"shows."}]},{"block_type":"element","block":"k6pz2hk6","search_text":"Learning more about go build","text_count":28,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Learning more about go build"}]},{"block_type":"element","block":"k6pz2hk7","search_text":"If you want to learn more about what is happening behind the scenes when you execute a go build command, you should add the -x flag to it, as in the next example:","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to learn more about what is happening behind the scenes when you execute a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"command, you should add the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-x"}]},{"block_type":"text","content":"flag to it, as in the next example:"}]},{"block_type":"element","block":"k6pz2hk8","search_text":"$ go build -x defer.go WORK=/var/folders/sk/ltk8cnw50lzdtr2hxcj5sv2m0000gn/T/go-build563076777 mkdir -p $WORK/command-line-arguments/_obj/ mkdir -p $WORK/command-line-arguments/_obj/exe/ cd /Users/mtsouk/Desktop/masterGo/ch/ch2/code /usr/local/Cellar/go/1.9.2/libexec/pkg/tool/darwin_amd64/compile -o $WORK/command-line-arguments.a -trimpath $WORK -goversion go1.9.2 -p main -complete -buildid 594c089b099f8acfb529046cd09a886b401d57c8 -D _/Users/mtsouk/Desktop/masterGo/ch/ch2/code -I $WORK -pack ./defer.go cd . /usr/local/Cellar/go/1.9.2/libexec/pkg/tool/darwin_amd64/link -o $WORK/command-line-arguments/_obj/exe/a.out -L $WORK -extld=clang -buildmode=exe -buildid=594c089b099f8acfb529046cd09a886b401d57c8 $WORK/command-line-arguments.a mv $WORK/command-line-arguments/_obj/exe/a.out defer ","text_count":793,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build -x defer.go\nWORK=/var/folders/sk/ltk8cnw50lzdtr2hxcj5sv2m0000gn/T/go-build563076777\nmkdir -p $WORK/command-line-arguments/_obj/\nmkdir -p $WORK/command-line-arguments/_obj/exe/\ncd /Users/mtsouk/Desktop/masterGo/ch/ch2/code\n/usr/local/Cellar/go/1.9.2/libexec/pkg/tool/darwin_amd64/compile -o $WORK/command-line-arguments.a -trimpath $WORK -goversion go1.9.2 -p main -complete -buildid 594c089b099f8acfb529046cd09a886b401d57c8 -D _/Users/mtsouk/Desktop/masterGo/ch/ch2/code -I $WORK -pack ./defer.go\ncd .\n/usr/local/Cellar/go/1.9.2/libexec/pkg/tool/darwin_amd64/link -o $WORK/command-line-arguments/_obj/exe/a.out -L $WORK -extld=clang -buildmode=exe -buildid=594c089b099f8acfb529046cd09a886b401d57c8 $WORK/command-line-arguments.a\nmv $WORK/command-line-arguments/_obj/exe/a.out defer"}]}]},{"block_type":"element","block":"k6pz2hk9","search_text":"Once again, there are many things happening in the background, and it is important to be aware of them. However, most of the time, you will not have to deal with the commands of the compilation process.","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, there are many things happening in the background, and it is important to be aware of them. However, most of the time, you will not have to deal with the commands of the compilation process."}]},{"block_type":"element","block":"k6pz2hka","search_text":"General Go coding advices","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"General Go coding advices"}]},{"block_type":"element","block":"k6pz2hkb","search_text":"The following list offers practical advices that will help you write better Go code:","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following list offers practical advices that will help you write better Go code:"}]},{"block_type":"element","block":"k6pz2hkc","search_text":"If you have an error in a Go function, either log it or return it, do not do both unless you have a really good reason for doing so! Go interfaces define behaviors, not data and data structures. Use the io.Reader and io.Writer interfaces because they make your code more extensible. Make sure that you pass a pointer to a variable of a function only when needed. The rest of the time, just pass the value of the variable. Error variables are not string variables; they are error variables! Do not test your Go code on production machines! If you don't really know a Go feature, test it before using it for the first time, especially if you are developing an application or a utility that will be used by a large number of users. If you are afraid of making mistakes, you will most likely end up doing nothing really useful! So, experiment as much as you can! ","text_count":859,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you have an error in a Go function, either log it or return it, do not do both unless you have a really good reason for doing so!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"interfaces"}]},{"block_type":"text","content":"define behaviors, not data and data structures."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interfaces because they make your code more extensible."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Make sure that you pass a pointer to a variable of a function only when needed. The rest of the time, just pass the value of the variable."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Error variables are not"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variables; they are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variables!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Do not test your Go code on production machines!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you don't really know a Go feature, test it before using it for the first time, especially if you are developing an application or a utility that will be used by a large number of users."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are afraid of making mistakes, you will most likely end up doing nothing really useful! So, experiment as much as you can!"}]}]},{"block_type":"element","block":"k6pz2hkd","search_text":"Additional Resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional Resources"}]},{"block_type":"element","block":"k6pz2hke","search_text":"Have a look at the following resources:","text_count":39,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Have a look at the following resources:"}]},{"block_type":"element","block":"k6pz2hkf","search_text":"Learn more about the unsafe standard Go package by visiting its documentation page at https://golang.org/pkg/unsafe/ . Visit the website of DTrace at http://dtrace.org/ . You can find out more information about the functions of the runtime package by visiting https://golang.org/pkg/runtime/ . Reading research papers might be difficult, but it is very rewarding. Be sure to download the On-the-fly Garbage Collection: An Exercise in Cooperation paper and read it. The paper can be found in many places, including https://dl.acm.org/citation.cfm?id=359655 . Visit https://github.com/gasche/gc-latency-experiment in order to find benchmarking code for the garbage collector of various programming languages. Should you wish to learn more about garbage collection, definitely visit http://gchandbook.org/ . Visit the documentation page of cgo at https://golang.org/cmd/cgo/ . ","text_count":874,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"standard Go package by visiting its documentation page at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/unsafe/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/unsafe/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the website of DTrace at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://dtrace.org/"},"children":[{"block_type":"text","content":"http://dtrace.org/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can find out more information about the functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime"}]},{"block_type":"text","content":"package by visiting&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/runtime/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/runtime/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Reading research papers might be difficult, but it is very rewarding. Be sure to download the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"On-the-fly Garbage Collection: An Exercise in Cooperation"}]},{"block_type":"text","content":"&nbsp;paper and read it. The paper can be found in many places, including&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://dl.acm.org/citation.cfm?id=359655"},"children":[{"block_type":"text","content":"https://dl.acm.org/citation.cfm?id=359655"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/gasche/gc-latency-experiment"},"children":[{"block_type":"text","content":"https://github.com/gasche/gc-latency-experiment"}]},{"block_type":"text","content":"in order to find benchmarking code for the garbage collector of various programming languages."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Should you wish to learn more about garbage collection, definitely visit"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://gchandbook.org/"},"children":[{"block_type":"text","content":"http://gchandbook.org/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cgo"}]},{"block_type":"text","content":"at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/cmd/cgo/"},"children":[{"block_type":"text","content":"https://golang.org/cmd/cgo/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hkg","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2hkh","search_text":"Write an example where you use your own C code from a Go program. Use strace(1) on your Linux machine to inspect the operation of some standard Unix utilities such as cp(1) and ls(1) . What do you see? If you are using a macOS machine, use dtruss(1) to see how the sync(8) utility works. Write a Go function, and use it in a C program. ","text_count":336,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write an example where you use your own C code from a Go program."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"on your Linux machine to inspect the operation of some standard Unix utilities such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cp(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ls(1)"}]},{"block_type":"text","content":". What do you see?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are using a macOS machine, use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"to see how the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync(8)"}]},{"block_type":"text","content":"utility works."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go function, and use it in a C program."}]}]},{"block_type":"element","block":"k6pz2hki","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2hkj","search_text":"This chapter covered many interesting Go topics including theoretical and practical information about the Go garbage collector ; how to call C code from your Go programs; the handy, yet sometimes tricky, defer keyword; the panic() and recover() functions; the strace(1) , dtrace(1) , and dtruss(1) Unix tools; and the use of the unsafe standard Go package. The chapter also presented some assembly language generated by Go.","text_count":423,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter covered many interesting Go topics including theoretical and practical information about the Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"garbage collector"}]},{"block_type":"text","content":"; how to call C code from your Go programs; the handy, yet sometimes tricky,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"keyword; the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions; the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtruss(1)"}]},{"block_type":"text","content":"Unix tools; and the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"standard Go package. The chapter also presented some assembly language generated by Go."}]},{"block_type":"element","block":"k6pz2hkk","search_text":"Toward the end of the chapter, it told you how to find out information about your Go environment using the runtime package and how to reveal and explain the node tree of a Go program before giving you some handy Go coding advice.","text_count":229,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Toward the end of the chapter, it told you how to find out information about your Go environment using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime"}]},{"block_type":"text","content":"package and how to reveal and explain the node tree of a Go program before giving you some handy Go coding advice."}]},{"block_type":"element","block":"k6pz2hkl","search_text":"At the end of the day, what you should remember from this chapter is that tools such as the unsafe Go package and the ability to call C code from Go are usually used for three occasions: first, when you want the best performance and you are willing to sacrifice some Go safety for it; second, when you want to communicate with another programming language; and third, when you want to implement something that cannot be implemented in Go.","text_count":438,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the end of the day, what you should remember from this chapter is that tools such as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"Go package and the ability to call C code from Go are usually used for three occasions: first, when you want the best performance and you are willing to sacrifice some Go safety for it; second, when you want to communicate with another programming language; and third, when you want to implement something that cannot be implemented in Go."}]},{"block_type":"element","block":"k6pz2hkm","search_text":"In the next chapter, you will start to learn about the basic data types that come with Go including arrays , slices , and maps . Despite their simplicity, those data types are the building blocks of almost every Go application because they are the basis of more complex data structures that allow you to store your data and move information inside your Go projects. Additionally, you will learn about pointers , which are also found in other programming languages, Go loops , and the unique way that Go works with dates and times.","text_count":530,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next chapter, you will start to learn about the basic data types that come with Go including"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"arrays"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slices"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"maps"}]},{"block_type":"text","content":". Despite their simplicity, those data types are the building blocks of almost every Go application because they are the basis of more complex data structures that allow you to store your data and move information inside your Go projects. Additionally, you will learn about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pointers"}]},{"block_type":"text","content":", which are also found in other programming languages, Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"loops"}]},{"block_type":"text","content":", and the unique way that Go works with dates and times."}]}]},{"title":"Working with Basic Go Data Types","author":"Mihalis Tsoukalos","block":"k6pz24ci","number":3,"contents":[{"block_type":"element","block":"k6pz2hkn","search_text":"In the previous chapter, we covered many fascinating topics including the way the Go garbage collector works, the panic() and recover() functions, the unsafe package, how to call C code from a Go program, and how to call Go code from a C program. We also addressed the node tree created by the Go compiler when compiling a Go program.","text_count":334,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we covered many fascinating topics including the way the Go garbage collector works, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"recover()"}]},{"block_type":"text","content":"functions, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package, how to call C code from a Go program, and how to call Go code from a C program. We also addressed the node tree created by the Go compiler when compiling a Go program."}]},{"block_type":"element","block":"k6pz2hko","search_text":"The core subject matter of this chapter is the basic data types of Go. This list includes arrays , slices , and maps . Despite their simplicity, these data types can help you store, retrieve, and alter the data in your programs in a very convenient and quick way. Moreover, this chapter will talk about pointers , constants , loops , and working with dates and times, which is a very interesting subject.","text_count":404,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The core subject matter of this chapter is the basic data types of Go. This list includes"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"arrays"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slices"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"maps"}]},{"block_type":"text","content":". Despite their simplicity, these data types can help you store, retrieve, and alter the data in your programs in a very convenient and quick way. Moreover, this chapter will talk about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pointers"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"constants"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"loops"}]},{"block_type":"text","content":", and working with dates and times, which is a very interesting subject."}]},{"block_type":"element","block":"k6pz2hkp","search_text":"In this chapter, you will learn the following topics:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2hkq","search_text":"Go arrays ","text_count":10,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go arrays"}]}]},{"block_type":"element","block":"k6pz2hkr","search_text":"Go slices and why slices are much better than arrays ","text_count":53,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go slices and why slices are much better than arrays"}]}]},{"block_type":"element","block":"k6pz2hks","search_text":"Go maps ","text_count":8,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go maps"}]}]},{"block_type":"element","block":"k6pz2hkt","search_text":"Pointers in Go ","text_count":15,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Pointers in Go"}]}]},{"block_type":"element","block":"k6pz2hku","search_text":"Looping in Go ","text_count":14,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Looping in Go"}]}]},{"block_type":"element","block":"k6pz2hkv","search_text":"Constants in Go ","text_count":16,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Constants in Go"}]}]},{"block_type":"element","block":"k6pz2hkw","search_text":"Working with times ","text_count":19,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Working with times"}]}]},{"block_type":"element","block":"k6pz2hkx","search_text":"Operating with dates ","text_count":21,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Operating with dates"}]}]},{"block_type":"element","block":"k6pz2hky","search_text":"Go loops","text_count":8,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go loops"}]},{"block_type":"element","block":"k6pz2hkz","search_text":"Every programming language has a way of looping, and Go is no exception. Go offers the for loop, which allows you to iterate over many kinds of data types.","text_count":155,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Every programming language has a way of looping, and Go is no exception. Go offers the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, which allows you to iterate over many kinds of data types."}]},{"block_type":"element","block":"k6pz2hl0","search_text":"Tip Go does not offer support for the while keyword. However, the for loops in Go can replace while loops! ","text_count":107,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go does not offer support for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"keyword. However, the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops in Go can replace"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"loops!"}]}]},{"block_type":"element","block":"k6pz2hl1","search_text":"The for loop","text_count":12,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The for loop"}]},{"block_type":"element","block":"k6pz2hl2","search_text":"The most common programming loop type is the for loop, which allows you to iterate for a predefined number of times or for as long as a condition is valid or according to a value that is calculated at the beginning of the for loop. Such values include the size of a slice or an array and the number of the keys on a map. This means that one of the most common ways for accessing all of the elements of an array, a slice, or a map is the for loop. The other way is with the use of the range keyword.","text_count":498,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The most common programming loop type is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, which allows you to iterate for a predefined number of times or for as long as a condition is valid or according to a value that is calculated at the beginning of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. Such values include the size of a slice or an array and the number of the keys on a map. This means that one of the most common ways for accessing all of the elements of an array, a slice, or a map is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. The other way is with the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword."}]},{"block_type":"element","block":"k6pz2hl3","search_text":"The following code shows the simplest form of a for loop, where a given variable takes a range of predefined values:","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following code shows the simplest form of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, where a given variable takes a range of predefined values:"}]},{"block_type":"element","block":"k6pz2hl4","search_text":"for i := 0; i < 100; i++ { } ","text_count":29,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; 100; i++ { \n}"}]}]},{"block_type":"element","block":"k6pz2hl5","search_text":"In the preceding loop, the values that i will take are from 0 to 99 . As soon as i reaches 100 , the execution of the for loop will stop. In this case, i is a local and temporary variable, which means that after the termination of the for loop, i will be garbage collected at some point and disappear. However, if i was defined outside the for loop, it would have kept its value after the termination of the for loop. In that case, the value of i after the termination of the for loop would have been 100 .","text_count":506,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding loop, the values that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"will take are from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"99"}]},{"block_type":"text","content":". As soon as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"reaches"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"100"}]},{"block_type":"text","content":", the execution of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop will stop. In this case,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"is a local and temporary variable, which means that after the termination of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"will be garbage collected at some point and disappear. However, if"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"was defined outside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, it would have kept its value after the termination of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. In that case, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"after the termination of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop would have been"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"100"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hl6","search_text":"You can completely exit a for loop using the break keyword. The break keyword also allows you to create a for loop without an exit condition, such as i < 100 used in the preceding example, because the exit condition can be included in the code block of the for loop. You are also allowed to have multiple exit conditions in a for loop.","text_count":335,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can completely exit a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"break"}]},{"block_type":"text","content":"keyword. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"break"}]},{"block_type":"text","content":"keyword also allows you to create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop without an exit condition, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i &lt; 100"}]},{"block_type":"text","content":"used in the preceding example, because the exit condition can be included in the code block of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. You are also allowed to have multiple exit conditions in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2hl7","search_text":"Additionally, you can skip a single iteration of a for loop using the continue keyword. The continue keyword stops running the block, jumps back up to the top of the for loop, and carries on for the next item.","text_count":209,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you can skip a single iteration of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"continue"}]},{"block_type":"text","content":"keyword. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"continue"}]},{"block_type":"text","content":"keyword stops running the block, jumps back up to the top of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, and carries on for the next item."}]},{"block_type":"element","block":"k6pz2hl8","search_text":"The while loop","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The while loop"}]},{"block_type":"element","block":"k6pz2hl9","search_text":"As discussed earlier, Go does not offer the while keyword for writing while loops, but it allows you to use a for loop instead of a while loop. This section will present two examples where a for loop does the job of a while loop.","text_count":229,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As discussed earlier, Go does not offer the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"keyword for writing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"loops, but it allows you to use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop instead of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"loop. This section will present two examples where a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop does the job of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2hla","search_text":"The following is the typical case where you want to write something like while(condition) :","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following is the typical case where you want to write something like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while(condition)"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2hlb","search_text":"for { } ","text_count":8,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n}"}]}]},{"block_type":"element","block":"k6pz2hlc","search_text":"It is the job of the developer to use the break keyword to exit this for loop!","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is the job of the developer to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"break"}]},{"block_type":"text","content":"keyword to exit this"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop!"}]},{"block_type":"element","block":"k6pz2hld","search_text":"However, the for loop can also emulate a do...while loop that are found in other programming languages. As an example, the following Go code is equivalent to a do...while(anExpression) loop:","text_count":190,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop can also emulate a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"do...while"}]},{"block_type":"text","content":"loop that are found in other programming languages. As an example, the following Go code is equivalent to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"do...while(anExpression)"}]},{"block_type":"text","content":"loop:"}]},{"block_type":"element","block":"k6pz2hle","search_text":"for ok := true; ok; ok = anExpression { } ","text_count":42,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for ok := true; ok; ok = anExpression { \n}"}]}]},{"block_type":"element","block":"k6pz2hlf","search_text":"As soon as the ok variable reaches the false value, the for loop will terminate.","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As soon as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ok"}]},{"block_type":"text","content":"variable reaches the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"value, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop will terminate."}]},{"block_type":"element","block":"k6pz2hlg","search_text":"The range keyword","text_count":17,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The range keyword"}]},{"block_type":"element","block":"k6pz2hlh","search_text":"Go also offers the range keyword, which is used in for loops and allows you to write easy to understand code for iterating over Go data types.","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go also offers the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword, which is used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops and allows you to write easy to understand code for iterating over Go data types."}]},{"block_type":"element","block":"k6pz2hli","search_text":"The main advantage of the range keyword is that you do not need to know the cardinality of a slice or a map in order to process its elements one by one. You will see range in action in a while.","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main advantage of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword is that you do not need to know the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"cardinality"}]},{"block_type":"text","content":"of a slice or a map in order to process its elements one by one. You will see"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"in action in a while."}]},{"block_type":"element","block":"k6pz2hlj","search_text":"Examples of Go for loops","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Examples of Go for loops"}]},{"block_type":"element","block":"k6pz2hlk","search_text":"This section will display multiple examples of for loops. The name of the file is loops.go , and it will be presented in four parts. The first code segment of loops.go is as follows:","text_count":182,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will display multiple examples of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops. The name of the file is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hll","search_text":"package main import ( \"fmt\" ) func main() { for i := 0; i < 100; i++ { if i%20 == 0 { continue } if i == 95 { break } fmt.Print(i, \" \") } ","text_count":138,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n \n    for i := 0; i &lt; 100; i++ { \n        if i%20 == 0 { \n            continue \n        } \n \n        if i == 95 { \n            break \n        } \n \n        fmt.Print(i, \" \") \n    }"}]}]},{"block_type":"element","block":"k6pz2hlm","search_text":"The preceding code shows a typical for loop as well as the use of the continue and break keywords.","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code shows a typical"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop as well as the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"continue"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"break"}]},{"block_type":"text","content":"keywords."}]},{"block_type":"element","block":"k6pz2hln","search_text":"The next code segment is as follows:","text_count":36,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next code segment is as follows:"}]},{"block_type":"element","block":"k6pz2hlo","search_text":"fmt.Println() i := 10 for { if i < 0 { break } fmt.Print(i, \" \") i-- } fmt.Println() ","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println() \n    i := 10 \n    for { \n        if i &lt; 0 { \n            break \n        } \n        fmt.Print(i, \" \") \n        i-- \n    } \n    fmt.Println()"}]}]},{"block_type":"element","block":"k6pz2hlp","search_text":"The preceding code emulates a typical while loop. Note the use of the break keyword to exit the for loop.","text_count":105,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code emulates a typical"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"while"}]},{"block_type":"text","content":"loop. Note the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"break"}]},{"block_type":"text","content":"keyword to exit the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2hlq","search_text":"The third part of loops.go follows next:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hlr","search_text":"i = 0 anExpression := true for ok := true; ok; ok = anExpression { if i > 10 { anExpression = false } fmt.Print(i, \" \") i++ } fmt.Println() ","text_count":140,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"i = 0 \n    anExpression := true \n    for ok := true; ok; ok = anExpression { \n        if i &gt; 10 { \n            anExpression = false \n        } \n \n        fmt.Print(i, \" \") \n        i++ \n    } \n    fmt.Println()"}]}]},{"block_type":"element","block":"k6pz2hls","search_text":"In this part, you see the use of a for loop that does the job of a do...while loop as discussed earlier in this chapter.","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see the use of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that does the job of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"do...while"}]},{"block_type":"text","content":"loop as discussed earlier in this chapter."}]},{"block_type":"element","block":"k6pz2hlt","search_text":"The last part of loops.go is shown in the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hlu","search_text":"anArray := [5]int{0, 1, -1, 2, -2} for i, value := range anArray { fmt.Println(\"index:\", i, \"value: \", value) } } ","text_count":114,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"anArray := [5]int{0, 1, -1, 2, -2} \n    for i, value := range anArray { \n        fmt.Println(\"index:\", i, \"value: \", value) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hlv","search_text":"Applying the range keyword to an array variable returns two values: an array index and the value of the element at that index, respectively. You can use both of them, one of them, or none of them; that is, in case you just want to count the elements of the array.","text_count":263,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Applying the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword to an array variable returns two values: an array index and the value of the element at that index, respectively. You can use both of them, one of them, or none of them; that is, in case you just want to count the elements of the array."}]},{"block_type":"element","block":"k6pz2hlw","search_text":"Executing loops.go will produce the following output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2hlx","search_text":"$ go run loops.go 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 81 82 83 84 85 86 87 88 89 90 91 92 93 94 10 9 8 7 6 5 4 3 2 1 0 0 1 2 3 4 5 6 7 8 9 10 11 index: 0 value: 0 index: 1 value: 1 index: 2 value: -1 index: 3 value: 2 index: 4 value: -2 ","text_count":420,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run loops.go\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 81 82 83 84 85 86 87 88 89 90 91 92 93 94\n10 9 8 7 6 5 4 3 2 1 0\n0 1 2 3 4 5 6 7 8 9 10 11\nindex: 0 value:  0\nindex: 1 value:  1\nindex: 2 value:  -1\nindex: 3 value:  2\nindex: 4 value:  -2"}]}]},{"block_type":"element","block":"k6pz2hly","search_text":"Go arrays","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go arrays"}]},{"block_type":"element","block":"k6pz2hlz","search_text":"Arrays are one of the most popular data structures for two reasons: arrays are simple and easy to understand and they are very versatile and can store many different kinds of data.","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Arrays"}]},{"block_type":"text","content":"are one of the most popular data structures for two reasons: arrays are simple and easy to understand and they are very versatile and can store many different kinds of data."}]},{"block_type":"element","block":"k6pz2hm0","search_text":"You can declare an array that stores four integers as follows:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can declare an array that stores four integers as follows:"}]},{"block_type":"element","block":"k6pz2hm1","search_text":"anArray := [4]int{1, 2, 4, -4} ","text_count":31,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"anArray := [4]int{1, 2, 4, -4}"}]}]},{"block_type":"element","block":"k6pz2hm2","search_text":"The size of the array is stated before its type, which is defined before its elements. You can find the length of an array with the help of the len() function: len(anArray) .","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The size of the array is stated before its type, which is defined before its elements. You can find the length of an array with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len()"}]},{"block_type":"text","content":"function:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(anArray)"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hm3","search_text":"The index of the first element of any dimension of an array is 0, the index of the second element of any array dimension is 1, and so on. This means that for an array with one dimension named a , the valid indexes are from 0 to len(a)-1 .","text_count":238,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The index of the first element of any dimension of an array is 0, the index of the second element of any array dimension is 1, and so on. This means that for an array with one dimension named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":", the valid indexes are from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(a)-1"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hm4","search_text":"Although you might be familiar with accessing the elements of an array in other programming languages using a for loop and a numeric variable, there are cooler ways to visit all of the elements of an array in Go that involve the use of the range keyword and that allow you to bypass the use of the len() function in the for loop. Look to the Go code of loops.go for such an example.","text_count":382,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you might be familiar with accessing the elements of an array in other programming languages using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop and a numeric variable, there are cooler ways to visit all of the elements of an array in Go that involve the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword and that allow you to bypass the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len()"}]},{"block_type":"text","content":"function in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. Look to the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"loops.go"}]},{"block_type":"text","content":"for such an example."}]},{"block_type":"element","block":"k6pz2hm5","search_text":"Multi-dimensional arrays","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Multi-dimensional arrays"}]},{"block_type":"element","block":"k6pz2hm6","search_text":"Arrays can have more than one dimension. However, using more than three dimensions without a serious reason can make your program difficult to read and might create bugs.","text_count":170,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Arrays can have more than one dimension. However, using more than three dimensions without a serious reason can make your program difficult to read and might create bugs."}]},{"block_type":"element","block":"k6pz2hm7","search_text":"Tip Arrays can store all the types of elements. We are just using integers here because they are easier to understand and type. ","text_count":128,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Arrays can store all the types of elements. We are just using integers here because they are easier to understand and type."}]}]},{"block_type":"element","block":"k6pz2hm8","search_text":"The following Go code shows how you can create an array with two dimensions ( twoD ) and another one with three dimensions ( threeD ):","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following Go code shows how you can create an array with two dimensions ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoD"}]},{"block_type":"text","content":") and another one with three dimensions ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"threeD"}]},{"block_type":"text","content":"):"}]},{"block_type":"element","block":"k6pz2hm9","search_text":"twoD := [4][4]int{{1, 2, 3, 4}, {5, 6, 7, 8}, {9, 10, 11, 12}, {13, 14, 15, 16}} threeD := [2][2][2]int{{{1, 0}, {-2, 4}}, {{5, -1}, {7, 0}}} ","text_count":142,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"twoD := [4][4]int{{1, 2, 3, 4}, {5, 6, 7, 8}, {9, 10, 11, 12}, \n{13, 14, 15, 16}} \nthreeD := [2][2][2]int{{{1, 0}, {-2, 4}}, {{5, -1}, {7, 0}}}"}]}]},{"block_type":"element","block":"k6pz2hma","search_text":"Accessing, assigning, or printing a single element from one of the previous two arrays can be done easily. As an example, the first element of the twoD array is twoD[0][0] and its value is 1 .","text_count":192,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Accessing, assigning, or printing a single element from one of the previous two arrays can be done easily. As an example, the first element of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoD"}]},{"block_type":"text","content":"array is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoD[0][0]"}]},{"block_type":"text","content":"and its value is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hmb","search_text":"Therefore, accessing all of the elements of the twoD array with the help of multiple for loops can be done as follows:","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Therefore, accessing all of the elements of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoD"}]},{"block_type":"text","content":"array with the help of multiple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops can be done as follows:"}]},{"block_type":"element","block":"k6pz2hmc","search_text":"for i := 0; i < len(threeD); i++ { for j := 0; j < len(v); j++ { for k := 0; k < len(m); k++ { } } } ","text_count":101,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; len(threeD); i++ { \n        for j := 0; j &lt; len(v); j++ { \n            for k := 0; k &lt; len(m); k++ { \n            } \n        } \n    }"}]}]},{"block_type":"element","block":"k6pz2hmd","search_text":"As you can see, you need as many for loops as the dimensions of the array in order to access all of its elements. The same rules apply to slices, which will be presented in the next section.","text_count":190,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, you need as many"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops as the dimensions of the array in order to access all of its elements. The same rules apply to slices, which will be presented in the next section."}]},{"block_type":"element","block":"k6pz2hme","search_text":"The code of usingArrays.go , which will be presented in three parts, presents a complete example of how to deal with arrays in Go.","text_count":130,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingArrays.go"}]},{"block_type":"text","content":", which will be presented in three parts, presents a complete example of how to deal with arrays in Go."}]},{"block_type":"element","block":"k6pz2hmf","search_text":"The first part of the code is as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the code is as follows:"}]},{"block_type":"element","block":"k6pz2hmg","search_text":"package main import ( \"fmt\" ) func main() { anArray := [4]int{1, 2, 4, -4} twoD := [4][4]int{{1, 2, 3, 4}, {5, 6, 7, 8}, {9, 10, 11, 12}, {13, 14, 15, 16}} threeD := [2][2][2]int{{{1, 0}, {-2, 4}}, {{5, -1}, {7, 0}}} ","text_count":217,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    anArray := [4]int{1, 2, 4, -4} \n    twoD := [4][4]int{{1, 2, 3, 4}, {5, 6, 7, 8}, {9, 10, 11, 12}, \n {13, 14, 15, 16}} \n    threeD := [2][2][2]int{{{1, 0}, {-2, 4}}, {{5, -1}, {7, 0}}}"}]}]},{"block_type":"element","block":"k6pz2hmh","search_text":"Here, you define three array variables, named anArray , twoD , and threeD , respectively.","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here, you define three array variables, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anArray"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoD"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"threeD"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2hmi","search_text":"The second part of usingArrays.go is shown here:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingArrays.go"}]},{"block_type":"text","content":"is shown here:"}]},{"block_type":"element","block":"k6pz2hmj","search_text":"fmt.Println(\"The length of\", anArray, \"is\", len(anArray)) fmt.Println(\"The first element of\", twoD, \"is\", twoD[0][0]) fmt.Println(\"The length of\", threeD, \"is\", len(threeD)) for i := 0; i < len(threeD); i++ { v := threeD[i] for j := 0; j < len(v); j++ { m := v[j] for k := 0; k < len(m); k++ { fmt.Print(m[k], \" \") } } fmt.Println() } ","text_count":335,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"The length of\", anArray, \"is\", len(anArray)) \n    fmt.Println(\"The first element of\", twoD, \"is\", twoD[0][0]) \n    fmt.Println(\"The length of\", threeD, \"is\", len(threeD)) \n \n    for i := 0; i &lt; len(threeD); i++ { \n        v := threeD[i] \n        for j := 0; j &lt; len(v); j++ { \n            m := v[j] \n            for k := 0; k &lt; len(m); k++ { \n                fmt.Print(m[k], \" \") \n            } \n        } \n        fmt.Println() \n    }"}]}]},{"block_type":"element","block":"k6pz2hmk","search_text":"What you get from the first for loop is a two-dimensional array ( threeD[i] ), whereas what you get from the second for loop is an array with one dimension ( v[j] ). The last for loop iterates over the elements of the array with one dimension.","text_count":243,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What you get from the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop is a two-dimensional array ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"threeD[i]"}]},{"block_type":"text","content":"), whereas what you get from the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop is an array with one dimension ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v[j]"}]},{"block_type":"text","content":"). The last"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop iterates over the elements of the array with one dimension."}]},{"block_type":"element","block":"k6pz2hml","search_text":"The last code part is shown in the following Go code:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code part is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hmm","search_text":"for _, v := range threeD { for _, m := range v { for _, s := range m { fmt.Print(s, \" \") } } fmt.Println() } } ","text_count":111,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, v := range threeD { \n        for _, m := range v { \n            for _, s := range m { \n                fmt.Print(s, \" \") \n            } \n        } \n        fmt.Println() \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hmn","search_text":"The range keyword does exactly the same job as the iteration variables used in the for loops of the preceding code segment, but it does so in a more elegant and clearer way.","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword does exactly the same job as the iteration variables used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loops of the preceding code segment, but it does so in a more elegant and clearer way."}]},{"block_type":"element","block":"k6pz2hmo","search_text":"Tip The range keyword also works with Go maps, which makes it pretty handy and my preferred way of iteration. ","text_count":110,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword also works with Go maps, which makes it pretty handy and my preferred way of iteration."}]}]},{"block_type":"element","block":"k6pz2hmp","search_text":"Executing usingArrays.go generates the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingArrays.go"}]},{"block_type":"text","content":"generates the following output:"}]},{"block_type":"element","block":"k6pz2hmq","search_text":"$ go run usingArrays.go The length of [1 2 4 -4] is 4 The first element of [[1 2 3 4] [5 6 7 8] [9 10 11 12] [13 14 15 16]] is 1 The length of [[[1 0] [-2 4]] [[5 -1] [7 0]]] is 2 1 0 -2 4 5 -1 7 0 1 0 -2 4 5 -1 7 0 ","text_count":216,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run usingArrays.go\nThe length of [1 2 4 -4] is 4\nThe first element of [[1 2 3 4] [5 6 7 8] [9 10 11 12] [13 14 15 16]] is 1\nThe length of [[[1 0] [-2 4]] [[5 -1] [7 0]]] is 2\n1 0 -2 4\n5 -1 7 0\n1 0 -2 4\n5 -1 7 0"}]}]},{"block_type":"element","block":"k6pz2hmr","search_text":"One of the biggest problems with arrays is out-of-bounds errors, which means trying to access an element that does not exist. It's like trying to access the sixth element of an array with only five elements. The Go compiler considers issues that can be detected as compiler errors because this helps the development workflow. Therefore, the Go compiler can detect out-of-bounds array access errors as follows:","text_count":409,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One of the biggest problems with arrays is out-of-bounds errors, which means trying to access an element that does not exist. It's like trying to access the sixth element of an array with only five elements. The Go compiler considers issues that can be detected as compiler errors because this helps the development workflow. Therefore, the Go compiler can detect out-of-bounds array access errors as follows:"}]},{"block_type":"element","block":"k6pz2hms","search_text":"./a.go:10: invalid array index -1 (index must be non-negative) ./a.go:10: invalid array index 20 (out of bounds for 2-element array)","text_count":132,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"./a.go:10: invalid array index -1 (index must be non-negative)\n./a.go:10: invalid array index 20 (out of bounds for 2-element array)"}]}]},{"block_type":"element","block":"k6pz2hmt","search_text":"The shortcomings of Go arrays","text_count":29,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The shortcomings of Go arrays"}]},{"block_type":"element","block":"k6pz2hmu","search_text":"Go arrays have many disadvantages that will make you reconsider using them in your Go projects. First of all, once you define an array, you cannot change its size, which means that Go arrays are not dynamic. Putting it simply, if you need to add an element to an existing array that has no space left, you will need to create a bigger array and copy all of the elements of the old array to the new one. Second, when you pass an array to a function as a parameter, you actually pass a copy of the array, which means that any changes you make to an array inside a function will be lost after the function exits. Last, passing a large array to a function can be pretty slow, mostly because Go has to create a copy of the array. The solution to all of these problems is to use Go slices, which will be presented in the next section.","text_count":828,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go arrays have many disadvantages that will make you reconsider using them in your Go projects. First of all, once you define an array, you cannot change its size, which means that Go arrays are not dynamic. Putting it simply, if you need to add an element to an existing array that has no space left, you will need to create a bigger array and copy all of the elements of the old array to the new one. Second, when you pass an array to a function as a parameter, you actually pass a copy of the array, which means that any changes you make to an array inside a function will be lost after the function exits. Last, passing a large array to a function can be pretty slow, mostly because Go has to create a copy of the array. The solution to all of these problems is to use Go slices, which will be presented in the next section."}]},{"block_type":"element","block":"k6pz2hmv","search_text":"Tip WARNING: Because of their disadvantages, arrays are rarely used in Go! ","text_count":75,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"WARNING: Because of their disadvantages, arrays are rarely used in Go!"}]}]},{"block_type":"element","block":"k6pz2hmw","search_text":"Go slices","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go slices"}]},{"block_type":"element","block":"k6pz2hmx","search_text":"Go slices are very powerful, and it would not be an exaggeration to say that slices could totally replace the use of arrays in Go. There are only a few occasions where you will need to use an array instead of a slice. The most obvious one is when you are absolutely sure that you will need to store a fixed number of elements.","text_count":326,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slices"}]},{"block_type":"text","content":"are very powerful, and it would not be an exaggeration to say that slices could totally replace the use of arrays in Go. There are only a few occasions where you will need to use an array instead of a slice. The most obvious one is when you are absolutely sure that you will need to store a fixed number of elements."}]},{"block_type":"element","block":"k6pz2hmy","search_text":"Tip Slices are implemented using arrays internally, which means that Go uses an underlying array for each slice. ","text_count":113,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Slices are implemented using arrays internally, which means that Go uses an underlying array for each slice."}]}]},{"block_type":"element","block":"k6pz2hmz","search_text":"As slices are passed by reference to functions, which means that what is actually passed is the memory address of the slice variable, any modifications that you make to a slice inside a function will not get lost after the function exits. Additionally, passing a big slice to a function is significantly faster than passing an array with the same number of elements because Go will not have to make a copy of the slice—it will just pass the memory address of the slice variable.","text_count":478,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As slices are"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"passed by reference"}]},{"block_type":"text","content":"to functions, which means that what is actually passed is the memory address of the slice variable, any modifications that you make to a slice inside a function will not get lost after the function exits. Additionally, passing a big slice to a function is significantly faster than passing an array with the same number of elements because Go will not have to make a copy of the slice&mdash;it will just pass the memory address of the slice variable."}]},{"block_type":"element","block":"k6pz2hn0","search_text":"Performing basic operations on slices","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Performing basic operations on slices"}]},{"block_type":"element","block":"k6pz2hn1","search_text":"You can create a new slice literal as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can create a new slice literal as follows:"}]},{"block_type":"element","block":"k6pz2hn2","search_text":"aSliceLiteral := []int{1, 2, 3, 4, 5} ","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"aSliceLiteral := []int{1, 2, 3, 4, 5}"}]}]},{"block_type":"element","block":"k6pz2hn3","search_text":"This means that slice literals are defined just like arrays but without the element count. If you put an element count in a definition, you will get an array instead!","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slice literals"}]},{"block_type":"text","content":"are defined just like arrays but without the element count. If you put an element count in a definition, you will get an array instead!"}]},{"block_type":"element","block":"k6pz2hn4","search_text":"However, there is also the make() function that allows you to create empty slices with the desired length and capacity as the parameters passed to make() . The capacity parameter can be omitted. In that case, the capacity of the slice will be the same as its length.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, there is also the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make()"}]},{"block_type":"text","content":"function that allows you to create empty slices with the desired"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"length"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"capacity"}]},{"block_type":"text","content":"as the parameters passed to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make()"}]},{"block_type":"text","content":". The capacity parameter can be omitted. In that case, the capacity of the slice will be the same as its length."}]},{"block_type":"element","block":"k6pz2hn5","search_text":"You can define a new empty slice with 20 places that can be automatically expanded when needed as follows:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can define a new empty slice with 20 places that can be automatically expanded when needed as follows:"}]},{"block_type":"element","block":"k6pz2hn6","search_text":"integer := make([]int, 20) ","text_count":27,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"integer := make([]int, 20)"}]}]},{"block_type":"element","block":"k6pz2hn7","search_text":"Please note that Go automatically initializes the elements of an empty slice to the zero value of its type, which means that the value of the initialization depends on the type of the object stored in the slice. Although it is good to know that Go initializes the elements of every slice created with make , you should not make any assumptions based on this fact because that behavior might change in the future.","text_count":412,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please note that Go automatically initializes the elements of an empty slice to the zero value of its type, which means that the value of the initialization depends on the type of the object stored in the slice. Although it is good to know that Go initializes the elements of every slice created with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":", you should not make any assumptions based on this fact because that behavior might change in the future."}]},{"block_type":"element","block":"k6pz2hn8","search_text":"After that, you can access all of the elements of a slice in the following way:","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you can access all of the elements of a slice in the following way:"}]},{"block_type":"element","block":"k6pz2hn9","search_text":"for i := 0; i < len(integer); i++ { fmt.Println(integer[i]) } ","text_count":62,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; len(integer); i++ { \n        fmt.Println(integer[i]) \n    }"}]}]},{"block_type":"element","block":"k6pz2hna","search_text":"If you want to empty an existing slice, the zero value for a slice variable is nil .","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to empty an existing slice, the zero value for a slice variable is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hnb","search_text":"aSliceLiteral = nil ","text_count":20,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"aSliceLiteral = nil"}]}]},{"block_type":"element","block":"k6pz2hnc","search_text":"You can add an element to the slice, which will automatically increase its size, using the append() function:","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can add an element to the slice, which will automatically increase its size, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"append()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2hnd","search_text":"integer = append(integer, -5000) ","text_count":33,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"integer = append(integer, -5000)"}]}]},{"block_type":"element","block":"k6pz2hne","search_text":"You can access the first element of the integer slice as integer[0] , whereas you can access the last element of the integer slice as integer[len(integer)-1] .","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can access the first element of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"integer"}]},{"block_type":"text","content":"slice as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"integer[0]"}]},{"block_type":"text","content":", whereas you can access the last element of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"integer"}]},{"block_type":"text","content":"slice as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"integer[len(integer)-1]"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hnf","search_text":"Also, you can access multiple continuous slice elements using the [:] notation. The next statement selects the second and the third elements of a slice:","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Also, you can access multiple continuous slice elements using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation. The next statement selects the second and the third elements of a slice:"}]},{"block_type":"element","block":"k6pz2hng","search_text":"integer[1:3] ","text_count":13,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"integer[1:3]"}]}]},{"block_type":"element","block":"k6pz2hnh","search_text":"Additionally, you can use [:] notation for creating a new slice from an existing slice or array:","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation for creating a new slice from an existing slice or array:"}]},{"block_type":"element","block":"k6pz2hni","search_text":"s2 := integer[1:3] ","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s2 := integer[1:3]"}]}]},{"block_type":"element","block":"k6pz2hnj","search_text":"Please note that this process is called re-slicing , and it can cause problems in some cases. Examine the following program:","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please note that this process is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"re-slicing"}]},{"block_type":"text","content":", and it can cause problems in some cases. Examine the following program:"}]},{"block_type":"element","block":"k6pz2hnk","search_text":"package main import \"fmt\" func main() { s1 := make([]int, 5) reSlice := s1[1:3] fmt.Println(s1) fmt.Println(reSlice) reSlice[0] = -100 reSlice[1] = 123456 fmt.Println(s1) fmt.Println(reSlice) } ","text_count":194,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport \"fmt\" \n \nfunc main() { \n \n    s1 := make([]int, 5) \n    reSlice := s1[1:3] \n    fmt.Println(s1) \n    fmt.Println(reSlice) \n \n    reSlice[0] = -100 \n    reSlice[1] = 123456 \n    fmt.Println(s1) \n    fmt.Println(reSlice) \n \n}"}]}]},{"block_type":"element","block":"k6pz2hnl","search_text":"First, note that in order to select the second and third elements of a slice using the [:] notation, you should use [1:3] , which means starting with index number 1 and going up to index number 3, without including index number 3.","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, note that in order to select the second and third elements of a slice using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation, you should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[1:3]"}]},{"block_type":"text","content":", which means starting with index number 1 and going up to index number 3, without including index number 3."}]},{"block_type":"element","block":"k6pz2hnm","search_text":"Tip Given an array a1 , you can create a slice s1 that references that array by executing s1 := a1[:] . ","text_count":104,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Given an array"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a1"}]},{"block_type":"text","content":", you can create a slice"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":"that references that array by executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1 := a1[:]"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hnn","search_text":"Executing the preceding code, which is saved as reslice.go , will create the next output:","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the preceding code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reslice.go"}]},{"block_type":"text","content":", will create the next output:"}]},{"block_type":"element","block":"k6pz2hno","search_text":"$ go run reslice.go [0 0 0 0 0] [0 0] [0 -100 123456 0 0] [-100 123456]","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run reslice.go\n[0 0 0 0 0]\n[0 0]\n[0 -100 123456 0 0]\n[-100 123456]"}]}]},{"block_type":"element","block":"k6pz2hnp","search_text":"At the end of the program, the contents of the s1 slice will be [0 -100 123456 0 0] , even though we did not change them directly. This means that altering the elements of a re-slice modifies the element of the original slice because both slices point to the same memory address! Put simply, the re-slice process does not make a copy of the original slice.","text_count":356,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the end of the program, the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":"slice will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[0 -100 123456 0 0]"}]},{"block_type":"text","content":", even though we did not change them directly. This means that altering the elements of a re-slice modifies the element of the original slice because both slices point to the same memory address! Put simply, the re-slice process does not make a copy of the original slice."}]},{"block_type":"element","block":"k6pz2hnq","search_text":"The second problem of re-slicing is that, even if you re-slice a slice in order to use a small part of the original slice, the underlying array from the original slice will be kept in memory for as long as the smaller re-slice exists because the original slice is being referenced by the smaller re-slice. Although this is not truly important for small slices, it can cause problems when you are reading big files into slices and you only want to use a small part of them.","text_count":472,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second problem of re-slicing is that, even if you re-slice a slice in order to use a small part of the original slice, the underlying array from the original slice will be kept in memory for as long as the smaller re-slice exists because the original slice is being referenced by the smaller re-slice. Although this is not truly important for small slices, it can cause problems when you are reading big files into slices and you only want to use a small part of them."}]},{"block_type":"element","block":"k6pz2hnr","search_text":"Slices are being expanded automatically","text_count":39,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Slices are being expanded automatically"}]},{"block_type":"element","block":"k6pz2hns","search_text":"Slices have two main properties: capacity and length . The tricky part is that usually these two properties have different values. The length of a slice is the same as the length of an array with the same number of elements and can be found using the len() function. The capacity of a slice is the current room that has been allocated for this particular slice, and it can be found with the cap() function. As slices are dynamic in size, if a slice runs out of room, Go automatically doubles its current length to make room for more elements.","text_count":542,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Slices have two main properties:"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"capacity"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"length"}]},{"block_type":"text","content":". The tricky part is that usually these two properties have different values. The length of a slice is the same as the length of an array with the same number of elements and can be found using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len()"}]},{"block_type":"text","content":"function. The capacity of a slice is the current room that has been allocated for this particular slice, and it can be found with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cap()"}]},{"block_type":"text","content":"function. As slices are dynamic in size, if a slice runs out of room, Go automatically doubles its current length to make room for more elements."}]},{"block_type":"element","block":"k6pz2hnt","search_text":"Put simply, if the length and the capacity of a slice have the same values and you try to add another element to the slice, the capacity of the slice will be doubled, whereas its length will be increased by one. Although this might work well for small slices, adding a single element to a really huge slice might take more memory than expected.","text_count":344,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Put simply, if the length and the capacity of a slice have the same values and you try to add another element to the slice, the capacity of the slice will be doubled, whereas its length will be increased by one. Although this might work well for small slices, adding a single element to a really huge slice might take more memory than expected."}]},{"block_type":"element","block":"k6pz2hnu","search_text":"The code of lenCap.go illustrates the concepts of capacity and length in more detail, and it will be presented in three parts. The first part of the program follows:","text_count":165,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lenCap.go"}]},{"block_type":"text","content":"illustrates the concepts of capacity and length in more detail, and it will be presented in three parts. The first part of the program follows:"}]},{"block_type":"element","block":"k6pz2hnv","search_text":"package main import ( \"fmt\" ) func printSlice(x []int) { for _, number := range x { fmt.Print(number, \" \") } fmt.Println() } ","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc printSlice(x []int) { \n    for _, number := range x { \n        fmt.Print(number, \" \") \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2hnw","search_text":"The printSlice() function helps you print a one-dimensional slice without having to repeat the same Go code all of the time.","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printSlice()"}]},{"block_type":"text","content":"function helps you print a one-dimensional slice without having to repeat the same Go code all of the time."}]},{"block_type":"element","block":"k6pz2hnx","search_text":"The second part of lenCap.go contains the next piece of Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lenCap.go"}]},{"block_type":"text","content":"contains the next piece of Go code:"}]},{"block_type":"element","block":"k6pz2hny","search_text":"func main() { aSlice := []int{-1, 0, 4} fmt.Printf(\"aSlice: \") printSlice(aSlice) fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice)) aSlice = append(aSlice, -100) fmt.Printf(\"aSlice: \") printSlice(aSlice) fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice)) ","text_count":278,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    aSlice := []int{-1, 0, 4} \n    fmt.Printf(\"aSlice: \") \n    printSlice(aSlice) \n \n    fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice)) \n    aSlice = append(aSlice, -100) \n    fmt.Printf(\"aSlice: \") \n    printSlice(aSlice) \n    fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice))"}]}]},{"block_type":"element","block":"k6pz2hnz","search_text":"In this part, as well as the next one, you will add some elements to the aSlice slice to alter its length and its capacity.","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, as well as the next one, you will add some elements to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aSlice"}]},{"block_type":"text","content":"slice to alter its length and its capacity."}]},{"block_type":"element","block":"k6pz2ho0","search_text":"The last portion of Go code is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last portion of Go code is as follows:"}]},{"block_type":"element","block":"k6pz2ho1","search_text":"aSlice = append(aSlice, -2) aSlice = append(aSlice, -3) aSlice = append(aSlice, -4) printSlice(aSlice) fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice)) } ","text_count":167,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"aSlice = append(aSlice, -2) \n    aSlice = append(aSlice, -3) \n    aSlice = append(aSlice, -4) \n    printSlice(aSlice) \n    fmt.Printf(\"Cap: %d, Length: %d\\n\", cap(aSlice), len(aSlice)) \n}"}]}]},{"block_type":"element","block":"k6pz2ho2","search_text":"The execution of lenCap.go will create the following output:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lenCap.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2ho3","search_text":"$ go run lenCap.go aSlice: -1 0 4 Cap: 3, Length: 3 aSlice: -1 0 4 -100 Cap: 6, Length: 4 -1 0 4 -100 -2 -3 -4 Cap: 12, Length: 7 ","text_count":130,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run lenCap.go\naSlice: -1 0 4\nCap: 3, Length: 3\naSlice: -1 0 4 -100\nCap: 6, Length: 4\n-1 0 4 -100 -2 -3 -4\nCap: 12, Length: 7"}]}]},{"block_type":"element","block":"k6pz2ho4","search_text":"As you can see, the initial size of the slice was 3. As a result, the initial value of its capacity was also 3. After adding one element to the slice, its size became 4, whereas its capacity became 6. After adding three more elements to the slice, its size became 7, whereas its capacity was doubled one more time and became 12.","text_count":328,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the initial size of the slice was 3. As a result, the initial value of its capacity was also 3. After adding one element to the slice, its size became 4, whereas its capacity became 6. After adding three more elements to the slice, its size became 7, whereas its capacity was doubled one more time and became 12."}]},{"block_type":"element","block":"k6pz2ho5","search_text":"Byte slices","text_count":11,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Byte slices"}]},{"block_type":"element","block":"k6pz2ho6","search_text":"A byte slice is a slice where its type is byte . You can create a new byte slice named s as follows:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slice"}]},{"block_type":"text","content":"is a slice where its type is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byte"}]},{"block_type":"text","content":". You can create a new byte slice named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2ho7","search_text":"s := make([]byte, 5) ","text_count":21,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s := make([]byte, 5)"}]}]},{"block_type":"element","block":"k6pz2ho8","search_text":"There is nothing special in the way that you can access a byte slice compared to the other types of slices. It is just that byte slices are used in file input and output operations. You will see byte slices in action in Chapter 8, Telling a Unix System What to Do .","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is nothing special in the way that you can access a byte slice compared to the other types of slices. It is just that byte slices are used in file input and output operations. You will see byte slices in action in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ho9","search_text":"The copy() function","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The copy() function"}]},{"block_type":"element","block":"k6pz2hoa","search_text":"You can create a slice from the elements of an existing array, and you can copy an existing slice to another one using the copy() function. However, as the use of copy() can be very tricky, this subsection will try to clarify its usage with the help of the Go code of copySlice.go , which will be presented in four parts.","text_count":321,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can create a slice from the elements of an existing array, and you can copy an existing slice to another one using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copy()"}]},{"block_type":"text","content":"function. However, as the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copy()"}]},{"block_type":"text","content":"can be very tricky, this subsection will try to clarify its usage with the help of the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copySlice.go"}]},{"block_type":"text","content":", which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2hob","search_text":"Tip You should be very careful when using the copy() function on slices because the built-in copy(dst, src) copies the minimum of the len(dst) and len(src) elements. ","text_count":166,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should be very careful when using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copy()"}]},{"block_type":"text","content":"function on slices because the built-in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copy(dst, src)"}]},{"block_type":"text","content":"copies the minimum of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(dst)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(src)"}]},{"block_type":"text","content":"elements."}]}]},{"block_type":"element","block":"k6pz2hoc","search_text":"The first part of the program is shown in the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hod","search_text":"package main import ( \"fmt\" ) func main() { a6 := []int{-10, 1, 2, 3, 4, 5} a4 := []int{-1, -2, -3, -4} fmt.Println(\"a6:\", a6) fmt.Println(\"a4:\", a4) copy(a6, a4) fmt.Println(\"a6:\", a6) fmt.Println(\"a4:\", a4) fmt.Println() ","text_count":223,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n \n    a6 := []int{-10, 1, 2, 3, 4, 5} \n    a4 := []int{-1, -2, -3, -4} \n    fmt.Println(\"a6:\", a6) \n    fmt.Println(\"a4:\", a4) \n \n    copy(a6, a4) \n    fmt.Println(\"a6:\", a6) \n    fmt.Println(\"a4:\", a4) \n    fmt.Println()"}]}]},{"block_type":"element","block":"k6pz2hoe","search_text":"In the preceding code, we define two slices named a6 and a4 , print them, and then try to copy a4 to a6 . As a6 has more elements than a4 , all of the elements of a4 will be copied to a6 . However, as a4 has only four elements and a6 has six elements, the last two elements of a6 will remain the same.","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, we define two slices named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a4"}]},{"block_type":"text","content":", print them, and then try to copy"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a4"}]},{"block_type":"text","content":"to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":". As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":"has more elements than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a4"}]},{"block_type":"text","content":", all of the elements of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a4"}]},{"block_type":"text","content":"will be copied to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":". However, as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a4"}]},{"block_type":"text","content":"has only four elements and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":"has six elements, the last two elements of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a6"}]},{"block_type":"text","content":"will remain the same."}]},{"block_type":"element","block":"k6pz2hof","search_text":"The second part of copySlice.go is as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copySlice.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hog","search_text":"b6 := []int{-10, 1, 2, 3, 4, 5} b4 := []int{-1, -2, -3, -4} fmt.Println(\"b6:\", b6) fmt.Println(\"b4:\", b4) copy(b4, b6) fmt.Println(\"b6:\", b6) fmt.Println(\"b4:\", b4) ","text_count":165,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"b6 := []int{-10, 1, 2, 3, 4, 5} \n    b4 := []int{-1, -2, -3, -4} \n    fmt.Println(\"b6:\", b6) \n    fmt.Println(\"b4:\", b4) \n    copy(b4, b6) \n    fmt.Println(\"b6:\", b6) \n    fmt.Println(\"b4:\", b4)"}]}]},{"block_type":"element","block":"k6pz2hoh","search_text":"In this case, only the first four elements of b6 will be copied to b4 because b4 has only four elements.","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case, only the first four elements of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b6"}]},{"block_type":"text","content":"will be copied to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b4"}]},{"block_type":"text","content":"because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b4"}]},{"block_type":"text","content":"has only four elements."}]},{"block_type":"element","block":"k6pz2hoi","search_text":"The third code segment of copySlice.go is shown in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copySlice.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hoj","search_text":"fmt.Println() array4 := [4]int{4, -4, 4, -4} s6 := []int{1, 1, -1, -1, 5, -5} copy(s6, array4[0:]) fmt.Println(\"array4:\", array4[0:]) fmt.Println(\"s6:\", s6) fmt.Println() ","text_count":171,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println() \n    array4 := [4]int{4, -4, 4, -4} \n    s6 := []int{1, 1, -1, -1, 5, -5} \n    copy(s6, array4[0:]) \n    fmt.Println(\"array4:\", array4[0:]) \n    fmt.Println(\"s6:\", s6) \n    fmt.Println()"}]}]},{"block_type":"element","block":"k6pz2hok","search_text":"Here you try to copy an array with four elements to a slice with six elements. Note that the array is converted to a slice with the help of the [:] notation ( array4[0:] ).","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you try to copy an array with four elements to a slice with six elements. Note that the array is converted to a slice with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"array4[0:]"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2hol","search_text":"The last code portion of copySlice.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copySlice.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hom","search_text":"array5 := [5]int{5, -5, 5, -5, 5} s7 := []int{7, 7, -7, -7, 7, -7, 7} copy(array5[0:], s7) fmt.Println(\"array5:\", array5) fmt.Println(\"s7:\", s7) } ","text_count":147,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"array5 := [5]int{5, -5, 5, -5, 5} \n    s7 := []int{7, 7, -7, -7, 7, -7, 7} \n    copy(array5[0:], s7) \n    fmt.Println(\"array5:\", array5) \n    fmt.Println(\"s7:\", s7) \n}"}]}]},{"block_type":"element","block":"k6pz2hon","search_text":"Here you can see how to copy a slice to an array that has places for five elements. As copy() only accepts slice arguments, you should also use the [:] notation to convert the array into a slice.","text_count":195,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see how to copy a slice to an array that has places for five elements. As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copy()"}]},{"block_type":"text","content":"only accepts slice arguments, you should also use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation to convert the array into a slice."}]},{"block_type":"element","block":"k6pz2hoo","search_text":"If you try to copy an array into a slice or vice versa without using the [:] notation, the program will fail to compile and will display one of the following error messages:","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to copy an array into a slice or vice versa without using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation, the program will fail to compile and will display one of the following error messages:"}]},{"block_type":"element","block":"k6pz2hop","search_text":"# command-line-arguments ./a.go:42:6: first argument to copy should be slice; have [5]int ./a.go:43:6: second argument to copy should be slice or string; have [5]int ./a.go:44:6: arguments to copy must be slices; have [5]int, [5]int","text_count":232,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"# command-line-arguments\n./a.go:42:6: first argument to copy should be slice; have [5]int\n./a.go:43:6: second argument to copy should be slice or string; have \n[5]int\n./a.go:44:6: arguments to copy must be slices; have [5]int, [5]int"}]}]},{"block_type":"element","block":"k6pz2hoq","search_text":"Executing copySlice.go will create the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"copySlice.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hor","search_text":"$ go run copySlice.go a6: [-10 1 2 3 4 5] a4: [-1 -2 -3 -4] a6: [-1 -2 -3 -4 4 5] a4: [-1 -2 -3 -4] b6: [-10 1 2 3 4 5] b4: [-1 -2 -3 -4] b6: [-10 1 2 3 4 5] b4: [-10 1 2 3] array4: [4 -4 4 -4] s6: [4 -4 4 -4 5 -5] array5: [7 7 -7 -7 7] s7: [7 7 -7 -7 7 -7 7]","text_count":259,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run copySlice.go\na6: [-10 1 2 3 4 5]\na4: [-1 -2 -3 -4]\na6: [-1 -2 -3 -4 4 5]\na4: [-1 -2 -3 -4]\n \nb6: [-10 1 2 3 4 5]\nb4: [-1 -2 -3 -4]\nb6: [-10 1 2 3 4 5]\nb4: [-10 1 2 3]\n  \narray4: [4 -4 4 -4]\ns6: [4 -4 4 -4 5 -5]\n   \narray5: [7 7 -7 -7 7]\ns7: [7 7 -7 -7 7 -7 7]"}]}]},{"block_type":"element","block":"k6pz2hos","search_text":"Multidimensional slices","text_count":23,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Multidimensional slices"}]},{"block_type":"element","block":"k6pz2hot","search_text":"Slices can have many dimensions as is also the case with arrays. The next statement creates a slice with two dimensions:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Slices can have many dimensions as is also the case with arrays. The next statement creates a slice with two dimensions:"}]},{"block_type":"element","block":"k6pz2hou","search_text":"s1 := make([][]int, 4) ","text_count":23,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s1 := make([][]int, 4)"}]}]},{"block_type":"element","block":"k6pz2hov","search_text":"Tip If you find yourselves using slices with many dimensions all of the time, you might need to reconsider your approach and choose a simpler design that does not require multidimensional slices. ","text_count":196,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you find yourselves using slices with many dimensions all of the time, you might need to reconsider your approach and choose a simpler design that does not require multidimensional slices."}]}]},{"block_type":"element","block":"k6pz2how","search_text":"You will find a code example with a multidimensional slice in the next section.","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will find a code example with a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"multidimensional slice"}]},{"block_type":"text","content":"in the next section."}]},{"block_type":"element","block":"k6pz2hox","search_text":"Another example of slices","text_count":25,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Another example of slices"}]},{"block_type":"element","block":"k6pz2hoy","search_text":"The Go code of the slices.go program will hopefully clarify many things about slices for you, and it will be presented in five parts.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slices.go"}]},{"block_type":"text","content":"program will hopefully clarify many things about slices for you, and it will be presented in five parts."}]},{"block_type":"element","block":"k6pz2hoz","search_text":"The first part of the program contains the expected preamble as well as the definition of two slices:","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program contains the expected preamble as well as the definition of two slices:"}]},{"block_type":"element","block":"k6pz2hp0","search_text":"package main import ( \"fmt\" ) func main() { aSlice := []int{1, 2, 3, 4, 5} fmt.Println(aSlice) integer := make([]int, 2) fmt.Println(integer) integer = nil fmt.Println(integer)","text_count":176,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    aSlice := []int{1, 2, 3, 4, 5} \n    fmt.Println(aSlice) \n    integer := make([]int, 2) \n    fmt.Println(integer) \n    integer = nil \n    fmt.Println(integer)"}]}]},{"block_type":"element","block":"k6pz2hp1","search_text":"The second part of the program shows how to use the [:] notation to create a new slice that references an existing array. Remember that you are not creating a copy of the array, just a reference to it, which will be verified in the output of the program:","text_count":254,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program shows how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[:]"}]},{"block_type":"text","content":"notation to create a new slice that references an existing array. Remember that you are not creating a copy of the array, just a reference to it, which will be verified in the output of the program:"}]},{"block_type":"element","block":"k6pz2hp2","search_text":"anArray := [5]int{-1, -2, -3, -4, -5} refAnArray := anArray[:] fmt.Println(anArray) fmt.Println(refAnArray) anArray[4] = -100 fmt.Println(refAnArray) ","text_count":150,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"anArray := [5]int{-1, -2, -3, -4, -5} \n    refAnArray := anArray[:] \n \n    fmt.Println(anArray) \n    fmt.Println(refAnArray) \n    anArray[4] = -100 \n    fmt.Println(refAnArray)"}]}]},{"block_type":"element","block":"k6pz2hp3","search_text":"The third code segment defines a slice with one dimension and another one with two dimensions using the make() function:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment defines a slice with one dimension and another one with two dimensions using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2hp4","search_text":"s := make([]byte, 5) fmt.Println(s) twoD := make([][]int, 3) fmt.Println(twoD) fmt.Println() ","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s := make([]byte, 5) \n    fmt.Println(s) \n    twoD := make([][]int, 3) \n    fmt.Println(twoD) \n    fmt.Println()"}]}]},{"block_type":"element","block":"k6pz2hp5","search_text":"As slices are automatically initialized by Go, all of the elements of the two preceding slices will have the zero value of the slice type, which for integers is 0 and for slices is nil . Keep in mind that the elements of a multidimensional slice are slices!","text_count":257,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As slices are automatically initialized by Go, all of the elements of the two preceding slices will have the zero value of the slice type, which for integers is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"and for slices is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":". Keep in mind that the elements of a multidimensional slice are slices!"}]},{"block_type":"element","block":"k6pz2hp6","search_text":"In the fourth part of slices.go that is shown in the next piece of Go code, you will learn how to initialize all the elements of a slice with two dimensions manually:","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slices.go"}]},{"block_type":"text","content":"that is shown in the next piece of Go code, you will learn how to initialize all the elements of a slice with two dimensions manually:"}]},{"block_type":"element","block":"k6pz2hp7","search_text":"for i := 0; i < len(twoD); i++ { for j := 0; j < 2; j++ { twoD[i] = append(twoD[i], i*j) } } ","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; len(twoD); i++ { \n        for j := 0; j &lt; 2; j++ { \n            twoD[i] = append(twoD[i], i*j) \n        } \n    }"}]}]},{"block_type":"element","block":"k6pz2hp8","search_text":"The preceding Go code shows that in order to expand an existing slice and make it grow, you will need to use the append() function and not reference an index that does not exist! The latter would create a panic: runtime error: index out of range error message! Note that the values of the slice elements have been chosen arbitrarily.","text_count":333,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding Go code shows that in order to expand an existing slice and make it grow, you will need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"append()"}]},{"block_type":"text","content":"function and not reference an index that does not exist! The latter would create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic: runtime error: index out of range"}]},{"block_type":"text","content":"error message! Note that the values of the slice elements have been chosen arbitrarily."}]},{"block_type":"element","block":"k6pz2hp9","search_text":"The last part of the program shows you how to use the range keyword to visit and print all of the elements of a slice with two dimensions:","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program shows you how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword to visit and print all of the elements of a slice with two dimensions:"}]},{"block_type":"element","block":"k6pz2hpa","search_text":"for _, x := range twoD { for i, y := range x { fmt.Println(\"i:\", i, \"value:\", y) } fmt.Println() } } ","text_count":101,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, x := range twoD { \n        for i, y := range x { \n            fmt.Println(\"i:\", i, \"value:\", y) \n        } \n        fmt.Println() \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hpb","search_text":"If you execute slices.go , you will get the following output:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slices.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hpc","search_text":"$ go run slices.go [1 2 3 4 5] [0 0] [] [-1 -2 -3 -4 -5] [-1 -2 -3 -4 -5] [-1 -2 -3 -4 -100] [0 0 0 0 0] [[] [] []] i: 0 value: 0 i: 1 value: 0 i: 0 value: 0 i: 1 value: 1 i: 0 value: 0 i: 1 value: 2 ","text_count":200,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run slices.go\n[1 2 3 4 5]\n[0 0]\n[]\n[-1 -2 -3 -4 -5]\n[-1 -2 -3 -4 -5]\n[-1 -2 -3 -4 -100]\n[0 0 0 0 0]\n[[] [] []]\n  \ni: 0 value: 0\ni: 1 value: 0\n   \ni: 0 value: 0\ni: 1 value: 1\n    \ni: 0 value: 0\ni: 1 value: 2"}]}]},{"block_type":"element","block":"k6pz2hpd","search_text":"It should not come as a surprise to you that the objects of the slice with the two dimensions are initialized to nil and therefore printed as empty. This happens because the zero value for the slice type is nil .","text_count":212,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It should not come as a surprise to you that the objects of the slice with the two dimensions are initialized to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"and therefore printed as empty. This happens because the zero value for the slice type is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hpe","search_text":"Sorting slices using sort.slice()","text_count":33,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Sorting slices using sort.slice()"}]},{"block_type":"element","block":"k6pz2hpf","search_text":"This subsection will illustrate the use of the sort.Slice() function that was first introduced in Go version 1.8. This means that the code presented, which is saved in sortSlice.go , will not run on older Go versions. The program will be presented in three parts. The first part of the program is as follows:","text_count":308,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will illustrate the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Slice()"}]},{"block_type":"text","content":"function that was first introduced in Go version 1.8. This means that the code presented, which is saved in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sortSlice.go"}]},{"block_type":"text","content":", will not run on older Go versions. The program will be presented in three parts. The first part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hpg","search_text":"package main import ( \"fmt\" \"sort\" ) type aStructure struct { person string height int weight int } ","text_count":100,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"sort\" \n) \n \ntype aStructure struct { \n    person string \n    height int \n    weight int \n}"}]}]},{"block_type":"element","block":"k6pz2hph","search_text":"Apart from the expected preamble, you can also see the definition of a Go structure for the first time in this book. Chapter 4, The Uses of Composite Types , will totally explore Go structures. For now, however, keep in mind that structures are data types with multiple variables of various types.","text_count":297,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the expected preamble, you can also see the definition of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go structure"}]},{"block_type":"text","content":"for the first time in this book. Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":", will totally explore Go structures. For now, however, keep in mind that structures are data types with multiple variables of various types."}]},{"block_type":"element","block":"k6pz2hpi","search_text":"The second part of sortSlice.go is shown in the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sortSlice.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hpj","search_text":"func main() { mySlice := make([]aStructure, 0) mySlice = append(mySlice, aStructure{\"Mihalis\", 180, 90}) mySlice = append(mySlice, aStructure{\"Bill\", 134, 45}) mySlice = append(mySlice, aStructure{\"Marietta\", 155, 45}) mySlice = append(mySlice, aStructure{\"Epifanios\", 144, 50}) mySlice = append(mySlice, aStructure{\"Athina\", 134, 40}) fmt.Println(\"0:\", mySlice) ","text_count":363,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    mySlice := make([]aStructure, 0) \n    mySlice = append(mySlice, aStructure{\"Mihalis\", 180, 90}) \n    mySlice = append(mySlice, aStructure{\"Bill\", 134, 45}) \n    mySlice = append(mySlice, aStructure{\"Marietta\", 155, 45}) \n    mySlice = append(mySlice, aStructure{\"Epifanios\", 144, 50}) \n    mySlice = append(mySlice, aStructure{\"Athina\", 134, 40}) \n \n    fmt.Println(\"0:\", mySlice)"}]}]},{"block_type":"element","block":"k6pz2hpk","search_text":"Here you create a new slice named mySlice with elements from the aStructure structure created earlier.","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you create a new slice named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mySlice"}]},{"block_type":"text","content":"with elements from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aStructure"}]},{"block_type":"text","content":"structure created earlier."}]},{"block_type":"element","block":"k6pz2hpl","search_text":"The final part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The final part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hpm","search_text":"sort.Slice(mySlice, func(i, j int) bool { return mySlice[i].height < mySlice[j].height }) fmt.Println(\"<:\", mySlice) sort.Slice(mySlice, func(i, j int) bool { return mySlice[i].height > mySlice[j].height }) fmt.Println(\">:\", mySlice) } ","text_count":236,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sort.Slice(mySlice, func(i, j int) bool { \n        return mySlice[i].height &lt; mySlice[j].height \n    }) \n    fmt.Println(\"&lt;:\", mySlice) \n    sort.Slice(mySlice, func(i, j int) bool { \n        return mySlice[i].height &gt; mySlice[j].height \n    }) \n    fmt.Println(\"&gt;:\", mySlice) \n}"}]}]},{"block_type":"element","block":"k6pz2hpn","search_text":"Here you sort mySlice two times using sort.Slice() and two anonymous functions, one anonymous function at a time, using the height field of aStructure .","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you sort"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mySlice"}]},{"block_type":"text","content":"two times using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Slice()"}]},{"block_type":"text","content":"and two anonymous functions, one anonymous function at a time, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"height"}]},{"block_type":"text","content":"field of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aStructure"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hpo","search_text":"Tip The sort.Slice() function changes the order of the elements in the slice according to the sorting function. ","text_count":112,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Slice()"}]},{"block_type":"text","content":"&nbsp;function changes the order of the elements in the slice according to the sorting function."}]}]},{"block_type":"element","block":"k6pz2hpp","search_text":"Executing sortSlice.go will create the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sortSlice.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hpq","search_text":"$ go run sortSlice.go 0: [{Mihalis 180 90} {Bill 134 45} {Marietta 155 45} {Epifanios 144 50} {Athina 134 40}] <: [{Bill 134 45} {Athina 134 40} {Epifanios 144 50} {Marietta 155 45} {Mihalis 180 90}] >: [{Mihalis 180 90} {Marietta 155 45} {Epifanios 144 50} {Bill 134 45} {Athina 134 40}] ","text_count":289,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run sortSlice.go\n0: [{Mihalis 180 90} {Bill 134 45} {Marietta 155 45} {Epifanios 144 \n50} {Athina 134 40}]\n&lt;: [{Bill 134 45} {Athina 134 40} {Epifanios 144 50} {Marietta 155 \n45} {Mihalis 180 90}]\n&gt;: [{Mihalis 180 90} {Marietta 155 45} {Epifanios 144 50} {Bill 134 \n45} {Athina 134 40}]"}]}]},{"block_type":"element","block":"k6pz2hpr","search_text":"If you try to execute sortSlice.go on a Unix machine with an older than 1.8 Go version, you will get the next error message:","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sortSlice.go"}]},{"block_type":"text","content":"on a Unix machine with an older than 1.8 Go version, you will get the next error message:"}]},{"block_type":"element","block":"k6pz2hps","search_text":"$ go version go version go1.3.3 linux/amd64 $ go run sortSlice.go # command-line-arguments ./sortSlice.go:24: undefined: sort.Slice ./sortSlice.go:28: undefined: sort.Slice ","text_count":173,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go version\ngo version go1.3.3 linux/amd64\n$ go run sortSlice.go\n# command-line-arguments\n./sortSlice.go:24: undefined: sort.Slice\n./sortSlice.go:28: undefined: sort.Slice"}]}]},{"block_type":"element","block":"k6pz2hpt","search_text":"Go maps","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go maps"}]},{"block_type":"element","block":"k6pz2hpu","search_text":"A Go map is equivalent to the well-known hash table found in many other programming languages. The main advantage of maps is that they can use any data type as their index, which in this case is called a map key or just a key . Although Go maps do not exclude any data types from being used as keys, for a data type to be used as a key, it must be comparable , which means that the Go compiler must be able to differentiate one key from another or, put simply, that the keys of a map must support the == operator. The good news is that almost all data types are comparable. However, as you can understand, using the bool data type as the key to a map will definitely limit your options! Additionally, using floating-point numbers as keys might present problems caused by the precision used among different machines and operating systems.","text_count":837,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"map"}]},{"block_type":"text","content":"is equivalent to the well-known"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"hash table"}]},{"block_type":"text","content":"found in many other programming languages. The main advantage of maps is that they can use any data type as their index, which in this case is called a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"map key"}]},{"block_type":"text","content":"or just a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"key"}]},{"block_type":"text","content":". Although Go maps do not exclude any data types from being used as keys, for a data type to be used as a key, it must be"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"comparable"}]},{"block_type":"text","content":", which means that the Go compiler must be able to differentiate one key from another or, put simply, that the keys of a map must support the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"=="}]},{"block_type":"text","content":"operator. The good news is that almost all data types are comparable. However, as you can understand, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bool"}]},{"block_type":"text","content":"data type as the key to a map will definitely limit your options! Additionally, using floating-point numbers as keys might present problems caused by the precision used among different machines and operating systems."}]},{"block_type":"element","block":"k6pz2hpv","search_text":"Tip A Go map is a reference to a hash table! The good thing is that Go hides the implementation of the hash table and therefore its complexity. You will learn more about implementing a hash table on your own in Go in Chapter 5, Enhancing Go Code with Data Structures . ","text_count":269,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go map is a reference to a hash table! The good thing is that Go hides the implementation of the hash table and therefore its complexity. You will learn more about implementing a hash table on your own in Go in Chapter 5,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Enhancing Go Code with Data Structures"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hpw","search_text":"You can create a new empty map with string keys and int values with the help of the make() function:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can create a new empty map with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"keys and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"values with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2hpx","search_text":"iMap = make(map[string]int) ","text_count":28,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"iMap = make(map[string]int)"}]}]},{"block_type":"element","block":"k6pz2hpy","search_text":"Alternatively, you can use the next map literal in order to create a new map that will be populated with data:","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Alternatively, you can use the next"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"map literal"}]},{"block_type":"text","content":"in order to create a new map that will be populated with data:"}]},{"block_type":"element","block":"k6pz2hpz","search_text":"anotherMap := map[string]int { \"k1\": 12 \"k2\": 13 } ","text_count":51,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"anotherMap := map[string]int { \n    \"k1\": 12 \n    \"k2\": 13 \n}"}]}]},{"block_type":"element","block":"k6pz2hq0","search_text":"You can access the two objects of anotherMap as anotherMap[\"k1\"] and anotherMap[\"k1\"] . You can delete an object of a map using the delete() function:","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can access the two objects of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherMap"}]},{"block_type":"text","content":"as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherMap[\"k1\"]"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherMap[\"k1\"]"}]},{"block_type":"text","content":". You can delete an object of a map using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"delete()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2hq1","search_text":"delete(anotherMap, \"k1\") ","text_count":25,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"delete(anotherMap, \"k1\")"}]}]},{"block_type":"element","block":"k6pz2hq2","search_text":"You can iterate over all of the elements of a map using the following technique:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can iterate over all of the elements of a map using the following technique:"}]},{"block_type":"element","block":"k6pz2hq3","search_text":"for key, value := range iMap { fmt.Println(key, value) }","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for key, value := range iMap { \n        fmt.Println(key, value) \n    }"}]}]},{"block_type":"element","block":"k6pz2hq4","search_text":"The Go code of usingMaps.go will illustrate the use of maps in more detail. The program will be presented in three parts. The first part is shown in the following Go code:","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingMaps.go"}]},{"block_type":"text","content":"will illustrate the use of maps in more detail. The program will be presented in three parts. The first part is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hq5","search_text":"package main import ( \"fmt\" ) func main() { iMap := make(map[string]int) iMap[\"k1\"] = 12 iMap[\"k2\"] = 13 fmt.Println(\"iMap:\", iMap) anotherMap := map[string]int{ \"k1\": 12, \"k2\": 13, } ","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n \n    iMap := make(map[string]int) \n    iMap[\"k1\"] = 12 \n    iMap[\"k2\"] = 13 \n    fmt.Println(\"iMap:\", iMap) \n \n    anotherMap := map[string]int{ \n        \"k1\": 12, \n        \"k2\": 13, \n    }"}]}]},{"block_type":"element","block":"k6pz2hq6","search_text":"The second part of usingMaps.go contains the following code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingMaps.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2hq7","search_text":"fmt.Println(\"anotherMap:\", anotherMap) delete(anotherMap, \"k1\") delete(anotherMap, \"k1\") delete(anotherMap, \"k1\") fmt.Println(\"anotherMap:\", anotherMap) _, ok := iMap[\"doesItExist\"] if ok { fmt.Println(\"Exists!\") } else { fmt.Println(\"Does NOT exist\") } ","text_count":254,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"anotherMap:\", anotherMap) \n    delete(anotherMap, \"k1\") \n    delete(anotherMap, \"k1\") \n    delete(anotherMap, \"k1\") \n    fmt.Println(\"anotherMap:\", anotherMap) \n \n    _, ok := iMap[\"doesItExist\"] \n    if ok { \n        fmt.Println(\"Exists!\") \n    } else { \n        fmt.Println(\"Does NOT exist\") \n    }"}]}]},{"block_type":"element","block":"k6pz2hq8","search_text":"Here you see a technique that allows you to determine whether a given key is in the map or not. This is a vital technique because without it you would not know whether a given map has the required information or not.","text_count":216,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see a technique that allows you to determine whether a given key is in the map or not. This is a vital technique because without it you would not know whether a given map has the required information or not."}]},{"block_type":"element","block":"k6pz2hq9","search_text":"Tip The bad thing is that if you try to get the value of a map key that does not exist in the map, you will end up getting zero, which gives you no way of determining whether the result was zero because the key you requested was not there, or because the element with the corresponding key actually had the zero value. ","text_count":319,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The bad thing is that if you try to get the value of a map key that does not exist in the map, you will end up getting zero, which gives you no way of determining whether the result was zero because the key you requested was not there, or because the element with the corresponding key actually had the zero value."}]}]},{"block_type":"element","block":"k6pz2hqa","search_text":"Additionally, you can see the delete() function in action-calling the same delete() statement multiple times does not make any difference and does not generate any warning messages.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you can see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"delete()"}]},{"block_type":"text","content":"function in action-calling the same"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"delete()"}]},{"block_type":"text","content":"statement multiple times does not make any difference and does not generate any warning messages."}]},{"block_type":"element","block":"k6pz2hqb","search_text":"The last part of the program is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hqc","search_text":"for key, value := range iMap { fmt.Println(key, value) } } ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for key, value := range iMap { \n        fmt.Println(key, value) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hqd","search_text":"Here you see the use of the range keyword on a map, which is pretty elegant and handy.","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword on a map, which is pretty elegant and handy."}]},{"block_type":"element","block":"k6pz2hqe","search_text":"If you execute usingMaps.go , you will get the following output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingMaps.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hqf","search_text":"$ go run usingMaps.go iMap: map[k1:12 k2:13] anotherMap: map[k1:12 k2:13] anotherMap: map[k2:13] Does NOT exist k1 12 k2 13","text_count":123,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run usingMaps.go\niMap: map[k1:12 k2:13]\nanotherMap: map[k1:12 k2:13]\nanotherMap: map[k2:13]\nDoes NOT exist\nk1 12\nk2 13"}]}]},{"block_type":"element","block":"k6pz2hqg","search_text":"Tip You cannot and should not make any assumptions about the order in which the map pairs will be displayed because that order is totally random! ","text_count":146,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You cannot and should not make any assumptions about the order in which the map pairs will be displayed because that order is totally random!"}]}]},{"block_type":"element","block":"k6pz2hqh","search_text":"Storing to a nil map","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Storing to a nil map"}]},{"block_type":"element","block":"k6pz2hqi","search_text":"The following Go code will work:","text_count":32,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following Go code will work:"}]},{"block_type":"element","block":"k6pz2hqj","search_text":"aMap := map[string]int{} aMap[\"test\"] = 1 ","text_count":42,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"aMap := map[string]int{} \naMap[\"test\"] = 1"}]}]},{"block_type":"element","block":"k6pz2hqk","search_text":"However, the following Go code will not work because you have assigned the nil value to the map you are trying to use:","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, the following Go code will"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"not"}]},{"block_type":"text","content":"work because you have assigned the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"value to the map you are trying to use:"}]},{"block_type":"element","block":"k6pz2hql","search_text":"aMap := map[string]int{} aMap = nil fmt.Println(aMap) aMap[\"test\"] = 1","text_count":70,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"aMap := map[string]int{} \naMap = nil \nfmt.Println(aMap) \naMap[\"test\"] = 1"}]}]},{"block_type":"element","block":"k6pz2hqm","search_text":"Saving the preceding code to failMap.go and trying to compile it will generate the following error message:","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Saving the preceding code to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"failMap.go"}]},{"block_type":"text","content":"and trying to compile it will generate the following error message:"}]},{"block_type":"element","block":"k6pz2hqn","search_text":"$ go run failMap.go map[] panic: assignment to entry in nil map ","text_count":64,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run failMap.go\nmap[]\npanic: assignment to entry in nil map"}]}]},{"block_type":"element","block":"k6pz2hqo","search_text":"This means that trying to insert data into a nil map will fail, however, looking up, deleting, finding the length, and using range loops on nil maps will not crash your code!","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that trying to insert data into a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"map will fail, however, looking up, deleting, finding the length, and using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"loops on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"maps will not crash your code!"}]},{"block_type":"element","block":"k6pz2hqp","search_text":"When you should use a map?","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"When you should use a map?"}]},{"block_type":"element","block":"k6pz2hqq","search_text":"Maps are more versatile than both slices and arrays, but this flexibility comes at a cost; that is, the extra processing power required for the implementation of a Go map. Nevertheless, built-in Go structures are very fast, so do not hesitate using a Go map when you need to use one.","text_count":283,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Maps are more versatile than both slices and arrays, but this flexibility comes at a cost; that is, the extra processing power required for the implementation of a Go map. Nevertheless, built-in Go structures are very fast, so do not hesitate using a Go map when you need to use one."}]},{"block_type":"element","block":"k6pz2hqr","search_text":"What you should remember is that Go maps are very convenient and can store many different kinds of data, while being both easy to understand and fast when you are working with them.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What you should remember is that Go maps are very convenient and can store many different kinds of data, while being both easy to understand and fast when you are working with them."}]},{"block_type":"element","block":"k6pz2hqs","search_text":"Go constants","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go constants"}]},{"block_type":"element","block":"k6pz2hqt","search_text":"Go supports constants , which are variables that cannot change their values. Constants in Go are defined with the help of the const keyword.","text_count":140,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go supports"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"constants"}]},{"block_type":"text","content":", which are variables that cannot change their values. Constants in Go are defined with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"keyword."}]},{"block_type":"element","block":"k6pz2hqu","search_text":"Tip Generally speaking, constants are usually global variables. Thus, you might rethink your approach if you find yourself defining too many constant variables with a local scope! ","text_count":180,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, constants are usually global variables. Thus, you might rethink your approach if you find yourself defining too many constant variables with a local scope!"}]}]},{"block_type":"element","block":"k6pz2hqv","search_text":"The main benefit that you get from using constants in your programs is the guarantee that their value will not change during program execution!","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main benefit that you get from using constants in your programs is the guarantee that their value will not change during program execution!"}]},{"block_type":"element","block":"k6pz2hqw","search_text":"Strictly speaking, the value of a constant variable is defined at compile time- not at run time. Behind the scenes, Go uses Boolean, string, or number as the type for storing a constant variable because this gives Go more flexibility when dealing with constants!","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, the value of a constant variable is defined at compile time-"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"not"}]},{"block_type":"text","content":"at run time. Behind the scenes, Go uses Boolean, string, or number as the type for storing a constant variable because this gives Go more flexibility when dealing with constants!"}]},{"block_type":"element","block":"k6pz2hqx","search_text":"You can define a new constant as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can define a new constant as follows:"}]},{"block_type":"element","block":"k6pz2hqy","search_text":"const HEIGHT = 200 ","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const HEIGHT = 200"}]}]},{"block_type":"element","block":"k6pz2hqz","search_text":"Additionally, if you want to declare many constants at once, mainly because they are related to each other, you can use the following notation:","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, if you want to declare many constants at once, mainly because they are related to each other, you can use the following notation:"}]},{"block_type":"element","block":"k6pz2hr0","search_text":"const ( C1 = \"C1C1C1\" C2 = \"C2C2C2\" C3 = \"C3C3C3\" ) ","text_count":52,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const ( \n    C1 = \"C1C1C1\" \n    C2 = \"C2C2C2\" \n    C3 = \"C3C3C3\" \n)"}]}]},{"block_type":"element","block":"k6pz2hr1","search_text":"Please note that the Go compiler considers the results of all operations applied to constants as constants. However, if a constant is part of a larger expression, this will not be the case.","text_count":189,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please note that the Go compiler considers the results of all operations applied to constants as constants. However, if a constant is part of a larger expression, this will not be the case."}]},{"block_type":"element","block":"k6pz2hr2","search_text":"And now for something completely different! The following three variable declarations mean exactly the same thing in Go:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"And now for something completely different! The following three variable declarations mean exactly the same thing in Go:"}]},{"block_type":"element","block":"k6pz2hr3","search_text":"s1 := \"My String\" var s2 = \"My String\" var s3 string = \"My String\" ","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s1 := \"My String\" \n    var s2 = \"My String\" \n    var s3 string = \"My String\""}]}]},{"block_type":"element","block":"k6pz2hr4","search_text":"However, as none of these variable declarations contains the const keyword in its declaration, none of them is a constant. This does not mean that you cannot define two constants in a similar way as follows:","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, as none of these variable declarations contains the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"keyword in its declaration, none of them is a constant. This does not mean that you cannot define two constants in a similar way as follows:"}]},{"block_type":"element","block":"k6pz2hr5","search_text":"const s1 = \"My String\" const s2 string = \"My String\" ","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const s1 = \"My String\" \n    const s2 string = \"My String\""}]}]},{"block_type":"element","block":"k6pz2hr6","search_text":"Although both s1 and s2 are constants, s2 comes with a type declaration ( string ), which makes its declaration more restrictive than the declaration of s1 . This is because a typed Go constant must follow all of the strict rules of a typed Go variable. On the other hand, a constant without a type need not follow all of the strict rules of a typed variable, which means that it can be mixed with expressions more liberally. Additionally, even constants without a type have a default type that is used when, and only when, no other type information is available. The main reason for this behavior is that as you do not know how a constant will be used. In that case, you do not want to use all of the available Go rules. A simple example is the definition of a numeric constant such as const value = 123 . As you might use the value constant in many expressions, declaring a type would make your job much more difficult. Look at the following Go code:","text_count":952,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2"}]},{"block_type":"text","content":"are constants,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2"}]},{"block_type":"text","content":"comes with a type declaration ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"), which makes its declaration more restrictive than the declaration of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":". This is because a typed Go constant must follow all of the strict rules of a typed Go variable. On the other hand, a constant without a type need not follow all of the strict rules of a typed variable, which means that it can be mixed with expressions more liberally. Additionally, even constants without a type have a default type that is used when, and only when, no other type information is available. The main reason for this behavior is that as you do not know how a constant will be used. In that case, you do not want to use all of the available Go rules. A simple example is the definition of a numeric constant such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const value = 123"}]},{"block_type":"text","content":". As you might use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"value"}]},{"block_type":"text","content":"constant in many expressions, declaring a type would make your job much more difficult. Look at the following Go code:"}]},{"block_type":"element","block":"k6pz2hr7","search_text":"const s1 = 123 const s2 float64 = 123 var v1 float32 = s1 * 12 var v2 float32 = s2 * 12 ","text_count":88,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const s1 = 123 \n    const s2 float64 = 123 \n \n    var v1 float32 = s1 * 12 \n    var v2 float32 = s2 * 12"}]}]},{"block_type":"element","block":"k6pz2hr8","search_text":"Although the compiler will not have a problem with the definition of v1 , the code used for the definition of v2 will not compile because s2 and v2 have different types:","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the compiler will not have a problem with the definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v1"}]},{"block_type":"text","content":", the code used for the definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v2"}]},{"block_type":"text","content":"will not compile because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v2"}]},{"block_type":"text","content":"have different types:"}]},{"block_type":"element","block":"k6pz2hr9","search_text":"$ go run a.go # command-line-arguments ./a.go:12:6: cannot use s2 * 12 (type float64) as type float32 in assignment","text_count":115,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run a.go\n# command-line-arguments\n./a.go:12:6: cannot use s2 * 12 (type float64) as type float32 in \nassignment"}]}]},{"block_type":"element","block":"k6pz2hra","search_text":"Tip As general advice, if you are using lots of constants in your programs, it might be a good idea to gather all of them in a Go package. ","text_count":139,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As general advice, if you are using lots of constants in your programs, it might be a good idea to gather all of them in a Go package."}]}]},{"block_type":"element","block":"k6pz2hrb","search_text":"The constant generator iota","text_count":27,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The constant generator iota"}]},{"block_type":"element","block":"k6pz2hrc","search_text":"The constant generator iota is used for declaring a sequence of related values that uses incrementing numbers without the need to type each one of them explicitly.","text_count":163,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"constant generator iota"}]},{"block_type":"text","content":"is used for declaring a sequence of related values that uses incrementing numbers without the need to type each one of them explicitly."}]},{"block_type":"element","block":"k6pz2hrd","search_text":"Most of the concepts related to the const keyword, including the constant generator iota, will be illustrated in the constants.go file, which will be presented in four parts.","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Most of the concepts related to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"keyword, including the constant generator iota, will be illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"constants.go"}]},{"block_type":"text","content":"file, which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2hre","search_text":"The first code segment of constants.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"constants.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hrf","search_text":"package main import ( \"fmt\" ) type Digit int type Power2 int const PI = 3.1415926 const ( C1 = \"C1C1C1\" C2 = \"C2C2C2\" C3 = \"C3C3C3\" ) ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype Digit int \ntype Power2 int \n \nconst PI = 3.1415926 \n \nconst ( \n    C1 = \"C1C1C1\" \n    C2 = \"C2C2C2\" \n    C3 = \"C3C3C3\" \n)"}]}]},{"block_type":"element","block":"k6pz2hrg","search_text":"In this part, we declare two new types, named Digit and Power2 , and four new constants, named PI , C1 , C2 and C3 .","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, we declare two new types, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Digit"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Power2"}]},{"block_type":"text","content":", and four new constants, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PI"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C1"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C2"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C3"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hrh","search_text":"Tip A Go type is a way of defining a new named type that uses the same underlying type as an existing one. This is mainly used for differentiating between different types that might use the same kind of data. ","text_count":209,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"type"}]},{"block_type":"text","content":"is a way of defining a new"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"named type"}]},{"block_type":"text","content":"that uses the same underlying type as an existing one. This is mainly used for differentiating between different types that might use the same kind of data."}]}]},{"block_type":"element","block":"k6pz2hri","search_text":"The second part of constants.go is shown in the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"constants.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hrj","search_text":"func main() { const s1 = 123 var v1 float32 = s1 * 12 fmt.Println(v1) fmt.Println(PI) ","text_count":86,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    const s1 = 123 \n    var v1 float32 = s1 * 12 \n    fmt.Println(v1) \n    fmt.Println(PI)"}]}]},{"block_type":"element","block":"k6pz2hrk","search_text":"In this part of the program, you define another constant ( s1 ) that is used in an expression ( v1 ).","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, you define another constant ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":") that is used in an expression ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"v1"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2hrl","search_text":"The third part of the program is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hrm","search_text":"const ( Zero Digit = iota One Two Three Four ) fmt.Println(One) fmt.Println(Two) ","text_count":81,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const ( \n        Zero Digit = iota \n        One \n        Two \n        Three \n        Four \n    ) \n    fmt.Println(One) \n    fmt.Println(Two)"}]}]},{"block_type":"element","block":"k6pz2hrn","search_text":"Here you see the definition of a constant generator iota based on Digit , which is equivalent to the following declaration of four constants:","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see the definition of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"constant generator iota"}]},{"block_type":"text","content":"based on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Digit"}]},{"block_type":"text","content":", which is equivalent to the following declaration of four constants:"}]},{"block_type":"element","block":"k6pz2hro","search_text":"const ( Zero = 0 One = 1 Two = 2 Three = 3 Four = 4 ) ","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const ( \n        Zero = 0 \n        One = 1 \n        Two = 2 \n        Three = 3 \n        Four = 4 \n    )"}]}]},{"block_type":"element","block":"k6pz2hrp","search_text":"The last part of the program of constants.go is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"constants.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hrq","search_text":"const ( p2_0 Power2 = 1 << iota _ p2_2 _ p2_4 _ p2_6 ) fmt.Println(\"2^0:\", p2_0) fmt.Println(\"2^2:\", p2_2) fmt.Println(\"2^4:\", p2_4) fmt.Println(\"2^6:\", p2_6) } ","text_count":161,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const ( \n        p2_0 Power2 = 1 &lt;&lt; iota \n        _ \n        p2_2 \n        _ \n        p2_4 \n        _ \n        p2_6 \n    ) \n \n    fmt.Println(\"2^0:\", p2_0) \n    fmt.Println(\"2^2:\", p2_2) \n    fmt.Println(\"2^4:\", p2_4) \n    fmt.Println(\"2^6:\", p2_6) \n \n}"}]}]},{"block_type":"element","block":"k6pz2hrr","search_text":"There is another constant generator iota here, which is a little different than the previous one. First, notice the use of the underscore character in a const block with a constant generator iota. This allows you to skip unwanted values. Second, the value of iota always increments, and it can be used in expressions, which is what occurred in this case.","text_count":354,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is another constant generator iota here, which is a little different than the previous one. First, notice the use of the underscore character in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"block with a constant generator iota. This allows you to skip unwanted values. Second, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"iota"}]},{"block_type":"text","content":"always increments, and it can be used in expressions, which is what occurred in this case."}]},{"block_type":"element","block":"k6pz2hrs","search_text":"Now let's see what really happens inside the const block. For p2_0 , iota has the value of 0 and p2_0 is defined as 1 . For p2_2 , iota has the value of 2 and p2_2 is defined as the result of the expression 1 << 2 , which is 00000100 in binary representation-the decimal value of 00000100 is 4 , which is the result and the value of p2_2 . Analogously, the value of p2_4 is 16 , and the value of p2_6 is 32 .","text_count":408,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's see what really happens inside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"block. For"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_0"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"iota"}]},{"block_type":"text","content":"has the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_0"}]},{"block_type":"text","content":"is defined as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":". For"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_2"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"iota"}]},{"block_type":"text","content":"has the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_2"}]},{"block_type":"text","content":"is defined as the result of the expression"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1 &lt;&lt; 2"}]},{"block_type":"text","content":", which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"00000100"}]},{"block_type":"text","content":"in binary representation-the decimal value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"00000100"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"4"}]},{"block_type":"text","content":", which is the result and the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_2"}]},{"block_type":"text","content":". Analogously, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_4"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"16"}]},{"block_type":"text","content":", and the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2_6"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"32"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hrt","search_text":"As you can see, the use of iota can save your time when it fits your needs!","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"iota"}]},{"block_type":"text","content":"can save your time when it fits your needs!"}]},{"block_type":"element","block":"k6pz2hru","search_text":"Executing constants.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"constants.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2hrv","search_text":"$ go run constants.go 1476 3.1415926 1 2 2^0: 1 2^2: 4 2^4: 16 2^6: 64 ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run constants.go\n1476\n3.1415926\n1\n2\n2^0: 1\n2^2: 4\n2^4: 16\n2^6: 64"}]}]},{"block_type":"element","block":"k6pz2hrw","search_text":"Go pointers","text_count":11,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go pointers"}]},{"block_type":"element","block":"k6pz2hrx","search_text":"Go supports pointers! Pointers are memory addresses that offer improved speed in exchange for difficult-to-debug code and nasty bugs-C programmers should know more about this. You have already seen pointers in action in Chapter 2, Understanding Go Internals , when we talked about unsafe code and the unsafe package, but this section will try to shed more light on this difficult and tricky subject. Additionally, native Go pointers are safe provided that you know what you are doing.","text_count":484,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go supports pointers!"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pointers"}]},{"block_type":"text","content":"are memory addresses that offer improved speed in exchange for difficult-to-debug code and nasty bugs-C programmers should know more about this. You have already seen pointers in action in Chapter 2,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Understanding Go Internals"}]},{"block_type":"text","content":", when we talked about unsafe code and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unsafe"}]},{"block_type":"text","content":"package, but this section will try to shed more light on this difficult and tricky subject. Additionally, native Go pointers are safe provided that you know what you are doing."}]},{"block_type":"element","block":"k6pz2hry","search_text":"When working with pointers, you need * to get the value of a pointer, which is called dereferencing the pointer , and & to get the memory address of a non-pointer variable.","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When working with pointers, you need"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*"}]},{"block_type":"text","content":"to get the value of a pointer, which is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"dereferencing the pointer"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&amp;"}]},{"block_type":"text","content":"to get the memory address of a non-pointer variable."}]},{"block_type":"element","block":"k6pz2hrz","search_text":"Tip Generally speaking, amateur developers should use pointers only when the libraries that they use require it, because pointers can be the cause of horrible and difficult to discover bugs when used carelessly. ","text_count":212,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, amateur developers should use pointers only when the libraries that they use require it, because pointers can be the cause of horrible and difficult to discover bugs when used carelessly."}]}]},{"block_type":"element","block":"k6pz2hs0","search_text":"You can make a function accept a pointer parameter as follows:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can make a function accept a pointer parameter as follows:"}]},{"block_type":"element","block":"k6pz2hs1","search_text":"func getPointer(n *int) { } ","text_count":28,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func getPointer(n *int) { \n}"}]}]},{"block_type":"element","block":"k6pz2hs2","search_text":"Similarly, a function can return a pointer as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, a function can return a pointer as follows:"}]},{"block_type":"element","block":"k6pz2hs3","search_text":"func returnPointer(n int) *int { } ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func returnPointer(n int) *int { \n}"}]}]},{"block_type":"element","block":"k6pz2hs4","search_text":"The use of safe Go pointers is illustrated in pointers.go , which will be presented in four parts. The first code segment of pointers.go follows next:","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The use of safe Go pointers is illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":", which will be presented in four parts. The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hs5","search_text":"package main import ( \"fmt\" ) func getPointer(n *int) { *n = *n * *n } func returnPointer(n int) *int { v := n * n return &v } ","text_count":127,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc getPointer(n *int) { \n    *n = *n * *n \n \n} \n \nfunc returnPointer(n int) *int { \n    v := n * n \n    return &amp;v \n}"}]}]},{"block_type":"element","block":"k6pz2hs6","search_text":"The good thing with getPointer() is that it allows you to update the variable passed to it without needing to return anything to the caller function. This happens because the pointer passed as a parameter contains the memory address of the variable.","text_count":249,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good thing with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPointer()"}]},{"block_type":"text","content":"is that it allows you to update the variable passed to it without needing to return anything to the caller function. This happens because the pointer passed as a parameter contains the memory address of the variable."}]},{"block_type":"element","block":"k6pz2hs7","search_text":"On the other hand, returnPointer() gets an integer parameter and returns a pointer to an integer, which is denoted by return &v . Although this might not appear to be that useful, you will really appreciate this capability in Chapter 4, The Uses of Composite Types , when we talk about pointers to Go structures, as well as in later chapters where more complex data structures will be involved.","text_count":394,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the other hand,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPointer()"}]},{"block_type":"text","content":"gets an integer parameter and returns a pointer to an integer, which is denoted by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return &amp;v"}]},{"block_type":"text","content":". Although this might not appear to be that useful, you will really appreciate this capability in Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":", when we talk about pointers to Go structures, as well as in later chapters where more complex data structures will be involved."}]},{"block_type":"element","block":"k6pz2hs8","search_text":"Both the getPointer() and returnPointer() functions find the square of an integer. However, they use a totally different approach, as getPointer() stores the result to the provided parameter whereas returnPointer() returns the result and requires a different variable for storing it.","text_count":283,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPointer()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPointer()"}]},{"block_type":"text","content":"functions find the square of an integer. However, they use a totally different approach, as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPointer()"}]},{"block_type":"text","content":"stores the result to the provided parameter whereas"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPointer()"}]},{"block_type":"text","content":"returns the result and requires a different variable for storing it."}]},{"block_type":"element","block":"k6pz2hs9","search_text":"The second part of the program contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hsa","search_text":"func main() { i := -10 j := 25 pI := &i pJ := &j fmt.Println(\"pI memory:\", pI) fmt.Println(\"pJ memory:\", pJ) fmt.Println(\"pI value:\", *pI) fmt.Println(\"pJ value:\", *pJ) ","text_count":169,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    i := -10 \n    j := 25 \n \n    pI := &amp;i \n    pJ := &amp;j \n \n    fmt.Println(\"pI memory:\", pI) \n    fmt.Println(\"pJ memory:\", pJ) \n    fmt.Println(\"pI value:\", *pI) \n    fmt.Println(\"pJ value:\", *pJ)"}]}]},{"block_type":"element","block":"k6pz2hsb","search_text":"Both i and j are normal integer variables. However, pI and pJ are both pointers pointing to i and j , respectively. The pI is the memory address of the pointer, whereas *pI is the value stored to that memory address.","text_count":216,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"are normal integer variables. However,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pI"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pJ"}]},{"block_type":"text","content":"are both pointers pointing to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":", respectively. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pI"}]},{"block_type":"text","content":"is the memory address of the pointer, whereas"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*pI"}]},{"block_type":"text","content":"is the value stored to that memory address."}]},{"block_type":"element","block":"k6pz2hsc","search_text":"The third part of pointers.go is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hsd","search_text":"*pI = 123456 *pI-- fmt.Println(\"i:\", i) ","text_count":40,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"*pI = 123456 \n    *pI-- \n    fmt.Println(\"i:\", i)"}]}]},{"block_type":"element","block":"k6pz2hse","search_text":"Here you can see how you can change the i variable through the pI pointer that points to i in two different ways. First, it does so by directly assigning a new value to it and second, using the -- operator.","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see how you can change the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"variable through the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pI"}]},{"block_type":"text","content":"pointer that points to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"in two different ways. First, it does so by directly assigning a new value to it and second, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"--"}]},{"block_type":"text","content":"operator."}]},{"block_type":"element","block":"k6pz2hsf","search_text":"The last code portion of pointers.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hsg","search_text":"getPointer(pJ) fmt.Println(\"j:\", j) k := returnPointer(12) fmt.Println(*k) fmt.Println(k) } ","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"getPointer(pJ) \n    fmt.Println(\"j:\", j) \n    k := returnPointer(12) \n    fmt.Println(*k) \n    fmt.Println(k) \n}"}]}]},{"block_type":"element","block":"k6pz2hsh","search_text":"Here you call the getPointer() function using pJ as its parameter. As we discussed before, any changes made to the pJ variable inside getPointer() will have an effect on the value of the j variable because the pJ variable points to the j variable, which can be verified by the output of the fmt.Println(\"j:\", j) statement. The call to returnPointer() returns a pointer that is assigned to the k pointer variable.","text_count":412,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPointer()"}]},{"block_type":"text","content":"function using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pJ"}]},{"block_type":"text","content":"as its parameter. As we discussed before, any changes made to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pJ"}]},{"block_type":"text","content":"variable inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPointer()"}]},{"block_type":"text","content":"will have an effect on the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"variable because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pJ"}]},{"block_type":"text","content":"variable points to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"variable, which can be verified by the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(\"j:\", j)"}]},{"block_type":"text","content":"statement. The call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPointer()"}]},{"block_type":"text","content":"returns a pointer that is assigned to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"pointer variable."}]},{"block_type":"element","block":"k6pz2hsi","search_text":"Running pointers.go will create the following output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hsj","search_text":"$ go run pointers.go pI memory: 0xc420012088 pJ memory: 0xc420012090 pI value: -10 pJ value: 25 i: 123455 j: 625 144 0xc4200120c8 ","text_count":130,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run pointers.go\npI memory: 0xc420012088\npJ memory: 0xc420012090\npI value: -10\npJ value: 25\ni: 123455\nj: 625\n144\n0xc4200120c8"}]}]},{"block_type":"element","block":"k6pz2hsk","search_text":"I realize that you may have trouble understanding the Go code of pointers.go because we have not yet discussed functions and function definitions, so feel free to look at Chapter 6, What You Might Not Know About Go Packages , where topics related to functions are explained in more detail.","text_count":289,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I realize that you may have trouble understanding the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointers.go"}]},{"block_type":"text","content":"because we have not yet discussed functions and function definitions, so feel free to look at Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":", where topics related to functions are explained in more detail."}]},{"block_type":"element","block":"k6pz2hsl","search_text":"Tip Strings in Go are value types, not pointers as in C. ","text_count":57,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strings in Go are value types, not pointers as in C."}]}]},{"block_type":"element","block":"k6pz2hsm","search_text":"Dealing with times and dates","text_count":28,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Dealing with times and dates"}]},{"block_type":"element","block":"k6pz2hsn","search_text":"In this section, you will learn how to parse date and time strings in Go, how to convert between different date and time formats, and how to print dates and times in the format you desire. Although this task might look insignificant at first, it can truly be critical when you want to synchronize multiple tasks, or when your application needs to read the date from one or more text files or directly from the user.","text_count":415,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will&nbsp;learn how to parse date and time strings in Go, how to convert between different date and time formats, and how to print dates and times in the format you desire. Although this task might look insignificant at first, it can truly be critical when you want to synchronize multiple tasks, or when your application needs to read the date from one or more text files or directly from the user."}]},{"block_type":"element","block":"k6pz2hso","search_text":"The time package is the star of working with times and dates in Go. You will see some of its functions in action in this section.","text_count":129,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package is the star of working with times and dates in Go. You will see some of its functions in action in this section."}]},{"block_type":"element","block":"k6pz2hsp","search_text":"Before learning how to parse a string and convert it into a time or a date, you will review a simple program named usingTime.go that will introduce the time package. The program will be presented in three parts. The first part of this program follows:","text_count":251,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Before learning how to parse a string and convert it into a time or a date, you will review a simple program named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingTime.go"}]},{"block_type":"text","content":"that will introduce the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package. The program will be presented in three parts. The first part of this program follows:"}]},{"block_type":"element","block":"k6pz2hsq","search_text":"package main import ( \"fmt\" \"time\" ) ","text_count":37,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2hsr","search_text":"The second code segment of usingTime.go is shown in the following Go code:","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingTime.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hss","search_text":"func main() { fmt.Println(\"Epoch time:\", time.Now().Unix()) t := time.Now() fmt.Println(t, t.Format(time.RFC3339)) fmt.Println(t.Weekday(), t.Day(), t.Month(), t.Year()) time.Sleep(time.Second) t1 := time.Now() fmt.Println(\"Time difference:\", t1.Sub(t)) ","text_count":254,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fmt.Println(\"Epoch time:\", time.Now().Unix()) \n    t := time.Now() \n    fmt.Println(t, t.Format(time.RFC3339)) \n    fmt.Println(t.Weekday(), t.Day(), t.Month(), t.Year()) \n \n    time.Sleep(time.Second) \n    t1 := time.Now() \n    fmt.Println(\"Time difference:\", t1.Sub(t))"}]}]},{"block_type":"element","block":"k6pz2hst","search_text":"The time.Now().Unix() function returns the Unix epoch time , which is the number of seconds that have elapsed since 00:00:00 UTC, 1 January 1970. The Format() function allows you to convert a time variable to another format-in this case, the RFC3339 format.","text_count":257,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Now().Unix()"}]},{"block_type":"text","content":"function returns the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unix epoch time"}]},{"block_type":"text","content":", which is the number of seconds that have elapsed since 00:00:00 UTC, 1 January 1970. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Format()"}]},{"block_type":"text","content":"function allows you to convert a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable to another format-in this case, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RFC3339"}]},{"block_type":"text","content":"format."}]},{"block_type":"element","block":"k6pz2hsu","search_text":"You will see the time.Sleep() function many times in this book as an easy way of emulating the delay from the execution of a true function. The time.Second constant allows you to use a one second duration in Go. If you want to define a duration of 10 seconds, you will need to multiply time.Second by 10! Other similar constants include time.Nanosecond , time.Microsecond , time.Millisecond , time.Minute , and time.Hour . Thus, the smallest amount of time that can be defined with the time package is the nanosecond. Last, the time.Sub() function allows you to find the time difference between two times.","text_count":605,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"function many times in this book as an easy way of emulating the delay from the execution of a true function. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Second"}]},{"block_type":"text","content":"constant allows you to use a one second duration in Go. If you want to define a duration of 10 seconds, you will need to multiply"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Second"}]},{"block_type":"text","content":"by 10! Other similar constants include"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Nanosecond"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Microsecond"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Millisecond"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Minute"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Hour"}]},{"block_type":"text","content":". Thus, the smallest amount of time that can be defined with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package is the nanosecond. Last, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sub()"}]},{"block_type":"text","content":"function allows you to find the time difference between two times."}]},{"block_type":"element","block":"k6pz2hsv","search_text":"The last part of the program is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2hsw","search_text":"formatT := t.Format(\"01 January 2006\") fmt.Println(formatT) loc, _ := time.LoadLocation(\"Europe/Paris\") londonTime := t.In(loc) fmt.Println(\"Paris:\", londonTime) } ","text_count":164,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"formatT := t.Format(\"01 January 2006\") \n    fmt.Println(formatT) \n    loc, _ := time.LoadLocation(\"Europe/Paris\") \n    londonTime := t.In(loc) \n    fmt.Println(\"Paris:\", londonTime) \n}"}]}]},{"block_type":"element","block":"k6pz2hsx","search_text":"Here you define a new date format using time.Format() in order to use it for printing out a time variable.","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you define a new date format using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Format()"}]},{"block_type":"text","content":"in order to use it for printing out a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2hsy","search_text":"Executing usingTime.go generates the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"usingTime.go"}]},{"block_type":"text","content":"generates the following output:"}]},{"block_type":"element","block":"k6pz2hsz","search_text":"$ go run usingTime.go Epoch time: 1510427100 2017-11-11 21:05:00.226749 +0200 EET m=+0.000268522 2017-11-11T21:05:00+02:00 Saturday 11 November 2017 Time difference: 1.004278426s 11 November 2017 Paris: 2017-11-11 20:05:00.226749 +0100 CET ","text_count":240,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run usingTime.go\nEpoch time: 1510427100\n2017-11-11 21:05:00.226749 +0200 EET m=+0.000268522 2017-11-11T21:05:00+02:00\nSaturday 11 November 2017\nTime difference: 1.004278426s\n11 November 2017\nParis: 2017-11-11 20:05:00.226749 +0100 CET"}]}]},{"block_type":"element","block":"k6pz2ht0","search_text":"Now that you know the basics of the time package, it is \"time\" to dig deeper into its functionality starting by working with times.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you know the basics of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package, it is \"time\" to dig deeper into its functionality starting by working with times."}]},{"block_type":"element","block":"k6pz2ht1","search_text":"Working with times","text_count":18,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Working with times"}]},{"block_type":"element","block":"k6pz2ht2","search_text":"When you have a time variable, it is easy to convert it into anything that is related to time or date. However, the main problem occurs when you have a string and you want to see whether it is a valid time or not. The function used for parsing time and date strings is time.Parse() , and it accepts two parameters. The first parameter denotes the expected format of the string that you will parse, while the second parameter is the actual string that will be parsed. The first parameter is composed of elements derived from a list of Go constants related to date and time parsing.","text_count":580,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When you have a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable, it is easy to convert it into anything that is related to time or date. However, the main problem occurs when you have a string and you want to see whether it is a valid time or not. The function used for parsing time and date strings is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":", and it accepts two parameters. The first parameter denotes the expected format of the string that you will parse, while the second parameter is the actual string that will be parsed. The first parameter is composed of elements derived from a list of Go constants related to date and time parsing."}]},{"block_type":"element","block":"k6pz2ht3","search_text":"Tip The list of constants that can be used for creating your own parse format can be found at https://golang.org/src/time/format.go . Go does not define the format of a date or a time in a form like DDYYYYMM or %D %Y %M as do the rest of the programming languages, rather it uses its own approach. Although you might find this approach strange at first, you will certainly appreciate it as it prevents the developer from making silly mistakes. ","text_count":444,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The list of constants that can be used for creating your own parse format can be found at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/time/format.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/time/format.go"}]},{"block_type":"text","content":". Go does not define the format of a date or a time in a form like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DDYYYYMM"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%D"}]},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%Y"}]},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%M"}]},{"block_type":"text","content":"as do the rest of the programming languages, rather it uses its own approach. Although you might find this approach strange at first, you will certainly appreciate it as it prevents the developer from making silly mistakes."}]}]},{"block_type":"element","block":"k6pz2ht4","search_text":"The Go constants for working with times are 15 for parsing the hour, 04 for parsing the minutes, and 05 for parsing the seconds. You can easily guess that all of these numeric values must be unique! You can use PM for parsing the PM string in uppercase and pm for parsing the lowercase version.","text_count":294,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go constants for working with times are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"15"}]},{"block_type":"text","content":"for parsing the hour,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"04"}]},{"block_type":"text","content":"for parsing the minutes, and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"05"}]},{"block_type":"text","content":"for parsing the seconds. You can easily guess that all of these numeric values must be unique! You can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PM"}]},{"block_type":"text","content":"for parsing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PM"}]},{"block_type":"text","content":"string in uppercase and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pm"}]},{"block_type":"text","content":"for parsing the lowercase version."}]},{"block_type":"element","block":"k6pz2ht5","search_text":"Tip You are not obligated to use every available Go constant. The main task of the developer is putting the various Go constants in the desired order in order to match the kind of strings that the program will have to process. ","text_count":227,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You are not obligated to use every available Go constant. The main task of the developer is putting the various Go constants in the desired order in order to match the kind of strings that the program will have to process."}]}]},{"block_type":"element","block":"k6pz2ht6","search_text":"You can consider the final version of the string that is passed as the first parameter to the time.Parse() function as a regular expression .","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can consider the final version of the string that is passed as the first parameter to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":"function as a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"regular expression"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ht7","search_text":"Parsing times","text_count":13,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Parsing times"}]},{"block_type":"element","block":"k6pz2ht8","search_text":"This section will tell you how to parse a string, which is given as a command-line argument to the parseTime.go utility in order to convert it into a time variable. This is not always possible, however, because the given string might not be in the correct format or might contain invalid characters. The parseTime.go utility will be presented in three parts.","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will tell you how to parse a string, which is given as a command-line argument to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":"utility in order to convert it into a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable. This is not always possible, however, because the given string might not be in the correct format or might contain invalid characters. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":"utility will be presented in three parts."}]},{"block_type":"element","block":"k6pz2ht9","search_text":"The first code segment of parseTime.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":"&nbsp;is as follows:"}]},{"block_type":"element","block":"k6pz2hta","search_text":"package main import ( \"fmt\" \"os\" \"path/filepath\" \"time\" ) ","text_count":58,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"path/filepath\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2htb","search_text":"The second part is shown in the following Go code:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2htc","search_text":"func main() { var myTime string if len(os.Args) != 2 { fmt.Printf(\"usage: %s string\\n\", filepath.Base(os.Args[0])) os.Exit(1) } myTime = os.Args[1] ","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var myTime string \n    if len(os.Args) != 2 { \n        fmt.Printf(\"usage: %s string\\n\", \n filepath.Base(os.Args[0])) \n        os.Exit(1) \n    } \n \n    myTime = os.Args[1]"}]}]},{"block_type":"element","block":"k6pz2htd","search_text":"The last portion of parseTime.go , which is where the magic happens, is as follows:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":", which is where the magic happens, is as follows:"}]},{"block_type":"element","block":"k6pz2hte","search_text":"d, err := time.Parse(\"15:04\", myTime) if err == nil { fmt.Println(\"Full:\", d) fmt.Println(\"Time:\", d.Hour(), d.Minute()) } else { fmt.Println(err) } } ","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"d, err := time.Parse(\"15:04\", myTime) \n    if err == nil { \n        fmt.Println(\"Full:\", d) \n        fmt.Println(\"Time:\", d.Hour(), d.Minute()) \n    } else { \n        fmt.Println(err) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2htf","search_text":"Thus, in order to parse an hour and minute string, you will need to use \"15:04\" . The value of the err variable tells you whether the parsing was successful or not.","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, in order to parse an hour and minute string, you will need to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"15:04\""}]},{"block_type":"text","content":". The value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"err"}]},{"block_type":"text","content":"variable tells you whether the parsing was successful or not."}]},{"block_type":"element","block":"k6pz2htg","search_text":"Executing parseTime.go will create the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hth","search_text":"$ go run parseTime.go usage: parseTime string exit status 1 $ go run parseTime.go 12:10 Full: 0000-01-01 12:10:00 +0000 UTC Time: 12 10 ","text_count":136,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run parseTime.go\nusage: parseTime string\nexit status 1\n$ go run parseTime.go 12:10\nFull: 0000-01-01 12:10:00 +0000 UTC\nTime: 12 10"}]}]},{"block_type":"element","block":"k6pz2hti","search_text":"As you can see here, Go prints a full date time string because this is what is stored in a time variable. If you are only interested in the time and not in the date, you should print only the parts of a time variable that you want.","text_count":231,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see here, Go prints a full date time string because this is what is stored in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable. If you are only interested in the time and not in the date, you should print only the parts of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"variable that you want."}]},{"block_type":"element","block":"k6pz2htj","search_text":"If you use a wrong Go constant like 22:04 when trying to parse a string and convert it into a time, you will get the following error message:","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you use a wrong Go constant like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"22:04"}]},{"block_type":"text","content":"when trying to parse a string and convert it into a time, you will get the following error message:"}]},{"block_type":"element","block":"k6pz2htk","search_text":"$ go run parseTime.go 12:10 parsing time \"12:10\" as \"22:04\": cannot parse \":10\" as \"2\" ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run parseTime.go 12:10\nparsing time \"12:10\" as \"22:04\": cannot parse \":10\" as \"2\""}]}]},{"block_type":"element","block":"k6pz2htl","search_text":"However, if you use a Go constant like 11 , which is used for parsing months when the month is given as a number, the error message will be slightly different:","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, if you use a Go constant like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"11"}]},{"block_type":"text","content":", which is used for parsing months when the month is given as a number, the error message will be slightly different:"}]},{"block_type":"element","block":"k6pz2htm","search_text":"$ go run parseTime.go 12:10 parsing time \"12:10\": month out of range","text_count":68,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run parseTime.go 12:10\nparsing time \"12:10\": month out of range"}]}]},{"block_type":"element","block":"k6pz2htn","search_text":"Working with dates","text_count":18,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Working with dates"}]},{"block_type":"element","block":"k6pz2hto","search_text":"In this subsection, you will learn how to parse strings that denote dates in Go. Doing this still requires the use of the time.Parse() function.","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to parse strings that denote dates in Go. Doing this still requires the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2htp","search_text":"The Go constants for working with dates are Jan for parsing the three-letter abbreviation used for describing a month, 2006 for parsing the year, and 02 for parsing the day of the month. If you use January instead of Jan , you will get the long name of the month instead of its three-letter abbreviation, which makes perfect sense.","text_count":331,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go constants for working with dates are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Jan"}]},{"block_type":"text","content":"for parsing the three-letter abbreviation used for describing a month,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2006"}]},{"block_type":"text","content":"for parsing the year, and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"02"}]},{"block_type":"text","content":"for parsing the day of the month. If you use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"January"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Jan"}]},{"block_type":"text","content":", you will get the long name of the month instead of its three-letter abbreviation, which makes perfect sense."}]},{"block_type":"element","block":"k6pz2htq","search_text":"Additionally, you can use Monday for parsing strings that contain a long weekday string and Mon for the abbreviated version of the weekday.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Monday"}]},{"block_type":"text","content":"for parsing strings that contain a long weekday string and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Mon"}]},{"block_type":"text","content":"for the abbreviated version of the weekday."}]},{"block_type":"element","block":"k6pz2htr","search_text":"Parsing dates","text_count":13,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Parsing dates"}]},{"block_type":"element","block":"k6pz2hts","search_text":"The name of the Go program that will be developed in this subsection is parseDate.go , and it will be presented in two parts.","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go program that will be developed in this subsection is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":", and it will be presented in two parts."}]},{"block_type":"element","block":"k6pz2htt","search_text":"The first part of parseDate.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":"&nbsp;is as follows:"}]},{"block_type":"element","block":"k6pz2htu","search_text":"package main import ( \"fmt\" \"os\" \"path/filepath\" \"time\" ) func main() { var myDate string if len(os.Args) != 2 { fmt.Printf(\"usage: %s string\\n\", filepath.Base(os.Args[0])) return } myDate = os.Args[1] ","text_count":202,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"path/filepath\" \n    \"time\" \n) \n \nfunc main() { \n \n    var myDate string \n    if len(os.Args) != 2 { \n        fmt.Printf(\"usage: %s string\\n\", \n filepath.Base(os.Args[0])) \n        return \n    } \n \n    myDate = os.Args[1]"}]}]},{"block_type":"element","block":"k6pz2htv","search_text":"The second part of parseDate.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2htw","search_text":"d, err := time.Parse(\"02 January 2006\", myDate) if err == nil { fmt.Println(\"Full:\", d) fmt.Println(\"Time:\", d.Day(), d.Month(), d.Year()) } else { fmt.Println(err) } } ","text_count":169,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"d, err := time.Parse(\"02 January 2006\", myDate) \n    if err == nil { \n        fmt.Println(\"Full:\", d) \n        fmt.Println(\"Time:\", d.Day(), d.Month(), d.Year()) \n    } else { \n        fmt.Println(err) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2htx","search_text":"If there is a character such as - between the name of the month and the year, you can use \"02 January-2006\" instead of \"02 January 2006\" as the first parameter to time.Parse() .","text_count":177,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If there is a character such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-"}]},{"block_type":"text","content":"between the name of the month and the year, you can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"02 January-2006\""}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"02 January 2006\""}]},{"block_type":"text","content":"as the first parameter to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hty","search_text":"Executing parseDate.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2htz","search_text":"$ go run parseDate.go usage: parseDate string $ go run parseDate.go \"20 July 2000\" Full: 2000-07-20 00:00:00 +0000 UTC Time: 20 July 2000 ","text_count":138,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run parseDate.go\nusage: parseDate string\n$ go run parseDate.go \"20 July 2000\"\nFull: 2000-07-20 00:00:00 +0000 UTC\nTime: 20 July 2000"}]}]},{"block_type":"element","block":"k6pz2hu0","search_text":"As parseDate.go does not expect data about the time, the 00:00:00 +0000 UTC string is automatically added to the end of the full date and time string.","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":"does not expect data about the time, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"00:00:00 +0000 UTC"}]},{"block_type":"text","content":"string is automatically added to the end of the full date and time string."}]},{"block_type":"element","block":"k6pz2hu1","search_text":"Changing date and time formats","text_count":30,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Changing date and time formats"}]},{"block_type":"element","block":"k6pz2hu2","search_text":"In this section, you will learn how to change the format of a string that contains both a date and a time. A very common place for finding such strings is the log files of web servers such as Apache and Nginx . As we do not know how to read a text file line by line, the text will be hard coded in the program, This fact, however, does not change the functionality of the program.","text_count":380,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to change the format of a string that contains both a date and a time. A very common place for finding such strings is the log files of web servers such as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Apache"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Nginx"}]},{"block_type":"text","content":". As we do not know how to read a text file line by line, the text will be hard coded in the program, This fact, however, does not change the functionality of the program."}]},{"block_type":"element","block":"k6pz2hu3","search_text":"The Go code of timeDate.go will be presented in four parts. The first part of this program is the following expected preamble:","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"will be presented in four parts. The first part of this program is the following expected preamble:"}]},{"block_type":"element","block":"k6pz2hu4","search_text":"package main import ( \"fmt\" \"regexp\" \"time\" ) ","text_count":46,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"regexp\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2hu5","search_text":"You need to import the regexp standard Go package for supporting regular expressions.","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp"}]},{"block_type":"text","content":"standard Go package for supporting regular expressions."}]},{"block_type":"element","block":"k6pz2hu6","search_text":"The second code portion of timeDate.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hu7","search_text":"func main() { logs := []string{\"127.0.0.1 - - [16/Nov/2017:10:49:46 +0200] 325504\", \"127.0.0.1 - - [16/Nov/2017:10:16:41 +0200] \\\"GET /CVEN HTTP/1.1\\\" 200 12531 \\\"-\\\" \\\"Mozilla/5.0 AppleWebKit/537.36\", \"127.0.0.1 200 9412 - - [12/Nov/2017:06:26:05 +0200] \\\"GET \\\"http://www.mtsoukalos.eu/taxonomy/term/47\\\" 1507\", \"[12/Nov/2017:16:27:21 +0300]\", \"[12/Nov/2017:20:88:21 +0200]\", \"[12/Nov/2017:20:21 +0200]\", } ","text_count":409,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    logs := []string{\"127.0.0.1 - - [16/Nov/2017:10:49:46 +0200] \n 325504\", \n        \"127.0.0.1 - - [16/Nov/2017:10:16:41 +0200] \\\"GET /CVEN \n HTTP/1.1\\\" 200 12531 \\\"-\\\" \\\"Mozilla/5.0 AppleWebKit/537.36\", \n        \"127.0.0.1 200 9412 - - [12/Nov/2017:06:26:05 +0200] \\\"GET \n \\\"http://www.mtsoukalos.eu/taxonomy/term/47\\\" 1507\", \n        \"[12/Nov/2017:16:27:21 +0300]\", \n        \"[12/Nov/2017:20:88:21 +0200]\", \n        \"[12/Nov/2017:20:21 +0200]\", \n    }"}]}]},{"block_type":"element","block":"k6pz2hu8","search_text":"As you cannot be sure about your data and its format, the sample data used for this program tries to cover many different cases, including incomplete data like [12/Nov/2017:20:21 +0200] , where there are no seconds in the time part, and erroneous data such as [12/Nov/2017:20:88:21 +0200] , where the value of the minutes is 88 .","text_count":329,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you cannot be sure about your data and its format, the sample data used for this program tries to cover many different cases, including incomplete data like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[12/Nov/2017:20:21 +0200]"}]},{"block_type":"text","content":", where there are no seconds in the time part, and erroneous data such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[12/Nov/2017:20:88:21 +0200]"}]},{"block_type":"text","content":", where the value of the minutes is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"88"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hu9","search_text":"The third part of timeDate.go contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hua","search_text":"for _, logEntry := range logs { r := regexp.MustCompile('.*\\[(\\d\\d\\/\\w+/\\d\\d\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\].*') if r.MatchString(logEntry) { match := r.FindStringSubmatch(logEntry) ","text_count":174,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, logEntry := range logs { \n        r := regexp.MustCompile('.*\\[(\\d\\d\\/\\w+/\\d\\d\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\].*') \n        if r.MatchString(logEntry) { \n            match := r.FindStringSubmatch(logEntry)"}]}]},{"block_type":"element","block":"k6pz2hub","search_text":"The main benefit that you receive from such a difficult-to-read regular expression in this particular program is that it allows your code to find out whether you have a date and time string somewhere in your line or not. After you get that string, you will feed time.Parse() with it and let that do the rest of the job!","text_count":319,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main benefit that you receive from such a difficult-to-read regular expression in this particular program is that it allows your code to find out whether you have a date and time string somewhere in your line or not. After you get that string, you will feed"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":"with it and let that do the rest of the job!"}]},{"block_type":"element","block":"k6pz2huc","search_text":"The last part of the program is shown in the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hud","search_text":"dt, err := time.Parse(\"02/Jan/2006:15:04:05 -0700\", match[1]) if err == nil { newFormat := dt.Format(time.RFC850) fmt.Println(newFormat) } else { fmt.Println(\"Not a valid date time format!\") } } else { fmt.Println(\"Not a match!\") } } } ","text_count":236,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"dt, err := time.Parse(\"02/Jan/2006:15:04:05 -0700\", \n match[1]) \n            if err == nil { \n                newFormat := dt.Format(time.RFC850) \n                fmt.Println(newFormat) \n            } else { \n                fmt.Println(\"Not a valid date time format!\") \n            } \n        } else { \n            fmt.Println(\"Not a match!\") \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hue","search_text":"Once you find a string that matches the regular expression, you parse it using time.Parse() to make sure that it is a valid date/time string. If yes, timeDate.go will print the date and time according to the RFC850 format .","text_count":223,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once you find a string that matches the regular expression, you parse it using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Parse()"}]},{"block_type":"text","content":"to make sure that it is a valid date/time string. If yes,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"will print the date and time according to the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"RFC850 format"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2huf","search_text":"If you execute timeDate.go , you will get the following output:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hug","search_text":"$ go run timeDate.go Thursday, 16-Nov-17 10:49:46 EET Thursday, 16-Nov-17 10:16:41 EET Sunday, 12-Nov-17 06:26:05 EET Sunday, 12-Nov-17 16:27:21 +0300 Not a valid date time format! Not a match!","text_count":193,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run timeDate.go\nThursday, 16-Nov-17 10:49:46 EET\nThursday, 16-Nov-17 10:16:41 EET\nSunday, 12-Nov-17 06:26:05 EET\nSunday, 12-Nov-17 16:27:21 +0300\nNot a valid date time format!\nNot a match!"}]}]},{"block_type":"element","block":"k6pz2huh","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2hui","search_text":"Consider looking at the following resources:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Consider looking at the following resources:"}]},{"block_type":"element","block":"k6pz2huj","search_text":"Visit the documentation page of the time package that can be found at https://golang.org/pkg/time/ Visit the documentation page of the regexp standard Go package at https://golang.org/pkg/regexp/ ","text_count":196,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package that can be found at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/time/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/time/"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp"}]},{"block_type":"text","content":"standard Go package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/regexp/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/regexp/"}]}]}]},{"block_type":"element","block":"k6pz2huk","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2hul","search_text":"Write a constant generator iota for the powers of number 4. Write a constant generator iota for the days of the week. Write a Go program that converts an existing array into a map. Write your own version of parseTime.go . Do not forget to test your program. Can you create a version of timeDate.go that can process two date and time formats? Write your own version of parseDate.go . ","text_count":383,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a constant generator iota for the powers of number 4."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a constant generator iota for the days of the week."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program that converts an existing array into a map."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write your own version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseTime.go"}]},{"block_type":"text","content":". Do not forget to test your program."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you create a version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"that can process two date and time formats?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write your own version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"parseDate.go"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2hum","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2hun","search_text":"In this chapter, you learned about many interesting Go topics including maps, arrays, and slices, as well as Go pointers, Go constants and loops, and how Go allows you to work with dates and times. By now, you should understand why slices are superior to arrays.","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you learned about many interesting Go topics including maps, arrays, and slices, as well as Go pointers, Go constants and loops, and how Go allows you to work with dates and times. By now, you should understand why slices are superior to arrays."}]},{"block_type":"element","block":"k6pz2huo","search_text":"The next chapter will cover building and using composite types in Go, which mainly includes types that are created with the struct keyword and are called structures . After that, we will talk about string variables and tuples .","text_count":227,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next chapter will cover building and using composite types in Go, which mainly includes types that are created with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"keyword and are called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"structures"}]},{"block_type":"text","content":". After that, we will talk about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variables and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tuples"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hup","search_text":"Additionally, the next chapter will address Regular expressions and Pattern matching , which are tricky subjects, not only in Go but also in every other programming language as well. When used properly and carefully, however, regular expressions and pattern matching can make the life of a developer so much easier that it is totally worth learning more about them.","text_count":365,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, the next chapter will address"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Regular expressions"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pattern matching"}]},{"block_type":"text","content":", which are tricky subjects, not only in Go but also in every other programming language as well. When used properly and carefully, however, regular expressions and pattern matching can make the life of a developer so much easier that it is totally worth learning more about them."}]},{"block_type":"element","block":"k6pz2huq","search_text":"Also, you will learn about the switch keyword and the strings package that allow you to manipulate UTF-8 strings.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Also, you will learn about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"keyword and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package that allow you to manipulate"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"UTF-8"}]},{"block_type":"text","content":"strings."}]}]},{"title":"The Uses of Composite Types","author":"Mihalis Tsoukalos","block":"k6pz24gj","number":4,"contents":[{"block_type":"element","block":"k6pz2hur","search_text":"In the previous chapter, we talked about many core Go topics including arrays, slices, maps, pointers, constants, the for loop, the range keyword, and how to work with times and dates. This chapter will investigate more advanced Go features such as tuples and strings, the strings standard Go package, the switch statement, but most importantly structures that are created using the struct keyword. Another important topic of this chapter will be defining regular expressions and performing Pattern matching in Go. After all these topics, the last section of this chapter will implement a simple key-value store in Go.","text_count":618,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we talked about many core Go topics including arrays, slices, maps, pointers, constants, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword, and how to work with times and dates. This chapter will investigate more advanced Go features such as tuples and strings, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"standard Go package, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement, but most importantly structures that are created using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"keyword. Another important topic of this chapter will be defining regular expressions and performing Pattern matching in Go. After all these topics, the last section of this chapter will implement a simple"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"key-value store"}]},{"block_type":"text","content":"in Go."}]},{"block_type":"element","block":"k6pz2hus","search_text":"In this chapter, you will learn the following topics:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2hut","search_text":"Go structures and the struct keyword ","text_count":37,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"structures"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"keyword"}]}]},{"block_type":"element","block":"k6pz2huu","search_text":"Go tuples ","text_count":10,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tuples"}]}]}]},{"block_type":"element","block":"k6pz2huv","search_text":"Go strings, runes, byte slices, and string literals ","text_count":52,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go strings, runes, byte slices, and string literals"}]}]},{"block_type":"element","block":"k6pz2huw","search_text":"Regular expressions in Go ","text_count":26,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Regular expressions in Go"}]}]},{"block_type":"element","block":"k6pz2hux","search_text":"Pattern matching in Go ","text_count":23,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Pattern matching in Go"}]}]},{"block_type":"element","block":"k6pz2huy","search_text":"The switch statement ","text_count":21,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement"}]}]},{"block_type":"element","block":"k6pz2huz","search_text":"The functionality that the strings package offers ","text_count":50,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The functionality that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package offers"}]}]},{"block_type":"element","block":"k6pz2hv0","search_text":"Calculating Pi with great accuracy ","text_count":35,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Calculating"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pi"}]},{"block_type":"text","content":"with great accuracy"}]}]},{"block_type":"element","block":"k6pz2hv1","search_text":"Developing a key-value store ","text_count":29,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"key-value store"}]}]}]},{"block_type":"element","block":"k6pz2hv2","search_text":"About composite types","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About composite types"}]},{"block_type":"element","block":"k6pz2hv3","search_text":"Although standard Go types are pretty handy, fast, and flexible, they most likely cannot cover every kind of data that you want to support in your Go code. Go solves this problem by supporting structures , which are custom types defined by the developer. Additionally, Go has its own way of supporting tuples , which mainly allows functions to return multiple values without needing to group them in structures as is the case in C.","text_count":431,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although standard Go types are pretty handy, fast, and flexible, they most likely cannot cover every kind of data that you want to support in your Go code. Go solves this problem by supporting"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"structures"}]},{"block_type":"text","content":", which are custom types defined by the developer. Additionally, Go has its own way of supporting"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tuples"}]},{"block_type":"text","content":", which mainly allows functions to return multiple values without needing to group them in structures as is the case in C."}]},{"block_type":"element","block":"k6pz2hv4","search_text":"Structures","text_count":10,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Structures"}]},{"block_type":"element","block":"k6pz2hv5","search_text":"Although arrays, slices, and maps are all very useful, they cannot group and hold multiple values in the same place. When you need to group various types of variables and create a new handy type, you can use a structure. The various elements of a structure are called fields of the structure or just fields.","text_count":307,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although arrays, slices, and maps are all very useful, they cannot group and hold multiple values in the same place. When you need to group various types of variables and create a new handy type, you can use a structure. The various elements of a structure are called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"fields of the structure"}]},{"block_type":"text","content":"or just fields."}]},{"block_type":"element","block":"k6pz2hv6","search_text":"We will start this section by explaining a simple structure that was first defined in the sortSlice.go source file of the previous chapter:","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We will start this section by explaining a simple structure that was first defined in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sortSlice.go"}]},{"block_type":"text","content":"source file of the previous chapter:"}]},{"block_type":"element","block":"k6pz2hv7","search_text":"type aStructure struct { person string height int weight int } ","text_count":63,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type aStructure struct { \n    person string \n    height int \n    weight int \n}"}]}]},{"block_type":"element","block":"k6pz2hv8","search_text":"For reasons that will become evident in Chapter 6, What You Might Not Know About Go Packages , the fields of a structure usually begin with an uppercase letter. This convention will be used throughout the rest of the book.","text_count":222,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For reasons that will become evident in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":", the fields of a structure usually begin with an uppercase letter. This convention will be used throughout the rest of the book."}]},{"block_type":"element","block":"k6pz2hv9","search_text":"This structure has three fields named person , height , and weight , respectively. You can create a new variable of the aStructure type as follows:","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This structure has three fields named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"person"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"height"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"weight"}]},{"block_type":"text","content":", respectively. You can create a new variable of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aStructure"}]},{"block_type":"text","content":"type as follows:"}]},{"block_type":"element","block":"k6pz2hva","search_text":"var s1 aStructure ","text_count":18,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var s1 aStructure"}]}]},{"block_type":"element","block":"k6pz2hvb","search_text":"Additionally, you can access a specific field of a structure by its name. So, in order to get the value of the person field of the s1 variable, you should type s1.person .","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you can access a specific field of a structure by its name. So, in order to get the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"person"}]},{"block_type":"text","content":"field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1"}]},{"block_type":"text","content":"variable, you should type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1.person"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hvc","search_text":"A structure literal can be defined as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"structure literal"}]},{"block_type":"text","content":"can be defined as follows:"}]},{"block_type":"element","block":"k6pz2hvd","search_text":"p1 := aStructure{\"fmt\", 12, -2}","text_count":31,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"p1 := aStructure{\"fmt\", 12, -2}"}]}]},{"block_type":"element","block":"k6pz2hve","search_text":"However, since remembering the order of the fields of a structure can be pretty hard, Go allows you to use another form for defining a structure literal:","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, since remembering the order of the fields of a structure can be pretty hard, Go allows you to use another form for defining a structure literal:"}]},{"block_type":"element","block":"k6pz2hvf","search_text":"p1 := aStructure{weight: 12, height: -2} ","text_count":41,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"p1 := aStructure{weight: 12, height: -2}"}]}]},{"block_type":"element","block":"k6pz2hvg","search_text":"In this case, you do not need to define an initial value for every field of the structure.","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case, you do not need to define an initial value for every field of the structure."}]},{"block_type":"element","block":"k6pz2hvh","search_text":"Now that you know the basics of structures, it is time to show you a more practical example, which is named structures.go and will be presented in four parts.","text_count":158,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you know the basics of structures, it is time to show you a more practical example, which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"and will be presented in four parts."}]},{"block_type":"element","block":"k6pz2hvi","search_text":"The first part of structures.go contains the following code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2hvj","search_text":"package main import ( \"fmt\" )","text_count":29,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2hvk","search_text":"Note Structures in particular and Go types in general are usually defined outside the main() function in order to have a global scope and be available to the entire Go package, unless you want to clarify that a type is only useful within the current scope and is not expected to be used elsewhere. ","text_count":298,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Structures in particular and Go types in general are usually defined outside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function in order to have a global scope and be available to the entire Go package, unless you want to clarify that a type is only useful within the current scope and is not expected to be used elsewhere."}]}]},{"block_type":"element","block":"k6pz2hvl","search_text":"The second code segment of structures.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hvm","search_text":"func main() { type XYZ struct { X int Y int Z int } var s1 XYZ fmt.Println(s1.Y, s1.Z) ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    type XYZ struct { \n        X int \n        Y int \n        Z int \n    } \n \n    var s1 XYZ \n    fmt.Println(s1.Y, s1.Z)"}]}]},{"block_type":"element","block":"k6pz2hvn","search_text":"As you can see, there is nothing that prevents you from defining a new structure type inside a function, but you should have a reason for doing so.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, there is nothing that prevents you from defining a new structure type inside a function, but you should have a reason for doing so."}]},{"block_type":"element","block":"k6pz2hvo","search_text":"The third portion of structures.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hvp","search_text":"p1 := XYZ{23, 12, -2} p2 := XYZ{Z: 12, Y: 13} fmt.Println(p1) fmt.Println(p2) ","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"p1 := XYZ{23, 12, -2} \n    p2 := XYZ{Z: 12, Y: 13} \n    fmt.Println(p1) \n    fmt.Println(p2)"}]}]},{"block_type":"element","block":"k6pz2hvq","search_text":"Here you define two structure literals named p1 and p2 that you print afterwards.","text_count":81,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you define two structure literals named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p1"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"p2"}]},{"block_type":"text","content":"that you print afterwards."}]},{"block_type":"element","block":"k6pz2hvr","search_text":"The last part of structures.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hvs","search_text":"pSlice := [4]XYZ{} pSlice[2] = p1 pSlice[0] = p2 fmt.Println(pSlice) p2 = XYZ{1, 2, 3} fmt.Println(pSlice) } ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"pSlice := [4]XYZ{} \n    pSlice[2] = p1 \n    pSlice[0] = p2 \n    fmt.Println(pSlice) \n    p2 = XYZ{1, 2, 3} \n    fmt.Println(pSlice) \n}"}]}]},{"block_type":"element","block":"k6pz2hvt","search_text":"In this last part, we created an array of structures named pSlice. As you will understand from the output of structures.go , when you assign a structure to an array of structures, the structure is copied into the array, so changing the value of the original structure will have no effect on the objects of the array.","text_count":316,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this last part, we created an array of structures named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pSlice."}]},{"block_type":"text","content":"As you will understand from the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":", when you assign a structure to an array of structures, the structure is copied into the array, so changing the value of the original structure will have no effect on the objects of the array."}]},{"block_type":"element","block":"k6pz2hvu","search_text":"Executing structures.go will generate the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2hvv","search_text":"$ go run structures.go 0 0 {23 12 -2} {0 13 12} [{0 13 12} {0 0 0} {23 12 -2} {0 0 0}] [{0 13 12} {0 0 0} {23 12 -2} {0 0 0}]","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run structures.go\n0 0\n{23 12 -2}\n{0 13 12}\n[{0 13 12} {0 0 0} {23 12 -2} {0 0 0}]\n[{0 13 12} {0 0 0} {23 12 -2} {0 0 0}]"}]}]},{"block_type":"element","block":"k6pz2hvw","search_text":"Tip Note that the order in which you put the fields in the definition of a structure type is significant for the type identity of the defined structure. Put simply, two structures with the same fields will not be considered identical in Go if their fields are not in exactly the same order. ","text_count":291,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the order in which you put the fields in the definition of a structure type is significant for the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"type identity"}]},{"block_type":"text","content":"of the defined structure. Put simply, two structures with the same fields will not be considered identical in Go if their fields are not in exactly the same order."}]}]},{"block_type":"element","block":"k6pz2hvx","search_text":"The output of structures.go illustrates that the zero value of a struct variable is constructed by zeroing all of the fields of the struct variable according to their types.","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"structures.go"}]},{"block_type":"text","content":"illustrates that the zero value of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"variable is constructed by zeroing all of the fields of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"variable according to their types."}]},{"block_type":"element","block":"k6pz2hvy","search_text":"Pointers to structures","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Pointers to structures"}]},{"block_type":"element","block":"k6pz2hvz","search_text":"In the previous chapter, we talked about pointers. In this section, we will continue our discussion of pointers and present an example that is related to pointers to structures . The name of the program is pointerStruct.go and will be presented in four parts.","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we talked about pointers. In this section, we will continue our discussion of pointers and present an example that is related to"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pointers to structures"}]},{"block_type":"text","content":". The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":"and will be presented in four parts."}]},{"block_type":"element","block":"k6pz2hw0","search_text":"The first part of the program contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hw1","search_text":"package main import ( \"fmt\" ) type myStructure struct { Name string Surname string Height int32 } ","text_count":98,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype myStructure struct { \n    Name    string \n    Surname string \n    Height  int32 \n}"}]}]},{"block_type":"element","block":"k6pz2hw2","search_text":"The second code segment from pointerStruct.go follows next:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2hw3","search_text":"func createStruct(n, s string, h int32) *myStructure { if h > 300 { h = 0 } return &myStructure{n, s, h} } ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func createStruct(n, s string, h int32) *myStructure { \n    if h &gt; 300 { \n        h = 0 \n    } \n    return &amp;myStructure{n, s, h} \n}"}]}]},{"block_type":"element","block":"k6pz2hw4","search_text":"The approach used in createStruct() for creating a new structure variable has many advantages over initializing structure variables on your own, including the fact that you are allowed to check whether the information provided is both correct and valid. Additionally, this approach is cleaner-there is a central point where structure variables are initialized so that if there is something wrong with your struct variables, you know where to look and who to blame! Note that some people might prefer to name the createStruct() function as NewStruct() .","text_count":552,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The approach used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"createStruct()"}]},{"block_type":"text","content":"for creating a new structure variable has many advantages over initializing structure variables on your own, including the fact that you are allowed to check whether the information provided is both correct and valid. Additionally, this approach is cleaner-there is a central point where structure variables are initialized so that if there is something wrong with your"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"variables, you know where to look and who to blame! Note that some people might prefer to name the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"createStruct()"}]},{"block_type":"text","content":"function as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NewStruct()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hw5","search_text":"Tip For those with a C or C++ background, it is perfectly legal for a Go function to return the memory address of a local variable. Nothing gets lost, so everybody is happy! ","text_count":174,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For those with a C or C++ background, it is perfectly legal for a Go function to return the memory address of a local variable. Nothing gets lost, so everybody is happy!"}]}]},{"block_type":"element","block":"k6pz2hw6","search_text":"The third portion of pointerStruct.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hw7","search_text":"func retStructure(n, s string, h int32) myStructure { if h > 300 { h = 0 } return myStructure{n, s, h} } ","text_count":105,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func retStructure(n, s string, h int32) myStructure { \n    if h &gt; 300 { \n        h = 0 \n    } \n    return myStructure{n, s, h} \n}"}]}]},{"block_type":"element","block":"k6pz2hw8","search_text":"This part presents the no pointer version of the createStruct() function named retStructure() . Both functions work fine, so choosing between the implementation of createStruct() and retStructure() is just a matter of personal preference. A more appropriate name for these functions might have been NewStructurePointer and NewStructure , respectively.","text_count":351,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part presents the no pointer version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"createStruct()"}]},{"block_type":"text","content":"function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retStructure()"}]},{"block_type":"text","content":". Both functions work fine, so choosing between the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"createStruct()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retStructure()"}]},{"block_type":"text","content":"is just a matter of personal preference. A more appropriate name for these functions might have been"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NewStructurePointer"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NewStructure"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2hw9","search_text":"The last part of pointerStruct.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hwa","search_text":"func main() { s1 := createStruct(\"Mihalis\", \"Tsoukalos\", 123) s2 := retStructure(\"Mihalis\", \"Tsoukalos\", 123) fmt.Println((*s1).Name) fmt.Println(s2.Name) fmt.Println(s1) fmt.Println(s2) } ","text_count":189,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    s1 := createStruct(\"Mihalis\", \"Tsoukalos\", 123) \n    s2 := retStructure(\"Mihalis\", \"Tsoukalos\", 123) \n    fmt.Println((*s1).Name) \n    fmt.Println(s2.Name) \n    fmt.Println(s1) \n    fmt.Println(s2) \n}"}]}]},{"block_type":"element","block":"k6pz2hwb","search_text":"If you execute pointerStruct.go , you will get the following output:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2hwc","search_text":"$ go run pointerStruct.go Mihalis Mihalis &{Mihalis Tsoukalos 123} {Mihalis Tsoukalos 123}","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run pointerStruct.go\nMihalis\nMihalis\n&amp;{Mihalis Tsoukalos 123}\n{Mihalis Tsoukalos 123}"}]}]},{"block_type":"element","block":"k6pz2hwd","search_text":"Here you can see one more time that the main difference between createStruct() and retStructure() is that the former returns a pointer to a structure, which means that you will need to dereference that pointer in order to use the object to which it points. This can make your code look a little uglier.","text_count":302,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see one more time that the main difference between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"createStruct()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retStructure()"}]},{"block_type":"text","content":"is that the former returns a pointer to a structure, which means that you will need to dereference that pointer in order to use the object to which it points. This can make your code look a little uglier."}]},{"block_type":"element","block":"k6pz2hwe","search_text":"Note Structures are very important in Go, and they are being used extensively in real-world programs because they allow you to group as many values as you want and treat those values as a single entity. ","text_count":203,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Structures are very important in Go, and they are being used extensively in real-world programs because they allow you to group as many values as you want and treat those values as a single entity."}]}]},{"block_type":"element","block":"k6pz2hwf","search_text":"Using the new keyword","text_count":21,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using the new keyword"}]},{"block_type":"element","block":"k6pz2hwg","search_text":"Go supports the new keyword that allows you to allocate new objects. However, there is a very important detail that you need to remember about new : new returns the memory address of the allocated object. Put simply, new returns a pointer!","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go supports the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"keyword that allows you to allocate new objects. However, there is a very important detail that you need to remember about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":":"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"returns the memory address of the allocated object. Put simply,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"returns a pointer!"}]},{"block_type":"element","block":"k6pz2hwh","search_text":"You can create a fresh aStructure variable as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can create a fresh"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aStructure"}]},{"block_type":"text","content":"variable as follows:"}]},{"block_type":"element","block":"k6pz2hwi","search_text":"pS := new(aStructure) ","text_count":22,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"pS := new(aStructure)"}]}]},{"block_type":"element","block":"k6pz2hwj","search_text":"After executing the new statement, you are ready to work with your fresh variable that has its allocated memory zeroed, but not initialized.","text_count":140,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After executing the new statement, you are ready to work with your fresh variable that has its allocated memory zeroed, but not initialized."}]},{"block_type":"element","block":"k6pz2hwk","search_text":"Note The main difference between new and make is that variables created with make are properly initialized without just zeroing the allocated memory space. Additionally, make can only be applied to maps, channels, and slices, and it does not return a memory address, which means that make does not return a pointer. ","text_count":316,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main difference between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":"is that variables created with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":"are properly initialized without just zeroing the allocated memory space. Additionally,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":"can only be applied to maps, channels, and slices, and it does not return a memory address, which means that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":"does not return a pointer."}]}]},{"block_type":"element","block":"k6pz2hwl","search_text":"The next statement will create a slice with new that points to nil :","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next statement will create a slice with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"that points to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2hwm","search_text":"sP := new([]aStructure) ","text_count":24,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sP := new([]aStructure)"}]}]},{"block_type":"element","block":"k6pz2hwn","search_text":"Tuples","text_count":6,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Tuples"}]},{"block_type":"element","block":"k6pz2hwo","search_text":"Strictly speaking, a tuple is a finite ordered list with multiple parts. The most important thing about tuples is that Go has no support for the tuple type, which means that Go does not officially care about tuples despite the fact that it has support for certain uses of tuples.","text_count":279,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tuple"}]},{"block_type":"text","content":"is a finite ordered list with multiple parts. The most important thing about tuples is that Go has no support for the tuple type, which means that Go does not officially care about tuples despite the fact that it has support for certain uses of tuples."}]},{"block_type":"element","block":"k6pz2hwp","search_text":"One interesting point here is that we have been using Go tuples in this book since Chapter 1, Go and the Operating System . They are used in statements like the next one, where a function returns two values that you get in a single statement:","text_count":242,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One interesting point here is that we have been using"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go tuples"}]},{"block_type":"text","content":"in this book since Chapter 1,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go and the Operating System"}]},{"block_type":"text","content":". They are used in statements like the next one, where a function returns two values that you get in a single statement:"}]},{"block_type":"element","block":"k6pz2hwq","search_text":"min, _ := strconv.ParseFloat(arguments[1], 64)","text_count":46,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"min, _ := strconv.ParseFloat(arguments[1], 64)"}]}]},{"block_type":"element","block":"k6pz2hwr","search_text":"The name of the Go program that will illustrate Go tuples is tuples.go , and it will be presented in three code segments. Please note that the code presented uses a function that returns three values as a tuple. You will learn more about functions in Chapter 6, W hat You Might Not Know About Go Packages .","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go program that will illustrate Go tuples is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tuples.go"}]},{"block_type":"text","content":", and it will be presented in three code segments. Please note that the code presented uses a function that returns three values as a tuple. You will learn more about functions in Chapter 6, W"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"hat You Might Not Know About Go Packages"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hws","search_text":"The first part of tuples.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tuples.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hwt","search_text":"package main import ( \"fmt\" ) func retThree(x int) (int, int, int) { return 2 * x, x * x, -x } ","text_count":95,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc retThree(x int) (int, int, int) { \n    return 2 * x, x * x, -x \n}"}]}]},{"block_type":"element","block":"k6pz2hwu","search_text":"Here you can see the implementation of a function named retThree() that returns a tuple containing three integer values. This capability permits the function to return multiple values without needing to group the various return values into a structure and to return a structure variable instead.","text_count":295,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see the implementation of a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retThree()"}]},{"block_type":"text","content":"that returns a tuple containing three integer values. This capability permits the function to return multiple values without needing to group the various return values into a structure and to return a structure variable instead."}]},{"block_type":"element","block":"k6pz2hwv","search_text":"In Chapter 6, What You Might Not Know About Go Packages , you will learn how to assign names to the return values of a Go function, which is a very handy feature that can save you from various types of bugs.","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":", you will learn how to assign names to the return values of a Go function, which is a very handy feature that can save you from various types of bugs."}]},{"block_type":"element","block":"k6pz2hww","search_text":"The second part of tuples.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tuples.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hwx","search_text":"func main() { fmt.Println(retThree(10)) n1, n2, n3 := retThree(20) fmt.Println(n1, n2, n3) ","text_count":91,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fmt.Println(retThree(10)) \n    n1, n2, n3 := retThree(20) \n    fmt.Println(n1, n2, n3)"}]}]},{"block_type":"element","block":"k6pz2hwy","search_text":"Here, we use the retThree() function twice. First, we do this without saving its return values. Second, by saving the three return values of retThree() in three different variables using a single statement, which in Go terminology is called a tuple assignment, hence the confusion about Go supporting tuples! If you do not care about one or more return values of a function, you can use an underscore character ( _ ) in its place. Note that it is a compile time error in Go if you declare a variable and do not use it afterwards.","text_count":529,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here, we use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retThree()"}]},{"block_type":"text","content":"function twice. First, we do this without saving its return values. Second, by saving the three return values of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"retThree()"}]},{"block_type":"text","content":"in three different variables using a single statement, which in Go terminology is called a tuple assignment, hence the confusion about Go supporting tuples! If you do not care about one or more return values of a function, you can use an underscore character ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_"}]},{"block_type":"text","content":") in its place. Note that it is a compile time error in Go if you declare a variable and do not use it afterwards."}]},{"block_type":"element","block":"k6pz2hwz","search_text":"The third part of the tuples.go program is shown in the following Go code:","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tuples.go"}]},{"block_type":"text","content":"program is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hx0","search_text":"n1, n2 = n2, n1 fmt.Println(n1, n2, n3) x1, x2, x3 := n1*2, n1*n1, -n1 fmt.Println(x1, x2, x3) } ","text_count":97,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"n1, n2 = n2, n1 \n    fmt.Println(n1, n2, n3) \n \n    x1, x2, x3 := n1*2, n1*n1, -n1 \n    fmt.Println(x1, x2, x3) \n}"}]}]},{"block_type":"element","block":"k6pz2hx1","search_text":"As you can see, tuples can do many intelligent things like swapping values without the need for a temporary variable as well as evaluating expressions.","text_count":151,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, tuples can do many intelligent things like swapping values without the need for a temporary variable as well as evaluating expressions."}]},{"block_type":"element","block":"k6pz2hx2","search_text":"Executing tuples.go will create the following output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tuples.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2hx3","search_text":"$ go run tuples.go 20 100 -10 40 400 -20 400 40 -20 800 160000 -400","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run tuples.go\n20 100 -10\n40 400 -20\n400 40 -20\n800 160000 -400"}]}]},{"block_type":"element","block":"k6pz2hx4","search_text":"Regular expressions and pattern matching","text_count":40,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Regular expressions and pattern matching"}]},{"block_type":"element","block":"k6pz2hx5","search_text":"Pattern matching , which plays a key role in Go, is a technique used for searching a string for some set of characters based on a specific search pattern that is based on regular expressions and grammars . If pattern matching is successful, it allows you to extract the desired data from the string, replace it, or delete it.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pattern matching"}]},{"block_type":"text","content":", which plays a key role in Go, is a technique used for searching a string for some set of characters based on a specific search pattern that is based on"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"regular expressions"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"grammars"}]},{"block_type":"text","content":". If pattern matching is successful, it allows you to extract the desired data from the string, replace it, or delete it."}]},{"block_type":"element","block":"k6pz2hx6","search_text":"The Go package responsible for defining regular expressions and performing pattern matching is called regexp . You will see it in action in a while.","text_count":148,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go package responsible for defining regular expressions and performing pattern matching is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp"}]},{"block_type":"text","content":". You will see it in action in a while."}]},{"block_type":"element","block":"k6pz2hx7","search_text":"Tip When using a regular expression in your code, you should consider the definition of the regular expression as the most important part of your program. ","text_count":155,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When using a regular expression in your code, you should consider the definition of the regular expression as the most important part of your program."}]}]},{"block_type":"element","block":"k6pz2hx8","search_text":"Now for some theory","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Now for some theory"}]},{"block_type":"element","block":"k6pz2hx9","search_text":"Every regular expression is compiled into a recognizer by building a generalized transition diagram called a finite automaton . A finite automaton can be either deterministic or nondeterministic. Nondeterministic means that more than one transition out of a state can be possible for the same input. A recognizer is a program that takes a string x as input and is able to tell if x is a sentence of a given language.","text_count":416,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Every regular expression is compiled into a recognizer by building a generalized transition diagram called a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"finite automaton"}]},{"block_type":"text","content":". A finite automaton can be either deterministic or nondeterministic. Nondeterministic means that more than one transition out of a state can be possible for the same input. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"recognizer"}]},{"block_type":"text","content":"is a program that takes a string"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"as input and is able to tell if"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"is a sentence of a given language."}]},{"block_type":"element","block":"k6pz2hxa","search_text":"A grammar is a set of production rules for strings in a formal language. The production rules describe how to create strings from the alphabet of the language that are valid according to the syntax of the language. A grammar does not describe the meaning of a string or what can be done with it in whatever context-it only describes its form. What is important here is to realize that grammars are the heart of regular expressions because, without a grammar, you cannot define or use a regular expression.","text_count":505,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"grammar"}]},{"block_type":"text","content":"&nbsp;is a set of production rules for strings in a formal language. The production rules describe how to create strings from the alphabet of the language that are valid according to the syntax of the language. A grammar does not describe the meaning of a string or what can be done with it in whatever context-it only describes its form. What is important here is to realize that grammars are the heart of regular expressions because, without a grammar, you cannot define or use a regular expression."}]},{"block_type":"element","block":"k6pz2hxb","search_text":"Tip Although regular expressions allow you to solve problems that would be extremely difficult to solve otherwise, do not try to solve every problem you face with a regular expression. Always use the right tool for the job! ","text_count":224,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although regular expressions allow you to solve problems that would be extremely difficult to solve otherwise, do not try to solve every problem you face with a regular expression. Always use the right tool for the job!"}]}]},{"block_type":"element","block":"k6pz2hxc","search_text":"The rest of this section will present three examples of regular expressions and pattern matching.","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The rest of this section will present three examples of regular expressions and pattern matching."}]},{"block_type":"element","block":"k6pz2hxd","search_text":"A simple example","text_count":16,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A simple example"}]},{"block_type":"element","block":"k6pz2hxe","search_text":"In this subsection, you will learn how to select a particular column from a line of text. To make things more interesting, you will also learn how to read a text file line by line. However, file I/O is the subject of Chapter 8, Telling a Unix System What to Do , so you refer to that chapter in order to get more information about the relevant Go code.","text_count":352,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to select a particular column from a line of text. To make things more interesting, you will also learn how to read a text file line by line. However, file I/O is the subject of Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":",&nbsp;so you refer to that chapter in order to get more information about the relevant Go code."}]},{"block_type":"element","block":"k6pz2hxf","search_text":"The name of the Go source file for this example is selectColumn.go . It will be presented in five segments. The utility needs at least two command-line arguments to operate; the first one is the column number you want, and the second one is the path of the text file to process. Nonetheless, you can put as many text files as you want—selectColumn.go will process all of them one by one!","text_count":387,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go source file for this example is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":". It will be presented in five segments. The utility needs at least two command-line arguments to operate; the first one is the column number you want, and the second one is the path of the text file to process. Nonetheless, you can put as many text files as you want&mdash;selectColumn.go will process all of them one by one!"}]},{"block_type":"element","block":"k6pz2hxg","search_text":"The first part of selectColumn.go is follows next:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"is follows next:"}]},{"block_type":"element","block":"k6pz2hxh","search_text":"package main import ( \"bufio\" \"fmt\" \"io\" \"os\" \"strconv\" \"strings\" ) ","text_count":68,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n    \"strconv\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2hxi","search_text":"The second code portion of selectColumn.go contains the following Go code:","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hxj","search_text":"func main() { arguments := os.Args if len(arguments) < 2 { fmt.Printf(\"usage: selectColumn column <file1> [<file2> [... <fileN]]\\n\") os.Exit(1) } temp, err := strconv.Atoi(arguments[1]) if err != nil { fmt.Println(\"Column value is not an integer:\", temp) return } column := temp if column < 0 { fmt.Println(\"Invalid Column number!\") os.Exit(1) } ","text_count":346,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) &lt; 2 { \n        fmt.Printf(\"usage: selectColumn column &lt;file1&gt; [&lt;file2&gt; [... &lt;fileN]]\\n\") \n        os.Exit(1) \n    } \n \n    temp, err := strconv.Atoi(arguments[1]) \n    if err != nil { \n        fmt.Println(\"Column value is not an integer:\", temp) \n        return \n    } \n \n    column := temp \n    if column &lt; 0 { \n        fmt.Println(\"Invalid Column number!\") \n        os.Exit(1) \n    }"}]}]},{"block_type":"element","block":"k6pz2hxk","search_text":"The first test that the program performs is to make sure that it has an adequate number of command-line arguments ( len(arguments) < 2 ). Additionally, you need two more tests to make sure that the provided column value is actually a number and that it is bigger than 0 .","text_count":271,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first test that the program performs is to make sure that it has an adequate number of command-line arguments ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(arguments) &lt; 2"}]},{"block_type":"text","content":"). Additionally, you need two more tests to make sure that the provided column value is actually a number and that it is bigger than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2hxl","search_text":"The third part of selectColumn.go follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2hxm","search_text":"for _, filename := range arguments[2:] { fmt.Println(\"\\t\\t\", filename) f, err := os.Open(filename) if err != nil { fmt.Printf(\"error opening file %s\\n\", err) continue } defer f.Close() ","text_count":185,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, filename := range arguments[2:] { \n        fmt.Println(\"\\t\\t\", filename) \n        f, err := os.Open(filename) \n        if err != nil { \n            fmt.Printf(\"error opening file %s\\n\", err) \n            continue \n        } \n        defer f.Close()"}]}]},{"block_type":"element","block":"k6pz2hxn","search_text":"The program performs various tests to make sure that the text file does exist and that you can read it. The os.Open() function is used for opening the text file. Remember that the Unix file permissions of a text file might not allow you to read it.","text_count":248,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The program performs various tests to make sure that the text file does exist and that you can read it. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Open()"}]},{"block_type":"text","content":"function is used for opening the text file. Remember that the Unix file permissions of a text file might not allow you to read it."}]},{"block_type":"element","block":"k6pz2hxo","search_text":"The fourth code piece of selectColumn.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code piece of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hxp","search_text":"r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break } else if err != nil { fmt.Printf(\"error reading file %s\", err) } ","text_count":153,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r := bufio.NewReader(f) \n        for { \n            line, err := r.ReadString('\\n') \n \n            if err == io.EOF { \n                break \n            } else if err != nil { \n                fmt.Printf(\"error reading file %s\", err) \n            }"}]}]},{"block_type":"element","block":"k6pz2hxq","search_text":"As you will learn in Chapter 8, Telling a Unix System What to Do , the bufio.ReadString() function reads a file until the first occurrence of its parameter. As a result, bufio.ReadString('\\n') tells Go to read a file line by line because \\n is the Unix newline character! The bufio.ReadString() function returns a byte slice.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will learn in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":",&nbsp;the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"function reads a file until the first occurrence of its parameter. As a result,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString('\\n')"}]},{"block_type":"text","content":"tells Go to read a file line by line because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\\n"}]},{"block_type":"text","content":"is the Unix newline character! The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"function returns a byte slice."}]},{"block_type":"element","block":"k6pz2hxr","search_text":"The last code segment of selectColumn.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hxs","search_text":"data := strings.Fields(line) if len(data) >= column { fmt.Println((data[column-1])) } } } } ","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"data := strings.Fields(line) \n            if len(data) &gt;= column { \n                fmt.Println((data[column-1])) \n            } \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hxt","search_text":"The logic behind the program is pretty simple: you split each line of text and select the desired column. However, as you cannot be sure that the current line has the required number of fields, you check that before printing any output. This is the simplest form of pattern matching because each line is split using space characters as word separators.","text_count":352,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The logic behind the program is pretty simple: you split each line of text and select the desired column. However, as you cannot be sure that the current line has the required number of fields, you check that before printing any output. This is the simplest form of pattern matching because each line is split using space characters as word separators."}]},{"block_type":"element","block":"k6pz2hxu","search_text":"If you want to have more information about the splitting of the lines—and I am sure that you do—then you will find very useful the fact that the strings.Fields() function splits a string based on the whitespace characters that are defined in the unicode.IsSpace() function and returns a slice of strings.","text_count":304,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to have more information about the splitting of the lines&mdash;and I am sure that you do&mdash;then you will find very useful the fact that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Fields()"}]},{"block_type":"text","content":"function splits a string based on the whitespace characters that are defined in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.IsSpace()"}]},{"block_type":"text","content":"function and returns a slice of strings."}]},{"block_type":"element","block":"k6pz2hxv","search_text":"Executing selectColumn.go will generate the next type of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"will generate the next type of output:"}]},{"block_type":"element","block":"k6pz2hxw","search_text":"$ go run selectColumn.go 15 /tmp/swtag.log /tmp/adobegc.log | head /tmp/swtag.log /tmp/adobegc.log AdobeGCData Successfully Initializing Stream ***********AdobeGC Perform Perform Trying","text_count":185,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run selectColumn.go 15 /tmp/swtag.log /tmp/adobegc.log  | head             /tmp/swtag.log             /tmp/adobegc.log\nAdobeGCData\nSuccessfully\nInitializing\nStream\n***********AdobeGC\nPerform\nPerform\nTrying"}]}]},{"block_type":"element","block":"k6pz2hxx","search_text":"The selectColumn.go utility prints the name of each processed file, even if you get no output from that file.","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go"}]},{"block_type":"text","content":"utility prints the name of each processed file, even if you get no output from that file."}]},{"block_type":"element","block":"k6pz2hxy","search_text":"Tip The important thing to remember here is that you should never trust your data, especially when it comes from nontechnical users. Put simply, always verify that the data you expect to grab is there! ","text_count":202,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The important thing to remember here is that you should never trust your data, especially when it comes from nontechnical users. Put simply, always verify that the data you expect to grab is there!"}]}]},{"block_type":"element","block":"k6pz2hxz","search_text":"A more advanced example","text_count":23,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A more advanced example"}]},{"block_type":"element","block":"k6pz2hy0","search_text":"In this section, you will learn how to match a date and time string as found in the log files of an Apache web server. To make things even more interesting, you will also learn how to change the date and time format of the log file into a different format. Once again, this requires reading the Apache log file, which is a plain text file, line by line.","text_count":353,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to match a date and time string as found in the log files of an Apache web server. To make things even more interesting, you will also learn how to change the date and time format of the log file into a different format. Once again, this requires reading the Apache log file, which is a plain text file, line by line."}]},{"block_type":"element","block":"k6pz2hy1","search_text":"The name of the command-line utility is changeDT.go , and it will be presented in five parts. Note that changeDT.go is an improved version of the timeDate.go utility presented in Chapter 3, Working with Basic Go Data Types , not only because it gets its data from an external file, but also because changeDT.go uses two regular expressions and therefore is able to match strings in two different time and date formats.","text_count":418,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the command-line utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":", and it will be presented in five parts. Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"is an improved version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeDate.go"}]},{"block_type":"text","content":"utility presented in Chapter 3,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Working with Basic Go Data Types"}]},{"block_type":"text","content":",&nbsp;not only because it gets its data from an external file, but also because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"uses two regular expressions and therefore is able to match strings in two different time and date formats."}]},{"block_type":"element","block":"k6pz2hy2","search_text":"Tip The very important point to note here is not try to implement every possible feature in the first version of your utilities! A better approach is to build a working version with fewer features and improve that version in small steps. ","text_count":238,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The very important point to note here is not try to implement every possible feature in the first version of your utilities! A better approach is to build a working version with fewer features and improve that version in small steps."}]}]},{"block_type":"element","block":"k6pz2hy3","search_text":"The first chunk of code of changeDT.go follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first chunk of code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2hy4","search_text":"package main import ( \"bufio\" \"fmt\" \"io\" \"os\" \"regexp\" \"strings\" \"time\" ) ","text_count":74,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n    \"regexp\" \n    \"strings\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2hy5","search_text":"Lots of packages are needed because changeDT.go does so many fascinating things.","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Lots of packages are needed because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"does so many fascinating things."}]},{"block_type":"element","block":"k6pz2hy6","search_text":"The second piece for code of changeDT.go is the following:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second piece for code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2hy7","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide one text file to process!\") os.Exit(1) } filename := arguments[1] f, err := os.Open(filename) if err != nil { fmt.Printf(\"error opening file %s\", err) os.Exit(1) } defer f.Close() notAMatch := 0 r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break","text_count":369,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide one text file to process!\") \n        os.Exit(1) \n    } \n \n    filename := arguments[1] \n    f, err := os.Open(filename) \n    if err != nil { \n        fmt.Printf(\"error opening file %s\", err) \n        os.Exit(1) \n    } \n    defer f.Close() \n \n    notAMatch := 0 \n    r := bufio.NewReader(f) \n    for { \n        line, err := r.ReadString('\\n') \n        if err == io.EOF { \n            break"}]}]},{"block_type":"element","block":"k6pz2hy8","search_text":"} else if err != nil { fmt.Printf(\"error reading file %s\", err) } ","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} else if err != nil { \n            fmt.Printf(\"error reading file %s\", err) \n        }"}]}]},{"block_type":"element","block":"k6pz2hy9","search_text":"In this part, you just try to open your input file for reading in order to read it line by line. The notAMatch variable holds the number of lines in the input file that did not match any one of the two regular expressions of the program.","text_count":237,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you just try to open your input file for reading in order to read it line by line. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"notAMatch"}]},{"block_type":"text","content":"variable holds the number of lines in the input file that did not match any one of the two regular expressions of the program."}]},{"block_type":"element","block":"k6pz2hya","search_text":"The third code segment of changeDT.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hyb","search_text":"r1 := regexp.MustCompile ('.*\\[(\\d\\d\\/\\w+/\\d\\d\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\] .*') if r1.MatchString(line) { match := r1.FindStringSubmatch(line) d1, err := time.Parse(\"02/Jan/2006:15:04:05 -0700\", match[1]) if err == nil { newFormat := d1.Format(time.Stamp) fmt.Print(strings.Replace(line, match[1], newFormat, 1)) else { notAMatch++ } continue } ","text_count":341,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r1 := regexp.MustCompile\n('.*\\[(\\d\\d\\/\\w+/\\d\\d\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\] .*') \n        if r1.MatchString(line) { \n            match := r1.FindStringSubmatch(line) \n            d1, err := time.Parse(\"02/Jan/2006:15:04:05 -0700\", match[1]) \n            if err == nil { \n                newFormat := d1.Format(time.Stamp) \n                fmt.Print(strings.Replace(line, match[1], newFormat, 1)) \n            else { \n                notAMatch++ \n            } \n            continue \n        }"}]}]},{"block_type":"element","block":"k6pz2hyc","search_text":"Here you can see that if the first date and time format is not a match, the program will continue its execution. However, if it enters the if block, the continue statement will get executed, which means that it will skip the remaining code of the surrounding for loop. Thus, in the first supported format, the time and date string has the 21/Nov/2017:19:28:09 +0200 format.","text_count":373,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see that if the first date and time format is not a match, the program will continue its execution. However, if it enters the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"block, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"continue"}]},{"block_type":"text","content":"statement will get executed, which means that it will skip the remaining code of the surrounding"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. Thus, in the first supported format, the time and date string has the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"21/Nov/2017:19:28:09 +0200"}]},{"block_type":"text","content":"format."}]},{"block_type":"element","block":"k6pz2hyd","search_text":"The regexp.MustCompile() function is like regexp.Compile() , but it panics if the expression cannot be parsed. The parenthesis around the regular expression allows you to use the matches afterwards. In this case, you can only have one match, which you will get using the regexp.FindStringSubmatch() function.","text_count":308,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp.MustCompile()"}]},{"block_type":"text","content":"function is like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp.Compile()"}]},{"block_type":"text","content":", but it panics if the expression cannot be parsed. The parenthesis around the regular expression allows you to use the matches afterwards. In this case, you can only have one match, which you will get using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp.FindStringSubmatch()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2hye","search_text":"The fourth part of changeDT.go follows next:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"&nbsp;follows next:"}]},{"block_type":"element","block":"k6pz2hyf","search_text":"r2 := regexp.MustCompile('.*\\[(\\w+\\-\\d\\d-\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\] .*') if r2.MatchString(line) { match := r2.FindStringSubmatch(line) d1, err := time.Parse(\"Jan-02-06:15:04:05 -0700\", match[1]) if err == nil { newFormat := d1.Format(time.Stamp) fmt.Print(strings.Replace(line, match[1], newFormat, 1)) else { notAMatch++ } continue } ","text_count":334,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r2 := regexp.MustCompile('.*\\[(\\w+\\-\\d\\d-\\d\\d:\\d\\d:\\d\\d:\\d\\d.*)\\] .*') \n    if r2.MatchString(line) { \n        match := r2.FindStringSubmatch(line) \n        d1, err := time.Parse(\"Jan-02-06:15:04:05 -0700\", match[1]) \n        if err == nil { \n            newFormat := d1.Format(time.Stamp) \n            fmt.Print(strings.Replace(line, match[1], newFormat, 1)) \n        else { \n            notAMatch++ \n        } \n        continue \n    }"}]}]},{"block_type":"element","block":"k6pz2hyg","search_text":"The second supported time and date format is Jun-21-17:19:28:09 +0200 . As you can understand, there are not that many differences between the two formats. Note that although the program uses just two date and time formats, you can have as many of these types of formats as you desire.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second supported time and date format is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Jun-21-17:19:28:09 +0200"}]},{"block_type":"text","content":". As you can understand, there are not that many differences between the two formats. Note that although the program uses just two date and time formats, you can have as many of these types of formats as you desire."}]},{"block_type":"element","block":"k6pz2hyh","search_text":"The last code portion of changeDT.go contains the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hyi","search_text":"} fmt.Println(notAMatch, \"lines did not match!\") } ","text_count":51,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} \n    fmt.Println(notAMatch, \"lines did not match!\") \n}"}]}]},{"block_type":"element","block":"k6pz2hyj","search_text":"Here you just print the number of lines that did not match any one of the two formats.","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you just print the number of lines that did not match any one of the two formats."}]},{"block_type":"element","block":"k6pz2hyk","search_text":"The text file that will be used for testing changeDT.go contains the following lines:","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The text file that will be used for testing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changeDT.go"}]},{"block_type":"text","content":"contains the following lines:"}]},{"block_type":"element","block":"k6pz2hyl","search_text":"$ cat logEntries.txt - - [21/Nov/2017:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 2188249 \"-\" - - [21/Jun/2017:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 - - [25/Lun/2017:20:05:34 +0200] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362 - - [Jun-21-17:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 - - [20/Nov/2017:20:05:34 +0200] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362 - - [35/Nov/2017:20:05:34 +0200] \"GET MongoDjango.zip HTTP/1.1\" 200 118362","text_count":458,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cat logEntries.txt\n- - [21/Nov/2017:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 2188249 \"-\"\n- - [21/Jun/2017:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200\n- - [25/Lun/2017:20:05:34 +0200] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362\n- - [Jun-21-17:19:28:09 +0200] \"GET /AMEv2.tif.zip HTTP/1.1\" 200\n- - [20/Nov/2017:20:05:34 +0200] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362\n- - [35/Nov/2017:20:05:34 +0200] \"GET MongoDjango.zip HTTP/1.1\" 200 118362"}]}]},{"block_type":"element","block":"k6pz2hym","search_text":"Executing changDT.go will generate the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"changDT.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2hyn","search_text":"$ go run changeDT.go logEntries.txt - - [Nov 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 2188249 \"-\" - - [Jun 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 - - [Jun 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 - - [Nov 20 20:05:34] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362 2 lines did not match!","text_count":303,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run changeDT.go logEntries.txt\n- - [Nov 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200 2188249 \"-\"\n- - [Jun 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200\n- - [Jun 21 19:28:09] \"GET /AMEv2.tif.zip HTTP/1.1\" 200\n- - [Nov 20 20:05:34] \"GET /MongoDjango.zip HTTP/1.1\" 200 118362\n2 lines did not match!"}]}]},{"block_type":"element","block":"k6pz2hyo","search_text":"Matching IPv4 addresses","text_count":23,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Matching IPv4 addresses"}]},{"block_type":"element","block":"k6pz2hyp","search_text":"An IPv4 address , or simply an IP address , has four discrete parts. As an IPv4 address is stored using 8-bit binary numbers. Each part can have values from 0, which is 00000000 in the binary format, to 255, which is equal to 11111111 in the binary format.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IPv4 address"}]},{"block_type":"text","content":", or simply an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IP address"}]},{"block_type":"text","content":", has four discrete parts. As an IPv4 address is stored using 8-bit binary numbers. Each part can have values from 0, which is 00000000 in the binary format, to 255, which is equal to 11111111 in the binary format."}]},{"block_type":"element","block":"k6pz2hyq","search_text":"Note The format of an IPv6 address is much more complicated than the format of an IPv4 address so the program presented here will not work with IPv6 addresses. ","text_count":160,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The format of an IPv6 address is much more complicated than the format of an IPv4 address so the program presented here will not work with IPv6 addresses."}]}]},{"block_type":"element","block":"k6pz2hyr","search_text":"The name of the program is findIPv4.go , and it will be presented in five parts. The first part of findIPv4.go is shown here:","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":", and it will be presented in five parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"is shown here:"}]},{"block_type":"element","block":"k6pz2hys","search_text":"package main import ( \"bufio\" \"fmt\" \"io\" \"net\" \"os\" \"path/filepath\" \"regexp\" ) ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"io\" \n    \"net\" \n    \"os\" \n    \"path/filepath\" \n    \"regexp\" \n)"}]}]},{"block_type":"element","block":"k6pz2hyt","search_text":"As findIPv4.go is a pretty sophisticated utility, it needs many standard Go packages.","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"is a pretty sophisticated utility, it needs many standard Go packages."}]},{"block_type":"element","block":"k6pz2hyu","search_text":"The second part is shown in the following Go code:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hyv","search_text":"func findIP(input string) string { partIP := \"(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\" grammar := partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP matchMe := regexp.MustCompile(grammar) return matchMe.FindString(input) } ","text_count":236,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func findIP(input string) string { \n    partIP := \"(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\" \n    grammar := partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP \n    matchMe := regexp.MustCompile(grammar) \n    return matchMe.FindString(input) \n}"}]}]},{"block_type":"element","block":"k6pz2hyw","search_text":"The preceding code contains the definition of the regular expression that will help you discover an IPv4 address inside a function. This is the most critical part of the program, because if you define the regular expression incorrectly, you will never be able to catch any IPv4 addresses!","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code contains the definition of the regular expression that will help you discover an IPv4 address inside a function. This is the most critical part of the program, because if you define the regular expression incorrectly, you will never be able to catch any IPv4 addresses!"}]},{"block_type":"element","block":"k6pz2hyx","search_text":"I will explain the regular expression a little further shortly, but before I do that, it is important to understand that prior to defining one or more regular expressions, you should be aware of the problem that you are trying to solve. In other words, if you are not aware of the fact that the decimal values of an IPv4 address cannot be larger than 255, no regular expression can save you!","text_count":391,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I will explain the regular expression a little further shortly, but before I do that, it is important to understand that prior to defining one or more regular expressions, you should be aware of the problem that you are trying to solve. In other words, if you are not aware of the fact that the decimal values of an IPv4 address cannot be larger than 255, no regular expression can save you!"}]},{"block_type":"element","block":"k6pz2hyy","search_text":"Now that we are on the same page, let's talk about the next two statements:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that we are on the same page, let's talk about the next two statements:"}]},{"block_type":"element","block":"k6pz2hyz","search_text":"partIP := \"(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\" grammar := partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP ","text_count":127,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"partIP := \"(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\" \ngrammar := partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP + \"\\\\.\" + partIP"}]}]},{"block_type":"element","block":"k6pz2hz0","search_text":"The regular expression defined in partIP matches each one of the four parts of an IP address. A valid IPv4 address can begin with 25 and end with 0, 1, 2, 3, 4, or 5 because that is the biggest 8-bit binary number ( 25[0-5] ), or it can begin with 2 followed by 0, 1, 2, 3, or 4 and end with 0, 1, 2, 3, 4, 5, 6, 7, 8, or 9 ( 2[0-4][0-9] ). Alternatively, it can begin with 1 followed by two more digits from 0 to 9 ( 1[0-9][0-9] ). The last alternative would be a natural number that has one or two digits. The first digit, which is optional, can be from 1 to 9, and the second, which is mandatory, can be from 0 to 9 ( [1-9]?[0-9] ).","text_count":635,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The regular expression defined in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"partIP"}]},{"block_type":"text","content":"matches each one of the four parts of an IP address. A valid IPv4 address can begin with 25 and end with 0, 1, 2, 3, 4, or 5 because that is the biggest 8-bit binary number ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"25[0-5]"}]},{"block_type":"text","content":"), or it can begin with 2 followed by 0, 1, 2, 3, or 4 and end with 0, 1, 2, 3, 4, 5, 6, 7, 8, or 9 ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2[0-4][0-9]"}]},{"block_type":"text","content":"). Alternatively, it can begin with 1 followed by two more digits from 0 to 9 ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1[0-9][0-9]"}]},{"block_type":"text","content":"). The last alternative would be a natural number that has one or two digits. The first digit, which is optional, can be from 1 to 9, and the second, which is mandatory, can be from 0 to 9 ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"[1-9]?[0-9]"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2hz1","search_text":"The grammar variable tells us that what we are looking for has four distinct parts, and each one of them must match partIP . This grammar variable is what matches the complete IPv4 address that we seek!","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grammar"}]},{"block_type":"text","content":"variable tells us that what we are looking for has four distinct parts, and each one of them must match"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"partIP"}]},{"block_type":"text","content":". This&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grammar"}]},{"block_type":"text","content":"variable is what matches the complete IPv4 address that we seek!"}]},{"block_type":"element","block":"k6pz2hz2","search_text":"Tip As findIPv4.go works with regular expressions to find an IPv4 address in a file, it can also process any kind of text file that contains valid IPv4 addresses! ","text_count":163,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"works with regular expressions to find an IPv4 address in a file, it can also process any kind of text file that contains valid IPv4 addresses!"}]}]},{"block_type":"element","block":"k6pz2hz3","search_text":"One last thing: if you have any special requirements, such as excluding certain IPv4 addresses or watching for specific addresses or networks, you can easily change the Go code of findIPv4.go and add the extra functionality you desire. This is the kind of flexibility achieved when you develop your own tools.","text_count":309,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One last thing: if you have any special requirements, such as excluding certain IPv4 addresses or watching for specific addresses or networks, you can easily change the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"and add the extra functionality you desire. This is the kind of flexibility achieved when you develop your own tools."}]},{"block_type":"element","block":"k6pz2hz4","search_text":"The third part of the findIPv4.go utility contains the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"utility contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hz5","search_text":"func main() { arguments := os.Args if len(arguments) < 2 { fmt.Printf(\"usage: %s logFile\\n\", filepath.Base(arguments[0])) os.Exit(1) } for _, filename := range arguments[1:] { f, err := os.Open(filename) if err != nil { fmt.Printf(\"error opening file %s\\n\", err) os.Exit(-1) } defer f.Close() ","text_count":293,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) &lt; 2 { \n        fmt.Printf(\"usage: %s logFile\\n\", filepath.Base(arguments[0])) \n        os.Exit(1) \n    } \n \n    for _, filename := range arguments[1:] { \n        f, err := os.Open(filename) \n        if err != nil { \n            fmt.Printf(\"error opening file %s\\n\", err) \n            os.Exit(-1) \n        } \n        defer f.Close()"}]}]},{"block_type":"element","block":"k6pz2hz6","search_text":"First, you make sure that you have a sufficient number of command-line parameters by checking the length of os.Args . Then, you can use a for loop to iterate over all of the command-line arguments.","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, you make sure that you have a sufficient number of command-line parameters by checking the length of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Args"}]},{"block_type":"text","content":". Then, you can use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop to iterate over all of the command-line arguments."}]},{"block_type":"element","block":"k6pz2hz7","search_text":"The fourth code portion of findIPv4.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2hz8","search_text":"r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break } else if err != nil { fmt.Printf(\"error reading file %s\", err) break } ","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r := bufio.NewReader(f) \n        for { \n            line, err := r.ReadString('\\n') \n            if err == io.EOF { \n                break \n            } else if err != nil { \n                fmt.Printf(\"error reading file %s\", err) \n                break \n            }"}]}]},{"block_type":"element","block":"k6pz2hz9","search_text":"As happened in selectColumn.go, you use bufio.ReadString() to read your input line by line.","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As happened in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"selectColumn.go,"}]},{"block_type":"text","content":"you use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"to read your input line by line."}]},{"block_type":"element","block":"k6pz2hza","search_text":"The last part of findIPv4.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2hzb","search_text":"ip := findIP(line) trial := net.ParseIP(ip) if trial.To4() == nil { continue } else { fmt.Println(ip) } } } } ","text_count":110,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"ip := findIP(line) \n            trial := net.ParseIP(ip) \n            if trial.To4() == nil { \n                continue \n            } else { \n                fmt.Println(ip) \n            } \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2hzc","search_text":"For each line of the input text file, you call the findIP() function. The net.ParseIP() function double checks that you are dealing with a valid IPv4 address-it is never a bad thing to double check! If the call to net.ParseIP() is successful, you print the IPv4 that you just found. After that, the program will deal with the next line of input.","text_count":345,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For each line of the input text file, you call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIP()"}]},{"block_type":"text","content":"function. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ParseIP()"}]},{"block_type":"text","content":"function double checks that you are dealing with a valid IPv4 address-it is never a bad thing to double check! If the call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ParseIP()"}]},{"block_type":"text","content":"is successful, you print the IPv4 that you just found. After that, the program will deal with the next line of input."}]},{"block_type":"element","block":"k6pz2hzd","search_text":"If you want, you can remove the else block from the preceding code and put the fmt.Println(ip) statement after the if block since continue will just jump away.","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want, you can remove the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"else"}]},{"block_type":"text","content":"block from the preceding code and put the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(ip)"}]},{"block_type":"text","content":"statement after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"block since"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"continue"}]},{"block_type":"text","content":"will just jump away."}]},{"block_type":"element","block":"k6pz2hze","search_text":"Executing findIPv4.go will generate the following type of output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2hzf","search_text":"$ go run findIPv4.go /tmp/auth.log 116.168.10.9 192.31.20.9 10.10.16.9 10.31.160.9 192.168.68.194","text_count":97,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run findIPv4.go /tmp/auth.log\n116.168.10.9\n192.31.20.9\n10.10.16.9\n10.31.160.9\n192.168.68.194"}]}]},{"block_type":"element","block":"k6pz2hzg","search_text":"Thus the output of findIPv4.go can have lines that are displayed multiple times. Apart from that detail, the output of the utility is pretty straightforward.","text_count":157,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"can have lines that are displayed multiple times. Apart from that detail, the output of the utility is pretty straightforward."}]},{"block_type":"element","block":"k6pz2hzh","search_text":"Processing the preceding output with some traditional Unix command line utilities might help you reveal more information about your data:","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Processing the preceding output with some traditional Unix command line utilities might help you reveal more information about your data:"}]},{"block_type":"element","block":"k6pz2hzi","search_text":"$ go run findIPv4.go /tmp/auth.log.1 /tmp/auth.log | sort -rn | uniq -c | sort -rn 38 xxx.zz.116.9 33 x.zz.2.190 25 xx.zzz.1.41 20 178.132.1.18 18 x.zzz.63.53 17 178.zzz.y.9 15 103.yyy.xxx.179 10 213.z.yy.194 10 yyy.zzz.110.4 9 yy.xx.65.113","text_count":240,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run findIPv4.go /tmp/auth.log.1 /tmp/auth.log | sort -rn | uniq -c | sort -rn\n    38 xxx.zz.116.9\n    33 x.zz.2.190\n    25 xx.zzz.1.41\n    20 178.132.1.18\n    18 x.zzz.63.53\n    17 178.zzz.y.9\n    15 103.yyy.xxx.179\n    10 213.z.yy.194\n    10 yyy.zzz.110.4\n     9 yy.xx.65.113"}]}]},{"block_type":"element","block":"k6pz2hzj","search_text":"What we did here is to find out the top-10 IPv4 addresses located in the processed text files using the sort(1) and uniq(1) Unix command-line utilities. The logic behind this pretty long bash(1) shell command is simple: the output of the findIPv4.go utility will become the input of the first sort -rn command in order to be sorted numerically in reverse order. Then the uniq -c command removes the lines that appear multiple times by replacing them with a single line that is preceded with the count of the number of times the line occurred in the input. The output then is sorted once again so that the IPv4 addresses with the higher number of occurrences will appear first!","text_count":676,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What we did here is to find out the top-10 IPv4 addresses located in the processed text files using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"uniq(1)"}]},{"block_type":"text","content":"Unix command-line utilities. The logic behind this pretty long"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bash(1)"}]},{"block_type":"text","content":"shell command is simple: the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"utility will become the input of the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort -rn"}]},{"block_type":"text","content":"command in order to be sorted numerically in reverse order. Then the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"uniq -c"}]},{"block_type":"text","content":"command removes the lines that appear multiple times by replacing them with a single line that is preceded with the count of the number of times the line occurred in the input. The output then is sorted once again so that the IPv4 addresses with the higher number of occurrences will appear first!"}]},{"block_type":"element","block":"k6pz2hzk","search_text":"Note Once again, it is important to realize that the core functionality of findIPv4.go is implemented through the regular expression. If the regular expression is defined incorrectly, or if it does not match all of the cases ( false negative ), or if it matches things that should not be matched ( false positive ), then your program will not work correctly! ","text_count":359,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, it is important to realize that the core functionality of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"is implemented through the regular expression. If the regular expression is defined incorrectly, or if it does not match all of the cases ("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"false negative"}]},{"block_type":"text","content":"), or if it matches things that should not be matched ("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"false positive"}]},{"block_type":"text","content":"), then your program will not work correctly!"}]}]},{"block_type":"element","block":"k6pz2hzl","search_text":"Strings","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Strings"}]},{"block_type":"element","block":"k6pz2hzm","search_text":"Strictly speaking, a string is not a composite type, but there are so many Go functions that support strings that I will describe strings in this chapter. As discussed in Chapter 3, Working with Basic Go Data Types , strings in Go are value types not pointers, as is the case with C strings . Additionally, Go supports UTF-8 strings by default, which means that you do not need to load any special packages or do anything tricky in order to print Unicode characters. However, there are subtle differences between a character, a rune, and a byte, as well as differences between a string and a string literal, which will be clarified here.","text_count":637,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"is not a composite type, but there are so many Go functions that support strings that I will describe strings in this chapter. As discussed in Chapter 3,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Working with Basic Go Data Types"}]},{"block_type":"text","content":", strings in Go are value types not pointers, as is the case with"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C strings"}]},{"block_type":"text","content":". Additionally, Go supports UTF-8 strings by default, which means that you do not need to load any special packages or do anything tricky in order to print Unicode characters. However, there are subtle differences between a character, a rune, and a byte, as well as differences between a string and a string literal, which will be clarified here."}]},{"block_type":"element","block":"k6pz2hzn","search_text":"A Go string is a read-only byte slice that can hold any type of bytes, and it can have an arbitrary length.","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go string is a read-only"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slice"}]},{"block_type":"text","content":"that can hold any type of bytes, and it can have an arbitrary length."}]},{"block_type":"element","block":"k6pz2hzo","search_text":"You can define a new string literal as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can define a new"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"string literal"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2hzp","search_text":"const sLiteral = \"\\x99\\x42\\x32\\x55\\x50\\x35\\x23\\x50\\x29\\x9c\" ","text_count":60,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const sLiteral = \"\\x99\\x42\\x32\\x55\\x50\\x35\\x23\\x50\\x29\\x9c\""}]}]},{"block_type":"element","block":"k6pz2hzq","search_text":"You might be surprised by the look of a string literal in Go. You can define a string variable as follows:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might be surprised by the look of a string literal in Go. You can define a string variable as follows:"}]},{"block_type":"element","block":"k6pz2hzr","search_text":"s2 := \"€£³\"","text_count":11,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s2 := \"&euro;&pound;&sup3;\""}]}]},{"block_type":"element","block":"k6pz2hzs","search_text":"You can find the length of a string variable or a string literal using the len() function.","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the length of a string variable or a string literal using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2hzt","search_text":"The strings.go file will illustrate many standard operations related to strings. It will be presented in five parts. The first part is shown in the following Go code:","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.go"}]},{"block_type":"text","content":"file will illustrate many standard operations related to strings. It will be presented in five parts. The first part is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hzu","search_text":"package main import ( \"fmt\" ) ","text_count":30,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2hzv","search_text":"The second portion of Go code is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second portion of Go code is as follows:"}]},{"block_type":"element","block":"k6pz2hzw","search_text":"func main() { const sLiteral = \"\\x99\\x42\\x32\\x55\\x50\\x35\\x23\\x50\\x29\\x9c\" fmt.Println(sLiteral) fmt.Printf(\"x: %x\\n\", sLiteral) fmt.Printf(\"sLiteral length: %d\\n\", len(sLiteral)) ","text_count":179,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    const sLiteral = \"\\x99\\x42\\x32\\x55\\x50\\x35\\x23\\x50\\x29\\x9c\" \n    fmt.Println(sLiteral) \n    fmt.Printf(\"x: %x\\n\", sLiteral) \n  \n    fmt.Printf(\"sLiteral length: %d\\n\", len(sLiteral))"}]}]},{"block_type":"element","block":"k6pz2hzx","search_text":"Each \\xAB sequence represents a single character of sLiteral . As a result, calling len(sLiteral) will return the number of characters of sLiteral . Using %x in fmt.Printf() will return the AB part of a \\xAB sequence.","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\\xAB"}]},{"block_type":"text","content":"sequence represents a single character of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sLiteral"}]},{"block_type":"text","content":". As a result, calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(sLiteral)"}]},{"block_type":"text","content":"will return the number of characters of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sLiteral"}]},{"block_type":"text","content":". Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%x"}]},{"block_type":"text","content":"in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"will return the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"AB"}]},{"block_type":"text","content":"part of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\\xAB"}]},{"block_type":"text","content":"sequence."}]},{"block_type":"element","block":"k6pz2hzy","search_text":"The third code segment of strings.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2hzz","search_text":"for i := 0; i < len(sLiteral); i++ { fmt.Printf(\"%x \", sLiteral[i]) } fmt.Println() fmt.Printf(\"q: %q\\n\", sLiteral) fmt.Printf(\"+q: %+q\\n\", sLiteral) fmt.Printf(\" x: % x\\n\", sLiteral) fmt.Printf(\"s: As a string: %s\\n\", sLiteral) ","text_count":229,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; len(sLiteral); i++ { \n        fmt.Printf(\"%x \", sLiteral[i]) \n    } \n    fmt.Println() \n \n    fmt.Printf(\"q: %q\\n\", sLiteral) \n    fmt.Printf(\"+q: %+q\\n\", sLiteral) \n    fmt.Printf(\" x: % x\\n\", sLiteral) \n \n    fmt.Printf(\"s: As a string: %s\\n\", sLiteral)"}]}]},{"block_type":"element","block":"k6pz2i00","search_text":"Here you see that you can access a string literal as if it were a slice. Using %q in fmt.Printf() with a string argument will print a double-quoted string safely escaped with Go syntax. Using %+q in fmt.Printf() with a string argument will guarantee ASCII-only output.","text_count":268,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see that you can access a string literal as if it were a slice. Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%q"}]},{"block_type":"text","content":"in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"with a string argument will print a double-quoted string safely escaped with Go syntax. Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%+q"}]},{"block_type":"text","content":"in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"with a string argument will guarantee ASCII-only output."}]},{"block_type":"element","block":"k6pz2i01","search_text":"Last, using % x (note the space between the % character and the x character) in fmt.Printf() will put spaces between the printed bytes. In order to print a string literal as a string, you will need to call fmt.Printf() with %s .","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"% x"}]},{"block_type":"text","content":"(note the space between the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%"}]},{"block_type":"text","content":"character and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"character) in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"will put spaces between the printed bytes. In order to print a string literal as a string, you will need to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%s"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i02","search_text":"The fourth portion of the code of strings.go is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth portion of the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i03","search_text":"s2 := \"€£³\" for x, y := range s2 { fmt.Printf(\"%#U starts at byte position %d\\n\", y, x) } fmt.Printf(\"s2 length: %d\\n\", len(s2)) ","text_count":129,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s2 := \"&euro;&pound;&sup3;\" \n    for x, y := range s2 { \n        fmt.Printf(\"%#U starts at byte position %d\\n\", y, x) \n    } \n \n    fmt.Printf(\"s2 length: %d\\n\", len(s2))"}]}]},{"block_type":"element","block":"k6pz2i04","search_text":"Here you define a string named s2 with three Unicode characters. Using fmt.Printf() with %#U will print the characters in the U+0058 format. Using the range keyword on a string that contains Unicode characters allows you to process its Unicode characters one by one.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you define a string named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2"}]},{"block_type":"text","content":"with three Unicode characters. Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%#U"}]},{"block_type":"text","content":"will print the characters in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"U+0058"}]},{"block_type":"text","content":"format. Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword on a string that contains Unicode characters allows you to process its Unicode characters one by one."}]},{"block_type":"element","block":"k6pz2i05","search_text":"The output of len(s2) might surprise you a little. As the s2 variable contains Unicode characters, its byte size is larger than the number of characters in it.","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"len(s2)"}]},{"block_type":"text","content":"might surprise you a little. As the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2"}]},{"block_type":"text","content":"variable contains Unicode characters, its byte size is larger than the number of characters in it."}]},{"block_type":"element","block":"k6pz2i06","search_text":"The last part of strings.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i07","search_text":"const s3 = \"ab12AB\" fmt.Println(\"s3:\", s3) fmt.Printf(\"x: % x\\n\", s3) fmt.Printf(\"s3 length: %d\\n\", len(s3)) for i := 0; i < len(s3); i++ { fmt.Printf(\"%x \", s3[i]) } fmt.Println() } ","text_count":183,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const s3 = \"ab12AB\" \n    fmt.Println(\"s3:\", s3) \n    fmt.Printf(\"x: % x\\n\", s3) \n \n    fmt.Printf(\"s3 length: %d\\n\", len(s3)) \n \n    for i := 0; i &lt; len(s3); i++ { \n        fmt.Printf(\"%x \", s3[i]) \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2i08","search_text":"Running strings.go will generate the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2i09","search_text":"$ go run strings.go �B2UP5#P)� x: 9942325550352350299c sLiteral length: 10 99 42 32 55 50 35 23 50 29 9c q: \"\\x99B2UP5#P)\\x9c\" +q: \"\\x99B2UP5#P)\\x9c\" x: 99 42 32 55 50 35 23 50 29 9c s: As a string: �B2UP5#P)� U+20AC '€' starts at byte position 0 U+00A3 '£' starts at byte position 3 U+00B3 '³' starts at byte position 5 s2 length: 7 s3: ab12AB x: 61 62 31 32 41 42 s3 length: 6 61 62 31 32 41 42","text_count":396,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run strings.go\n�B2UP5#P)�\nx: 9942325550352350299c\nsLiteral length: 10\n99 42 32 55 50 35 23 50 29 9c\nq: \"\\x99B2UP5#P)\\x9c\"\n+q: \"\\x99B2UP5#P)\\x9c\"\n x: 99 42 32 55 50 35 23 50 29 9c\ns: As a string: �B2UP5#P)�\nU+20AC '&euro;' starts at byte position 0\nU+00A3 '&pound;' starts at byte position 3\nU+00B3 '&sup3;' starts at byte position 5\ns2 length: 7\ns3: ab12AB\nx: 61 62 31 32 41 42\ns3 length: 6\n61 62 31 32 41 42"}]}]},{"block_type":"element","block":"k6pz2i0a","search_text":"It's no surprise if you find the information presented in this section pretty strange and complex, especially if you are unfamiliar with Unicode and UTF-8 representations of characters and symbols. The good thing is that you will not need most of them in your everyday life as a Go developer, and that you will most likely get away with using simple fmt.Println() and fmt.Printf() commands in your programs to print your output. However, if you are living outside of Europe or the USA, you might find some of the information in this section pretty handy.","text_count":554,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It's no surprise if you find the information presented in this section pretty strange and complex, especially if you are unfamiliar with Unicode and UTF-8 representations of characters and symbols. The good thing is that you will not need most of them in your everyday life as a Go developer, and that you will most likely get away with using simple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"commands in your programs to print your output. However, if you are living outside of Europe or the USA, you might find some of the information in this section pretty handy."}]},{"block_type":"element","block":"k6pz2i0b","search_text":"What is a rune?","text_count":15,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"What is a rune?"}]},{"block_type":"element","block":"k6pz2i0c","search_text":"A rune is an int32 value, and therefore it is a Go type that is used for representing a Unicode code point . A Unicode code point or code position is a numerical value that is usually used for representing single Unicode characters; however, it can also have alternative meanings, such as providing formatting information.","text_count":322,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"rune"}]},{"block_type":"text","content":"is an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int32"}]},{"block_type":"text","content":"value, and therefore it is a Go type that is used for representing a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unicode code point"}]},{"block_type":"text","content":". A Unicode code point or code position is a numerical value that is usually used for representing single Unicode characters; however, it can also have alternative meanings, such as providing formatting information."}]},{"block_type":"element","block":"k6pz2i0d","search_text":"Note NOTE : You can consider a string as a collection of runes. ","text_count":64,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"NOTE"}]},{"block_type":"text","content":": You can consider a string as a collection of runes."}]}]},{"block_type":"element","block":"k6pz2i0e","search_text":"A rune literal is a character in single quotes. You may also consider a rune literal as a rune constant . Behind the scenes, a rune literal is associated with a Unicode code point.","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"rune literal"}]},{"block_type":"text","content":"is a character in single quotes. You may also consider a rune literal as a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"rune constant"}]},{"block_type":"text","content":". Behind the scenes, a rune literal is associated with a Unicode code point."}]},{"block_type":"element","block":"k6pz2i0f","search_text":"Runes will be illustrated in runes.go , which is will be presented in three parts. The first part of runes.go follows next:","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Runes will be illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runes.go"}]},{"block_type":"text","content":", which is will be presented in three parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runes.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i0g","search_text":"package main import ( \"fmt\" ) ","text_count":30,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2i0h","search_text":"The second part of runes.go contains the following code:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runes.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2i0i","search_text":"func main() { const r1 = '€' fmt.Println(\"(int32) r1:\", r1) fmt.Printf(\"(HEX) r1: %x\\n\", r1) fmt.Printf(\"(as a String) r1: %s\\n\", r1) fmt.Printf(\"(as a character) r1: %c\\n\", r1) ","text_count":178,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    const r1 = '&euro;' \n    fmt.Println(\"(int32) r1:\", r1) \n    fmt.Printf(\"(HEX) r1: %x\\n\", r1) \n    fmt.Printf(\"(as a String) r1: %s\\n\", r1) \n    fmt.Printf(\"(as a character) r1: %c\\n\", r1)"}]}]},{"block_type":"element","block":"k6pz2i0j","search_text":"So, first you define a rune literal named r1 . (Please note that the Euro sign does not belong to the ASCII table of characters.) Then you print r1 using various statements. First you print its int32 value and then its hexadecimal value. After that, you try printing it as a string. Finally, you print it as a character, which is what gives you the same output as the one used in the definition of r1 .","text_count":402,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, first you define a rune literal named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r1"}]},{"block_type":"text","content":". (Please note that the Euro sign does not belong to the ASCII table of characters.) Then you print"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r1"}]},{"block_type":"text","content":"using various statements. First you print its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int32"}]},{"block_type":"text","content":"value and then its hexadecimal value. After that, you try printing it as a string. Finally, you print it as a character, which is what gives you the same output as the one used in the definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r1"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i0k","search_text":"The third and last code segment of runes.go is shown in the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third and last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runes.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i0l","search_text":"fmt.Println(\"A string is a collection of runes:\", []byte(\"Mihalis\")) aString := []byte(\"Mihalis\") for x, y := range aString { fmt.Println(x, y) fmt.Printf(\"Char: %c\\n\", aString[x]) } fmt.Printf(\"%s\\n\", aString) } ","text_count":213,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"A string is a collection of runes:\", []byte(\"Mihalis\")) \n    aString := []byte(\"Mihalis\") \n    for x, y := range aString { \n        fmt.Println(x, y) \n        fmt.Printf(\"Char: %c\\n\", aString[x]) \n    } \n    fmt.Printf(\"%s\\n\", aString) \n}"}]}]},{"block_type":"element","block":"k6pz2i0m","search_text":"Here you see that a byte slice is a collection of runes, and that printing a byte slice with fmt.Println() might not return what you may have expected. In order to convert a rune into a character, you should use %c in a fmt.Printf() statement, and in order to print a byte slice as a string, you will need to use fmt.Printf() with %s .","text_count":335,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see that a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slice"}]},{"block_type":"text","content":"is a collection of runes, and that printing a byte slice with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"might not return what you may have expected. In order to convert a rune into a character, you should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%c"}]},{"block_type":"text","content":"in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"statement, and in order to print a byte slice as a string, you will need to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%s"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i0n","search_text":"Executing runes.go will create the following output:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runes.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2i0o","search_text":"$ go run runes.go (int32) r1: 8364 (HEX) r1: 20ac (as a String) r1: %!s(int32=8364) (as a character) r1: € A string is a collection of runes: [77 105 104 97 108 105 115] 0 77 Char: M 1 105 Char: i 2 104 Char: h 3 97 Char: a 4 108 Char: l 5 105 Char: i 6 115 Char: s Mihalis","text_count":273,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run runes.go\n(int32) r1: 8364\n(HEX) r1: 20ac\n(as a String) r1: %!s(int32=8364)\n(as a character) r1: &euro;\nA string is a collection of runes: [77 105 104 97 108 105 115]\n0 77\nChar: M\n1 105\nChar: i\n2 104\nChar: h\n3 97\nChar: a\n4 108\nChar: l\n5 105\nChar: i\n6 115\nChar: s\nMihalis"}]}]},{"block_type":"element","block":"k6pz2i0p","search_text":"Finally, the easiest way to get an illegal rune literal error message is by using single quotes instead of double quotes when importing a package:","text_count":146,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the easiest way to get an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"illegal rune literal"}]},{"block_type":"text","content":"error message is by using single quotes instead of double quotes when importing a package:"}]},{"block_type":"element","block":"k6pz2i0q","search_text":"$ cat a.go package main import ( 'fmt' ) func main(){ } $ go run a.go package main:a.go:4:2: illegal rune literal","text_count":113,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cat a.go\npackage main\nimport (\n    'fmt'\n)\nfunc main(){\n}\n$ go run a.go\npackage main:a.go:4:2: illegal rune literal"}]}]},{"block_type":"element","block":"k6pz2i0r","search_text":"The Unicode package","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The Unicode package"}]},{"block_type":"element","block":"k6pz2i0s","search_text":"The unicode standard Go package contains various handy functions. One of them, which is called unicode.IsPrint() , can help you identify the parts of a string that are printable using runes. This technique will be illustrated in the Go code of unicode.go , which will be presented in two parts.","text_count":294,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"standard Go package contains various handy functions. One of them, which is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.IsPrint()"}]},{"block_type":"text","content":", can help you identify the parts of a string that are printable using runes. This technique will be illustrated in the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.go"}]},{"block_type":"text","content":", which will be presented in two parts."}]},{"block_type":"element","block":"k6pz2i0t","search_text":"The first part of unicode.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i0u","search_text":"package main import ( \"fmt\" \"unicode\" ) func main() { const sL = \"\\x99\\x00ab\\x50\\x00\\x23\\x50\\x29\\x9c\" ","text_count":102,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"unicode\" \n) \n \nfunc main() { \n    const sL = \"\\x99\\x00ab\\x50\\x00\\x23\\x50\\x29\\x9c\""}]}]},{"block_type":"element","block":"k6pz2i0v","search_text":"The second code segment of unicode.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i0w","search_text":"for i := 0; i < len(sL); i++ { if unicode.IsPrint(rune(sL[i])) { fmt.Printf(\"%c\\n\", sL[i]) } else { fmt.Println(\"Not printable!\") } } } ","text_count":136,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; len(sL); i++ { \n        if unicode.IsPrint(rune(sL[i])) { \n            fmt.Printf(\"%c\\n\", sL[i]) \n        } else { \n            fmt.Println(\"Not printable!\") \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i0x","search_text":"As stated before, all of the dirty work is done by the unicode.IsPrint() function that returns true when a rune is printable and false otherwise. If you are really into Unicode characters, you should definitely check the documentation page of the unicode package.","text_count":263,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As stated before, all of the dirty work is done by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.IsPrint()"}]},{"block_type":"text","content":"function that returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"when a rune is printable and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"otherwise. If you are really into Unicode characters, you should definitely check the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2i0y","search_text":"Executing unicode.go will generate the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2i0z","search_text":"$ go run unicode.go Not printable! Not printable! a b P Not printable! # ","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run unicode.go\nNot printable!\nNot printable!\na\nb\nP\nNot printable!\n#"}]}]},{"block_type":"element","block":"k6pz2i10","search_text":"P ) Not printable!","text_count":18,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"P\n)\nNot printable!"}]}]},{"block_type":"element","block":"k6pz2i11","search_text":"The strings package","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The strings package"}]},{"block_type":"element","block":"k6pz2i12","search_text":"The strings standard Go package allows you to manipulate UTF-8 strings in Go and includes many powerful functions. Most of these functions will be illustrated in the useStrings.go source file, which will be presented in five parts. Note that the functions of the strings package that are related to file input and output will be demonstrated in Chapter 8, Telling a Unix System What to Do .","text_count":390,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"standard Go package allows you to manipulate UTF-8 strings in Go and includes many powerful functions. Most of these functions will be illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"source file, which will be presented in five parts. Note that the functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package that are related to file input and output will be demonstrated in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i13","search_text":"The first part of useStrings.go follows next:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i14","search_text":"package main import ( \"fmt\" s \"strings\" \"unicode\" ) var f = fmt.Printf ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    s \"strings\" \n    \"unicode\" \n) \n \nvar f = fmt.Printf"}]}]},{"block_type":"element","block":"k6pz2i15","search_text":"Tip You can apply this great tip to all Go packages. There is a difference in the way that the strings package is imported. This kind of import statement makes Go create an alias for that package. So, instead of writing strings.FunctionName() , you can now write s.FunctionName() , which is a bit shorter. Please note that you will not be able to call a function of the strings package as strings.FunctionName() anymore! ","text_count":421,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can apply this great tip to all Go packages. There is a difference in the way that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package is imported. This kind of import statement makes Go create an alias for that package. So, instead of writing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.FunctionName()"}]},{"block_type":"text","content":", you can now write"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s.FunctionName()"}]},{"block_type":"text","content":", which is a bit shorter. Please note that you will not be able to call a function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.FunctionName()"}]},{"block_type":"text","content":"anymore!"}]}]},{"block_type":"element","block":"k6pz2i16","search_text":"Another handy trick is that if you find yourself using the same function all of the time, and you want to use something shorter instead, you can assign a variable name to that function and use that variable name instead. Here you see that feature applied to the fmt.Printf() function. Nevertheless, you should not overuse this feature because you might end up having difficult to read code!","text_count":390,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Another handy trick is that if you find yourself using the same function all of the time, and you want to use something shorter instead, you can assign a variable name to that function and use that variable name instead. Here you see that feature applied to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"function. Nevertheless, you should not overuse this feature because you might end up having difficult to read code!"}]},{"block_type":"element","block":"k6pz2i17","search_text":"The second part of the useStrings.go program contains the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i18","search_text":"func main() { upper := s.ToUpper(\"Hello there!\") f(\"To Upper: %s\\n\", upper) f(\"To Lower: %s\\n\", s.ToLower(\"Hello THERE\")) f(\"%s\\n\", s.Title(\"tHis wiLL be A title!\")) f(\"EqualFold: %v\\n\", s.EqualFold(\"Mihalis\", \"MIHAlis\")) f(\"EqualFold: %v\\n\", s.EqualFold(\"Mihalis\", \"MIHAli\")) ","text_count":277,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    upper := s.ToUpper(\"Hello there!\") \n    f(\"To Upper: %s\\n\", upper) \n    f(\"To Lower: %s\\n\", s.ToLower(\"Hello THERE\")) \n \n    f(\"%s\\n\", s.Title(\"tHis wiLL be A title!\")) \n \n    f(\"EqualFold: %v\\n\", s.EqualFold(\"Mihalis\", \"MIHAlis\")) \n    f(\"EqualFold: %v\\n\", s.EqualFold(\"Mihalis\", \"MIHAli\"))"}]}]},{"block_type":"element","block":"k6pz2i19","search_text":"In this code segment, you see many functions that allow you to play with the case of a string. Additionally, you see that the strings.EqualFold() function allows you to determine whether two strings are the same in spite of their differences in their letters.","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, you see many functions that allow you to play with the case of a string. Additionally, you see that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.EqualFold()"}]},{"block_type":"text","content":"function allows you to determine whether two strings are the same in spite of their differences in their letters."}]},{"block_type":"element","block":"k6pz2i1a","search_text":"The third code portion of useStrings.go follows here:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"follows here:"}]},{"block_type":"element","block":"k6pz2i1b","search_text":"f(\"Prefix: %v\\n\", s.HasPrefix(\"Mihalis\", \"Mi\")) f(\"Prefix: %v\\n\", s.HasPrefix(\"Mihalis\", \"mi\")) f(\"Suffix: %v\\n\", s.HasSuffix(\"Mihalis\", \"is\")) f(\"Suffix: %v\\n\", s.HasSuffix(\"Mihalis\", \"IS\")) f(\"Index: %v\\n\", s.Index(\"Mihalis\", \"ha\")) f(\"Index: %v\\n\", s.Index(\"Mihalis\", \"Ha\")) f(\"Count: %v\\n\", s.Count(\"Mihalis\", \"i\")) f(\"Count: %v\\n\", s.Count(\"Mihalis\", \"I\")) f(\"Repeat: %s\\n\", s.Repeat(\"ab\", 5)) f(\"TrimSpace: %s\\n\", s.TrimSpace(\" \\tThis is a line. \\n\")) f(\"TrimLeft: %s\", s.TrimLeft(\" \\tThis is a\\t line. \\n\", \"\\n\\t \")) f(\"TrimRight: %s\\n\", s.TrimRight(\" \\tThis is a\\t line. \\n\", \"\\n\\t \")) ","text_count":594,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f(\"Prefix: %v\\n\", s.HasPrefix(\"Mihalis\", \"Mi\")) \n   f(\"Prefix: %v\\n\", s.HasPrefix(\"Mihalis\", \"mi\")) \n   f(\"Suffix: %v\\n\", s.HasSuffix(\"Mihalis\", \"is\")) \n   f(\"Suffix: %v\\n\", s.HasSuffix(\"Mihalis\", \"IS\")) \n \n   f(\"Index: %v\\n\", s.Index(\"Mihalis\", \"ha\")) \n   f(\"Index: %v\\n\", s.Index(\"Mihalis\", \"Ha\")) \n   f(\"Count: %v\\n\", s.Count(\"Mihalis\", \"i\")) \n   f(\"Count: %v\\n\", s.Count(\"Mihalis\", \"I\")) \n   f(\"Repeat: %s\\n\", s.Repeat(\"ab\", 5)) \n \n   f(\"TrimSpace: %s\\n\", s.TrimSpace(\" \\tThis is a line. \\n\")) \n   f(\"TrimLeft: %s\", s.TrimLeft(\" \\tThis is a\\t line. \\n\", \"\\n\\t \")) \n   f(\"TrimRight: %s\\n\", s.TrimRight(\" \\tThis is a\\t line. \\n\", \"\\n\\t \"))"}]}]},{"block_type":"element","block":"k6pz2i1c","search_text":"The strings.Count() function counts the number of non-overlapping times the second parameter appears in the string that is given as the first parameter. The strings.HasPrefix() function returns true when the first parameter string begins with the second parameter string and false otherwise. Similarly, the strings.HasSuffix() function returns true when the first parameter, which is a string, ends with the second parameter, which is also a string, and false otherwise.","text_count":470,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Count()"}]},{"block_type":"text","content":"function counts the number of non-overlapping times the second parameter appears in the string that is given as the first parameter. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.HasPrefix()"}]},{"block_type":"text","content":"function returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"when the first parameter string begins with the second parameter string and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"otherwise. Similarly, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.HasSuffix()"}]},{"block_type":"text","content":"function returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"when the first parameter, which is a string, ends with the second parameter, which is also a string, and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"otherwise."}]},{"block_type":"element","block":"k6pz2i1d","search_text":"The fourth code segment of useStrings.go contains the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i1e","search_text":"f(\"Compare: %v\\n\", s.Compare(\"Mihalis\", \"MIHALIS\")) f(\"Compare: %v\\n\", s.Compare(\"Mihalis\", \"Mihalis\")) f(\"Compare: %v\\n\", s.Compare(\"MIHALIS\", \"MIHalis\")) f(\"Fields: %v\\n\", s.Fields(\"This is a string!\")) f(\"Fields: %v\\n\", s.Fields(\"Thisis\\na\\tstring!\")) f(\"%s\\n\", s.Split(\"abcd efg\", \"\")) ","text_count":290,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f(\"Compare: %v\\n\", s.Compare(\"Mihalis\", \"MIHALIS\")) \n    f(\"Compare: %v\\n\", s.Compare(\"Mihalis\", \"Mihalis\")) \n    f(\"Compare: %v\\n\", s.Compare(\"MIHALIS\", \"MIHalis\")) \n \n    f(\"Fields: %v\\n\", s.Fields(\"This is a string!\")) \n    f(\"Fields: %v\\n\", s.Fields(\"Thisis\\na\\tstring!\")) \n \n    f(\"%s\\n\", s.Split(\"abcd efg\", \"\"))"}]}]},{"block_type":"element","block":"k6pz2i1f","search_text":"This code portion contains some pretty advanced and ingenious functions. The first handy function is strings.Split() , which allows you to split the given string according to the desired separator string. The strings.Split() function returns a string slice .","text_count":258,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This code portion contains some pretty advanced and ingenious functions. The first handy function is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Split()"}]},{"block_type":"text","content":", which allows you to split the given string according to the desired separator string. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Split()"}]},{"block_type":"text","content":"function returns a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"string slice"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i1g","search_text":"Using \"\" as the second parameter of strings.Split() will allow you to process a string character by character!","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"\""}]},{"block_type":"text","content":"as the second parameter of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Split()"}]},{"block_type":"text","content":"will allow you to process a string character by character!"}]},{"block_type":"element","block":"k6pz2i1h","search_text":"The strings.Compare() function compares two strings lexicographically, and it may return 0 if the two strings are identical and -1 or +1 otherwise.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Compare()"}]},{"block_type":"text","content":"function compares two strings lexicographically, and it may return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"if the two strings are identical and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-1"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"+1"}]},{"block_type":"text","content":"otherwise."}]},{"block_type":"element","block":"k6pz2i1i","search_text":"Last, the strings.Fields() function splits the string parameter using white space characters as separators. The white space characters are defined in the unicode.IsSpace() function.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Fields()"}]},{"block_type":"text","content":"function splits the string parameter using white space characters as separators. The white space characters are defined in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.IsSpace()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2i1j","search_text":"Tip strings.Split() is a powerful function that you should learn because sooner rather than later you will have to use it in your programs! ","text_count":140,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Split()"}]},{"block_type":"text","content":"is a powerful function that you should learn because sooner rather than later you will have to use it in your programs!"}]}]},{"block_type":"element","block":"k6pz2i1k","search_text":"The last part of useStrings.go is shown in the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i1l","search_text":"f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", -1)) f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", 4)) f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", 2)) lines := []string{\"Line 1\", \"Line 2\", \"Line 3\"} f(\"Join: %s\\n\", s.Join(lines, \"+++\")) f(\"SplitAfter: %s\\n\", s.SplitAfter(\"123++432++\", \"++\")) trimFunction := func(c rune) bool { return !unicode.IsLetter(c) } f(\"TrimFunc: %s\\n\", s.TrimFunc(\"123 abc ABC \\t .\", trimFunction)) } ","text_count":412,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", -1)) \n    f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", 4)) \n    f(\"%s\\n\", s.Replace(\"abcd efg\", \"\", \"_\", 2)) \n \n    lines := []string{\"Line 1\", \"Line 2\", \"Line 3\"} \n    f(\"Join: %s\\n\", s.Join(lines, \"+++\")) \n \n    f(\"SplitAfter: %s\\n\", s.SplitAfter(\"123++432++\", \"++\")) \n \n    trimFunction := func(c rune) bool { \n        return !unicode.IsLetter(c) \n    } \n    f(\"TrimFunc: %s\\n\", s.TrimFunc(\"123 abc ABC \\t .\", trimFunction)) \n}"}]}]},{"block_type":"element","block":"k6pz2i1m","search_text":"As in the previous part of useStrings.go , the last code segment contains functions that implement some very intelligent functionality in a simple to understand and easy to use way.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As in the previous part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":", the last code segment contains functions that implement some very intelligent functionality in a simple to understand and easy to use way."}]},{"block_type":"element","block":"k6pz2i1n","search_text":"The strings.Replace() function takes four parameters. The first one is the string that you want to process. The second parameter contains the string that, if found, will be replaced by the third parameter of strings.Replace() . The last parameter is the maximum number of replacements that will happen. If that parameter has a negative value, then there is no limit to the number of replacements that can take place.","text_count":416,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Replace()"}]},{"block_type":"text","content":"function takes four parameters. The first one is the string that you want to process. The second parameter contains the string that, if found, will be replaced by the third parameter of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Replace()"}]},{"block_type":"text","content":". The last parameter is the maximum number of replacements that will happen. If that parameter has a negative value, then there is no limit to the number of replacements that can take place."}]},{"block_type":"element","block":"k6pz2i1o","search_text":"The last two statements of the program define a trim function , which allows you to keep the runes of a string that interest you and utilize that function as the second argument to the strings.TrimFunc() function.","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last two statements of the program define a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"trim function"}]},{"block_type":"text","content":", which allows you to keep the runes of a string that interest you and utilize that function as the second argument to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.TrimFunc()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2i1p","search_text":"Last, the strings.SplitAfter() function splits its first parameter string into substrings based on the separator string that is given as the second parameter to the function.","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.SplitAfter()"}]},{"block_type":"text","content":"function splits its first parameter string into substrings based on the separator string that is given as the second parameter to the function."}]},{"block_type":"element","block":"k6pz2i1q","search_text":"Tip For the full list of functions similar to unicode.IsLetter() , you should visit the documentation page of the unicode standard Go package. ","text_count":143,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the full list of functions similar to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode.IsLetter()"}]},{"block_type":"text","content":", you should visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"standard Go package."}]}]},{"block_type":"element","block":"k6pz2i1r","search_text":"Executing useStrings.go will display the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"will display the following output:"}]},{"block_type":"element","block":"k6pz2i1s","search_text":"$ go run useStrings.go To Upper: HELLO THERE! To Lower: hello there THis WiLL Be A Title! EqualFold: true EqualFold: false Prefix: true Prefix: false Suffix: true Suffix: false Index: 2 Index: -1 Count: 2 Count: 0 Repeat: ababababab TrimSpace: This is a line. TrimLeft: This is a line. TrimRight: This is a line. Compare: 1 Compare: 0 Compare: -1 Fields: [This is a string!] Fields: [Thisis a string!] [a b c d e f g] _a_b_c_d_ _e_f_g __a_b_c_d efg _a_bcd efg Join: Line 1+++Line 2+++Line 3 SplitAfter: [123++ 432++ ] TrimFunc: abc ABC","text_count":535,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useStrings.go\nTo Upper: HELLO THERE!\nTo Lower: hello there\nTHis WiLL Be A Title!\nEqualFold: true\nEqualFold: false\nPrefix: true\nPrefix: false\nSuffix: true\nSuffix: false\nIndex: 2\nIndex: -1\nCount: 2\nCount: 0\nRepeat: ababababab\nTrimSpace: This is a line.\nTrimLeft: This is a      line.\nTrimRight:        This is a    line.\nCompare: 1\nCompare: 0\nCompare: -1\nFields: [This is a string!]\nFields: [Thisis a string!]\n[a b c d   e f g]\n_a_b_c_d_ _e_f_g\n__a_b_c_d efg\n_a_bcd efg\nJoin: Line 1+++Line 2+++Line 3\nSplitAfter: [123++ 432++ ]\nTrimFunc: abc ABC"}]}]},{"block_type":"element","block":"k6pz2i1t","search_text":"Please note that the list of functions presented from the strings package is far from complete. You should examine the documentation page of the strings package at https://golang.org/pkg/strings/ for the complete list of available functions.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please note that the list of functions presented from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package is far from complete. You should examine the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/strings/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/strings/"}]},{"block_type":"text","content":"for the complete list of available functions."}]},{"block_type":"element","block":"k6pz2i1u","search_text":"If you are working with text and text processing, you will definitely need to learn all of the gory details and functions of the strings package, so make sure that you experiment with all these functions a lot and create many examples that will help you clarify things.","text_count":269,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are working with text and text processing, you will definitely need to learn all of the gory details and functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package, so make sure that you experiment with all these functions&nbsp;a lot and create many examples that will help you clarify things."}]},{"block_type":"element","block":"k6pz2i1v","search_text":"The switch statement","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The switch statement"}]},{"block_type":"element","block":"k6pz2i1w","search_text":"The main reason for presenting the switch statement in this chapter is because a switch case can use regular expressions! First, however, take a look at this simple switch block:","text_count":178,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main reason for presenting the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement in this chapter is because a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"case can use regular expressions! First, however, take a look at this simple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block:"}]},{"block_type":"element","block":"k6pz2i1x","search_text":"switch asString { case \"1\": fmt.Println(\"One!\") case \"0\": fmt.Println(\"Zero!\") default: fmt.Println(\"Do not care!\") } ","text_count":118,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"switch asString { \ncase \"1\": \n      fmt.Println(\"One!\") \ncase \"0\": \n      fmt.Println(\"Zero!\") \ndefault: \n     fmt.Println(\"Do not care!\") \n}"}]}]},{"block_type":"element","block":"k6pz2i1y","search_text":"The preceding switch block can differentiate the asString value among the \"1\" string, the \"0\" string, and everything else ( default ).","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block can differentiate the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"asString"}]},{"block_type":"text","content":"value among the \"1\" string, the \"0\" string, and everything else ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2i1z","search_text":"Tip Having a match all remaining cases case in a switch block is considered a very good practice. However, as the order of the cases in a switch block does matter, the match all remaining cases case should be put last. In Go, the name of the match all remaining cases case is default . ","text_count":286,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Having a"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"match all remaining cases"}]},{"block_type":"text","content":"case in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block is considered a very good practice. However, as the order of the cases in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block does matter, the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"match all remaining cases"}]},{"block_type":"text","content":"case should be put last. In Go, the name of the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"match all remaining cases"}]},{"block_type":"text","content":"case is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2i20","search_text":"A switch statement, however, can be much more flexible and adaptable:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement, however, can be much more flexible and adaptable:"}]},{"block_type":"element","block":"k6pz2i21","search_text":"switch { case number < 0: fmt.Println(\"Less than zero!\") case number > 0: fmt.Println(\"Bigger than zero!\") default: fmt.Println(\"Zero!\") } ","text_count":139,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"switch { \ncase number &lt; 0: \n    fmt.Println(\"Less than zero!\") \ncase number &gt; 0: \n    fmt.Println(\"Bigger than zero!\") \ndefault: \n    fmt.Println(\"Zero!\") \n}"}]}]},{"block_type":"element","block":"k6pz2i22","search_text":"The preceding switch block does the job of identifying whether you are dealing with a positive integer, a negative integer, or zero. As you can see, the branches of a switch statement can have conditions. You will soon see that the branches of a switch statement can also have regular expressions in them!","text_count":305,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block does the job of identifying whether you are dealing with a positive integer, a negative integer, or zero. As you can see, the branches of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement can have conditions. You will soon see that the branches of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement can also have regular expressions in them!"}]},{"block_type":"element","block":"k6pz2i23","search_text":"All of these examples and some additional ones can be found in switch.go , which will be presented in five parts.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of these examples and some additional ones can be found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":", which will be presented in five parts."}]},{"block_type":"element","block":"k6pz2i24","search_text":"The first part of switch.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i25","search_text":"package main import ( \"fmt\" \"os\" \"regexp\" \"strconv\" ) func main() { arguments := os.Args if len(arguments) < 2 { fmt.Println(\"usage: switch number\") os.Exit(1) } ","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"regexp\" \n    \"strconv\" \n) \n \nfunc main() { \n \n    arguments := os.Args \n    if len(arguments) &lt; 2 { \n        fmt.Println(\"usage: switch number\") \n        os.Exit(1) \n    }"}]}]},{"block_type":"element","block":"k6pz2i26","search_text":"The regexp package is needed for supporting regular expressions in switch .","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp"}]},{"block_type":"text","content":"package is needed for supporting regular expressions in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i27","search_text":"The second code segment of switch.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i28","search_text":"number, err := strconv.Atoi(arguments[1]) if err != nil { fmt.Println(\"This value is not an integer:\", number) } else { switch { case number < 0: fmt.Println(\"Less than zero!\") case number > 0: fmt.Println(\"Bigger than zero!\") default: fmt.Println(\"Zero!\") } } ","text_count":261,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"number, err := strconv.Atoi(arguments[1]) \n    if err != nil { \n        fmt.Println(\"This value is not an integer:\", number) \n    } else { \n        switch { \n        case number &lt; 0: \n            fmt.Println(\"Less than zero!\") \n        case number &gt; 0: \n            fmt.Println(\"Bigger than zero!\") \n        default: \n            fmt.Println(\"Zero!\") \n        } \n    }"}]}]},{"block_type":"element","block":"k6pz2i29","search_text":"The third part of switch.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i2a","search_text":"asString := arguments[1] switch asString { case \"5\": fmt.Println(\"Five!\") case \"0\": fmt.Println(\"Zero!\") default: fmt.Println(\"Do not care!\") } ","text_count":144,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"asString := arguments[1] \n    switch asString { \n    case \"5\": \n        fmt.Println(\"Five!\") \n    case \"0\": \n        fmt.Println(\"Zero!\") \n    default: \n        fmt.Println(\"Do not care!\") \n    }"}]}]},{"block_type":"element","block":"k6pz2i2b","search_text":"In this code segment, you can see that a switch case can also contain hardcoded values. This mainly occurs when the switch keyword is followed by the name of a variable.","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, you can see that a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"case can also contain hardcoded values. This mainly occurs when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"keyword is followed by the name of a variable."}]},{"block_type":"element","block":"k6pz2i2c","search_text":"The fourth code portion of switch.go contains the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i2d","search_text":"var negative = regexp.MustCompile('-') var floatingPoint = regexp.MustCompile('\\d?\\.\\d') var email = regexp.MustCompile('^[^@]+@[^@.]+\\.[^@.]+') switch { case negative.MatchString(asString): fmt.Println(\"Negative number\") case floatingPoint.MatchString(asString): fmt.Println(\"Floating point!\") case email.MatchString(asString): fmt.Println(\"It is an email!\") fallthrough default: fmt.Println(\"Something else!\") } ","text_count":414,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var negative = regexp.MustCompile('-') \n    var floatingPoint = regexp.MustCompile('\\d?\\.\\d') \n    var email = regexp.MustCompile('^[^@]+@[^@.]+\\.[^@.]+') \n  \n    switch { \n    case negative.MatchString(asString): \n        fmt.Println(\"Negative number\") \n    case floatingPoint.MatchString(asString): \n        fmt.Println(\"Floating point!\") \n    case email.MatchString(asString): \n        fmt.Println(\"It is an email!\") \n        fallthrough \n    default: \n        fmt.Println(\"Something else!\") \n    }"}]}]},{"block_type":"element","block":"k6pz2i2e","search_text":"Many interesting things are happening here. First, you define three regular expressions named negative , floatingPoint , and email , respectively. Then you use all three of them in the switch block with the help of the regexp.MatchString() function that does the actual matching.","text_count":279,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Many interesting things are happening here. First, you define three regular expressions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"negative"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"floatingPoint"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"email"}]},{"block_type":"text","content":", respectively. Then you use all three of them in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp.MatchString()"}]},{"block_type":"text","content":"function that does the actual matching."}]},{"block_type":"element","block":"k6pz2i2f","search_text":"Last, the fallthrough keyword also tells Go to execute the branch that follows the current one, which in this case is the default branch. This means that when the code of the email.MatchString(asString) case is the one that will get executed, the default case will also be executed.","text_count":282,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fallthrough"}]},{"block_type":"text","content":"keyword also tells Go to execute the branch that follows the current one, which in this case is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"branch. This means that when the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"email.MatchString(asString)"}]},{"block_type":"text","content":"case is the one that will get executed, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"case will also be executed."}]},{"block_type":"element","block":"k6pz2i2g","search_text":"The last part of switch.go is as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i2h","search_text":"var aType error = nil switch aType.(type) { case nil: fmt.Println(\"It is nil interface!\") default: fmt.Println(\"Not nil interface!\") } } ","text_count":137,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var aType error = nil \n    switch aType.(type) { \n    case nil: \n        fmt.Println(\"It is nil interface!\") \n    default: \n        fmt.Println(\"Not nil interface!\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i2i","search_text":"Here you can see that switch can differentiate between types. You will learn more about working with switch and Go interfaces at Chapter 7, Reflection and Interfaces for All Seasons .","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"can differentiate between types. You will learn more about working with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"and Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"interfaces"}]},{"block_type":"text","content":"at Chapter 7,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Reflection and Interfaces for All Seasons"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i2j","search_text":"Executing switch.go with various input arguments will generate the following type of output:","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"with various input arguments will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2i2k","search_text":"$ go run switch.go usage: switch number. exit status 1 $ go run switch.go mike@g.com This value is not an integer: 0 Do not care! It is an email! Something else! It is nil interface! $ go run switch.go 5 Bigger than zero! Five! Something else! It is nil interface! $ go run switch.go 0 Zero! Zero! Something else! It is nil interface! $ go run switch.go 1.2 This value is not an integer: 0 Do not care! Floating point! It is nil interface! $ go run switch.go -1.5 This value is not an integer: 0 Do not care! Negative number It is nil interface!","text_count":545,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run switch.go\nusage: switch number.\nexit status 1\n$ go run switch.go mike@g.com\nThis value is not an integer: 0\nDo not care!\nIt is an email!\nSomething else!\nIt is nil interface!\n$ go run switch.go 5\nBigger than zero!\nFive!\nSomething else!\nIt is nil interface!\n$ go run switch.go 0\nZero!\nZero!\nSomething else!\nIt is nil interface!\n$ go run switch.go 1.2\nThis value is not an integer: 0\nDo not care!\nFloating point!\nIt is nil interface!\n$ go run switch.go -1.5\nThis value is not an integer: 0\nDo not care!\nNegative number\nIt is nil interface!"}]}]},{"block_type":"element","block":"k6pz2i2l","search_text":"Calculating Pi with great accuracy","text_count":34,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Calculating Pi with great accuracy"}]},{"block_type":"element","block":"k6pz2i2m","search_text":"In this section, you will learn how to calculate Pi with great accuracy using a standard Go package named math/big and the special purpose types offered by that package.","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to calculate"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Pi"}]},{"block_type":"text","content":"with great accuracy using a standard Go package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"and the special purpose types offered by that package."}]},{"block_type":"element","block":"k6pz2i2n","search_text":"Note This section contains the ugliest Go code that I have even seen! Even Java code looks better than this. ","text_count":109,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section contains the ugliest Go code that I have even seen! Even"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Java"}]},{"block_type":"text","content":"code looks better than this."}]}]},{"block_type":"element","block":"k6pz2i2o","search_text":"The name of the program that uses Bellard's formula to calculate Pi is calculatePi.go , and it will be presented in four parts.","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program that uses Bellard's formula to calculate Pi is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2i2p","search_text":"The first part of calculatePi.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i2q","search_text":"package main import ( \"fmt\" \"math\" \"math/big\" \"os\" \"strconv\" ) var precision uint = 0 ","text_count":86,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math\" \n    \"math/big\" \n    \"os\" \n    \"strconv\" \n) \n \nvar precision uint = 0"}]}]},{"block_type":"element","block":"k6pz2i2r","search_text":"The precision variable holds the desired precision of the calculations, and it is made global in order to be accessible from everywhere in the program.","text_count":151,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"precision"}]},{"block_type":"text","content":"variable holds the desired precision of the calculations, and it is made global in order to be accessible from everywhere in the program."}]},{"block_type":"element","block":"k6pz2i2s","search_text":"The second code segment of calculatePi.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i2t","search_text":"func Pi(accuracy uint) *big.Float { k := 0 pi := new(big.Float).SetPrec(precision).SetFloat64(0) k1k2k3 := new(big.Float).SetPrec(precision).SetFloat64(0) k4k5k6 := new(big.Float).SetPrec(precision).SetFloat64(0) temp := new(big.Float).SetPrec(precision).SetFloat64(0) minusOne := new(big.Float).SetPrec(precision).SetFloat64(-1) total := new(big.Float).SetPrec(precision).SetFloat64(0) two2Six := math.Pow(2, 6) two2SixBig := new(big.Float).SetPrec(precision).SetFloat64(two2Six) ","text_count":481,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Pi(accuracy uint) *big.Float { \n    k := 0 \n    pi := new(big.Float).SetPrec(precision).SetFloat64(0) \n    k1k2k3 := new(big.Float).SetPrec(precision).SetFloat64(0) \n    k4k5k6 := new(big.Float).SetPrec(precision).SetFloat64(0) \n    temp := new(big.Float).SetPrec(precision).SetFloat64(0) \n    minusOne := new(big.Float).SetPrec(precision).SetFloat64(-1) \n    total := new(big.Float).SetPrec(precision).SetFloat64(0) \n \n    two2Six := math.Pow(2, 6) \n    two2SixBig := new(big.Float).SetPrec(precision).SetFloat64(two2Six)"}]}]},{"block_type":"element","block":"k6pz2i2u","search_text":"The new(big.Float) call creates a new big.Float variable with the desired precision, which is set by SetPrec() .","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new(big.Float)"}]},{"block_type":"text","content":"call creates a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"big.Float"}]},{"block_type":"text","content":"variable with the desired precision, which is set by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SetPrec()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i2v","search_text":"The third part of calculatePi.go contains the remaining Go code of the Pi() function:","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":"contains the remaining Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pi()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i2w","search_text":"for { if k > int(accuracy) { break } t1 := float64(float64(1) / float64(10*k+9)) k1 := new(big.Float).SetPrec(precision).SetFloat64(t1) t2 := float64(float64(64) / float64(10*k+3)) k2 := new(big.Float).SetPrec(precision).SetFloat64(t2) t3 := float64(float64(32) / float64(4*k+1)) k3 := new(big.Float).SetPrec(precision).SetFloat64(t3) k1k2k3.Sub(k1, k2) k1k2k3.Sub(k1k2k3, k3) t4 := float64(float64(4) / float64(10*k+5)) k4 := new(big.Float).SetPrec(precision).SetFloat64(t4) t5 := float64(float64(4) / float64(10*k+7)) k5 := new(big.Float).SetPrec(precision).SetFloat64(t5) t6 := float64(float64(1) / float64(4*k+3)) k6 := new(big.Float).SetPrec(precision).SetFloat64(t6) k4k5k6.Add(k4, k5) k4k5k6.Add(k4k5k6, k6) k4k5k6 = k4k5k6.Mul(k4k5k6, minusOne) temp.Add(k1k2k3, k4k5k6) k7temp := new(big.Int).Exp(big.NewInt(-1), big.NewInt(int64(k)), nil) k8temp := new(big.Int).Exp(big.NewInt(1024), big.NewInt(int64(k)), nil) k7 := new(big.Float).SetPrec(precision).SetFloat64(0) k7.SetInt(k7temp) k8 := new(big.Float).SetPrec(precision).SetFloat64(0) k8.SetInt(k8temp) t9 := float64(256) / float64(10*k+1) k9 := new(big.Float).SetPrec(precision).SetFloat64(t9) k9.Add(k9, temp) total.Mul(k9, k7) total.Quo(total, k8) pi.Add(pi, total) k = k + 1 }","text_count":1241,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        if k &gt; int(accuracy) { \n            break \n        } \n        t1 := float64(float64(1) / float64(10*k+9)) \n        k1 := new(big.Float).SetPrec(precision).SetFloat64(t1) \n        t2 := float64(float64(64) / float64(10*k+3)) \n        k2 := new(big.Float).SetPrec(precision).SetFloat64(t2) \n        t3 := float64(float64(32) / float64(4*k+1)) \n        k3 := new(big.Float).SetPrec(precision).SetFloat64(t3) \n        k1k2k3.Sub(k1, k2) \n        k1k2k3.Sub(k1k2k3, k3) \n        t4 := float64(float64(4) / float64(10*k+5)) \n        k4 := new(big.Float).SetPrec(precision).SetFloat64(t4) \n        t5 := float64(float64(4) / float64(10*k+7)) \n        k5 := new(big.Float).SetPrec(precision).SetFloat64(t5) \n        t6 := float64(float64(1) / float64(4*k+3)) \n        k6 := new(big.Float).SetPrec(precision).SetFloat64(t6) \n        k4k5k6.Add(k4, k5) \n        k4k5k6.Add(k4k5k6, k6) \n        k4k5k6 = k4k5k6.Mul(k4k5k6, minusOne) \n        temp.Add(k1k2k3, k4k5k6) \n \n        k7temp := new(big.Int).Exp(big.NewInt(-1), big.NewInt(int64(k)), nil) \n        k8temp := new(big.Int).Exp(big.NewInt(1024), big.NewInt(int64(k)), nil) \n        k7 := new(big.Float).SetPrec(precision).SetFloat64(0) \n        k7.SetInt(k7temp) \n        k8 := new(big.Float).SetPrec(precision).SetFloat64(0) \n        k8.SetInt(k8temp) \n \n        t9 := float64(256) / float64(10*k+1) \n        k9 := new(big.Float).SetPrec(precision).SetFloat64(t9) \n        k9.Add(k9, temp) \n        total.Mul(k9, k7) \n        total.Quo(total, k8) \n        pi.Add(pi, total) \n \n        k = k + 1 \n    }"}]}]},{"block_type":"element","block":"k6pz2i2x","search_text":"pi.Quo(pi, two2SixBig) return pi } ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"pi.Quo(pi, two2SixBig) \n    return pi \n}"}]}]},{"block_type":"element","block":"k6pz2i2y","search_text":"This part of the program is the Go implementation of Bellard's formula. The bad thing about math/big is that you need a special function of it for almost every type of calculation. This is the case primarily because those functions keep the precision at the desired level. Thus, without using big.Float and big.Int variables, as well as the functions of math/big all of the time, you cannot compute Pi with the desired precision.","text_count":429,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part of the program is the Go implementation of Bellard's formula. The bad thing about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"is that you need a special function of it for almost every type of calculation. This is the case primarily because those functions keep the precision at the desired level. Thus, without using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"big.Float"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"big.Int"}]},{"block_type":"text","content":"variables, as well as the functions of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"all of the time, you cannot compute Pi with the desired precision."}]},{"block_type":"element","block":"k6pz2i2z","search_text":"The last part of calculatePi.go shows the implementation of the main() function:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":"shows the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i30","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide one numeric argument!\") os.Exit(1) } temp, _ := strconv.ParseUint(arguments[1], 10, 32) precision = uint(temp) * 3 PI := Pi(precision) fmt.Println(PI) } ","text_count":241,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide one numeric argument!\") \n        os.Exit(1) \n    } \n \n    temp, _ := strconv.ParseUint(arguments[1], 10, 32) \n    precision = uint(temp) * 3 \n \n    PI := Pi(precision) \n    fmt.Println(PI) \n}"}]}]},{"block_type":"element","block":"k6pz2i31","search_text":"Executing calculatePi.go will generate the following type of output:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"calculatePi.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2i32","search_text":"$ go run calculatePi.go Please provide one numeric argument! exit status 1 $ go run calculatePi.go 20 3.141592653589793258 $ go run calculatePi.go 200 3.141592653589793256960399361738762404019183156248573243493179283571046450248913467118511784317615354282017929416292809050813937875283435610586313363548602436768047706489838924381929","text_count":333,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run calculatePi.go\nPlease provide one numeric argument!\nexit status 1\n$ go run calculatePi.go 20\n3.141592653589793258\n$ go run calculatePi.go 200\n3.141592653589793256960399361738762404019183156248573243493179283571046450248913467118511784317615354282017929416292809050813937875283435610586313363548602436768047706489838924381929"}]}]},{"block_type":"element","block":"k6pz2i33","search_text":"The moral of this section is that there are many different data types, and that you should use the right data type each time!","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The moral of this section is that there are many different data types, and that you should use the right data type each time!"}]},{"block_type":"element","block":"k6pz2i34","search_text":"Developing a key/value store in Go","text_count":34,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Developing a key/value store in Go"}]},{"block_type":"element","block":"k6pz2i35","search_text":"In this section, you will learn how to develop an unsophisticated version of a key-value store in Go, which means that you will learn how to implement the core functionality of a key-value store without any additional bells and whistles. The idea behind a key-value store is modest: answer queries fast and, generally speaking, work as fast as possible. This translates into using simple algorithms and simple data structures.","text_count":426,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to develop an unsophisticated version of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"key-value store"}]},{"block_type":"text","content":"in Go, which means that you will learn how to implement the core functionality of a key-value store without any additional bells and whistles. The idea behind a key-value store is modest: answer queries fast and, generally speaking, work as fast as possible. This translates into using simple algorithms and simple data structures."}]},{"block_type":"element","block":"k6pz2i36","search_text":"The program presented now will basically implement the four fundamental tasks of a key-value store:","text_count":99,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The program presented now will basically implement the four fundamental tasks of a key-value store:"}]},{"block_type":"element","block":"k6pz2i37","search_text":"Adding a new element Deleting an existing element from the key-value store based on a key Looking up for the value of a specific key in the store, and Changing the value of an existing key ","text_count":189,"tag_name":"ol","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Adding a new element"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Deleting an existing element from the key-value store based on a key"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Looking up for the value of a specific key in the store, and"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Changing the value of an existing key"}]}]},{"block_type":"element","block":"k6pz2i38","search_text":"These four functions allow you to have full control over the key-value store. The commands for these four functions will be named ADD , DELETE , LOOKUP , and CHANGE , respectively. This means that the program will only operate when its gets one of these four commands. Additionally, the program will stop when you enter the STOP word as input, and it will print the full contents of the key-value store when you enter the PRINT command.","text_count":436,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"These four functions allow you to have full control over the key-value store. The commands for these four functions will be named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DELETE"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"LOOKUP"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CHANGE"}]},{"block_type":"text","content":", respectively. This means that the program will only operate when its gets one of these four commands. Additionally, the program will stop when you enter the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"STOP"}]},{"block_type":"text","content":"word as input, and it will print the full contents of the key-value store when you enter the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PRINT"}]},{"block_type":"text","content":"command."}]},{"block_type":"element","block":"k6pz2i39","search_text":"The name of the program in this example will be keyValue.go , and it will be presented in five code segments.","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program in this example will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":", and it will be presented in five code segments."}]},{"block_type":"element","block":"k6pz2i3a","search_text":"The first code segment of keyValue.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i3b","search_text":"package main import ( \"bufio\" \"fmt\" \"os\" \"strings\" ) type myElement struct { Name string Surname string Id string } var DATA = make(map[string]myElement) ","text_count":154,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"os\" \n    \"strings\" \n) \n \ntype myElement struct { \n    Name    string \n    Surname string \n    Id      string \n} \n \nvar DATA = make(map[string]myElement)"}]}]},{"block_type":"element","block":"k6pz2i3c","search_text":"The key-value store is stored in a native Go map because using a built-in Go structure is usually faster. The map variable is defined as a global variable, where its keys are string variables and its values are myElement variables. You can also see the definition of the myElement struct type here.","text_count":298,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The key-value store is stored in a native Go map because using a built-in Go structure is usually faster. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"map"}]},{"block_type":"text","content":"variable is defined as a global variable, where its keys are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":"variables and its values are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myElement"}]},{"block_type":"text","content":"variables. You can also see the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myElement struct"}]},{"block_type":"text","content":"type here."}]},{"block_type":"element","block":"k6pz2i3d","search_text":"The second code segment of keyValue.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i3e","search_text":"func ADD(k string, n myElement) bool { if k == \"\" { return false } if LOOKUP(k) == nil { DATA[k] = n return true } return false } func DELETE(k string) bool { if LOOKUP(k) != nil { delete(DATA, k) return true } return false } ","text_count":226,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func ADD(k string, n myElement) bool { \n    if k == \"\" { \n        return false \n    } \n \n    if LOOKUP(k) == nil { \n        DATA[k] = n \n        return true \n    } \n    return false \n} \n \nfunc DELETE(k string) bool { \n    if LOOKUP(k) != nil { \n        delete(DATA, k) \n        return true \n    } \n    return false \n}"}]}]},{"block_type":"element","block":"k6pz2i3f","search_text":"This code contains the implementation of two functions that support the functionality of the ADD and DELETE commands. Note that if the user tries to add a new element to the store without giving enough values to populate the myElement struct, the ADD function will not fail. For this particular program, the missing fields of the myElement struct will be set to the empty string. However, if you try to add a key that already exists, you will get an error message instead of modifying the existing key-value.","text_count":508,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This code contains the implementation of two functions that support the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DELETE"}]},{"block_type":"text","content":"commands. Note that if the user tries to add a new element to the store without giving enough values to populate the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myElement"}]},{"block_type":"text","content":"struct, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD"}]},{"block_type":"text","content":"function will not fail. For this particular program, the missing fields of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myElement"}]},{"block_type":"text","content":"struct will be set to the empty string. However, if you try to add a key that already exists, you will get an error message instead of modifying the existing key-value."}]},{"block_type":"element","block":"k6pz2i3g","search_text":"Notice that I rarely use function names with all caps unless I want them to stand out in the code.","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that I rarely use function names with all caps unless I want them to stand out in the code."}]},{"block_type":"element","block":"k6pz2i3h","search_text":"The third portion of keyValue.go contains the following code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2i3i","search_text":"func LOOKUP(k string) *myElement { _, ok := DATA[k] if ok { n := DATA[k] return &n } else { return nil } } func CHANGE(k string, n myElement) bool { DATA[k] = n return true } func PRINT() { for k, d := range DATA { fmt.Printf(\"key: %s value: %v\\n\", k, d) } } ","text_count":259,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func LOOKUP(k string) *myElement { \n    _, ok := DATA[k] \n    if ok { \n        n := DATA[k] \n        return &amp;n \n    } else { \n        return nil \n    } \n} \n \nfunc CHANGE(k string, n myElement) bool { \n    DATA[k] = n \n    return true \n} \n \nfunc PRINT() { \n    for k, d := range DATA { \n        fmt.Printf(\"key: %s value: %v\\n\", k, d) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i3j","search_text":"In this Go code segment, you see the implementation of the functions that support the functionality of the LOOKUP and CHANGE commands. If you try to change a key that does not exist, the program will add that key to the store without generating any error messages.","text_count":264,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this Go code segment, you see the implementation of the functions that support the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"LOOKUP"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CHANGE"}]},{"block_type":"text","content":"commands. If you try to change a key that does not exist, the program will add that key to the store without generating any error messages."}]},{"block_type":"element","block":"k6pz2i3k","search_text":"In this part, you can also see the implementation of the PRINT() function that prints the full contents of the key-value store.","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you can also see the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PRINT()"}]},{"block_type":"text","content":"function that prints the full contents of the key-value store."}]},{"block_type":"element","block":"k6pz2i3l","search_text":"The fourth part of keyValue.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i3m","search_text":"func main() { scanner := bufio.NewScanner(os.Stdin) for scanner.Scan() { text := scanner.Text() text = strings.TrimSpace(text) tokens := strings.Fields(text) switch len(tokens) { case 0: continue case 1: tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 2: tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 3: tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 4: tokens = append(tokens, \"\") } ","text_count":510,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    scanner := bufio.NewScanner(os.Stdin) \n    for scanner.Scan() { \n        text := scanner.Text() \n        text = strings.TrimSpace(text) \n        tokens := strings.Fields(text) \n \n        switch len(tokens) { \n        case 0: \n               continue \n        case 1: \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\") \n        case 2: \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\") \n        case 3: \n              tokens = append(tokens, \"\") \n              tokens = append(tokens, \"\")\n        case 4: \n              tokens = append(tokens, \"\") \n        }"}]}]},{"block_type":"element","block":"k6pz2i3n","search_text":"In this part of keyValue.go , you read the input from the user. First, the for loop makes sure that the program will keep running for as long as the user provides some input. Additionally, the program makes sure that the tokens slice has at least five elements, even though only the ADD command requires that number of elements. Thus, for an ADD operation to be complete and not to have any missing values, you will need an input that looks like ADD aKey Field1 Field2 Field3 .","text_count":477,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":", you read the input from the user. First, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop makes sure that the program will keep running for as long as the user provides some input. Additionally, the program makes sure that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tokens"}]},{"block_type":"text","content":"slice has at least five elements, even though only the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD"}]},{"block_type":"text","content":"command requires that number of elements. Thus, for an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD"}]},{"block_type":"text","content":"operation to be complete and not to have any missing values, you will need an input that looks like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ADD aKey Field1 Field2 Field3"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i3o","search_text":"The last part of keyValue.go is shown in the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i3p","search_text":"switch tokens[0] { case \"PRINT\": PRINT() case \"STOP\": return case \"DELETE\": if !DELETE(tokens[1]) { fmt.Println(\"Delete operation failed!\") } case \"ADD\": n := myElement{tokens[2], tokens[3], tokens[4]} if !ADD(tokens[1], n) { fmt.Println(\"Add operation failed!\") } case \"LOOKUP\": n := LOOKUP(tokens[1]) if n != nil { fmt.Printf(\"%v\\n\", *n) } case \"CHANGE\": n := myElement{tokens[2], tokens[3], tokens[4]} if !CHANGE(tokens[1], n) { fmt.Println(\"Update operation failed!\") } default: fmt.Println(\"Unknown command - please try again!\") } } } ","text_count":540,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"switch tokens[0] { \n        case \"PRINT\": \n              PRINT() \n        case \"STOP\": \n              return \n        case \"DELETE\": \n              if !DELETE(tokens[1]) { \n                    fmt.Println(\"Delete operation failed!\") \n              } \n        case \"ADD\": \n              n := myElement{tokens[2], tokens[3], tokens[4]} \n              if !ADD(tokens[1], n) { \n                    fmt.Println(\"Add operation failed!\") \n              } \n        case \"LOOKUP\": \n              n := LOOKUP(tokens[1]) \n              if n != nil { \n                    fmt.Printf(\"%v\\n\", *n) \n              } \n        case \"CHANGE\": \n              n := myElement{tokens[2], tokens[3], tokens[4]} \n              if !CHANGE(tokens[1], n) { \n                    fmt.Println(\"Update operation failed!\") \n              } \n        default: \n              fmt.Println(\"Unknown command - please try again!\") \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i3q","search_text":"In this part of the program, you process the input from the user. The switch statement makes the design of the program very clean, and it saves you from having to use multiple if...else statements.","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, you process the input from the user. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement makes the design of the program very clean, and it saves you from having to use multiple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if...else"}]},{"block_type":"text","content":"statements."}]},{"block_type":"element","block":"k6pz2i3r","search_text":"Executing and using keyValue.go will create the following output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing and using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"will create the following&nbsp;output:"}]},{"block_type":"element","block":"k6pz2i3s","search_text":"$ go run keyValue.go UNKNOWN Unknown command - please try again! ADD 123 1 2 3 ADD 234 2 3 4 ADD 345 PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} key: 345 value: { } ADD 345 3 4 5 Add operation failed! PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} key: 345 value: { } CHANGE 345 3 4 5 PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} key: 345 value: {3 4 5} DELETE 345 PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} DELETE 345 Delete operation failed! PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} ADD 345 3 4 5 ADD 567 -5 -6 -7 PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} key: 345 value: {3 4 5} key: 567 value: {-5 -6 -7} CHANGE 345 PRINT key: 123 value: {1 2 3} key: 234 value: {2 3 4} key: 345 value: { } key: 567 value: {-5 -6 -7} STOP","text_count":787,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run keyValue.go\nUNKNOWN\nUnknown command - please try again!\nADD 123 1 2 3\nADD 234 2 3 4\nADD 345\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nkey: 345 value: {  }\nADD 345 3 4 5\nAdd operation failed!\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nkey: 345 value: {  }\nCHANGE 345 3 4 5\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nkey: 345 value: {3 4 5}\nDELETE 345\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nDELETE 345\nDelete operation failed!\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nADD 345 3 4 5\nADD 567 -5 -6 -7\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nkey: 345 value: {3 4 5}\nkey: 567 value: {-5 -6 -7}\nCHANGE 345\nPRINT\nkey: 123 value: {1 2 3}\nkey: 234 value: {2 3 4}\nkey: 345 value: {  }\nkey: 567 value: {-5 -6 -7}\nSTOP"}]}]},{"block_type":"element","block":"k6pz2i3t","search_text":"You will have to wait until Chapter 8, Telling a Unix System What to Do , in order to learn how to add data persistence to the key-value store.","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will have to wait until Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":", in order to learn how to add data persistence to the key-value store."}]},{"block_type":"element","block":"k6pz2i3u","search_text":"You can also improve keyValue.go by adding goroutines and channels to it. However, adding goroutines and channels to a single user application has no practical meaning. Nevertheless, if you make keyValue.go capable of operating over TCP/IP networks, then the use of goroutines and channels will allow it to accept multiple connections and serve multiple users. You will learn more about routines and channels in Chapter 9, Go Concurrency – Goroutines, Channels and Pipelines and Chapter 10, Go Concurrency – Advanced topics . You will also learn about creating network applications in Go in Chapter 12, The Foundations of Network Programming in Go , and in Chapter 13, Network Programming – Building Servers and Clients .","text_count":721,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can also improve"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"by adding goroutines and channels to it. However, adding goroutines and channels to a single user application has no practical meaning. Nevertheless, if you make"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"capable of operating over TCP/IP networks, then the use of goroutines and channels will allow it to accept multiple connections and serve multiple users. You will learn more about routines and channels in Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Goroutines, Channels and Pipelines"}]},{"block_type":"text","content":"&nbsp;and Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Advanced topics"}]},{"block_type":"text","content":". You will also learn about creating network applications in Go in Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The&nbsp;"}]},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Foundations of Network Programming in Go"}]},{"block_type":"text","content":", and in Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming &ndash; Building Servers and Clients"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i3v","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2i3w","search_text":"You might find the following resources useful:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might find the following resources useful:"}]},{"block_type":"element","block":"k6pz2i3x","search_text":"Read the documentation of the regexp standard Go package that can be found at https://golang.org/pkg/regexp/ Visit the man page of the grep(1) utility Develop a Go program that finds all of the IPv4 addresses of a log file that downloaded ZIP files You can find more information about the math/big Go package at https://golang.org/pkg/math/big/ Review the documentation of the unicode standard Go package at https://golang.org/pkg/unicode/ Although you might find it hard at first, start reading The Go Programming Language Specification at https://golang.org/ref/spec ","text_count":569,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Read the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp"}]},{"block_type":"text","content":"standard Go package that can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/regexp/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/regexp/"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the man page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grep(1)"}]},{"block_type":"text","content":"utility"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop a Go program that finds all of the IPv4 addresses of a log file that downloaded ZIP files"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can find more information about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"Go package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/math/big/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/math/big/"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Review the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"standard Go package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/unicode/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/unicode/"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Although you might find it hard at first, start reading The Go Programming Language Specification at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/ref/spec","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/ref/spec"}]}]}]},{"block_type":"element","block":"k6pz2i3y","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2i3z","search_text":"Try to write a Go program that prints the invalid part or parts of an IPv4 address Describe the differences between make and new without looking at the chapter Describe the differences between a character, a byte, and a rune Using the code of findIPv4.go , write a Go program that prints the most popular IPv4 addresses found in a log file without processing the output with any Unix utilities Develop a Go program that finds the IPv4 addresses in a log file that generated a 404 HTML error message Using the math/big standard Go package, write a Go program that calculates square roots with high precision. Choose the algorithm on your own Write a Go utility that finds a given date and time format in its input and returns just the time part of it Develop a Go utility that uses a regular expression in order to match integers from 200 to 400 Try to improve keyValue.go by adding logging to it Modify the findIP() function of the findIPv4.go utility so that the regular expression is compiled only once and not every time the findIP() function is called ","text_count":1056,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to write a Go program that prints the invalid part or parts of an IPv4 address"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Describe the differences between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"new"}]},{"block_type":"text","content":"without looking at the chapter"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Describe the differences between a character, a byte, and a rune"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":", write a Go program that prints the most popular IPv4 addresses found in a log file without processing the output with any Unix utilities"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop a Go program that finds the IPv4 addresses in a log file that generated a 404 HTML error message"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"standard Go package, write a Go program that calculates square roots with high precision. Choose the algorithm on your own"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go utility that finds a given date and time format in its input and returns just the time part of it"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop a Go utility that uses a regular expression in order to match integers from 200 to 400"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to improve"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"by adding logging to it"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIP()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIPv4.go"}]},{"block_type":"text","content":"utility so that the regular expression is compiled only once and not every time the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"findIP()"}]},{"block_type":"text","content":"function is called"}]}]},{"block_type":"element","block":"k6pz2i40","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2i41","search_text":"In this chapter, you learned about many handy Go features, including creating and using structures, tuples, strings, runes, and the functionality of the unicode standard Go package. Additionally, you learned about pattern matching and regular expressions, the switch statement, the strings standard Go package, you developed a key-value store in Go, and learned how to use the types of the math/big package to calculate Pi with the required accuracy.","text_count":450,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you learned about many handy Go features, including creating and using structures, tuples, strings, runes, and the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"standard Go package. Additionally, you learned about pattern matching and regular expressions, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"standard Go package, you developed a key-value store in Go, and learned how to use the types of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":"package to calculate Pi with the required accuracy."}]},{"block_type":"element","block":"k6pz2i42","search_text":"In the next chapter, you will learn how to arrange and manipulate data using more advanced features like binary trees, linked lists, doubly-linked lists, queues, stacks and hash tables, as well as the structures that can be found in the container standard Go package. The last topic of the next chapter will be random numbers and generating difficult-to-guess strings that can be used as passwords.","text_count":398,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next chapter, you will learn how to arrange and manipulate data using more advanced features like binary trees, linked lists, doubly-linked lists, queues, stacks and hash tables, as well as the structures that can be found in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package. The last topic of the next chapter will be"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"random numbers"}]},{"block_type":"text","content":"and generating difficult-to-guess strings that can be used as passwords."}]}]},{"title":"Enhancing Go Code with Data Structures","author":"Mihalis Tsoukalos","block":"k6pz24hv","number":5,"contents":[{"block_type":"element","block":"k6pz2i43","search_text":"In the previous chapter, we discussed composite data types, which are constructed using the struct keyword as well as topics such as regular expressions, pattern matching, tuples, runes, strings and the unicode and strings standard Go packages before developing a simple key-value store in Go.There are times, however, that the structures offered by a programming language will not fit a particular problem. In such cases, you will need to create your own data structures to store, search, and receive your data in explicit and specialized ways.Consequently, this chapter is all about developing and using many well-known data structures in Go including binary trees, linked lists, hash tables, stacks, and queues and learning about their advantages. As nothing describes a data structure better than an image, you will see many explanatory figures in this chapter! The last part of the chapter will address random number generation, which can help you generate difficult-to-guess passwords! In this chapter of Mastering Go, you will learn about the following topics:","text_count":1067,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we discussed composite data types, which are constructed using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"keyword as well as topics such as regular expressions, pattern matching, tuples, runes, strings and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"standard Go packages before developing a simple key-value store in Go.There are times, however, that the structures offered by a programming language will not fit a particular problem. In such cases, you will need to create your own data structures to store, search, and receive your data in explicit and specialized ways.Consequently, this chapter is all about developing and using many well-known data structures in Go including binary trees, linked lists, hash tables, stacks, and queues and learning about their advantages. As nothing describes a data structure better than an image, you will see many explanatory figures in this chapter! The last part of the chapter will address random number generation, which can help you generate difficult-to-guess passwords! In this chapter of Mastering Go, you will learn about the following topics:"}]},{"block_type":"element","block":"k6pz2i44","search_text":"Graphs and nodes Measuring the complexity of an algorithm Binary trees in Go Hash tables in Go Linked lists in Go Doubly linked lists in Go Queues in Go Stacks in Go The data structures offered by the container standard Go package Generating random numbers in Go Building random strings that can be used as difficult-to-crack passwords ","text_count":336,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Graphs and nodes"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Measuring the complexity of an algorithm"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Binary trees in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Hash tables in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Linked lists in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Doubly linked lists in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Queues in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Stacks in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The data structures offered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Generating random numbers in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Building random strings that can be used as difficult-to-crack passwords"}]}]},{"block_type":"element","block":"k6pz2i45","search_text":"About graphs and nodes","text_count":22,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About graphs and nodes"}]},{"block_type":"element","block":"k6pz2i46","search_text":"A graph G(V,E) is a finite, nonempty set of vertices V (or nodes ) and a set of edges E. There are two main types of graphs: cyclic graphs and acyclic graphs . A cyclic graph is one where all or a number of its vertices are connected in a closed chain. In acyclic graphs, there are no closed chains. A Directed Graph is one whose edges have a direction associated with them. A Directed Acyclic Graph is a directed graph with no cycles in it.","text_count":441,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"graph"}]},{"block_type":"text","content":"G(V,E) is a finite, nonempty set of vertices V (or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"nodes"}]},{"block_type":"text","content":") and a set of edges E. There are two main types of graphs:"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"cyclic graphs"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"acyclic graphs"}]},{"block_type":"text","content":". A cyclic graph is one where all or a number of its vertices are connected in a closed chain. In acyclic graphs, there are no closed chains. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Directed Graph"}]},{"block_type":"text","content":"is one whose edges have a direction associated with them. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Directed Acyclic Graph"}]},{"block_type":"text","content":"is a directed graph with no cycles in it."}]},{"block_type":"element","block":"k6pz2i47","search_text":"Tip As a node may contain any kind of information, nodes are usually implemented using Go structures. ","text_count":102,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As a node may contain any kind of information, nodes are usually implemented using Go structures."}]}]},{"block_type":"element","block":"k6pz2i48","search_text":"Algorithm complexity","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Algorithm complexity"}]},{"block_type":"element","block":"k6pz2i49","search_text":"The efficiency of an algorithm is judged by its computational complexity, which mostly has to do with the number of times the algorithm needs to access its input data to do its job.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The efficiency of an algorithm is judged by its computational complexity, which mostly has to do with the number of times the algorithm needs to access its input data to do its job."}]},{"block_type":"element","block":"k6pz2i4a","search_text":"The Big O notation is used in computer science for describing the complexity of an algorithm. Thus, an O(n) algorithm, which needs to access its input only once, is considered better than an O(n 2 ) algorithm, which is better than an O(n 3 ) algorithm, and so on. The worst algorithms, however, are the ones with an O(n!) running time, which makes them almost unusable for inputs with more than 300 elements.","text_count":408,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Big O notation"}]},{"block_type":"text","content":"is used in computer science for describing the complexity of an algorithm. Thus, an"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n)"}]},{"block_type":"text","content":"algorithm, which needs to access its input only once, is considered better than an"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n"},{"block_type":"element","tag_name":"sup","attributes":{},"children":[{"block_type":"text","content":"2"}]},{"block_type":"text","content":")"}]},{"block_type":"text","content":"algorithm, which is better than an"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n"},{"block_type":"element","tag_name":"sup","attributes":{},"children":[{"block_type":"text","content":"3"}]},{"block_type":"text","content":")"}]},{"block_type":"text","content":"algorithm, and so on. The worst algorithms, however, are the ones with an"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n!)"}]},{"block_type":"text","content":"running time, which makes them almost unusable for inputs with more than 300 elements."}]},{"block_type":"element","block":"k6pz2i4b","search_text":"Last, most Go lookup operations in built-in types, such as finding the value of a map key or accessing an array element, have a constant time, which is represented by O(1) . This means that built-in types are generally faster than custom types, and that you should generally favor using them, unless you want full control over what is going on behind the scenes. Furthermore, not all data structures are created equal. Generally speaking, array operations are faster than map operations, which is the price you have to pay for the versatility of a map.","text_count":552,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, most Go lookup operations in built-in types, such as finding the value of a map key or accessing an array element, have a constant time, which is represented by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(1)"}]},{"block_type":"text","content":". This means that built-in types are generally faster than custom types, and that you should generally favor using them, unless you want full control over what is going on behind the scenes. Furthermore, not all data structures are created equal. Generally speaking, array operations are faster than map operations, which is the price you have to pay for the versatility of a map."}]},{"block_type":"element","block":"k6pz2i4c","search_text":"Tip Although every algorithm has its drawbacks, if you do not have lots of data, the algorithm is not really important as long as it performs the desired job accurately. ","text_count":170,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although every algorithm has its drawbacks, if you do not have lots of data, the algorithm is not really important as long as it performs the desired job accurately."}]}]},{"block_type":"element","block":"k6pz2i4d","search_text":"Binary trees in Go","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Binary trees in Go"}]},{"block_type":"element","block":"k6pz2i4e","search_text":"A binary tree is a data structure where underneath each node there are two other nodes at most . At most means that a node can be connected to one, two, or no other nodes. The root of a tree is the first node of the tree. The depth of a tree , which is also called the height of a tree, is defined as the longest path from the root to a node, whereas the depth of a node is the number of edges from the node to the root of the tree. A leaf is a node with no children.","text_count":467,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"binary tree"}]},{"block_type":"text","content":"is a data structure where underneath each node there are two other nodes"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"at most"}]},{"block_type":"text","content":". At most means that a node can be connected to one, two, or no other nodes. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"root of a tree"}]},{"block_type":"text","content":"is the first node of the tree. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"depth of a tree"}]},{"block_type":"text","content":", which is also called the height of a tree, is defined as the longest path from the root to a node, whereas the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"depth of a node"}]},{"block_type":"text","content":"is the number of edges from the node to the root of the tree. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"leaf"}]},{"block_type":"text","content":"is a node with no children."}]},{"block_type":"element","block":"k6pz2i4f","search_text":"A tree is considered balanced when the longest distance from the root to a leaf is at most one more than the shortest such distance. As the name suggests, an Unbalanced Tree is a tree that is not balanced. Balancing a tree might be a difficult and slow operation, so it is better to keep your tree balanced from the very beginning than trying to balance it after you have created it, especially when your tree has many nodes.","text_count":425,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A tree is considered"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"balanced"}]},{"block_type":"text","content":"when the longest distance from the root to a leaf is at most one more than the shortest such distance. As the name suggests, an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unbalanced Tree"}]},{"block_type":"text","content":"is a tree that is not balanced. Balancing a tree might be a difficult and slow operation, so it is better to keep your tree balanced from the very beginning than trying to balance it after you have created it, especially when your tree has many nodes."}]},{"block_type":"element","block":"k6pz2i4g","search_text":"The following figure shows an unbalanced binary tree. Its root node is J, and nodes A, G, W, and D are leaves.","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following figure shows an unbalanced binary tree. Its root node is J, and nodes A, G, W, and D are leaves."}]},{"block_type":"element","block":"k6pz2i4h","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000018.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i4i","search_text":"An unbalanced binary tree","text_count":25,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An unbalanced binary tree"}]},{"block_type":"element","block":"k6pz2i4j","search_text":"Implementing a binary tree in Go","text_count":32,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a binary tree in Go"}]},{"block_type":"element","block":"k6pz2i4k","search_text":"This section illustrates how to implement a binary tree in Go using the source code found in binTree.go as an example. The contents of binTree.go will be presented in five parts. The first part follows next:","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section illustrates how to implement a binary tree in Go using the source code found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"as an example. The contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"will be presented in five parts. The first part follows next:"}]},{"block_type":"element","block":"k6pz2i4l","search_text":"package main import ( \"fmt\" \"math/rand\" \"time\" ) type Tree struct { Left *Tree Value int Right *Tree } ","text_count":103,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"time\" \n) \n \ntype Tree struct { \n    Left  *Tree \n    Value int \n    Right *Tree \n}"}]}]},{"block_type":"element","block":"k6pz2i4m","search_text":"What you see here is the definition of the node of the tree using a Go structure. The math/rand package is used for populating the tree with random numbers, as we do not yet have any real data.","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What you see here is the definition of the node of the tree using a Go structure. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/rand"}]},{"block_type":"text","content":"package is used for populating the tree with random numbers, as we do not yet have any real data."}]},{"block_type":"element","block":"k6pz2i4n","search_text":"The second code part of binTree.go is shown in the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i4o","search_text":"func traverse(t *Tree) { if t == nil { return } traverse(t.Left) fmt.Print(t.Value, \" \") traverse(t.Right) } ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(t *Tree) { \n    if t == nil { \n        return \n    } \n    traverse(t.Left) \n    fmt.Print(t.Value, \" \") \n    traverse(t.Right) \n}"}]}]},{"block_type":"element","block":"k6pz2i4p","search_text":"The traverse() function reveals how you can visit all of the nodes of a binary tree using recursion.","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function reveals how you can visit all of the nodes of a binary tree using recursion."}]},{"block_type":"element","block":"k6pz2i4q","search_text":"The third code segment of binTree.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i4r","search_text":"func create(n int) *Tree { var t *Tree rand.Seed(time.Now().Unix()) for i := 0; i < 2*n; i++ { temp := rand.Intn(n * 2) t = insert(t, temp) } return t } ","text_count":153,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func create(n int) *Tree { \n    var t *Tree \n    rand.Seed(time.Now().Unix()) \n    for i := 0; i &lt; 2*n; i++ { \n        temp := rand.Intn(n * 2) \n        t = insert(t, temp) \n    } \n    return t \n}"}]}]},{"block_type":"element","block":"k6pz2i4s","search_text":"The create() function is only used for populating the binary tree with random integers.","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create()"}]},{"block_type":"text","content":"function is only used for populating the binary tree with random integers."}]},{"block_type":"element","block":"k6pz2i4t","search_text":"The fourth part of the program is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2i4u","search_text":"func insert(t *Tree, v int) *Tree { if t == nil { return &Tree{nil, v, nil} } if v == t.Value { return t } if v < t.Value { t.Left = insert(t.Left, v) return t } t.Right = insert(t.Right, v) return t } ","text_count":202,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func insert(t *Tree, v int) *Tree { \n    if t == nil { \n        return &amp;Tree{nil, v, nil} \n    } \n \n    if v == t.Value { \n        return t \n    } \n \n    if v &lt; t.Value { \n        t.Left = insert(t.Left, v) \n        return t \n    } \n    t.Right = insert(t.Right, v) \n    return t \n}"}]}]},{"block_type":"element","block":"k6pz2i4v","search_text":"The insert() function does many important things using if statements. The first if statement checks whether you are dealing with an empty tree or not. If it is indeed an empty tree, then the new node will be the root of the tree and it will be created as &Tree{nil, v, nil} . The second if statement determines whether the value you are trying to insert already exists in the binary tree or not. If it exists, the function returns without doing anything else. The third if statement determines whether the value you are trying to insert will go to the left or to the right side of the node that is currently being examined and acts accordingly.","text_count":644,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"insert()"}]},{"block_type":"text","content":"function does many important things using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statements. The first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement checks whether you are dealing with an empty tree or not. If it is indeed an empty tree, then the new node will be the root of the tree and it will be created as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&amp;Tree{nil, v, nil}"}]},{"block_type":"text","content":". The second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement determines whether the value you are trying to insert already exists in the binary tree or not. If it exists, the function returns without doing anything else. The third"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement determines whether the value you are trying to insert will go to the left or to the right side of the node that is currently being examined and acts accordingly."}]},{"block_type":"element","block":"k6pz2i4w","search_text":"Notice that the presented implementation creates unbalanced binary trees.","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that the presented implementation creates unbalanced binary trees."}]},{"block_type":"element","block":"k6pz2i4x","search_text":"The last part of binTree.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i4y","search_text":"func main() { tree := create(10) fmt.Println(\"The value of the root of the tree is\", tree.Value) traverse(tree) fmt.Println() tree = insert(tree, -10) tree = insert(tree, -2) traverse(tree) fmt.Println() fmt.Println(\"The value of the root of the tree is\", tree.Value) } ","text_count":270,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    tree := create(10) \n    fmt.Println(\"The value of the root of the tree is\", tree.Value) \n    traverse(tree) \n    fmt.Println() \n    tree = insert(tree, -10) \n    tree = insert(tree, -2) \n    traverse(tree) \n    fmt.Println() \n    fmt.Println(\"The value of the root of the tree is\", tree.Value) \n}"}]}]},{"block_type":"element","block":"k6pz2i4z","search_text":"Executing binTree.go will generate the following type of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binTree.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2i50","search_text":"$ go run binTree.go The value of the root of the tree is 18 0 3 4 5 7 8 9 10 11 14 16 17 18 19 -10 -2 0 3 4 5 7 8 9 10 11 14 16 17 18 19 The value of the root of the tree is 18","text_count":176,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run binTree.go\nThe value of the root of the tree is 18\n0 3 4 5 7 8 9 10 11 14 16 17 18 19\n-10 -2 0 3 4 5 7 8 9 10 11 14 16 17 18 19\nThe value of the root of the tree is 18"}]}]},{"block_type":"element","block":"k6pz2i51","search_text":"Advantages of binary trees","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Advantages of binary trees"}]},{"block_type":"element","block":"k6pz2i52","search_text":"You cannot beat a tree when you need to represent hierarchical data. For that reason, trees are extensively used when the compiler of a programming language parses a computer program.","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You cannot beat a tree when you need to represent hierarchical data. For that reason, trees are extensively used when the compiler of a programming language parses a computer program."}]},{"block_type":"element","block":"k6pz2i53","search_text":"Additionally, trees are ordered by design, which means that you do not have to make any special effort to order them; putting an element into its correct place keeps them ordered. However, deleting an element from a tree is not always trivial because of the way that trees are constructed.","text_count":289,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, trees are"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"ordered"}]},{"block_type":"text","content":"by design, which means that you do not have to make any special effort to order them; putting an element into its correct place keeps them ordered. However, deleting an element from a tree is not always trivial because of the way that trees are constructed."}]},{"block_type":"element","block":"k6pz2i54","search_text":"If a binary tree is balanced, its search, insert, and delete operations take about log(n) steps, where n is the total number of elements that the tree holds. Additionally, the height of a balanced binary tree is approximately log2(n) , which means that a balanced tree with 10,000 elements has a height of about 14, and that is remarkably small. Similarly, the height of a balanced tree with 100,000 elements will be about 17, and the height of a balanced tree with 1,000,000 elements will be about 20. In other words, putting a significantly large number of elements into a balanced binary tree does not change the speed of the tree in an extreme way. Stated differently, you can reach any node of a tree with 1,000,000 nodes in less than 20 steps!","text_count":749,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If a binary tree is balanced, its search, insert, and delete operations take about"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"log(n)"}]},{"block_type":"text","content":"steps, where"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"is the total number of elements that the tree holds. Additionally, the height of a balanced binary tree is approximately"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"log2(n)"}]},{"block_type":"text","content":", which means that a balanced tree with 10,000 elements has a height of about 14, and that is remarkably small. Similarly, the height of a balanced tree with 100,000 elements will be about 17, and the height of a balanced tree with 1,000,000 elements will be about 20. In other words, putting a significantly large number of elements into a balanced binary tree does not change the speed of the tree in an extreme way. Stated differently, you can reach any node of a tree with 1,000,000 nodes in less than 20 steps!"}]},{"block_type":"element","block":"k6pz2i55","search_text":"A major disadvantage of binary trees is that the shape of the tree depends on the order in which its elements were inserted. If the keys of a tree are long and complex, then inserting or searching for an element might be slow due to the large number of comparisons required. Last, if a tree is not balanced, then the performance of the tree is unpredictable.","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A major disadvantage of binary trees is that the shape of the tree depends on the order in which its elements were inserted. If the keys of a tree are long and complex, then inserting or searching for an element might be slow due to the large number of comparisons required. Last, if a tree is not balanced, then the performance of the tree is unpredictable."}]},{"block_type":"element","block":"k6pz2i56","search_text":"Tip Although you can create a linked list or an array faster than a binary tree, the flexibility that a binary tree offers in search operations might worth the extra overhead and maintenance. When searching for an element on a binary tree, you check whether the value of the element that you are looking for is bigger or smaller than the value of the current node and use that decision to choose which part of the tree you will go down next,. Doing this saves you a lot of time. ","text_count":479,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you can create a linked list or an array faster than a binary tree, the flexibility that a binary tree offers in search operations might worth the extra overhead and maintenance. When searching for an element on a binary tree, you check whether the value of the element that you are looking for is bigger or smaller than the value of the current node and use that decision to choose which part of the tree you will go down next,. Doing this saves you a lot of time."}]}]},{"block_type":"element","block":"k6pz2i57","search_text":"Hash tables in Go","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Hash tables in Go"}]},{"block_type":"element","block":"k6pz2i58","search_text":"Strictly speaking, a Hash table is a data structure that stores one or more key and value pairs and uses a hash function to compute an index into an array of buckets or slots from which the correct value can be discovered. Ideally, the hash function should assign each key to a unique bucket, provided that you have the required number of buckets, which is usually the case.","text_count":374,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Hash table"}]},{"block_type":"text","content":"is a data structure that stores one or more key and value pairs and uses a hash function to compute an index into an array of buckets or slots from which the correct value can be discovered. Ideally, the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"hash function"}]},{"block_type":"text","content":"should assign each key to a unique bucket, provided that you have the required number of buckets, which is usually the case."}]},{"block_type":"element","block":"k6pz2i59","search_text":"A good hash function must be able to produce a uniform distribution of the hash values, because it is inefficient to have unused buckets or big differences in the cardinalities of the buckets. Additionally, the hash function should work consistently and output the same hash value for identical keys. Otherwise, it would be impossible to locate the information you want!","text_count":370,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A good hash function must be able to produce a uniform distribution of the hash values, because it is inefficient to have unused buckets or big differences in the cardinalities of the buckets. Additionally, the hash function should work consistently and output the same hash value for identical keys. Otherwise, it would be impossible to locate the information you want!"}]},{"block_type":"element","block":"k6pz2i5a","search_text":"The next figure shows what a hash table with 10 buckets looks like.","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next figure shows what a hash table with 10 buckets looks like."}]},{"block_type":"element","block":"k6pz2i5b","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000002.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i5c","search_text":"A hash table with 10 buckets","text_count":28,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A hash table with 10 buckets"}]},{"block_type":"element","block":"k6pz2i5d","search_text":"Implementing a hash table in Go","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a hash table in Go"}]},{"block_type":"element","block":"k6pz2i5e","search_text":"The Go code of hashTable.go , which will be presented in five parts, will help clarify many things about hash tables.","text_count":117,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":", which will be presented in five parts, will help clarify many things about hash tables."}]},{"block_type":"element","block":"k6pz2i5f","search_text":"The first part of hashTable.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i5g","search_text":"package main import ( \"fmt\" ) const SIZE = 15 type Node struct { Value int Next *Node } ","text_count":88,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nconst SIZE = 15 \n \ntype Node struct { \n    Value int \n    Next  *Node \n}"}]}]},{"block_type":"element","block":"k6pz2i5h","search_text":"In this part, you can see the definition of the node of the hash table, which, as expected, is defined using a Go structure. The SIZE constant variable holds the number of buckets of the hash table.","text_count":198,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you can see the definition of the node of the hash table, which, as expected, is defined using a Go structure. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIZE"}]},{"block_type":"text","content":"constant variable holds the number of buckets of the hash table."}]},{"block_type":"element","block":"k6pz2i5i","search_text":"The second segment from hashTable.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i5j","search_text":"type HashTable struct { Table map[int]*Node Size int } func hashFunction(i, size int) int { return (i % size) } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type HashTable struct { \n    Table map[int]*Node \n    Size  int \n} \n \nfunc hashFunction(i, size int) int { \n    return (i % size) \n}"}]}]},{"block_type":"element","block":"k6pz2i5k","search_text":"In this code segment, you can see the implementation of the hash function used in this particular hash. The hashFunction() uses the modulo operator . The main reason for choosing the modulo operator is because this particular hash table has to cope with integer values. If you were dealing with strings or floating-point numbers, then you should have used a different logic in your hash function.","text_count":396,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, you can see the implementation of the hash function used in this particular hash. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashFunction()"}]},{"block_type":"text","content":"uses the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"modulo operator"}]},{"block_type":"text","content":". The main reason for choosing the modulo operator is because this particular hash table has to cope with integer values. If you were dealing with strings or floating-point numbers, then you should have used a different logic in your hash function."}]},{"block_type":"element","block":"k6pz2i5l","search_text":"The actual hash is stored in a HashTable structure that has two fields. The second field is the size of the hash table, and the first field is a map that associates an integer with a linked list ( *Node ). As a result, this hash table will have as many linked lists as the number of its buckets. This also means that the nodes of each bucket of the hash table will be stored in linked lists. You will learn more about linked lists in a little while.","text_count":449,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The actual hash is stored in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"HashTable"}]},{"block_type":"text","content":"structure that has two fields. The second field is the size of the hash table, and the first field is a map that associates an integer with a linked list ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*Node"}]},{"block_type":"text","content":"). As a result, this hash table will have as many linked lists as the number of its buckets. This also means that the nodes of each bucket of the hash table will be stored in linked lists. You will learn more about linked lists in a little while."}]},{"block_type":"element","block":"k6pz2i5m","search_text":"The third code portion of hashTable.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i5n","search_text":"func insert(hash *HashTable, value int) int { index := hashFunction(value, hash.Size) element := Node{Value: value, Next: hash.Table[index]} hash.Table[index] = &element return index } ","text_count":185,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func insert(hash *HashTable, value int) int { \n    index := hashFunction(value, hash.Size) \n    element := Node{Value: value, Next: hash.Table[index]} \n    hash.Table[index] = &amp;element \n    return index \n}"}]}]},{"block_type":"element","block":"k6pz2i5o","search_text":"The insert() function is called for inserting elements into the hash table. Note that the current implementation of the insert() function does not check for duplicate values.","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"insert()"}]},{"block_type":"text","content":"function is called for inserting elements into the hash table. Note that the current implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"insert()"}]},{"block_type":"text","content":"function does not check for duplicate values."}]},{"block_type":"element","block":"k6pz2i5p","search_text":"The fourth part of hashTable.go comes next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"comes next:"}]},{"block_type":"element","block":"k6pz2i5q","search_text":"func traverse(hash *HashTable) { for k := range hash.Table { if hash.Table[k] != nil { t := hash.Table[k] for t != nil { fmt.Printf(\"%d -> \", t.Value) t = t.Next } fmt.Println() } } } ","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(hash *HashTable) { \n    for k := range hash.Table { \n        if hash.Table[k] != nil { \n            t := hash.Table[k] \n            for t != nil { \n                fmt.Printf(\"%d -&gt; \", t.Value) \n                t = t.Next \n            } \n            fmt.Println() \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i5r","search_text":"The traverse() function is used for printing all of the values in the hash table. The function visits each one of the linked lists of the hash table and prints the stored values, linked list by linked list.","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function is used for printing all of the values in the hash table. The function visits each one of the linked lists of the hash table and prints the stored values, linked list by linked list."}]},{"block_type":"element","block":"k6pz2i5s","search_text":"The last code portion of hashTable.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i5t","search_text":"func main() { table := make(map[int]*Node, SIZE) hash := &HashTable{Table: table, Size: SIZE} fmt.Println(\"Number of spaces:\", hash.Size) for i := 0; i < 120; i++ { insert(hash, i) } traverse(hash) }","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    table := make(map[int]*Node, SIZE) \n    hash := &amp;HashTable{Table: table, Size: SIZE} \n    fmt.Println(\"Number of spaces:\", hash.Size) \n    for i := 0; i &lt; 120; i++ { \n        insert(hash, i) \n    } \n    traverse(hash) \n}"}]}]},{"block_type":"element","block":"k6pz2i5u","search_text":"In this part of the code, you create a new hash table named hash using the table variable, which is a map that holds the buckets of the hash table. As you already know, the slots of a hash table are implemented using linked lists. The main reason for using a map to hold the linked lists of a hash table instead of a slice or an array is that the keys of a slice or an array can only be positive integers, while the keys of a map can be almost anything you need.","text_count":462,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the code, you create a new hash table named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hash"}]},{"block_type":"text","content":"using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"table"}]},{"block_type":"text","content":"variable, which is a map that holds the buckets of the hash table. As you already know, the slots of a hash table are implemented using linked lists. The main reason for using a map to hold the linked lists of a hash table instead of a slice or an array is that the keys of a slice or an array can only be positive integers, while the keys of a map can be almost anything you need."}]},{"block_type":"element","block":"k6pz2i5v","search_text":"Executing hashTable.go will produce the following output:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2i5w","search_text":"$ go run hashTable.go Number of spaces: 15 108 -> 93 -> 78 -> 63 -> 48 -> 33 -> 18 -> 3 -> 109 -> 94 -> 79 -> 64 -> 49 -> 34 -> 19 -> 4 -> 117 -> 102 -> 87 -> 72 -> 57 -> 42 -> 27 -> 12 -> 119 -> 104 -> 89 -> 74 -> 59 -> 44 -> 29 -> 14 -> 111 -> 96 -> 81 -> 66 -> 51 -> 36 -> 21 -> 6 -> 112 -> 97 -> 82 -> 67 -> 52 -> 37 -> 22 -> 7 -> 116 -> 101 -> 86 -> 71 -> 56 -> 41 -> 26 -> 11 -> 114 -> 99 -> 84 -> 69 -> 54 -> 39 -> 24 -> 9 -> 118 -> 103 -> 88 -> 73 -> 58 -> 43 -> 28 -> 13 -> 105 -> 90 -> 75 -> 60 -> 45 -> 30 -> 15 -> 0 -> 106 -> 91 -> 76 -> 61 -> 46 -> 31 -> 16 -> 1 -> 107 -> 92 -> 77 -> 62 -> 47 -> 32 -> 17 -> 2 -> 110 -> 95 -> 80 -> 65 -> 50 -> 35 -> 20 -> 5 -> 113 -> 98 -> 83 -> 68 -> 53 -> 38 -> 23 -> 8 -> 115 -> 100 -> 85 -> 70 -> 55 -> 40 -> 25 -> 10 -> ","text_count":773,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run hashTable.go\nNumber of spaces: 15\n108 -&gt; 93 -&gt; 78 -&gt; 63 -&gt; 48 -&gt; 33 -&gt; 18 -&gt; 3 -&gt;\n109 -&gt; 94 -&gt; 79 -&gt; 64 -&gt; 49 -&gt; 34 -&gt; 19 -&gt; 4 -&gt;\n117 -&gt; 102 -&gt; 87 -&gt; 72 -&gt; 57 -&gt; 42 -&gt; 27 -&gt; 12 -&gt;\n119 -&gt; 104 -&gt; 89 -&gt; 74 -&gt; 59 -&gt; 44 -&gt; 29 -&gt; 14 -&gt;\n111 -&gt; 96 -&gt; 81 -&gt; 66 -&gt; 51 -&gt; 36 -&gt; 21 -&gt; 6 -&gt;\n112 -&gt; 97 -&gt; 82 -&gt; 67 -&gt; 52 -&gt; 37 -&gt; 22 -&gt; 7 -&gt;\n116 -&gt; 101 -&gt; 86 -&gt; 71 -&gt; 56 -&gt; 41 -&gt; 26 -&gt; 11 -&gt;\n114 -&gt; 99 -&gt; 84 -&gt; 69 -&gt; 54 -&gt; 39 -&gt; 24 -&gt; 9 -&gt;\n118 -&gt; 103 -&gt; 88 -&gt; 73 -&gt; 58 -&gt; 43 -&gt; 28 -&gt; 13 -&gt;\n105 -&gt; 90 -&gt; 75 -&gt; 60 -&gt; 45 -&gt; 30 -&gt; 15 -&gt; 0 -&gt;\n106 -&gt; 91 -&gt; 76 -&gt; 61 -&gt; 46 -&gt; 31 -&gt; 16 -&gt; 1 -&gt;\n107 -&gt; 92 -&gt; 77 -&gt; 62 -&gt; 47 -&gt; 32 -&gt; 17 -&gt; 2 -&gt;\n110 -&gt; 95 -&gt; 80 -&gt; 65 -&gt; 50 -&gt; 35 -&gt; 20 -&gt; 5 -&gt;\n113 -&gt; 98 -&gt; 83 -&gt; 68 -&gt; 53 -&gt; 38 -&gt; 23 -&gt; 8 -&gt;\n115 -&gt; 100 -&gt; 85 -&gt; 70 -&gt; 55 -&gt; 40 -&gt; 25 -&gt; 10 -&gt;"}]}]},{"block_type":"element","block":"k6pz2i5x","search_text":"This particular hash table is perfectly balanced because it has to deal with continuous numbers that are placed in a slot according to the results of the modulo operator . Real-world problems might not generate such convenient results!","text_count":235,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This particular hash table is perfectly balanced because it has to deal with continuous numbers that are placed in a slot according to the results of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"modulo operator"}]},{"block_type":"text","content":". Real-world problems might not generate such convenient results!"}]},{"block_type":"element","block":"k6pz2i5y","search_text":"Tip The remainder of a Euclidean division between two natural numbers a and b can be calculated according to the a = bq + r formula, where q is the quotient and r is the remainder. The values allowed for the remainder can be between 0 and b-1 , which are the possible results of the modulo operator. ","text_count":300,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remainder of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Euclidean division"}]},{"block_type":"text","content":"between two natural numbers"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"can be calculated according to the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"a = bq + r"}]},{"block_type":"text","content":"formula, where"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"q"}]},{"block_type":"text","content":"is the quotient and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"is the remainder. The values allowed for the remainder can be between"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"b-1"}]},{"block_type":"text","content":", which are the possible results of the modulo operator."}]}]},{"block_type":"element","block":"k6pz2i5z","search_text":"Note that if you execute hashTable.go several times, you will most likely get an output where the lines are in a different order, because the way that Go outputs the key and value pairs of a map is totally random!","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that if you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTable.go"}]},{"block_type":"text","content":"several times, you will most likely get an output where the lines are in a different order, because the way that Go outputs the key and value pairs of a map is totally random!"}]},{"block_type":"element","block":"k6pz2i60","search_text":"Implementing the lookup functionality","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing the lookup functionality"}]},{"block_type":"element","block":"k6pz2i61","search_text":"In this section, you will see an implementation of the lookup() function that allows you to determine whether a given element is already in the hash table or not. The code of the lookup() function is based on that of the traverse() function, as follows:","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see an implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookup()"}]},{"block_type":"text","content":"function that allows you to determine whether a given element is already in the hash table or not. The code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookup()"}]},{"block_type":"text","content":"function is based on that of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function, as follows:"}]},{"block_type":"element","block":"k6pz2i62","search_text":"func lookup(hash *HashTable, value int) bool { index := hashFunction(value, hash.Size) if hash.Table[index] != nil { t := hash.Table[index] for t != nil { if t.Value == value { return true } t = t.Next } } return false } ","text_count":221,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func lookup(hash *HashTable, value int) bool { \n    index := hashFunction(value, hash.Size) \n    if hash.Table[index] != nil { \n        t := hash.Table[index] \n        for t != nil { \n            if t.Value == value { \n                return true \n            } \n            t = t.Next \n        } \n    } \n    return false \n}"}]}]},{"block_type":"element","block":"k6pz2i63","search_text":"You can find the preceding code in the hashTableLookup.go source file. Executing hashTableLookup.go will create the following output:","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the preceding code in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTableLookup.go"}]},{"block_type":"text","content":"source file. Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTableLookup.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2i64","search_text":"$ go run hashTableLookup.go 120 is not in the hash table! 121 is not in the hash table! 122 is not in the hash table! 123 is not in the hash table! 124 is not in the hash table! ","text_count":178,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run hashTableLookup.go\n120 is not in the hash table!\n121 is not in the hash table!\n122 is not in the hash table!\n123 is not in the hash table!\n124 is not in the hash table!"}]}]},{"block_type":"element","block":"k6pz2i65","search_text":"The preceding output means that the lookup() function does its job pretty well!","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output means that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookup()"}]},{"block_type":"text","content":"function does its job pretty well!"}]},{"block_type":"element","block":"k6pz2i66","search_text":"Advantages of hash tables","text_count":25,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Advantages of hash tables"}]},{"block_type":"element","block":"k6pz2i67","search_text":"If you think that hash tables are not that useful, handy, or smart, consider the following: When a hash table has n keys and k buckets, the search speed for the n keys goes from O(n) for a linear search down to O(n/k) ! Although the improvement might look small, you must realize that for a hash array with only 20 slots, the search time will be reduced by 20 times! This makes hash tables perfect for applications such as dictionaries or any other analogous application where you have to search large amounts of data.","text_count":518,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you think that hash tables are not that useful, handy, or smart, consider the following: When a hash table has"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"keys and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"buckets, the search speed for the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"keys goes from"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n)"}]},{"block_type":"text","content":"for a linear search down to"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"O(n/k)"}]},{"block_type":"text","content":"! Although the improvement might look small, you must realize that for a hash array with only 20 slots, the search time will be reduced by 20 times! This makes hash tables perfect for applications such as dictionaries or any other analogous application where you have to search large amounts of data."}]},{"block_type":"element","block":"k6pz2i68","search_text":"Linked lists in Go","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Linked lists in Go"}]},{"block_type":"element","block":"k6pz2i69","search_text":"A Linked list is a data structure with a finite set of elements where each element uses at least two memory locations, one for storing the actual data and the other for storing a pointer that links the current element to the next one, thus creating a sequence of elements that construct the linked list.","text_count":303,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Linked list"}]},{"block_type":"text","content":"is a data structure with a finite set of elements where each element uses at least two memory locations, one for storing the actual data and the other for storing a pointer that links the current element to the next one, thus creating a sequence of elements that construct the linked list."}]},{"block_type":"element","block":"k6pz2i6a","search_text":"The first element of a linked list is called the head whereas the last element of a linked list is often called the tail . The first thing that you should do when defining a linked list is to keep the head of the list in a separate variable because the head is the only thing that you have to access the entire linked list. Note that if you lose the pointer to that first node of a single linked list, there is no way to find it again.","text_count":435,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first element of a linked list is called the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"head"}]},{"block_type":"text","content":"whereas the last element of a linked list is often called the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"tail"}]},{"block_type":"text","content":". The first thing that you should do when defining a linked list is to keep the head of the list in a separate variable because the head is the only thing that you have to access the entire linked list. Note that if you lose the pointer to that first node of a single linked list, there is no way to find it again."}]},{"block_type":"element","block":"k6pz2i6b","search_text":"The following figure shows a linked list with five nodes:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following figure shows a linked list with five nodes:"}]},{"block_type":"element","block":"k6pz2i6c","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000024.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i6d","search_text":"A linked list with five nodes","text_count":29,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A linked list with five nodes"}]},{"block_type":"element","block":"k6pz2i6e","search_text":"The next figure shows you how to remove an existing node from a linked list in order to understand better the steps that are involved in the process. The main thing that you will need to do is to arrange the pointer to the left node of the node that you are removing in order to point to the right node of the node that is being removed.","text_count":337,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next figure shows you how to remove an existing node from a linked list in order to understand better the steps that are involved in the process. The main thing that you will need to do is to arrange the pointer to the left node of the node that you are removing in order to point to the right node of the node that is being removed."}]},{"block_type":"element","block":"k6pz2i6f","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000021.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i6g","search_text":"Removing a node from a linked list","text_count":34,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Removing a node from a linked list"}]},{"block_type":"element","block":"k6pz2i6h","search_text":"The linked list implementation that follows is relatively simple and will not include the delete node functionality, which is left as an exercise for the reader to tackle.","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The linked list implementation that follows is relatively simple and will not include the delete node functionality, which is left as an exercise for the reader to tackle."}]},{"block_type":"element","block":"k6pz2i6i","search_text":"Implementing a linked list in Go","text_count":32,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a linked list in Go"}]},{"block_type":"element","block":"k6pz2i6j","search_text":"The Go source file for the implementation of the linked list is called linkedList.go , and it will be presented in five parts.","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go source file for the implementation of the linked list is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":", and it will be presented in five parts."}]},{"block_type":"element","block":"k6pz2i6k","search_text":"The first code segment of linkedList.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i6l","search_text":"package main import ( \"fmt\" ) type Node struct { Value int Next *Node } var root = new(Node) ","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype Node struct { \n    Value int \n    Next  *Node \n} \n \nvar root = new(Node)"}]}]},{"block_type":"element","block":"k6pz2i6m","search_text":"In this part of the program, you define the Node structure type that will be used for the nodes of the linked list as well as the root global variable that holds the first element of the linked list, which will be accessible from everywhere in the code.","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, you define the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Node"}]},{"block_type":"text","content":"structure type that will be used for the nodes of the linked list as well as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"root"}]},{"block_type":"text","content":"global variable that holds the first element of the linked list, which will be accessible from everywhere in the code."}]},{"block_type":"element","block":"k6pz2i6n","search_text":"The second part of linkedList.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i6o","search_text":"func addNode(t *Node, v int) int { if root == nil { t = &Node{v, nil} root = t return 0 } if v == t.Value { fmt.Println(\"Node already exists:\", v) return -1 } if t.Next == nil { t.Next = &Node{v, nil} return -2 } return addNode(t.Next, v) } ","text_count":241,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func addNode(t *Node, v int) int { \n   if root == nil { \n         t = &amp;Node{v, nil} \n         root = t \n         return 0 \n   } \n \n   if v == t.Value { \n         fmt.Println(\"Node already exists:\", v) \n         return -1 \n   } \n \n   if t.Next == nil { \n         t.Next = &amp;Node{v, nil} \n         return -2 \n   } \n \n   return addNode(t.Next, v) \n}"}]}]},{"block_type":"element","block":"k6pz2i6p","search_text":"Due to the way linked lists work, they do not normally contain duplicate entries. Furthermore, new nodes are usually added at the end of a linked list when the linked list is not sorted.","text_count":186,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Due to the way linked lists work, they do not normally contain duplicate entries. Furthermore, new nodes are usually added at the end of a linked list when the linked list is not sorted."}]},{"block_type":"element","block":"k6pz2i6q","search_text":"Thus, the addNode() function is used for adding new nodes to the linked list. There are three distinct cases in the implementation that are examined using if statements. In the first case, you test whether you are dealing with an empty linked list or not. In the second case, you check whether the value that you want to add is already in the list. In the third case, you check whether you have reached the end of the linked list. In this case, you add a new node at the end of the list with the desired value using t.Next = &Node{v, nil} . If none of these conditions is true, you repeat the same process with the addNode() function for the next node of the linked list using return addNode(t.Next, v) .","text_count":704,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"addNode()"}]},{"block_type":"text","content":"function is used for adding new nodes to the linked list. There are three distinct cases in the implementation that are examined using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statements. In the first case, you test whether you are dealing with an empty linked list or not. In the second case, you check whether the value that you want to add is already in the list. In the third case, you check whether you have reached the end of the linked list. In this case, you add a new node at the end of the list with the desired value using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t.Next = &amp;Node{v, nil}"}]},{"block_type":"text","content":". If none of these conditions is true, you repeat the same process with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"addNode()"}]},{"block_type":"text","content":"function for the next node of the linked list using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return addNode(t.Next, v)"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i6r","search_text":"The third code segment of the linkedList.go program contains the implementation of the traverse() function:","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"program contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i6s","search_text":"func traverse(t *Node) { if t == nil { fmt.Println(\"-> Empty list!\") return } for t != nil { fmt.Printf(\"%d -> \", t.Value) t = t.Next } fmt.Println() } ","text_count":152,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(t *Node) { \n    if t == nil { \n        fmt.Println(\"-&gt; Empty list!\") \n        return \n    }  \n \n    for t != nil { \n        fmt.Printf(\"%d -&gt; \", t.Value) \n        t = t.Next \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2i6t","search_text":"The fourth part of linkedList.go is as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i6u","search_text":"func lookupNode(t *Node, v int) bool { if root == nil { t = &Node{v, nil} root = t return false } if v == t.Value { return true } if t.Next == nil { return false } return lookupNode(t.Next, v) } func size(t *Node) int { if t == nil { fmt.Println(\"-> Empty list!\") return 0 } i := 0 for t != nil { i++ t = t.Next } return i } ","text_count":325,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func lookupNode(t *Node, v int) bool { \n    if root == nil { \n        t = &amp;Node{v, nil} \n        root = t \n        return false \n    } \n \n    if v == t.Value { \n        return true \n    } \n \n    if t.Next == nil { \n        return false \n    } \n \n    return lookupNode(t.Next, v) \n} \n \nfunc size(t *Node) int { \n    if t == nil { \n        fmt.Println(\"-&gt; Empty list!\") \n        return 0 \n    } \n \n    i := 0 \n    for t != nil { \n        i++ \n        t = t.Next \n    } \n    return i \n}"}]}]},{"block_type":"element","block":"k6pz2i6v","search_text":"In this part, you see the implementation of two very handy functions: lookupNode() and size() . The former checks whether a given element exists in the linked list, while the latter returns the size of the linked list, which is the number of nodes in the linked list.","text_count":267,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see the implementation of two very handy functions:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookupNode()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size()"}]},{"block_type":"text","content":". The former checks whether a given element exists in the linked list, while the latter returns the size of the linked list, which is the number of nodes in the linked list."}]},{"block_type":"element","block":"k6pz2i6w","search_text":"The logic behind the implementation of the lookupNode() function is easy to understand: You start accessing all of the elements of the single linked list in order to search for the value you crave. If you reach the tail of the linked list without having found the desired value, then you know that the linked list does not contain that value.","text_count":342,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The logic behind the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookupNode()"}]},{"block_type":"text","content":"function is easy to understand: You start accessing all of the elements of the single linked list in order to search for the value you crave. If you reach the tail of the linked list without having found the desired value, then you know that the linked list does not contain that value."}]},{"block_type":"element","block":"k6pz2i6x","search_text":"The last part of linkedList.go contains the implementation of the main() function:","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i6y","search_text":"func main() { fmt.Println(root) root = nil traverse(root) addNode(root, 1) addNode(root, -1) traverse(root) addNode(root, 10) addNode(root, 5) addNode(root, 45) addNode(root, 5) addNode(root, 5) traverse(root) addNode(root, 100) traverse(root) if lookupNode(root, 100) { fmt.Println(\"Node exists!\") } else { fmt.Println(\"Node does not exist!\") } if lookupNode(root, -100) { fmt.Println(\"Node exists!\") } else { fmt.Println(\"Node does not exist!\") } } ","text_count":451,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fmt.Println(root) \n    root = nil \n    traverse(root) \n    addNode(root, 1) \n    addNode(root, -1) \n    traverse(root) \n    addNode(root, 10) \n    addNode(root, 5) \n    addNode(root, 45) \n    addNode(root, 5) \n    addNode(root, 5) \n    traverse(root) \n    addNode(root, 100) \n    traverse(root) \n \n    if lookupNode(root, 100) { \n        fmt.Println(\"Node exists!\") \n    } else { \n        fmt.Println(\"Node does not exist!\") \n    } \n \n    if lookupNode(root, -100) { \n        fmt.Println(\"Node exists!\") \n    } else { \n        fmt.Println(\"Node does not exist!\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2i6z","search_text":"Executing linkedList.go will generate the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2i70","search_text":"$ go run linkedList.go &{0 <nil>} -> Empty list! 1 -> -1 -> Node already exists: 5 Node already exists: 5 1 -> -1 -> 10 -> 5 -> 45 -> 1 -> -1 -> 10 -> 5 -> 45 -> 100 -> Node exists! Node does not exist! ","text_count":203,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run linkedList.go\n&amp;{0 &lt;nil&gt;}\n-&gt; Empty list!\n1 -&gt; -1 -&gt;\nNode already exists: 5\nNode already exists: 5\n1 -&gt; -1 -&gt; 10 -&gt; 5 -&gt; 45 -&gt;\n1 -&gt; -1 -&gt; 10 -&gt; 5 -&gt; 45 -&gt; 100 -&gt;\nNode exists!\nNode does not exist!"}]}]},{"block_type":"element","block":"k6pz2i71","search_text":"Advantages of linked lists","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Advantages of linked lists"}]},{"block_type":"element","block":"k6pz2i72","search_text":"The greatest advantages of linked lists are that they are easy to understand and implement, and they are generic enough so that they can be used in many different situations. This means that they can be used to model many different kinds of data. Additionally, linked lists are really fast at sequential searching when used with pointers.","text_count":338,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The greatest advantages of linked lists are that they are easy to understand and implement, and they are generic enough so that they can be used in many different situations. This means that they can be used to model many different kinds of data. Additionally, linked lists are really fast at sequential searching when used with pointers."}]},{"block_type":"element","block":"k6pz2i73","search_text":"Linked lists cannot only help you sort your data, but they can also assist you in keeping your data sorted even after inserting or deleting elements. Deleting a node from a sorted linked list is the same as in an unsorted linked list; however, inserting a new node into a sorted linked list is different because the new node has to go to the right place in order to keep the list sorted. In practice, this means that if you have lots of data and you know that you will need to delete data all the time, using a linked list is a better choice than using a hash table or a binary tree.","text_count":583,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Linked lists cannot only help you sort your data, but they can also assist you in keeping your data sorted even after inserting or deleting elements. Deleting a node from a sorted linked list is the same as in an unsorted linked list; however, inserting a new node into a sorted linked list is different because the new node has to go to the right place in order to keep the list sorted. In practice, this means that if you have lots of data and you know that you will need to delete data all the time, using a linked list is a better choice than using a hash table or a binary tree."}]},{"block_type":"element","block":"k6pz2i74","search_text":"Last, sorted linked lists allow you to use various optimization techniques when searching or inserting a node. The most common technique is keeping a pointer at the center node of the sorted linked list and starting your lookups from there. This simple optimization can reduce the time of the lookup operation in half!","text_count":318,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last,"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"sorted linked lists"}]},{"block_type":"text","content":"allow you to use various optimization techniques when searching or inserting a node. The most common technique is keeping a pointer at the center node of the sorted linked list and starting your lookups from there. This simple optimization can reduce the time of the lookup operation in half!"}]},{"block_type":"element","block":"k6pz2i75","search_text":"Doubly linked lists in Go","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Doubly linked lists in Go"}]},{"block_type":"element","block":"k6pz2i76","search_text":"A doubly linked list is one where each node keeps a pointer to the previous element on the list as well as the next element.","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"doubly linked list"}]},{"block_type":"text","content":"is one where each node keeps a pointer to the previous element on the list as well as the next element."}]},{"block_type":"element","block":"k6pz2i77","search_text":"The following figure shows what a doubly linked list looks like:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following figure shows what a doubly linked list looks like:"}]},{"block_type":"element","block":"k6pz2i78","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000019.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i79","search_text":"A doubly linked list","text_count":20,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A doubly linked list"}]},{"block_type":"element","block":"k6pz2i7a","search_text":"Thus, on a doubly linked list, the next link of the first node points to the second node, while its previous link points to nil (also called as NULL ). Analogously, the next link of the last node points to nil , while its previous link points to the next-to-last node of the doubly linked list.","text_count":294,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, on a doubly linked list, the next link of the first node points to the second node, while its previous link points to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"(also called as&nbsp;"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"NULL"}]},{"block_type":"text","content":"). Analogously, the next link of the last node points to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", while its previous link points to the next-to-last node of the doubly linked list."}]},{"block_type":"element","block":"k6pz2i7b","search_text":"The last figure of this chapter illustrates the addition of a node in a doubly linked list. As you can imagine, the main task that needs to be accomplished is dealing with the pointers of three nodes: the new node, the node that will be on the left of the new node, and the node that will be on the right of the new node.","text_count":321,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last figure of this chapter illustrates the addition of a node in a doubly linked list. As you can imagine, the main task that needs to be accomplished is dealing with the pointers of three nodes: the new node, the node that will be on the left of the new node, and the node that will be on the right of the new node."}]},{"block_type":"element","block":"k6pz2i7c","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000016.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2i7d","search_text":"Inserting a new node in the middle of a doubly linked list","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Inserting a new node in the middle of a doubly linked list"}]},{"block_type":"element","block":"k6pz2i7e","search_text":"Thus in reality, the main difference between a single linked list and a doubly linked list is that the latter requires more housekeeping. This is the price that you will have to pay for being able to access your doubly linked list both ways.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus in reality, the main difference between a single linked list and a doubly linked list is that the latter requires more housekeeping. This is the price that you will have to pay for being able to access your doubly linked list both ways."}]},{"block_type":"element","block":"k6pz2i7f","search_text":"Implementing a doubly linked list in Go","text_count":39,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a doubly linked list in Go"}]},{"block_type":"element","block":"k6pz2i7g","search_text":"The name of the program with the Go implementation of a doubly linked list is doublyLList.go , and will be offered to you in five parts. The general idea behind a doubly linked list is that same as in a single linked list, but you just have to do more housekeeping due to the presence of two pointers in each node of the list.","text_count":326,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program with the Go implementation of a doubly linked list is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":", and will be offered to you in five parts. The general idea behind a doubly linked list is that same as in a single linked list, but you just have to do more housekeeping due to the presence of two pointers in each node of the list."}]},{"block_type":"element","block":"k6pz2i7h","search_text":"The first part of doublyLList.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i7i","search_text":"package main import ( \"fmt\" ) type Node struct { Value int Previous *Node Next *Node } ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype Node struct { \n    Value    int \n    Previous *Node \n    Next     *Node \n}"}]}]},{"block_type":"element","block":"k6pz2i7j","search_text":"In this part, you can see the definition of the node of the doubly linked list using a Go structure. However, this time, the struct has two pointer fields for apparent reasons.","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you can see the definition of the node of the doubly linked list using a Go structure. However, this time, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"has two pointer fields for apparent reasons."}]},{"block_type":"element","block":"k6pz2i7k","search_text":"The second code portion of doublyLList.go contains the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i7l","search_text":"func addNode(t *Node, v int) int { if root == nil { t = &Node{v, nil, nil} root = t return 0 } if v == t.Value { fmt.Println(\"Node already exists:\", v) return -1 } if t.Next == nil { temp := t t.Next = &Node{v, temp, nil} return -2 } return addNode(t.Next, v) } ","text_count":262,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func addNode(t *Node, v int) int { \n    if root == nil { \n        t = &amp;Node{v, nil, nil} \n        root = t \n        return 0 \n    } \n \n    if v == t.Value { \n        fmt.Println(\"Node already exists:\", v) \n        return -1 \n    } \n \n    if t.Next == nil { \n        temp := t \n        t.Next = &amp;Node{v, temp, nil} \n        return -2 \n    } \n \n    return addNode(t.Next, v) \n}"}]}]},{"block_type":"element","block":"k6pz2i7m","search_text":"As happened in the case of the single linked list, each new node is placed at the end of the current doubly linked list. However, this is not mandatory as you can decide that you want to have a sorted doubly linked list.","text_count":220,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As happened in the case of the single linked list, each new node is placed at the end of the current doubly linked list. However, this is not mandatory as you can decide that you want to have a sorted doubly linked list."}]},{"block_type":"element","block":"k6pz2i7n","search_text":"The third part of doublyLList.go is as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i7o","search_text":"func traverse(t *Node) { if t == nil { fmt.Println(\"-> Empty list!\") return } for t != nil { fmt.Printf(\"%d -> \", t.Value) t = t.Next } fmt.Println() } func reverse(t *Node) { if t == nil { fmt.Println(\"-> Empty list!\") return } temp := t for t != nil { temp = t t = t.Next } for temp.Previous != nil { fmt.Printf(\"%d -> \", temp.Value) temp = temp.Previous } fmt.Printf(\"%d -> \", temp.Value) fmt.Println() } ","text_count":408,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(t *Node) { \n    if t == nil { \n        fmt.Println(\"-&gt; Empty list!\") \n        return \n    } \n \n    for t != nil { \n        fmt.Printf(\"%d -&gt; \", t.Value) \n        t = t.Next \n    } \n    fmt.Println() \n} \n \nfunc reverse(t *Node) { \n    if t == nil { \n        fmt.Println(\"-&gt; Empty list!\") \n        return \n    } \n \n    temp := t \n    for t != nil { \n        temp = t \n        t = t.Next \n    } \n \n    for temp.Previous != nil { \n        fmt.Printf(\"%d -&gt; \", temp.Value) \n        temp = temp.Previous \n         \n\n} \n   fmt.Printf(\"%d -&gt; \", temp.Value) \n   fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2i7p","search_text":"Here you see the Go code for the traverse() and reverse() functions. The implementation of the traverse() function is the same as in the linkedList.go program. However, the logic behind the reverse() function is very interesting, as we do not keep a pointer to the tail of the doubly linked list, we need to go to the end of the doubly linked list before being able to access its nodes in reverse order.","text_count":403,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see the Go code for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reverse()"}]},{"block_type":"text","content":"functions. The implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function is the same as in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"program. However, the logic behind the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reverse()"}]},{"block_type":"text","content":"function is very interesting, as we do not keep a pointer to the tail of the doubly linked list, we need to go to the end of the doubly linked list before being able to access its nodes in reverse order."}]},{"block_type":"element","block":"k6pz2i7q","search_text":"The fourth part of doublyLList.go contains the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i7r","search_text":"func size(t *Node) int { if t == nil { fmt.Println(\"-> Empty list!\") return 0 } n := 0 for t != nil { n++ t = t.Next } return n } func lookupNode(t *Node, v int) bool { if root == nil { return false } if v == t.Value { return true } if t.Next == nil { return false } return lookupNode(t.Next, v) } ","text_count":298,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func size(t *Node) int { \n    if t == nil { \n        fmt.Println(\"-&gt; Empty list!\") \n        return 0 \n    } \n \n    n := 0 \n    for t != nil { \n        n++ \n        t = t.Next \n    } \n    return n \n} \n \nfunc lookupNode(t *Node, v int) bool { \n    if root == nil { \n        return false \n    } \n \n    if v == t.Value { \n        return true \n    } \n \n    if t.Next == nil { \n        return false \n    } \n \n    return lookupNode(t.Next, v) \n}"}]}]},{"block_type":"element","block":"k6pz2i7s","search_text":"The last code segment of doublyLList.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i7t","search_text":"var root = new(Node) func main() { fmt.Println(root) root = nil traverse(root) addNode(root, 1) addNode(root, 1) traverse(root) addNode(root, 10) addNode(root, 5) addNode(root, 0) addNode(root, 0) traverse(root) addNode(root, 100) fmt.Println(\"Size:\", size(root)) traverse(root) reverse(root) } ","text_count":295,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var root = new(Node) \n \nfunc main() { \n    fmt.Println(root) \n    root = nil \n    traverse(root) \n    addNode(root, 1) \n    addNode(root, 1) \n    traverse(root) \n    addNode(root, 10) \n    addNode(root, 5) \n    addNode(root, 0) \n    addNode(root, 0) \n    traverse(root) \n    addNode(root, 100) \n    fmt.Println(\"Size:\", size(root)) \n    traverse(root) \n    reverse(root) \n}"}]}]},{"block_type":"element","block":"k6pz2i7u","search_text":"If you execute doublyLList.go , you will get the following output:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2i7v","search_text":"$ go run doublyLList.go &{0 <nil> <nil>} -> Empty list! Node already exists: 1 1 -> Node already exists: 0 1 -> 10 -> 5 -> 0 -> Size: 5 1 -> 10 -> 5 -> 0 -> 100 -> 100 -> 0 -> 5 -> 10 -> 1 -> ","text_count":192,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run doublyLList.go\n&amp;{0 &lt;nil&gt; &lt;nil&gt;}\n-&gt; Empty list!\nNode already exists: 1\n1 -&gt;\nNode already exists: 0\n1 -&gt; 10 -&gt; 5 -&gt; 0 -&gt;\nSize: 5\n1 -&gt; 10 -&gt; 5 -&gt; 0 -&gt; 100 -&gt;\n100 -&gt; 0 -&gt; 5 -&gt; 10 -&gt; 1 -&gt;"}]}]},{"block_type":"element","block":"k6pz2i7w","search_text":"As you can see, the reverse() function works just fine!","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reverse()"}]},{"block_type":"text","content":"function works just fine!"}]},{"block_type":"element","block":"k6pz2i7x","search_text":"Advantages of doubly linked lists","text_count":33,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Advantages of doubly linked lists"}]},{"block_type":"element","block":"k6pz2i7y","search_text":"Doubly linked lists are more versatile than single linked lists because you can traverse them in any direction you want and also you can insert and delete elements from a doubly linked list more easily. Additionally, even if you lose the pointer to the head of a doubly linked list, you can still find the head node of that list. However, this versatility comes at a price; that is, maintaining two pointers for each node. It is up to the developer to decide whether that extra complexity is justified or not.","text_count":509,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Doubly linked lists are more versatile than single linked lists because you can traverse them in any direction you want and also you can insert and delete elements from a doubly linked list more easily. Additionally, even if you lose the pointer to the head of a doubly linked list, you can still find the head node of that list. However, this versatility comes at a price; that is, maintaining two pointers for each node. It is up to the developer to decide whether that extra complexity is justified or not."}]},{"block_type":"element","block":"k6pz2i7z","search_text":"After all, your music player might be using a doubly linked list to represent your current list of songs and be able to go to the previous song as well as the next one!","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After all, your music player might be using a doubly linked list to represent your current list of songs and be able to go to the previous song as well as the next one!"}]},{"block_type":"element","block":"k6pz2i80","search_text":"Queues in Go","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Queues in Go"}]},{"block_type":"element","block":"k6pz2i81","search_text":"A Queue is a special kind of a linked list where each new element is inserted to the head and removed from the tail of the linked list. We do not need a figure to describe a queue; imagine going to a bank and waiting for the people that came before you to finish their transactions before you can talk to a bank teller. That is a queue!","text_count":336,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Queue"}]},{"block_type":"text","content":"is a special kind of a linked list where each new element is inserted to the head and removed from the tail of the linked list. We do not need a figure to describe a queue; imagine going to a bank and waiting for the people that came before you to finish their transactions before you can talk to a bank teller. That is a queue!"}]},{"block_type":"element","block":"k6pz2i82","search_text":"The main advantage of queues is simplicity! You only need two functions to access a queue, which means that you have to worry about fewer things going wrong and you can implement a queue any way you want so long as you can offer support for those two functions!","text_count":261,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main advantage of queues is simplicity! You only need two functions to access a queue, which means that you have to worry about fewer things going wrong and you can implement a queue any way you want so long as you can offer support for those two functions!"}]},{"block_type":"element","block":"k6pz2i83","search_text":"Implementing a queue in Go","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a queue in Go"}]},{"block_type":"element","block":"k6pz2i84","search_text":"The program that will illustrate the Go implementation of a queue is called queue.go , and it will be presented in five parts. Note that a linked list will be used for the implementation of the queue. The Push() and a Pop() functions are used for adding and removing nodes from the queue, respectively.","text_count":302,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The program that will illustrate the Go implementation of a queue is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":", and it will be presented in five parts. Note that a linked list will be used for the implementation of the queue. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"functions are used for adding and removing nodes from the queue, respectively."}]},{"block_type":"element","block":"k6pz2i85","search_text":"The first part of the code for queue.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the code for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2i86","search_text":"package main import ( \"fmt\" ) type Node struct { Value int Next *Node } var size = 0 var queue = new(Node) ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype Node struct { \n    Value int \n    Next  *Node \n} \n \nvar size = 0 \nvar queue = new(Node)"}]}]},{"block_type":"element","block":"k6pz2i87","search_text":"Having a variable ( size ) for keeping the number of nodes that you have on the queue is handy but not compulsory. However, the implementation presented here supports this functionality because it makes things simpler.","text_count":218,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Having a variable ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size"}]},{"block_type":"text","content":") for keeping the number of nodes that you have on the queue is handy but not compulsory. However, the implementation presented here supports this functionality because it makes things simpler."}]},{"block_type":"element","block":"k6pz2i88","search_text":"The second code portion of queue.go contains the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i89","search_text":"func Push(t *Node, v int) bool { if queue == nil { queue = &Node{v, nil} size++ return true } t = &Node{v, nil} t.Next = queue queue = t size++ return true } ","text_count":158,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Push(t *Node, v int) bool { \n    if queue == nil { \n        queue = &amp;Node{v, nil} \n        size++ \n        return true \n    } \n \n    t = &amp;Node{v, nil} \n    t.Next = queue \n    queue = t \n    size++ \n \n    return true \n}"}]}]},{"block_type":"element","block":"k6pz2i8a","search_text":"This part displays the implementation of the Push() function, which is straightforward. If the queue is empty, then the new node will become the queue. If the queue is not empty, then you create a new node that is placed in front of the current queue. After that, the head of the queue becomes the node that was just created.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part displays the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"function, which is straightforward. If the queue is empty, then the new node will become the queue. If the queue is not empty, then you create a new node that is placed in front of the current queue. After that, the head of the queue becomes the node that was just created."}]},{"block_type":"element","block":"k6pz2i8b","search_text":"The third part of queue.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i8c","search_text":"func Pop(t *Node) (int, bool) { if size == 0 { return 0, false } if size == 1 { queue = nil size-- return t.Value, true } temp := t for (t.Next) != nil { temp = t t = t.Next } v := (temp.Next).Value temp.Next = nil size-- return v, true } ","text_count":239,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Pop(t *Node) (int, bool) { \n    if size == 0 { \n        return 0, false \n    } \n \n    if size == 1 { \n        queue = nil \n        size-- \n        return t.Value, true \n    } \n \n    temp := t \n    for (t.Next) != nil { \n        temp = t \n        t = t.Next \n    } \n \n    v := (temp.Next).Value \n    temp.Next = nil \n \n    size-- \n    return v, true \n}"}]}]},{"block_type":"element","block":"k6pz2i8d","search_text":"The preceding code shows the implementation of the Pop() function, which removes the oldest element of the queue. If the queue is empty ( size == 0 ), there is nothing to extract. If the queue has only one node, then you extract the value of that node and the queue becomes empty. Otherwise, you extract the last element of the queue, remove the last node of the queue, and fix the required pointers before returning the desired value.","text_count":435,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code shows the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"function, which removes the oldest element of the queue. If the queue is empty ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size == 0"}]},{"block_type":"text","content":"), there is nothing to extract. If the queue has only one node, then you extract the value of that node and the queue becomes empty. Otherwise, you extract the last element of the queue, remove the last node of the queue, and fix the required pointers before returning the desired value."}]},{"block_type":"element","block":"k6pz2i8e","search_text":"The fourth part of queue.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i8f","search_text":"func traverse(t *Node) { if size == 0 { fmt.Println(\"Empty Queue!\") return } for t != nil { fmt.Printf(\"%d -> \", t.Value) t = t.Next } fmt.Println() } ","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(t *Node) { \n    if size == 0 { \n        fmt.Println(\"Empty Queue!\") \n        return \n    } \n \n    for t != nil { \n        fmt.Printf(\"%d -&gt; \", t.Value) \n        t = t.Next \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2i8g","search_text":"Strictly speaking, the traverse() function is not necessary for the operation of a queue, but it gives you a practical way of looking at all of the nodes of the queue.","text_count":167,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traverse()"}]},{"block_type":"text","content":"function is not necessary for the operation of a queue, but it gives you a practical way of looking at all of the nodes of the queue."}]},{"block_type":"element","block":"k6pz2i8h","search_text":"The last code segment of queue.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i8i","search_text":"func main() { queue = nil Push(queue, 10) fmt.Println(\"Size:\", size) traverse(queue) v, b := Pop(queue) if b { fmt.Println(\"Pop:\", v) } fmt.Println(\"Size:\", size) for i := 0; i < 5; i++ { Push(queue, i) } traverse(queue) fmt.Println(\"Size:\", size) v, b = Pop(queue) if b { fmt.Println(\"Pop:\", v) } fmt.Println(\"Size:\", size) v, b = Pop(queue) if b { fmt.Println(\"Pop:\", v) } fmt.Println(\"Size:\", size) traverse(queue) } ","text_count":420,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    queue = nil \n    Push(queue, 10) \n    fmt.Println(\"Size:\", size) \n    traverse(queue) \n \n    v, b := Pop(queue) \n    if b { \n        fmt.Println(\"Pop:\", v) \n    } \n    fmt.Println(\"Size:\", size) \n \n    for i := 0; i &lt; 5; i++ { \n        Push(queue, i) \n    } \n    traverse(queue) \n    fmt.Println(\"Size:\", size) \n \n    v, b = Pop(queue) \n    if b { \n        fmt.Println(\"Pop:\", v) \n    } \n    fmt.Println(\"Size:\", size) \n \n    v, b = Pop(queue) \n    if b { \n        fmt.Println(\"Pop:\", v) \n    } \n    fmt.Println(\"Size:\", size) \n    traverse(queue) \n}"}]}]},{"block_type":"element","block":"k6pz2i8j","search_text":"Almost all of the Go code in main() is for checking the operation of the queue. The most important code in here are the two if statements that let you know whether the Pop() function returned an actual value, or if the queue was empty and there is nothing to return.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Almost all of the Go code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"is for checking the operation of the queue. The most important code in here are the two"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statements that let you know whether the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"function returned an actual value, or if the queue was empty and there is nothing to return."}]},{"block_type":"element","block":"k6pz2i8k","search_text":"Executing queue.go will produce the following type of output:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"will produce the following type of output:"}]},{"block_type":"element","block":"k6pz2i8l","search_text":"$ go run queue.go Size: 1 10 -> Pop: 10 Size: 0 4 -> 3 -> 2 -> 1 -> 0 -> Size: 5 Pop: 0 Size: 4 Pop: 1 Size: 3 4 -> 3 -> 2 ->","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run queue.go\nSize: 1\n10 -&gt;\nPop: 10\nSize: 0\n4 -&gt; 3 -&gt; 2 -&gt; 1 -&gt; 0 -&gt;\nSize: 5\nPop: 0\nSize: 4\nPop: 1\nSize: 3\n4 -&gt; 3 -&gt; 2 -&gt;"}]}]},{"block_type":"element","block":"k6pz2i8m","search_text":"Stacks in Go","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Stacks in Go"}]},{"block_type":"element","block":"k6pz2i8n","search_text":"A Stack is a data structure that looks like a pile of plates. The last plate that goes on the top of the pile is the one that will be used first when you need to use a new plate.","text_count":178,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Stack"}]},{"block_type":"text","content":"is a data structure that looks like a pile of plates. The last plate that goes on the top of the pile is the one that will be used first when you need to use a new plate."}]},{"block_type":"element","block":"k6pz2i8o","search_text":"The main advantage of a stack is its simplicity because you only have to worry about implementing two functions in order to be able to work with a stack-adding a new node to the stack and removing a node from the stack.","text_count":219,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main advantage of a stack is its simplicity because you only have to worry about implementing two functions in order to be able to work with a stack-adding a new node to the stack and removing a node from the stack."}]},{"block_type":"element","block":"k6pz2i8p","search_text":"Implementing a stack in Go","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing a stack in Go"}]},{"block_type":"element","block":"k6pz2i8q","search_text":"It is now time to look at the implementation of a stack in Go. This will be illustrated in the stack.go source file. Once again, a linked list will be used for implementing the stack. As you know, you will need two functions: one function named Push() for putting things on the stack and another one named Pop() for removing things from the stack. Although it is not necessary, it is useful to keep the number of elements that you have on the stack on a separate variable in order to be able to tell whether you are dealing with an empty stack or not without having to access the linked list itself.","text_count":599,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is now time to look at the implementation of a stack in Go. This will be illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"source file. Once again, a linked list will be used for implementing the stack. As you know, you will need two functions: one function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"for putting things on the stack and another one named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"for removing things from the stack. Although it is not necessary, it is useful to keep the number of elements that you have on the stack on a separate variable in order to be able to tell whether you are dealing with an empty stack or not without having to access the linked list itself."}]},{"block_type":"element","block":"k6pz2i8r","search_text":"The source code of stack.go will be presented in four parts. The first part follows next:","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"will be presented in four parts. The first part follows next:"}]},{"block_type":"element","block":"k6pz2i8s","search_text":"package main import ( \"fmt\" ) type Node struct { Value int Next *Node } var size = 0 var stack = new(Node) ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype Node struct { \n    Value int \n    Next  *Node \n} \n \nvar size = 0 \nvar stack = new(Node)"}]}]},{"block_type":"element","block":"k6pz2i8t","search_text":"The second part of stack.go contains the implementation of the Push() function:","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i8u","search_text":"func Push(v int) bool { if stack == nil { stack = &Node{v, nil} size = 1 return true } temp := &Node{v, nil} temp.Next = stack stack = temp size++ return true } ","text_count":161,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Push(v int) bool { \n    if stack == nil { \n        stack = &amp;Node{v, nil} \n        size = 1 \n        return true \n    } \n \n    temp := &amp;Node{v, nil} \n    temp.Next = stack \n    stack = temp \n    size++ \n    return true \n}"}]}]},{"block_type":"element","block":"k6pz2i8v","search_text":"If the stack is not empty, then you create a new node ( temp ), which is placed in front of the current stack. After that, this new node becomes the head of the stack. The current version of the Push() function always returns true , but if your stack does not have unlimited space, you might want to modify it and return false when you are about to exceed its capacity.","text_count":369,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If the stack is not empty, then you create a new node ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"temp"}]},{"block_type":"text","content":"), which is placed in front of the current stack. After that, this new node becomes the head of the stack. The current version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"function always returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":", but if your stack does not have unlimited space, you might want to modify it and return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"when you are about to exceed its capacity."}]},{"block_type":"element","block":"k6pz2i8w","search_text":"The third part contains the implementation of the Pop() function:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2i8x","search_text":"func Pop(t *Node) (int, bool) { if size == 0 { return 0, false } if size == 1 { size = 0 stack = nil return t.Value, true } stack = stack.Next size-- return t.Value, true } ","text_count":173,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Pop(t *Node) (int, bool) { \n    if size == 0 { \n        return 0, false \n    } \n \n    if size == 1 { \n        size = 0 \n        stack = nil \n        return t.Value, true \n    } \n \n    stack = stack.Next \n    size-- \n    return t.Value, true \n}"}]}]},{"block_type":"element","block":"k6pz2i8y","search_text":"The fourth code segment of stack.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i8z","search_text":"func traverse(t *Node) { if size == 0 { fmt.Println(\"Empty Stack!\") return } for t != nil { fmt.Printf(\"%d -> \", t.Value) t = t.Next } fmt.Println() } ","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func traverse(t *Node) { \n    if size == 0 { \n        fmt.Println(\"Empty Stack!\") \n        return \n    } \n \n    for t != nil { \n        fmt.Printf(\"%d -&gt; \", t.Value) \n        t = t.Next \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2i90","search_text":"As the stack is implemented using a linked list, it is traversed as such.","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the stack is implemented using a linked list, it is traversed as such."}]},{"block_type":"element","block":"k6pz2i91","search_text":"The last part of stack.go is shown in the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i92","search_text":"func main() { stack = nil v, b := Pop(stack) if b { fmt.Print(v, \" \") } else { fmt.Println(\"Pop() failed!\") } Push(100) traverse(stack) Push(200) traverse(stack) for i := 0; i < 10; i++ { Push(i) } for i := 0; i < 15; i++ { v, b := Pop(stack) if b { fmt.Print(v, \" \") } else { break } } fmt.Println() traverse(stack) } ","text_count":319,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    stack = nil \n    v, b := Pop(stack) \n    if b { \n        fmt.Print(v, \" \") \n    } else { \n        fmt.Println(\"Pop() failed!\") \n    } \n \n    Push(100) \n    traverse(stack) \n    Push(200) \n    traverse(stack) \n \n    for i := 0; i &lt; 10; i++ { \n        Push(i) \n    } \n \n    for i := 0; i &lt; 15; i++ { \n        v, b := Pop(stack) \n        if b { \n            fmt.Print(v, \" \") \n        } else { \n            break \n        } \n    } \n    fmt.Println() \n    traverse(stack) \n}"}]}]},{"block_type":"element","block":"k6pz2i93","search_text":"As you just saw, the source code of stack.go is a little shorter than the Go code of queue.go , primarily because the idea behind a stack is simpler than the idea behind a queue.","text_count":178,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you just saw, the source code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"is a little shorter than the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":", primarily because the idea behind a stack is simpler than the idea behind a queue."}]},{"block_type":"element","block":"k6pz2i94","search_text":"Executing stack.go will generate the following type of output:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2i95","search_text":"$ go run stack.go Pop() failed! 100 -> 200 -> 100 -> 9 8 7 6 5 4 3 2 1 0 200 100 Empty Stack! ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run stack.go\nPop() failed!\n100 -&gt;\n200 -&gt; 100 -&gt;\n9 8 7 6 5 4 3 2 1 0 200 100\nEmpty Stack!"}]}]},{"block_type":"element","block":"k6pz2i96","search_text":"Tip So far, you have seen how a linked list is used in the implementation of a hash table, queue, and a stack. These examples should help you to realize the usefulness and the importance of linked lists in programming and computer science in general! ","text_count":251,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So far, you have seen how a linked list is used in the implementation of a hash table, queue, and a stack. These examples should help you to realize the usefulness and the importance of linked lists in programming and computer science in general!"}]}]},{"block_type":"element","block":"k6pz2i97","search_text":"The container package","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The container package"}]},{"block_type":"element","block":"k6pz2i98","search_text":"In this section, I will explain the use of the container standard Go package. The container package supports three data structures: a heap , list , and ring . These data structures are implemented in container/heap , container/list , and container/ring , respectively.","text_count":268,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, I will explain the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"package supports three data structures: a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"heap"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring"}]},{"block_type":"text","content":". These data structures are implemented in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/list"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/ring"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2i99","search_text":"For those of you who are unfamiliar with rings, a ring is a circular list , which means that the last element of a ring points to its first element. In essence, this means that all of the nodes of a ring are equivalent and that a ring does not have a beginning and an end. As a result, each element of a ring can help you traverse the entire ring.","text_count":347,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For those of you who are unfamiliar with rings, a ring is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"circular list"}]},{"block_type":"text","content":", which means that the last element of a ring points to its first element. In essence, this means that all of the nodes of a ring are equivalent and that a ring does not have a beginning and an end. As a result, each element of a ring can help you traverse the entire ring."}]},{"block_type":"element","block":"k6pz2i9a","search_text":"The next three subsections will illustrate each one of the packages contained in the container package. The rational advice is that if the functionality of the container standard Go package suits your needs, use it; otherwise, you should implement and use your own data structures.","text_count":281,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next three subsections will illustrate each one of the packages contained in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"package. The rational advice is that if the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package suits your needs, use it; otherwise, you should implement and use your own data structures."}]},{"block_type":"element","block":"k6pz2i9b","search_text":"Using container/heap","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using container/heap"}]},{"block_type":"element","block":"k6pz2i9c","search_text":"In this subsection, you will see the functionality that the container/heap package offers. First of all, you should know that the container/heap package implements a heap, which is a tree where the value of each node of the tree is the smallest element in its subtree. Note that I am using the phrase smallest element instead of minimum value in order to make clear that a heap does not only support numerical values.","text_count":417,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will see the functionality that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"package offers. First of all, you should know that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"package implements a heap, which is a tree where the value of each node of the tree is the smallest element in its subtree. Note that I am using the phrase"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"smallest element"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"minimum value"}]},{"block_type":"text","content":"in order to make clear that a heap does not only support numerical values."}]},{"block_type":"element","block":"k6pz2i9d","search_text":"However, as you can guess, in order to implement a heap tree in Go, you will have to develop a way to tell which one of two elements is smaller than the other on your own. In such cases, Go uses interfaces because they allow you to define such a behavior.","text_count":255,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, as you can guess, in order to implement a heap tree in Go, you will have to develop a way to tell which one of two elements is"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"smaller"}]},{"block_type":"text","content":"than the other on your own. In such cases, Go uses interfaces because they allow you to define such a behavior."}]},{"block_type":"element","block":"k6pz2i9e","search_text":"This means that the container/heap package is more advanced than the other two packages found in container , and that you will have to define some things before being able to use the functionality of the container/heap package. Strictly speaking, the container/heap package requires that you implement the container/heap.Interface , which is defined as follows:","text_count":361,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"package is more advanced than the other two packages found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":", and that you will have to define some things before being able to use the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"package. Strictly speaking, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"package requires that you implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap.Interface"}]},{"block_type":"text","content":", which is defined as follows:"}]},{"block_type":"element","block":"k6pz2i9f","search_text":"type Interface interface { sort.Interface Push(x interface{}) // add x as element Len() Pop() interface{} // remove and return element Len() - 1. } ","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Interface interface { \n    sort.Interface \n    Push(x interface{}) // add x as element Len() \n    Pop() interface{}   // remove and return element Len() - 1. \n}"}]}]},{"block_type":"element","block":"k6pz2i9g","search_text":"You will learn more about Interfaces in Chapter 7, Reflection and Interfaces for All Seasons . For now, just remember that compliance with a Go interface requires the implementation of one or more functions or other interfaces, which in this case is sort.Interface as well as the Push() and Pop() functions. The sort.Interface requires that you implement the Len() , Less() , and Swap() functions, which makes perfect sense because you cannot perform any kind of sorting without being able to swap two elements, being able to calculate a value for the things that you want to sort, and being able to tell which element between two elements is bigger than the other based on the value that you calculated previously. Although you might think that this is a lot of work, keep in mind that most of the times the implementation of these functions is either trivial or rather simple.","text_count":878,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Interfaces"}]},{"block_type":"text","content":"in Chapter 7,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Reflection and Interfaces for All Seasons"}]},{"block_type":"text","content":". For now, just remember that compliance with a Go interface requires the implementation of one or more functions or other interfaces, which in this case is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Interface"}]},{"block_type":"text","content":"as well as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"functions. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Interface"}]},{"block_type":"text","content":"requires that you implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Len()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Less()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Swap()"}]},{"block_type":"text","content":"functions, which makes perfect sense because you cannot perform any kind of sorting without being able to swap two elements, being able to calculate a"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"value"}]},{"block_type":"text","content":"for the things that you want to sort, and being able to tell which element between two elements is bigger than the other based on the value that you calculated previously. Although you might think that this is a lot of work, keep in mind that most of the times the implementation of these functions is either trivial or rather simple."}]},{"block_type":"element","block":"k6pz2i9h","search_text":"Since the purpose of this section is to illustrate the use of container/heap and not to make your life difficult, the data type for the elements in this example will be float32 .","text_count":178,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Since the purpose of this section is to illustrate the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":"and not to make your life difficult, the data type for the elements in this example will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float32"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i9i","search_text":"The Go code of conHeap.go will be presented in five parts. The first part follows next:","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"will be presented in five parts. The first part follows next:"}]},{"block_type":"element","block":"k6pz2i9j","search_text":"package main import ( \"container/heap\" \"fmt\" ) type heapFloat32 []float32 ","text_count":74,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"container/heap\" \n    \"fmt\" \n) \n \ntype heapFloat32 []float32"}]}]},{"block_type":"element","block":"k6pz2i9k","search_text":"The second part of the conHeap.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2i9l","search_text":"func (n *heapFloat32) Pop() interface{} { old := *n x := old[len(old)-1] new := old[0 : len(old)-1] *n = new return x } func (n *heapFloat32) Push(x interface{}) { *n = append(*n, x.(float32)) } ","text_count":195,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (n *heapFloat32) Pop() interface{} { \n    old := *n \n    x := old[len(old)-1] \n    new := old[0 : len(old)-1] \n    *n = new \n    return x \n} \n \nfunc (n *heapFloat32) Push(x interface{}) { \n    *n = append(*n, x.(float32)) \n}"}]}]},{"block_type":"element","block":"k6pz2i9m","search_text":"Although you define two functions named Pop() and Push() here, these two functions are used for interface compliance. In order to add and remove elements from the heap, you should call heap.Push() and heap.Pop() respectively.","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you define two functions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Pop()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Push()"}]},{"block_type":"text","content":"here, these two functions are used for interface compliance. In order to add and remove elements from the heap, you should call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"heap.Push()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"heap.Pop()"}]},{"block_type":"text","content":"respectively."}]},{"block_type":"element","block":"k6pz2i9n","search_text":"The third code segment of conHeap.go contains the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2i9o","search_text":"func (n heapFloat32) Len() int { return len(n) } func (n heapFloat32) Less(a, b int) bool { return n[a] < n[b] } func (n heapFloat32) Swap(a, b int) { n[a], n[b] = n[b], n[a] } ","text_count":177,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (n heapFloat32) Len() int { \n    return len(n) \n} \n \nfunc (n heapFloat32) Less(a, b int) bool { \n    return n[a] &lt; n[b] \n} \n \nfunc (n heapFloat32) Swap(a, b int) { \n    n[a], n[b] = n[b], n[a] \n}"}]}]},{"block_type":"element","block":"k6pz2i9p","search_text":"This part implements the three functions needed by the sort.Interface interface.","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part implements the three functions needed by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sort.Interface"}]},{"block_type":"text","content":"interface."}]},{"block_type":"element","block":"k6pz2i9q","search_text":"The fourth part of conHeap.go is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2i9r","search_text":"func main() { myHeap := &heapFloat32{1.2, 2.1, 3.1, -100.1} heap.Init(myHeap) size := len(*myHeap) fmt.Printf(\"Heap size: %d\\n\", size) fmt.Printf(\"%v\\n\", myHeap) ","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    myHeap := &amp;heapFloat32{1.2, 2.1, 3.1, -100.1} \n    heap.Init(myHeap) \n    size := len(*myHeap) \n    fmt.Printf(\"Heap size: %d\\n\", size) \n    fmt.Printf(\"%v\\n\", myHeap)"}]}]},{"block_type":"element","block":"k6pz2i9s","search_text":"The last code portion of conHeap.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"&nbsp;follows next:"}]},{"block_type":"element","block":"k6pz2i9t","search_text":"myHeap.Push(float32(-100.2)) myHeap.Push(float32(0.2)) fmt.Printf(\"Heap size: %d\\n\", len(*myHeap)) fmt.Printf(\"%v\\n\", myHeap) heap.Init(myHeap) fmt.Printf(\"%v\\n\", myHeap) } ","text_count":173,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"myHeap.Push(float32(-100.2)) \n    myHeap.Push(float32(0.2)) \n    fmt.Printf(\"Heap size: %d\\n\", len(*myHeap)) \n    fmt.Printf(\"%v\\n\", myHeap) \n    heap.Init(myHeap) \n    fmt.Printf(\"%v\\n\", myHeap) \n}"}]}]},{"block_type":"element","block":"k6pz2i9u","search_text":"In this last part of conHeap.go , you add two new elements to myHeap using heap.Push() . However, in order for the heap to get properly re-sorted, you will need to make another call to heap.Init() .","text_count":198,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":", you add two new elements to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHeap"}]},{"block_type":"text","content":"using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"heap.Push()"}]},{"block_type":"text","content":". However, in order for the heap to get properly re-sorted, you will need to make another call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"heap.Init()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2i9v","search_text":"Executing conHeap.go will generate the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2i9w","search_text":"$ go run conHeap.go Heap size: 4 &[-100.1 1.2 3.1 2.1] Heap size: 6 &[-100.1 1.2 3.1 2.1 -100.2 0.2] &[-100.2 -100.1 0.2 2.1 1.2 3.1] ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run conHeap.go\nHeap size: 4\n&amp;[-100.1 1.2 3.1 2.1]\nHeap size: 6\n&amp;[-100.1 1.2 3.1 2.1 -100.2 0.2]\n&amp;[-100.2 -100.1 0.2 2.1 1.2 3.1]"}]}]},{"block_type":"element","block":"k6pz2i9x","search_text":"If you find it strange that the 2.1 1.2 3.1 triplet in the last line of the output is not sorted in the linear logic, remember that a heap is a tree-not a linear structure like an array or a slice.","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you find it strange that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2.1 1.2 3.1"}]},{"block_type":"text","content":"triplet in the last line of the output is not sorted in the linear logic, remember that a heap is a tree-not a linear structure like an array or a slice."}]},{"block_type":"element","block":"k6pz2i9y","search_text":"Using container/list","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using container/list"}]},{"block_type":"element","block":"k6pz2i9z","search_text":"This subsection will illustrate the operation of the container/list package using the Go code of conList.go , which will be presented in three parts.","text_count":149,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will illustrate the operation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/list"}]},{"block_type":"text","content":"package using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conList.go"}]},{"block_type":"text","content":", which will be presented in three parts."}]},{"block_type":"element","block":"k6pz2ia0","search_text":"Tip The container/list package implements a linked list . ","text_count":58,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/list"}]},{"block_type":"text","content":"package implements a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"linked list"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2ia1","search_text":"The first part of conList.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conList.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ia2","search_text":"package main import ( \"container/list\" \"fmt\" \"strconv\" ) func printList(l *list.List) { for t := l.Back(); t != nil; t = t.Prev() { fmt.Print(t.Value, \" \") } fmt.Println() for t := l.Front(); t != nil; t = t.Next() { fmt.Print(t.Value, \" \") } fmt.Println() } ","text_count":259,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"container/list\" \n    \"fmt\" \n    \"strconv\" \n) \n \nfunc printList(l *list.List) { \n    for t := l.Back(); t != nil; t = t.Prev() { \n        fmt.Print(t.Value, \" \") \n    } \n    fmt.Println() \n \n    for t := l.Front(); t != nil; t = t.Next() { \n        fmt.Print(t.Value, \" \") \n    } \n \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2ia3","search_text":"Here, you see a function named printList() , which allows you to print the contents of a list.List variable passed as a pointer. The Go code shows you how to print the elements of a list.List starting from the first element and going to the last element and vice versa. Usually, you will need to use only one of the two methods in your programs. The Prev() and Next() functions allow you to iterate over the elements of a list backwards and forward.","text_count":449,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here, you see a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printList()"}]},{"block_type":"text","content":", which allows you to print the contents of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.List"}]},{"block_type":"text","content":"variable passed as a pointer. The Go code shows you how to print the elements of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.List"}]},{"block_type":"text","content":"starting from the first element and going to the last element and vice versa. Usually, you will need to use only one of the two methods in your programs. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Prev()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Next()"}]},{"block_type":"text","content":"functions allow you to iterate over the elements of a list backwards and forward."}]},{"block_type":"element","block":"k6pz2ia4","search_text":"The second code segment of conList.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conList.go"}]},{"block_type":"text","content":"&nbsp;follows next:"}]},{"block_type":"element","block":"k6pz2ia5","search_text":"func main() { values := list.New() e1 := values.PushBack(\"One\") e2 := values.PushBack(\"Two\") values.PushFront(\"Three\") values.InsertBefore(\"Four\", e1) values.InsertAfter(\"Five\", e2) values.Remove(e2) values.Remove(e2) values.InsertAfter(\"FiveFive\", e2) values.PushBackList(values) printList(values) values.Init() ","text_count":313,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    values := list.New() \n \n    e1 := values.PushBack(\"One\") \n    e2 := values.PushBack(\"Two\") \n    values.PushFront(\"Three\") \n    values.InsertBefore(\"Four\", e1) \n    values.InsertAfter(\"Five\", e2) \n    values.Remove(e2) \n    values.Remove(e2) \n    values.InsertAfter(\"FiveFive\", e2) \n    values.PushBackList(values) \n \n    printList(values) \n \n    values.Init()"}]}]},{"block_type":"element","block":"k6pz2ia6","search_text":"The list.PushBack() function allows you to insert an object at the back of a linked list, whereas the list.PushFront() function allows you to insert an object at the front of a list. The return value of both functions is the element inserted in the list. If you want to insert a new element after a specific element, then you should use the list.InsertAfter() function. Similarly, if you want to insert a new element before a specific element, you should use the list.InsertBefore() function. If the element does not exist, then the list will not change. The list.PushBackList() inserts a copy of an existing list at the end of another list, whereas the list.PushFrontList() function puts a copy of an existing list at the front of another list. The list.Remove() function removes a specific element from a list.","text_count":812,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.PushBack()"}]},{"block_type":"text","content":"function allows you to insert an object at the back of a linked list, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.PushFront()"}]},{"block_type":"text","content":"function allows you to insert an object at the front of a list. The return value of both functions is the element inserted in the list. If you want to insert a new element after a specific element, then you should use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.InsertAfter()"}]},{"block_type":"text","content":"function. Similarly, if you want to insert a new element before a specific element, you should use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.InsertBefore()"}]},{"block_type":"text","content":"function. If the element does not exist, then the list will not change. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.PushBackList()"}]},{"block_type":"text","content":"inserts a copy of an existing list at the end of another list, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.PushFrontList()"}]},{"block_type":"text","content":"function puts a copy of an existing list at the front of another list. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list.Remove()"}]},{"block_type":"text","content":"function removes a specific element from a list."}]},{"block_type":"element","block":"k6pz2ia7","search_text":"Note the use of the values.Init() function that either empties an existing list or initializes a new list.","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"values.Init()"}]},{"block_type":"text","content":"function that either empties an existing list or initializes a new list."}]},{"block_type":"element","block":"k6pz2ia8","search_text":"The last portion of the code of conList.go is shown in the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last portion of the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conList.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ia9","search_text":"fmt.Printf(\"After Init(): %v\\n\", values) for i := 0; i < 20; i++ { values.PushFront(strconv.Itoa(i)) } printList(values) } ","text_count":123,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Printf(\"After Init(): %v\\n\", values) \n \n    for i := 0; i &lt; 20; i++ { \n        values.PushFront(strconv.Itoa(i)) \n    } \n \n    printList(values) \n}"}]}]},{"block_type":"element","block":"k6pz2iaa","search_text":"Here, you create a new list using a for loop-the strconv.Itoa() function converts an integer value into a string.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here, you create a new list using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop-the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Itoa()"}]},{"block_type":"text","content":"function converts an integer value into a string."}]},{"block_type":"element","block":"k6pz2iab","search_text":"In conclusion, the use of the functions of the container/list package is straightforward and comes with no surprises.","text_count":117,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In conclusion, the use of the functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/list"}]},{"block_type":"text","content":"package is straightforward and comes with no surprises."}]},{"block_type":"element","block":"k6pz2iac","search_text":"Executing conList.go will generate the following type of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conList.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2iad","search_text":"$ go run conList.go Five One Four Three Five One Four Three Three Four One Five Three Four One Five After Init(): &{{0xc420074180 0xc420074180 <nil> <nil>} 0} 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0","text_count":258,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run conList.go\nFive One Four Three Five One Four Three\nThree Four One Five Three Four One Five\nAfter Init(): &amp;{{0xc420074180 0xc420074180 &lt;nil&gt; &lt;nil&gt;} 0}\n0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19\n19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0"}]}]},{"block_type":"element","block":"k6pz2iae","search_text":"Using container/ring","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using container/ring"}]},{"block_type":"element","block":"k6pz2iaf","search_text":"This section will illustrate the use of the container/ring package using the Go code of conRing.go , which will be presented in four parts. Note that the container/ring package is much simpler than both container/list and container/heap , which means that it contains fewer functions than the other two packages.","text_count":312,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will illustrate the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/ring"}]},{"block_type":"text","content":"package using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":", which will be presented in four parts. Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/ring"}]},{"block_type":"text","content":"package is much simpler than both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/list"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container/heap"}]},{"block_type":"text","content":", which means that it contains fewer functions than the other two packages."}]},{"block_type":"element","block":"k6pz2iag","search_text":"The first code segment of conRing.go follows next:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iah","search_text":"package main import ( \"container/ring\" \"fmt\" ) var size int = 10 ","text_count":65,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"container/ring\" \n    \"fmt\" \n) \n \nvar size int = 10"}]}]},{"block_type":"element","block":"k6pz2iai","search_text":"The size variable holds the size of the ring that will be created.","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size"}]},{"block_type":"text","content":"variable holds the size of the ring that will be created."}]},{"block_type":"element","block":"k6pz2iaj","search_text":"The second part of conRing.go contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iak","search_text":"func main() { myRing := ring.New(size + 1) fmt.Println(\"Empty ring:\", *myRing) for i := 0; i < myRing.Len()-1; i++ { myRing.Value = i myRing = myRing.Next()","text_count":156,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    myRing := ring.New(size + 1) \n    fmt.Println(\"Empty ring:\", *myRing) \n \n    for i := 0; i &lt; myRing.Len()-1; i++ { \n        myRing.Value = i \n        myRing = myRing.Next()"}]}]},{"block_type":"element","block":"k6pz2ial","search_text":"} myRing.Value = 2 ","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} \n \n    myRing.Value = 2"}]}]},{"block_type":"element","block":"k6pz2iam","search_text":"Thus, a new ring is created with the help of the ring.New() function, which requires a single parameter-the size of the ring. The myRing.Value = 2 statement at the end adds the value 2 to the ring. That value, however, already exists in the ring as it was added in the for loop. Last, the zero value of a ring is a ring with a single element whose value is nil .","text_count":362,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, a new ring is created with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.New()"}]},{"block_type":"text","content":"function, which requires a single parameter-the size of the ring. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myRing.Value = 2"}]},{"block_type":"text","content":"statement at the end adds the value"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"2"}]},{"block_type":"text","content":"to the ring. That value, however, already exists in the ring as it was added in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. Last, the zero value of a ring is a ring with a single element whose value is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ian","search_text":"The third part of conRing.go is shown in the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iao","search_text":"sum := 0 myRing.Do(func(x interface{}) { t := x.(int) sum = sum + t }) fmt.Println(\"Sum:\", sum) ","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sum := 0 \n    myRing.Do(func(x interface{}) { \n        t := x.(int) \n        sum = sum + t \n    }) \n    fmt.Println(\"Sum:\", sum)"}]}]},{"block_type":"element","block":"k6pz2iap","search_text":"The ring.Do() function allows you to call a function for each element of a ring in forward order. However, if that function makes any changes to the ring, then the behavior of ring.Do() is undefined. The x.(int) statement is called type assertion . You will learn more about type assertions in Chapter 7, Reflection and Interfaces for All Seasons . For now, just know that it shows that x is of type int .","text_count":405,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Do()"}]},{"block_type":"text","content":"function allows you to call a function for each element of a ring in forward order. However, if that function makes any changes to the ring, then the behavior of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Do()"}]},{"block_type":"text","content":"is undefined. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x.(int)"}]},{"block_type":"text","content":"statement is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"type assertion"}]},{"block_type":"text","content":". You will learn more about type assertions in Chapter 7,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Reflection and Interfaces for All Seasons"}]},{"block_type":"text","content":". For now, just know that it shows that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"is of type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iaq","search_text":"The last part of the conRing.go program is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2iar","search_text":"for i := 0; i < myRing.Len()+2; i++ { myRing = myRing.Next() fmt.Print(myRing.Value, \" \") } fmt.Println() } ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; myRing.Len()+2; i++ { \n            myRing = myRing.Next() \n            fmt.Print(myRing.Value, \" \") \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2ias","search_text":"The only problem with rings is that you can keep calling ring.Next() indefinitely, so you will need to find a way to put a stop to that. In this case, this is accomplished with the help of the ring.Len() function. Personally, I prefer to use the ring.Do() function for iterating over all of the elements of a ring because it generates cleaner code, but using a for loop is just as good!","text_count":386,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The only problem with rings is that you can keep calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Next()"}]},{"block_type":"text","content":"indefinitely, so you will need to find a way to put a stop to that. In this case, this is accomplished with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Len()"}]},{"block_type":"text","content":"function. Personally, I prefer to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Do()"}]},{"block_type":"text","content":"function for iterating over all of the elements of a ring because it generates cleaner code, but using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop is just as good!"}]},{"block_type":"element","block":"k6pz2iat","search_text":"Executing conRing.go will generate the following type of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conRing.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2iau","search_text":"$ go run conRing.go Empty ring: {0xc42000a080 0xc42000a1a0 <nil>} Sum: 47 0 1 2 3 4 5 6 7 8 9 2 0 1 ","text_count":100,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run conRing.go\nEmpty ring: {0xc42000a080 0xc42000a1a0 &lt;nil&gt;}\nSum: 47\n0 1 2 3 4 5 6 7 8 9 2 0 1"}]}]},{"block_type":"element","block":"k6pz2iav","search_text":"The output verifies that a ring can contain duplicate values, which means that unless you use the ring.Len() function, you have no safe way of knowing the size of a ring.","text_count":170,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output verifies that a ring can contain duplicate values, which means that unless you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ring.Len()"}]},{"block_type":"text","content":"function, you have no safe way of knowing the size of a ring."}]},{"block_type":"element","block":"k6pz2iaw","search_text":"Generating random numbers","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Generating random numbers"}]},{"block_type":"element","block":"k6pz2iax","search_text":"Random number generation is an art as well as a research area in Computer science. This happens because computers are purely logical machines, and it turns out that using them to generate random numbers is extremely difficult!","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Random number generation is an art as well as a research area in Computer science. This happens because computers are purely logical machines, and it turns out that using them to generate random numbers is extremely difficult!"}]},{"block_type":"element","block":"k6pz2iay","search_text":"Go uses the math/rand package for generating random numbers. It needs a seed to start producing random numbers. The seed is used for initializing the entire process, and it is extremely important because if you always start with the same seed, you will always get the same sequence of random numbers. This means that everybody can regenerate that sequence, and that particular sequence will not be random after all!","text_count":415,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/rand"}]},{"block_type":"text","content":"package for generating random numbers. It needs a seed to start producing random numbers. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"seed"}]},{"block_type":"text","content":"is used for initializing the entire process, and it is extremely important because if you always start with the same seed, you will always get the same sequence of random numbers. This means that everybody can regenerate that sequence, and that particular sequence will not be random after all!"}]},{"block_type":"element","block":"k6pz2iaz","search_text":"The name of the utility that will help us generate random numbers is randomNumbers.go , and it will be presented in four parts. The utility takes various parameters, which are the lower and upper limits of the random numbers that will be generated as well as the amount of random numbers to generate. If you use a fourth command parameter, the program will use that as the seed of the random number generator, which will help you regenerate the same number sequence in the future that mainly happens for testing purposes.","text_count":521,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility that will help us generate random numbers is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"randomNumbers.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The utility takes various parameters, which are the lower and upper limits of the random numbers that will be generated as well as the amount of random numbers to generate. If you use a fourth command parameter, the program will use that as the seed of the random number generator, which will help you regenerate the same number sequence in the future that mainly happens for testing purposes."}]},{"block_type":"element","block":"k6pz2ib0","search_text":"The first part of the utility follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the utility follows next:"}]},{"block_type":"element","block":"k6pz2ib1","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" \"time\" ) func random(min, max int) int { return rand.Intn(max-min) + min } ","text_count":130,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n) \n \nfunc random(min, max int) int { \n    return rand.Intn(max-min) + min \n}"}]}]},{"block_type":"element","block":"k6pz2ib2","search_text":"The random() function does all of the job, which is generating random numbers in the given range by calling rand.Intn() .","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"random()"}]},{"block_type":"text","content":"function does all of the job, which is generating random numbers in the given range by calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rand.Intn()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ib3","search_text":"The second part of the command-line utility follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the command-line utility follows next:"}]},{"block_type":"element","block":"k6pz2ib4","search_text":"func main() { MIN := 0 MAX := 100 TOTAL := 100 SEED := time.Now().Unix() arguments := os.Args ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    MIN := 0 \n    MAX := 100 \n    TOTAL := 100 \n    SEED := time.Now().Unix() \n \n    arguments := os.Args"}]}]},{"block_type":"element","block":"k6pz2ib5","search_text":"In this part, you initialize the variables that will be used in the program.","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you initialize the variables that will be used in the program."}]},{"block_type":"element","block":"k6pz2ib6","search_text":"The third part of randomNumbers.go contains the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"randomNumbers.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ib7","search_text":"switch len(arguments) { case 2: fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") MIN, _ = strconv.Atoi(arguments[1]) MAX = MIN + 100 case 3: fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") MIN, _ = strconv.Atoi(arguments[1]) MAX, _ = strconv.Atoi(arguments[2]) case 4: fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") MIN, _ = strconv.Atoi(arguments[1]) MAX, _ = strconv.Atoi(arguments[2]) TOTAL, _ = strconv.Atoi(arguments[3]) case 5: MIN, _ = strconv.Atoi(arguments[1]) MAX, _ = strconv.Atoi(arguments[2]) TOTAL, _ = strconv.Atoi(arguments[3]) SEED, _ = strconv.ParseInt(arguments[4], 10, 64) default: fmt.Println(\"Using default values!\") } ","text_count":668,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"switch len(arguments) { \n    case 2: \n            fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") \n            MIN, _ = strconv.Atoi(arguments[1]) \n            MAX = MIN + 100 \n    case 3: \n            fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") \n            MIN, _ = strconv.Atoi(arguments[1]) \n            MAX, _ = strconv.Atoi(arguments[2]) \n    case 4: \n            fmt.Println(\"Usage: ./randomNumbers MIN MAX TOTAL SEED\") \n            MIN, _ = strconv.Atoi(arguments[1]) \n            MAX, _ = strconv.Atoi(arguments[2]) \n            TOTAL, _ = strconv.Atoi(arguments[3]) \n    case 5: \n            MIN, _ = strconv.Atoi(arguments[1]) \n            MAX, _ = strconv.Atoi(arguments[2]) \n            TOTAL, _ = strconv.Atoi(arguments[3]) \n            SEED, _ = strconv.ParseInt(arguments[4], 10, 64) \n    default: \n            fmt.Println(\"Using default values!\") \n    }"}]}]},{"block_type":"element","block":"k6pz2ib8","search_text":"The logic behind this switch block is relatively simple: depending on the number of command-line arguments you have, you use either the initial values of the missing arguments or the values given by the user. For reasons of simplicity, the error variables of the strconv.Atoi() and strconv.ParseInt() functions are not being ignored using underscore characters. If this was a commercial program, the error variables of the strconv.Atoi() and strconv.ParseInt() functions would not have been ignored!","text_count":499,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The logic behind this"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"block is relatively simple: depending on the number of command-line arguments you have, you use either the initial values of the missing arguments or the values given by the user. For reasons of simplicity, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variables of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Atoi()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseInt()"}]},{"block_type":"text","content":"functions are not being ignored using underscore characters. If this was a commercial program, the error variables of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Atoi()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseInt()"}]},{"block_type":"text","content":"functions would not have been ignored!"}]},{"block_type":"element","block":"k6pz2ib9","search_text":"Last, the reason for using strconv.ParseInt() for setting a new value to the SEED variable is that the rand.Seed() function requires an int64 parameter. The first parameter of strconv.ParseInt() is the string to parse, the second parameter is the base of the generated number, and the third parameter is the bit size of the generated number. As we want to create a decimal integer that uses 64 bits, we are using 10 as the base and 64 as the bit size. Note that should you have wished to parse an unsigned integer, you should have used the strconv.ParseUint() function instead.","text_count":577,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Last, the reason for using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseInt()"}]},{"block_type":"text","content":"for setting a new value to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SEED"}]},{"block_type":"text","content":"variable is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rand.Seed()"}]},{"block_type":"text","content":"function requires an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int64"}]},{"block_type":"text","content":"parameter. The first parameter of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseInt()"}]},{"block_type":"text","content":"is the string to parse, the second parameter is the base of the generated number, and the third parameter is the bit size of the generated number. As we want to create a decimal integer that uses 64 bits, we are using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"10"}]},{"block_type":"text","content":"as the base and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"64"}]},{"block_type":"text","content":"as the bit size. Note that should you have wished to parse an unsigned integer, you should have used the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.ParseUint()"}]},{"block_type":"text","content":"function instead."}]},{"block_type":"element","block":"k6pz2iba","search_text":"The last part of randomNumbers.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"randomNumbers.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ibb","search_text":"rand.Seed(SEED) for i := 0; i < TOTAL; i++ { myrand := random(MIN, MAX) fmt.Print(myrand) fmt.Print(\" \") } fmt.Println() } ","text_count":123,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"rand.Seed(SEED) \n    for i := 0; i &lt; TOTAL; i++ { \n            myrand := random(MIN, MAX) \n            fmt.Print(myrand) \n            fmt.Print(\" \") \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2ibc","search_text":"Tip Instead of using the Unix epoch time as the seed for the random number generator, you can use the /dev/random system device. You will learn about reading from /dev/random in Chapter 8, Telling a Unix system What to Do . ","text_count":224,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Instead of using the Unix epoch time as the seed for the random number generator, you can use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"system device. You will learn about reading from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix system What to Do"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2ibd","search_text":"Executing randomNumbers.go will create the following type of output:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"randomNumbers.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ibe","search_text":"$ go run randomNumbers.go Using default values! 75 69 15 75 62 67 64 8 73 1 83 92 7 34 8 70 22 58 38 8 54 34 91 65 1 50 76 5 82 61 90 10 38 40 63 6 28 51 54 49 27 52 92 76 35 44 9 66 76 90 10 29 22 20 83 33 92 80 50 62 26 19 45 56 75 40 30 97 23 87 10 43 11 42 65 80 82 25 53 27 51 99 88 53 36 37 73 52 61 4 81 71 57 30 72 51 55 62 63 79 $ go run randomNumbers.go 1 3 2 Usage: ./randomNumbers MIN MAX TOTAL SEED 1 1 $ go run randomNumbers.go 1 3 2 Usage: ./randomNumbers MIN MAX TOTAL SEED 2 2 $ go run randomNumbers.go 1 5 10 10 3 1 4 4 1 1 4 4 4 3 $ go run randomNumbers.go 1 5 10 10 3 1 4 4 1 1 4 4 4 3 ","text_count":606,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run randomNumbers.go\nUsing default values!\n75 69 15 75 62 67 64 8 73 1 83 92 7 34 8 70 22 58 38 8 54 34 91 65 1 50 76 5 82 61 90 10 38 40 63 6 28 51 54 49 27 52 92 76 35 44 9 66 76 90 10 29 22 20 83 33 92 80 50 62 26 19 45 56 75 40 30 97 23 87 10 43 11 42 65 80 82 25 53 27 51 99 88 53 36 37 73 52 61 4 81 71 57 30 72 51 55 62 63 79\n$ go run randomNumbers.go 1 3 2\nUsage: ./randomNumbers MIN MAX TOTAL SEED\n1 1\n$ go run randomNumbers.go 1 3 2\nUsage: ./randomNumbers MIN MAX TOTAL SEED\n2 2\n$ go run randomNumbers.go 1 5 10 10\n3 1 4 4 1 1 4 4 4 3\n$ go run randomNumbers.go 1 5 10 10\n3 1 4 4 1 1 4 4 4 3"}]}]},{"block_type":"element","block":"k6pz2ibf","search_text":"If you are really interested in random number generation, you should start by reading the second volume of The Art of Computer Programming by Donald E. Knuth ( Addison-Wesley Professional , 2011 ).","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are really interested in random number generation, you should start by reading the second volume of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Art of Computer Programming"}]},{"block_type":"text","content":"by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Donald E. Knuth"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Addison-Wesley Professional"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"2011"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2ibg","search_text":"Should you wish to generate more secure random numbers in Go, use the crypto/rand package. This package implements a cryptographically secure pseudorandom number generator. You can find more information about the crypto/rand package by visiting its documentation page at https://golang.org/pkg/crypto/rand/ .","text_count":308,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Should you wish to generate more secure random numbers in Go, use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"crypto/rand"}]},{"block_type":"text","content":"package. This package implements a cryptographically secure pseudorandom number generator. You can find more information about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"crypto/rand"}]},{"block_type":"text","content":"package by visiting its documentation page at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/crypto/rand/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/crypto/rand/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ibh","search_text":"Generating random strings","text_count":25,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Generating random strings"}]},{"block_type":"element","block":"k6pz2ibi","search_text":"Once you know how a computer represents single characters, it is not difficult to go from random numbers to random strings. This section will present a technique for creating difficult-to-guess passwords based on the Go code of randomNumbers.go , which was presented in the previous section. The name of the Go program for this task will be generatePassword.go , and it will be presented in four parts. The utility requires just one command-line parameter, which is the length of the password that you want to generate.","text_count":519,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once you know how a computer represents single characters, it is not difficult to go from random numbers to random strings. This section will present a technique for creating difficult-to-guess passwords based on the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"randomNumbers.go"}]},{"block_type":"text","content":", which was presented in the previous section. The name of the Go program for this task will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The utility requires just one command-line parameter, which is the length of the password that you want to generate."}]},{"block_type":"element","block":"k6pz2ibj","search_text":"The first part of generatePassword.go contains the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ibk","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" \"time\" ) func random(min, max int) int { return rand.Intn(max-min) + min } ","text_count":130,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n) \n \nfunc random(min, max int) int { \n    return rand.Intn(max-min) + min \n}"}]}]},{"block_type":"element","block":"k6pz2ibl","search_text":"The second code portion of generatePassword.go contains the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ibm","search_text":"func main() { MIN := 0 MAX := 94 SEED := time.Now().Unix() var LENGTH int64 = 8 arguments := os.Args ","text_count":101,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    MIN := 0 \n    MAX := 94 \n    SEED := time.Now().Unix() \n    var LENGTH int64 = 8 \n \n    arguments := os.Args"}]}]},{"block_type":"element","block":"k6pz2ibn","search_text":"As we only want to get printable ASCII characters, we limit the range of random numbers that can be generated. The number of printable characters in the ASCII table is 94. This means that the range of the random numbers that the program can generate should be from 0 to 94, not including 94.","text_count":291,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As we only want to get printable ASCII characters, we limit the range of random numbers that can be generated. The number of printable characters in the ASCII table is 94. This means that the range of the random numbers that the program can generate should be from 0 to 94, not including 94."}]},{"block_type":"element","block":"k6pz2ibo","search_text":"The third code segment of generatePassword.go is shown in the following Go code:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ibp","search_text":"switch len(arguments) { case 2: LENGTH, _ = strconv.ParseInt(os.Args[1], 10, 64) default: fmt.Println(\"Using default values!\") } rand.Seed(SEED) ","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"switch len(arguments) { \n    case 2: \n            LENGTH, _ = strconv.ParseInt(os.Args[1], 10, 64) \n    default: \n            fmt.Println(\"Using default values!\") \n    } \n \n    rand.Seed(SEED)"}]}]},{"block_type":"element","block":"k6pz2ibq","search_text":"The last part of generatePassword.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ibr","search_text":"startChar := \"!\" var i int64 = 1 for { myRand := random(MIN, MAX) newChar := string(startChar[0] + byte(myRand)) fmt.Print(newChar) if i == LENGTH { break } i++ } fmt.Println() } ","text_count":179,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"startChar := \"!\" \n    var i int64 = 1 \n    for { \n            myRand := random(MIN, MAX) \n            newChar := string(startChar[0] + byte(myRand)) \n            fmt.Print(newChar) \n            if i == LENGTH { \n                    break \n            } \n            i++ \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2ibs","search_text":"The startChar variable holds the first ASCII character that can be generated by the utility, which in this case is the exclamation mark that has a decimal ASCII value of 33. Given that the program can generate random numbers up to 94, the maximum ASCII value that can be generated is 93 + 33, which is equal to 126, which is the ASCII value of ~ . The following output shows the ASCII table with the corresponding decimal values for each character:","text_count":448,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"startChar"}]},{"block_type":"text","content":"variable holds the first ASCII character that can be generated by the utility, which in this case is the exclamation mark that has a decimal ASCII value of 33. Given that the program can generate random numbers up to 94, the maximum ASCII value that can be generated is 93 + 33, which is equal to 126, which is the ASCII value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~"}]},{"block_type":"text","content":". The following output shows the ASCII table with the corresponding decimal values for each character:"}]},{"block_type":"element","block":"k6pz2ibt","search_text":"The decimal set: 0 nul 1 soh 2 st 3 etx 4 eot 5 enq 6 ack 7 bel 8 bs 9 ht 10 nl 11 vt 12 np 13 cr 14 so 15 si 16 dle 17 dc1 18 dc 19 dc3 20 dc4 21 nak 22 syn 23 etb 24 can 25 em 26 su 27 esc 28 fs 29 gs 30 rs 31 us 32 sp 33 ! 34 \" 35 # 36 $ 37 % 38 & 39 ' 40 ( 41 ) 42 * 43 + 44 , 45 - 46 . 47 / 48 0 49 1 50 2 51 3 52 4 53 5 54 6 55 7 56 8 57 9 58 : 59 ; 60 < 61 = 62 > 63 ? 64 @ 65 A 66 B 67 C 68 D 69 E 70 F 71 G 72 H 73 I 74 J 75 K 76 L 77 M 78 N 79 O 80 P 81 Q 82 R 83 S 84 T 85 U 86 V 87 W 88 X 89 Y 90 Z 91 [ 92 \\ 93 ] 94 ^ 95 _ 96 ' 97 a 98 b 99 c 100 d 101 e 102 f 103 g 104 h 105 i 106 j 107 k 108 l 109 m 110 n 111 o 112 p 113 q 114 r 115 s 116 t 117 u 118 v 119 w 120 x 121 y 122 z 123 { 124 | 125 } 126 ~ 127 del ","text_count":726,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"The decimal set:\n\n  0 nul   1 soh   2 st   3 etx   4 eot   5 enq   6 ack   7 bel\n  8 bs    9 ht   10 nl  11 vt   12 np   13 cr   14 so   15 si\n 16 dle  17 dc1  18 dc  19 dc3  20 dc4  21 nak  22 syn  23 etb\n 24 can  25 em   26 su  27 esc  28 fs   29 gs   30 rs   31 us\n 32 sp   33 !    34 \"   35 #    36 $    37 %    38 &amp;    39  '\n 40 (    41 )    42 *   43 +    44 ,    45 -    46 .    47  /\n 48 0    49 1    50 2   51 3    52 4    53 5    54 6    55  7\n 56 8    57 9    58 :   59 ;    60 &lt;    61 =    62 &gt;    63  ?\n 64 @    65 A    66 B   67 C    68 D    69 E    70 F    71  G\n 72 H    73 I    74 J   75 K    76 L    77 M    78 N    79  O\n 80 P    81 Q    82 R   83 S    84 T    85 U    86 V    87  W\n 88 X    89 Y    90 Z   91 [    92 \\    93 ]    94 ^    95  _\n 96 '    97 a    98 b   99 c    100 d   101 e   102 f  103  g\n104 h   105 i   106 j  107 k    108 l   109 m   110 n  111  o\n112 p   113 q   114 r  115 s    116 t   117 u   118 v  119  w\n120 x   121 y   122 z  123 {    124 |   125 }   126 ~  127 del"}]}]},{"block_type":"element","block":"k6pz2ibu","search_text":"Tip Typing man ascii on your favorite Unix shell will also generate the ASCII table in a readable form. ","text_count":104,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Typing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"man ascii"}]},{"block_type":"text","content":"on your favorite Unix shell will also generate the ASCII table in a readable form."}]}]},{"block_type":"element","block":"k6pz2ibv","search_text":"Executing generatePassword.go with the appropriate command-line parameters will create the following type of output:","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"with the appropriate command-line parameters will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ibw","search_text":"$ go run generatePassword.go Using default values! ugs$5mvl $ go run generatePassword.go Using default values! PA/8hA@? $ go run generatePassword.go 20 HBR+=3\\UA'B@ExT4QG|o $ go run generatePassword.go 20 XLcr|R{*pX/::'t2u^T' ","text_count":226,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run generatePassword.go\nUsing default values!\nugs$5mvl\n$ go run generatePassword.go\nUsing default values!\nPA/8hA@?\n$ go run generatePassword.go 20\nHBR+=3\\UA'B@ExT4QG|o\n$ go run generatePassword.go 20\nXLcr|R{*pX/::'t2u^T'"}]}]},{"block_type":"element","block":"k6pz2ibx","search_text":"Additional Resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional Resources"}]},{"block_type":"element","block":"k6pz2iby","search_text":"You should find the following resources very useful:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should find the following resources very useful:"}]},{"block_type":"element","block":"k6pz2ibz","search_text":"Examine the Graphviz utility website. This utility lets you draw graphs using its own language: http://graphviz.org/ . Read the documentation page of the sub packages of the container standard Go package by visiting https://golang.org/pkg/container/ . Should you wish to learn more about data structures, you should read The Design and Analysis of Computer Algorithms by Alfred V. Aho ,‎ John E. Hopcroft , and‎ Jeffrey D. Ullman ( Addison-Wesley , 1974 ). It is an excellent book! Other really interesting books about algorithms and data structures are Programming Pearls by Jon Bentley ( Addison-Wesley Professional , 1999 ) and More Programming Pearls: Confessions of a Coder also by John Bentley ( Addison-Wesley Professional , 1988 ). Reading both books will make you a better programmer! ","text_count":794,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Examine the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Graphviz"}]},{"block_type":"text","content":"utility website. This utility lets you draw graphs using its own language:"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://graphviz.org/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://graphviz.org/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Read the documentation page of the sub packages of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package by visiting"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/container/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/container/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Should you wish to learn more about data structures, you should read"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Design and Analysis of Computer Algorithms"}]},{"block_type":"text","content":"by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Alfred V. Aho"}]},{"block_type":"text","content":",&lrm;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"John E. Hopcroft"}]},{"block_type":"text","content":", and&lrm;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Jeffrey D. Ullman"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Addison-Wesley"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"1974"}]},{"block_type":"text","content":"). It is an excellent book!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Other really interesting books about algorithms and data structures are&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Programming Pearls"}]},{"block_type":"text","content":"&nbsp;by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Jon Bentley"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Addison-Wesley Professional"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"1999"}]},{"block_type":"text","content":") and&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"More Programming Pearls: Confessions of a Coder"}]},{"block_type":"text","content":"also by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"John Bentley"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Addison-Wesley Professional"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"1988"}]},{"block_type":"text","content":"). Reading both books will make you a better programmer!"}]}]},{"block_type":"element","block":"k6pz2ic0","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2ic1","search_text":"Try to change the logic behind generatePassword.go by picking the password from a list of passwords found in a Go slice combined with the current system time or date. Make the necessary changes to the code of queue.go in order to store floating-point numbers instead of integers. Change the Go code of stack.go so that its nodes have three data fields of integer type, named Value , Number , and Seed . Apart from the apparent changes to the definition of the Nodestruct , what is the main change that you will need to make to the rest of the program? Can you change the code in linkedList.go in order to keep the nodes of the linked list sorted? Similarly, can you change the Go code of doublyLList.go in order to keep the nodes of the list sorted? Can you develop a function for deleting existing nodes? Change the code of hashTableLookup.go so that you do not have duplicate values in your hash table. Use the lookup() function for that! Can you modify the Go code of generatePassword.go in order to generate passwords that only contain uppercase letters? Try to change the code of conHeap.go in order to support a custom and more complex structure instead of just float32 elements. Implement the delete node functionality that is missing from linkedList.go . Do you think that a doubly linked list would make the code of the queue.go program better? Try to implement a queue using a doubly linked list instead of a single linked list. ","text_count":1439,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to change the logic behind"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"by picking the password from a list of passwords found in a Go slice combined with the current system time or date."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Make the necessary changes to the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"in order to store floating-point numbers instead of integers."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Change the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stack.go"}]},{"block_type":"text","content":"so that its nodes have three data fields of integer type, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Value"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Number"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Seed"}]},{"block_type":"text","content":". Apart from the apparent changes to the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Nodestruct"}]},{"block_type":"text","content":", what is the main change that you will need to make to the rest of the program?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you change the code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"in order to keep the nodes of the linked list sorted?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Similarly, can you change the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doublyLList.go"}]},{"block_type":"text","content":"in order to keep the nodes of the list sorted? Can you develop a function for deleting existing nodes?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Change the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hashTableLookup.go"}]},{"block_type":"text","content":"so that you do not have duplicate values in your hash table. Use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookup()"}]},{"block_type":"text","content":"function for that!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"generatePassword.go"}]},{"block_type":"text","content":"in order to generate passwords that only contain uppercase letters?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to change the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"conHeap.go"}]},{"block_type":"text","content":"in order to support a custom and more complex structure instead of just"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float32"}]},{"block_type":"text","content":"elements."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Implement the delete node functionality that is missing from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"linkedList.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Do you think that a doubly linked list would make the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"queue.go"}]},{"block_type":"text","content":"program better? Try to implement a queue using a doubly linked list instead of a single linked list."}]}]},{"block_type":"element","block":"k6pz2ic2","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2ic3","search_text":"In this chapter, we discussed many interesting and useful topics related to Go data structures, including implementing linked lists, doubly linked lists, hash tables, queues, and stacks, as well as using the functionality of the container standard Go package and generating random numbers and difficult-to-guess passwords in Go. What you should remember from this chapter is that the foundation of every data structure is the definition and the implementation of its node.","text_count":472,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, we discussed many interesting and useful topics related to Go data structures, including implementing linked lists, doubly linked lists, hash tables, queues, and stacks, as well as using the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"container"}]},{"block_type":"text","content":"standard Go package and generating random numbers and difficult-to-guess passwords in Go. What you should remember from this chapter is that the foundation of every data structure is the definition and the implementation of its node."}]},{"block_type":"element","block":"k6pz2ic4","search_text":"I am sure that you will find the next chapter as one of the most interesting and valuable chapters of this book. The main topic of the next chapter is Go packages. It also includes information about how to define and use the various types of Go functions in your programs. So don't waste any more time—start reading it now!","text_count":323,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I am sure that you will find the next chapter as one of the most interesting and valuable chapters of this book. The main topic of the next chapter is Go packages. It also includes information about how to define and use the various types of Go functions in your programs. So don't waste any more time&mdash;start reading it now!"}]}]},{"title":"What You Might Not Know About Go Packages","author":"Mihalis Tsoukalos","block":"k6pz24jl","number":6,"contents":[{"block_type":"element","block":"k6pz2ic5","search_text":"In the previous chapter, we talked about developing and using custom data structures such as linked lists, binary trees, and hash tables as well as generating random numbers and difficult-to-guess passwords in Go.","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we talked about developing and using custom data structures such as linked lists, binary trees, and hash tables as well as generating random numbers and difficult-to-guess passwords in Go."}]},{"block_type":"element","block":"k6pz2ic6","search_text":"The main focus of this chapter is Go packages, which is the Go way of organizing, delivering, and using code. The most common components of a Go package are functions , which are pretty flexible in Go. In the last part of this chapter you will see some advanced packages that belong to the Go standard library in order to understand better that not all Go packages are created equal.","text_count":383,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main focus of this chapter is Go packages, which is the Go way of organizing, delivering, and using code. The most common components of a Go package are"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"functions"}]},{"block_type":"text","content":", which are pretty flexible in Go. In the last part of this chapter you will see some advanced packages that belong to the Go standard library in order to understand better that not all Go packages are created equal."}]},{"block_type":"element","block":"k6pz2ic7","search_text":"In this chapter of Mastering Go , you will learn the following topics:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2ic8","search_text":"Developing functions in Go Anonymous functions Functions that return multiple values Naming the return values of a function Functions that return other functions Functions that get other functions as parameters Developing Go packages Private and Public package objects Using the init() function in packages The sophisticated html/template standard Go package The text/template standard package, another truly sophisticated Go package that has its own language The syscall standard Go package, which is a low-level package that, although you might not use directly, it is used extensively by other Go packages ","text_count":609,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing functions in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Anonymous functions"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Functions that return multiple values"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Naming the return values of a function"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Functions that return other functions"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Functions that get other functions as parameters"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing Go packages"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Private and Public package objects"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function in packages"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The sophisticated"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"standard Go package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"standard package, another truly sophisticated Go package that has its own language"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package, which is a low-level package that, although you might not use directly, it is used extensively by other Go packages"}]}]},{"block_type":"element","block":"k6pz2ic9","search_text":"About Go packages","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About Go packages"}]},{"block_type":"element","block":"k6pz2ica","search_text":"Everything in Go is delivered in the form of packages. A Go package is a Go source file that begins with the package keyword followed by the name of the package. Some packages have a structure. For example, the net package has several subdirectories, named http , mail , rpc , smtp , textproto , and url , which should be imported as net/http , net/mail , net/rpc , net/smtp , net/textproto , and net/url , respectively.","text_count":420,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Everything in Go is delivered in the form of packages. A Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"package"}]},{"block_type":"text","content":"is a Go source file that begins with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"package"}]},{"block_type":"text","content":"keyword followed by the name of the package. Some packages have a structure. For example, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package has several subdirectories, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mail"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rpc"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"smtp"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textproto"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"url"}]},{"block_type":"text","content":", which should be imported as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/mail"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/rpc"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/smtp"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/textproto"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2icb","search_text":"Packages are mainly used for grouping related functions, variables, and constants so that you can transfer them easily and use them in your own Go programs. Note that apart from the main package, Go packages are not autonomous programs and cannot be compiled into executable files. This means that they need to be called directly or indirectly from a main package in order to be used. As a result, if you try to execute a Go package as if it was an autonomous program, you will be disappointed:","text_count":494,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Packages are mainly used for grouping related functions, variables, and constants so that you can transfer them easily and use them in your own Go programs. Note that apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package, Go packages are not autonomous programs and cannot be compiled into executable files. This means that they need to be called directly or indirectly from a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package in order to be used. As a result, if you try to execute a Go package as if it was an autonomous program, you will be disappointed:"}]},{"block_type":"element","block":"k6pz2icc","search_text":"$ go run aPackage.go go run: cannot run non-main package","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run aPackage.go\ngo run: cannot run non-main package"}]}]},{"block_type":"element","block":"k6pz2icd","search_text":"About Go functions","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About Go functions"}]},{"block_type":"element","block":"k6pz2ice","search_text":"Functions are an important element of every programming language because they allow you to break big programs into smaller and more manageable parts. Functions must be as independent from each other as possible and must do one job and only one job well. So, if you find yourselves writing functions that do multiple things, you might consider replacing them by multiple functions instead! The single most popular Go function is main() , which is used in every independent Go program. You should already know that function definitions begin with the func keyword.","text_count":562,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Functions"}]},{"block_type":"text","content":"are an important element of every programming language because they allow you to break big programs into smaller and more manageable parts. Functions must be as independent from each other as possible and must do one job and only one job well. So, if you find yourselves writing functions that do multiple things, you might consider replacing them by multiple functions instead! The single most popular Go function is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":", which is used in every independent Go program. You should already know that function definitions begin with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"func"}]},{"block_type":"text","content":"keyword."}]},{"block_type":"element","block":"k6pz2icf","search_text":"Anonymous functions","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Anonymous functions"}]},{"block_type":"element","block":"k6pz2icg","search_text":"Anonymous functions can be defined inline without the need for a name, and they are usually used for implementing things that require a small amount of code. In Go, a function can return an anonymous function or take an anonymous function as one of its arguments. Additionally, anonymous functions can be attached to Go variables.","text_count":330,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Anonymous functions"}]},{"block_type":"text","content":"can be defined inline without the need for a name, and they are usually used for implementing things that require a small amount of code. In Go, a function can return an anonymous function or take an anonymous function as one of its arguments. Additionally, anonymous functions can be attached to Go variables."}]},{"block_type":"element","block":"k6pz2ich","search_text":"Note that anonymous functions are also called closures , especially in functional programming terminology.","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that anonymous functions are also called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"closures"}]},{"block_type":"text","content":", especially in functional programming terminology."}]},{"block_type":"element","block":"k6pz2ici","search_text":"Tip It is considered a good practice for anonymous functions to have a small implementation and a local focus. If an anonymous function does not have a local focus, then you might need to consider making it a regular function. ","text_count":227,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is considered a good practice for anonymous functions to have a small implementation and a local focus. If an anonymous function does not have a local focus, then you might need to consider making it a regular function."}]}]},{"block_type":"element","block":"k6pz2icj","search_text":"When an anonymous function is suitable for a job, then it is extremely convenient and makes your life easier; just do not use too many anonymous functions in your programs without having a good reason. You will see anonymous functions in action in a little while.","text_count":263,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When an anonymous function is suitable for a job, then it is extremely convenient and makes your life easier; just do not use too many anonymous functions in your programs without having a good reason. You will see anonymous functions in action in a little while."}]},{"block_type":"element","block":"k6pz2ick","search_text":"Functions that return multiple values","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Functions that return multiple values"}]},{"block_type":"element","block":"k6pz2icl","search_text":"As you already know from functions such as strconv.Atoi() , Go functions can return multiple distinct values, which saves you from having to create a dedicated structure in order to be able to receive multiple values at once from a function. You can declare a function that returns four values, two int values, a float64 value, and a string , as follows:","text_count":354,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you already know from functions such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Atoi()"}]},{"block_type":"text","content":", Go functions can return multiple distinct values, which saves you from having to create a dedicated structure in order to be able to receive multiple values at once from a function. You can declare a function that returns four values, two"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"values, a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float64"}]},{"block_type":"text","content":"value, and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string"}]},{"block_type":"text","content":", as follows:"}]},{"block_type":"element","block":"k6pz2icm","search_text":"func aFunction() (int, int, float64, string) { }","text_count":48,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func aFunction() (int, int, float64, string) {\n}"}]}]},{"block_type":"element","block":"k6pz2icn","search_text":"It is now time to illustrate functions; that is, anonymous functions and functions that return multiple values in more detail using the Go code of functions.go as an example. The relevant code will be presented in five parts.","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is now time to illustrate functions; that is, anonymous functions and functions that return multiple values in more detail using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"as an example. The relevant code will be presented in five parts."}]},{"block_type":"element","block":"k6pz2ico","search_text":"The first code portion of functions.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2icp","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" )","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n\nimport ( \n   \"fmt\" \n   \"os\" \n   \"strconv\" \n)"}]}]},{"block_type":"element","block":"k6pz2icq","search_text":"The second code segment from functions.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2icr","search_text":"func doubleSquare(x int) (int, int) { return x * 2, x * x } ","text_count":60,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func doubleSquare(x int) (int, int) { \n   return x * 2, x * x \n}"}]}]},{"block_type":"element","block":"k6pz2ics","search_text":"Here you can see the definition and implementation of a function named doubleSquare() , which requires a single int parameter and returns two int values.","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see the definition and implementation of a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doubleSquare()"}]},{"block_type":"text","content":", which requires a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"parameter and returns two"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"values."}]},{"block_type":"element","block":"k6pz2ict","search_text":"The third part of the functions.go program is as follows:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2icu","search_text":"func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"The program needs 1 argument!\") return } y, err := strconv.Atoi(arguments[1]) if err != nil { fmt.Println(err) return } ","text_count":193,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   arguments := os.Args \n   if len(arguments) != 2 { \n         fmt.Println(\"The program needs 1 argument!\") \n         return \n   } \n \n   y, err := strconv.Atoi(arguments[1]) \n   if err != nil { \n          fmt.Println(err) \n          return \n   }"}]}]},{"block_type":"element","block":"k6pz2icv","search_text":"The preceding code deals with the command line arguments of the program.","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code deals with the command line arguments of the program."}]},{"block_type":"element","block":"k6pz2icw","search_text":"The fourth portion of the functions.go program contains the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth portion of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2icx","search_text":"square := func(s int) int { return s * s } fmt.Println(\"The square of\", y, \"is\", square(y)) double := func(s int) int { return s + s } fmt.Println(\"The double of\", y, \"is\", double(y)) ","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"square := func(s int) int { \n          return s * s \n   } \n   fmt.Println(\"The square of\", y, \"is\", square(y)) \n \n   double := func(s int) int { \n          return s + s \n   } \n   fmt.Println(\"The double of\", y, \"is\", double(y))"}]}]},{"block_type":"element","block":"k6pz2icy","search_text":"Each one of the square and double variables holds an anonymous function. The bad part is that you are allowed to change the value of square , double , or any other variable that holds an anonymous function afterwards, which means that the meaning of those variables can change and calculate something else instead.","text_count":314,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each one of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"double"}]},{"block_type":"text","content":"variables holds an anonymous function. The bad part is that you are allowed to change the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"double"}]},{"block_type":"text","content":", or any other variable that holds an anonymous function afterwards, which means that the meaning of those variables can change and calculate something else instead."}]},{"block_type":"element","block":"k6pz2icz","search_text":"Tip It is not considered a good programming practice to alter the code of variables that hold anonymous functions because this might be the root cause of nasty bugs! ","text_count":166,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is not considered a good programming practice to alter the code of variables that hold anonymous functions because this might be the root cause of nasty bugs!"}]}]},{"block_type":"element","block":"k6pz2id0","search_text":"The last part of functions.go is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2id1","search_text":"fmt.Println(doubleSquare(y)) d, s := doubleSquare(y) fmt.Println(d, s) } ","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(doubleSquare(y)) \n   d, s := doubleSquare(y) \n   fmt.Println(d, s) \n}"}]}]},{"block_type":"element","block":"k6pz2id2","search_text":"So, you can either print the return values of a function, such as doubleSquare() , or assign them to distinct variables.","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, you can either print the return values of a function, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"doubleSquare()"}]},{"block_type":"text","content":", or assign them to distinct variables."}]},{"block_type":"element","block":"k6pz2id3","search_text":"Executing functions.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"functions.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2id4","search_text":"$ go run functions.go 1 21 The program needs 1 argument! rMacBook:code mtsouk $ go run functions.go 10 The square of 10 is 100 The double of 10 is 20 20 100 20 100","text_count":163,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run functions.go 1 21\nThe program needs 1 argument!\nrMacBook:code mtsouk\n$ go run functions.go 10\nThe square of 10 is 100\nThe double of 10 is 20\n20 100\n20 100"}]}]},{"block_type":"element","block":"k6pz2id5","search_text":"The return values of a function can be named!","text_count":45,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The return values of a function can be named!"}]},{"block_type":"element","block":"k6pz2id6","search_text":"Unlike C, Go allows you to name the return values of a Go function. Additionally, when such a function has a return statement without any arguments, then the function automatically returns the current value of each named return value in the order in which they were declared in the definition of the function!","text_count":309,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Unlike C, Go allows you to name the return values of a Go function. Additionally, when such a function has a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return"}]},{"block_type":"text","content":"statement without any arguments, then the function automatically returns the current value of each named return value in the order in which they were declared in the definition of the function!"}]},{"block_type":"element","block":"k6pz2id7","search_text":"Tip Named returned values are a very handy Go feature that can save you from various types of bugs, so use them! My personal advice is to name the return values of your functions unless there is a very good reason not to do so. ","text_count":228,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Named returned values are a very handy Go feature that can save you from various types of bugs, so use them! My personal advice is to name the return values of your functions unless there is a very good reason not to do so."}]}]},{"block_type":"element","block":"k6pz2id8","search_text":"The source code that illustrates Go functions that have named return values is returnNames.go , and it will be presented in three parts.","text_count":136,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code that illustrates Go functions that have named return values is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnNames.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2id9","search_text":"The first part of the returnNames.go program is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnNames.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2ida","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" ) func namedMinMax(x, y int) (min, max int) { if x > y { min = y max = x } else { min = x max = y } return } ","text_count":152,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n   \"os\" \n   \"strconv\" \n) \n \nfunc namedMinMax(x, y int) (min, max int) { \n   if x &gt; y { \n        min = y \n        max = x \n   } else { \n        min = x \n        max = y \n   } \n   return \n}"}]}]},{"block_type":"element","block":"k6pz2idb","search_text":"In this code segment, you can see the implementation of the namedMinMax() function, which uses named return parameters. However, there is a tricky point here: the namedMinMax() function does not explicitly return any variables in its return statement. Nevertheless, as this function has named return values in its signature, the min and max parameters are automatically returned in the order in which they were put into the function definition.","text_count":444,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, you can see the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"namedMinMax()"}]},{"block_type":"text","content":"function, which uses named return parameters. However, there is a tricky point here: the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"namedMinMax()"}]},{"block_type":"text","content":"function does not explicitly return any variables in its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return"}]},{"block_type":"text","content":"statement. Nevertheless, as this function has named return values in its signature, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"min"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"max"}]},{"block_type":"text","content":"parameters are automatically returned in the order in which they were put into the function definition."}]},{"block_type":"element","block":"k6pz2idc","search_text":"The second code segment from returnNames.go follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnNames.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2idd","search_text":"func minMax(x, y int) (min, max int) { if x > y { min = y max = x } else { min = x max = y } return min, max } ","text_count":111,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func minMax(x, y int) (min, max int) { \n   if x &gt; y { \n         min = y \n         max = x \n   } else { \n         min = x \n         max = y \n   } \n   return min, max \n}"}]}]},{"block_type":"element","block":"k6pz2ide","search_text":"The minMax() function also uses named return values, but its return statement specifically defines the order and the variables that are going to be returned.","text_count":157,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"minMax()"}]},{"block_type":"text","content":"function also uses named return values, but its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return"}]},{"block_type":"text","content":"statement specifically defines the order and the variables that are going to be returned."}]},{"block_type":"element","block":"k6pz2idf","search_text":"The last code portion from returnNames.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnNames.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2idg","search_text":"func main() { arguments := os.Args if len(arguments) < 3 { fmt.Println(\"The program needs at least 2 arguments!\") return } a1, _ := strconv.Atoi(arguments[1]) a2, _ := strconv.Atoi(arguments[2]) fmt.Println(minMax(a1, a2)) min, max := minMax(a1, a2) fmt.Println(min, max) fmt.Println(namedMinMax(a1, a2)) min, max = namedMinMax(a1, a2) fmt.Println(min, max) } ","text_count":360,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   arguments := os.Args \n   if len(arguments) &lt; 3 { \n         fmt.Println(\"The program needs at least 2 arguments!\") \n         return \n   } \n \n   a1, _ := strconv.Atoi(arguments[1]) \n   a2, _ := strconv.Atoi(arguments[2]) \n \n   fmt.Println(minMax(a1, a2)) \n   min, max := minMax(a1, a2) \n   fmt.Println(min, max) \n \n   fmt.Println(namedMinMax(a1, a2)) \n   min, max = namedMinMax(a1, a2) \n   fmt.Println(min, max) \n}"}]}]},{"block_type":"element","block":"k6pz2idh","search_text":"The purpose of the Go code in the main() function is to verify that all methods generate the same results.","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the Go code in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function is to verify that all methods generate the same results."}]},{"block_type":"element","block":"k6pz2idi","search_text":"Executing returnNames.go will produce the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnNames.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2idj","search_text":"$ go run returnNames.go -20 1 -20 1 -20 1 -20 1 -20 1","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run returnNames.go -20 1\n-20 1\n-20 1\n-20 1\n-20 1"}]}]},{"block_type":"element","block":"k6pz2idk","search_text":"Functions with pointer parameters","text_count":33,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Functions with pointer parameters"}]},{"block_type":"element","block":"k6pz2idl","search_text":"Function can take pointer parameters provided that their signature allows it. The Go code of ptrFun.go will illustrate the use of pointers as function parameters.","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Function can take pointer parameters provided that their signature allows it. The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptrFun.go"}]},{"block_type":"text","content":"will illustrate the use of pointers as function parameters."}]},{"block_type":"element","block":"k6pz2idm","search_text":"The first part of ptrFun.go follows next:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptrFun.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2idn","search_text":"package main import ( \"fmt\" ) func getPtr(v *float64) float64 { return *v * *v } ","text_count":81,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n) \n \nfunc getPtr(v *float64) float64 { \n   return *v * *v \n}"}]}]},{"block_type":"element","block":"k6pz2ido","search_text":"So, the getPtr() function accepts a pointer parameter that points to a float64 value.","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPtr()"}]},{"block_type":"text","content":"function accepts a pointer parameter that points to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float64"}]},{"block_type":"text","content":"value."}]},{"block_type":"element","block":"k6pz2idp","search_text":"The second part of the program is shown in the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the program is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2idq","search_text":"func main() { x := 12.2 fmt.Println(getPtr(&x)) x = 12 fmt.Println(getPtr(&x)) } ","text_count":81,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   x := 12.2 \n   fmt.Println(getPtr(&amp;x)) \n   x = 12 \n   fmt.Println(getPtr(&amp;x)) \n}"}]}]},{"block_type":"element","block":"k6pz2idr","search_text":"The tricky part here is that you need to pass the address of the variable to the getPtr() function because it requires a pointer parameter, which can be done by putting an ampersand in front of a variable ( &x ).","text_count":212,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The tricky part here is that you need to pass the address of the variable to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPtr()"}]},{"block_type":"text","content":"function because it requires a pointer parameter, which can be done by putting an ampersand in front of a variable ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&amp;x"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2ids","search_text":"Executing ptrFun.go will generate the following kind of output:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptrFun.go"}]},{"block_type":"text","content":"will generate the following kind of output:"}]},{"block_type":"element","block":"k6pz2idt","search_text":"$ go run ptrFun.go 148.83999999999997 144","text_count":41,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run ptrFun.go\n148.83999999999997\n144"}]}]},{"block_type":"element","block":"k6pz2idu","search_text":"If you try to pass a plain value such as 12.12 to getPtr() and call it like getPtr(12.12) , the compilation of the program will fail, as shown in the following the next error message:","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to pass a plain value such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"12.12"}]},{"block_type":"text","content":"to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPtr()"}]},{"block_type":"text","content":"and call it like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"getPtr(12.12)"}]},{"block_type":"text","content":", the compilation of the program will fail, as shown in the following the next error message:"}]},{"block_type":"element","block":"k6pz2idv","search_text":"$ go run ptrFun.go # command-line-arguments ./ptrFun.go:15:21: cannot use 12.12 (type float64) as type *float64 in argument to getPtr","text_count":133,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run ptrFun.go\n# command-line-arguments\n./ptrFun.go:15:21: cannot use 12.12 (type float64) as type *float64 in argument to getPtr"}]}]},{"block_type":"element","block":"k6pz2idw","search_text":"Functions that return pointers","text_count":30,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Functions that return pointers"}]},{"block_type":"element","block":"k6pz2idx","search_text":"As you learned in Chapter 4, The Uses of Composite Types , as illustrated in the pointerStruct.go program, it is considered a good practice to create new structure variables using a separate function and return a pointer to them from that function. So, the scenario of functions returning pointers is very common. Generally speaking, such a function simplifies the structure of a program and allows the developer to concentrate on more important things instead of copying the same Go code all the time. This section will use a much simpler example, as found in the Go code of returnPtr.go .","text_count":590,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you learned in Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":", as illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pointerStruct.go"}]},{"block_type":"text","content":"program, it is considered a good practice to create new structure variables using a separate function and return a pointer to them from that function. So, the scenario of functions returning pointers is very common. Generally speaking, such a function simplifies the structure of a program and allows the developer to concentrate on more important things instead of copying the same Go code all the time. This section will use a much simpler example, as found in the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPtr.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2idy","search_text":"The first part of returnPtr.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPtr.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2idz","search_text":"package main import ( \"fmt\" ) func returnPtr(x int) *int { y := x * x return &y } ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n) \n \nfunc returnPtr(x int) *int { \n   y := x * x \n   return &amp;y \n}"}]}]},{"block_type":"element","block":"k6pz2ie0","search_text":"Apart from the expected preamble, this portion defines a new function that returns a pointer to an int variable. The only thing to remember is to use &y in the return statement in order to return the memory address of the y variable.","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the expected preamble, this portion defines a new function that returns a pointer to an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"variable. The only thing to remember is to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&amp;y"}]},{"block_type":"text","content":"in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return"}]},{"block_type":"text","content":"statement in order to return the memory address of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"y"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2ie1","search_text":"The second part of returnPtr.go is as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPtr.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ie2","search_text":"func main() { sq := returnPtr(10) fmt.Println(\"sq:\", *sq) ","text_count":58,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   sq := returnPtr(10) \n   fmt.Println(\"sq:\", *sq)"}]}]},{"block_type":"element","block":"k6pz2ie3","search_text":"As you already know, the * character dereferences a pointer variable , which means that it returns the actual value stored at the memory address instead of the memory address itself.","text_count":182,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you already know, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*"}]},{"block_type":"text","content":"character"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"dereferences a pointer variable"}]},{"block_type":"text","content":", which means that it returns the actual value stored at the memory address instead of the memory address itself."}]},{"block_type":"element","block":"k6pz2ie4","search_text":"The last code segment from returnPtr.go is shown in the following Go code:","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPtr.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ie5","search_text":"fmt.Println(\"sq:\", sq) } ","text_count":25,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"sq:\", sq) \n}"}]}]},{"block_type":"element","block":"k6pz2ie6","search_text":"The preceding code will return the memory address of the sq variable, not the int value stored in it!","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code will return the memory address of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sq"}]},{"block_type":"text","content":"variable, not the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"value stored in it!"}]},{"block_type":"element","block":"k6pz2ie7","search_text":"If you execute returnPtr.go , you will see the following output (the memory address will differ):","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnPtr.go"}]},{"block_type":"text","content":", you will see the following output (the memory address will differ):"}]},{"block_type":"element","block":"k6pz2ie8","search_text":"$ go run returnPtr.go sq: 100 sq: 0xc420014088","text_count":46,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run returnPtr.go\nsq: 100\nsq: 0xc420014088"}]}]},{"block_type":"element","block":"k6pz2ie9","search_text":"Functions that return other functions","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Functions that return other functions"}]},{"block_type":"element","block":"k6pz2iea","search_text":"In this section, you are going to learn how to implement a Go function that returns another function using the Go code of returnFunction.go , which will be presented in three segments.","text_count":184,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you are going to learn how to implement a Go function that returns another function using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":", which will be presented in three segments."}]},{"block_type":"element","block":"k6pz2ieb","search_text":"The first code segment of returnFunction.go is as follows:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iec","search_text":"package main import ( \"fmt\" ) func funReturnFun() func() int { i := 0 return func() int { i++ return i * i } } ","text_count":111,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n) \n \nfunc funReturnFun() func() int { \n   i := 0 \n   return func() int { \n         i++ \n         return i * i \n   } \n}"}]}]},{"block_type":"element","block":"k6pz2ied","search_text":"As you can see from the implementation of funReturnFun() , its return value is an anonymous function!","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funReturnFun()"}]},{"block_type":"text","content":", its return value is an anonymous function!"}]},{"block_type":"element","block":"k6pz2iee","search_text":"The second code segment from returnFunction.go contains the following code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2ief","search_text":"func main() { i := funReturnFun() j := funReturnFun() ","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   i := funReturnFun() \n   j := funReturnFun()"}]}]},{"block_type":"element","block":"k6pz2ieg","search_text":"In this code, you call funReturnFun() two times and assign its return value, which is a function, to two separate variables named i and j . As you will see in the output of the program, the two variables are totally unrelated to each other.","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code, you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funReturnFun()"}]},{"block_type":"text","content":"two times and assign its return value, which is a function, to two separate variables named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":". As you will see in the output of the program, the two variables are totally unrelated to each other."}]},{"block_type":"element","block":"k6pz2ieh","search_text":"The last code section of returnFunction.go follows next:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code section of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iei","search_text":"fmt.Println(\"1:\", i()) fmt.Println(\"2:\", i()) fmt.Println(\"j1:\", j()) fmt.Println(\"j2:\", j()) fmt.Println(\"3:\", i()) } ","text_count":119,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"1:\", i()) \n   fmt.Println(\"2:\", i()) \n   fmt.Println(\"j1:\", j()) \n   fmt.Println(\"j2:\", j()) \n   fmt.Println(\"3:\", i()) \n}"}]}]},{"block_type":"element","block":"k6pz2iej","search_text":"So, in this Go code, you use the i variable three times as i() and the j variable two times as j() . The important thing here is that although both i and j were created by calling funReturnFun() , they are totally independent of each other and share nothing. As a result, although their return values come from the same sequence, they do not interfere with each other in any way.","text_count":379,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, in this Go code, you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"variable three times as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i()"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"variable two times as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j()"}]},{"block_type":"text","content":". The important thing here is that although both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j"}]},{"block_type":"text","content":"were created by calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funReturnFun()"}]},{"block_type":"text","content":", they are totally independent of each other and share nothing. As a result, although their return values come from the same sequence, they do not interfere with each other in any way."}]},{"block_type":"element","block":"k6pz2iek","search_text":"Executing returnFunction.go will produce the following output:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2iel","search_text":"$ go run returnFunction.go 1: 1 2: 4 j1: 1 j2: 4 3: 9","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run returnFunction.go\n1: 1\n2: 4\nj1: 1\nj2: 4\n3: 9"}]}]},{"block_type":"element","block":"k6pz2iem","search_text":"As you can see from the output of returnFunction.go , the value of i in funReturnFun() keeps increasing and does not become 0 after each call either to i() or j() .","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"returnFunction.go"}]},{"block_type":"text","content":", the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funReturnFun()"}]},{"block_type":"text","content":"keeps increasing and does not become"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"after each call either to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i()"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ien","search_text":"Functions that accept other functions as parameters","text_count":51,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Functions that accept other functions as parameters"}]},{"block_type":"element","block":"k6pz2ieo","search_text":"Go functions can accept other Go functions as parameters, which is a feature that adds versatility to what you can do with a Go function. The single most common use of this functionality is for sorting elements. However, in the example presented here, which is named funFun.go , we will implement a much simpler case that deals with integer values. The relevant code will be presented in three parts.","text_count":400,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go functions can accept other Go functions as parameters, which is a feature that adds versatility to what you can do with a Go function. The single most common use of this functionality is for sorting elements. However, in the example presented here, which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun.go"}]},{"block_type":"text","content":", we will implement a much simpler case that deals with integer values. The relevant code will be presented in three parts."}]},{"block_type":"element","block":"k6pz2iep","search_text":"The first code segment of funFun.go is shown in the following Go code:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ieq","search_text":"package main import \"fmt\" func function1(i int) int { return i + i } func function2(i int) int { return i * i } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport \"fmt\" \n \nfunc function1(i int) int { \n   return i + i \n} \n \nfunc function2(i int) int { \n   return i * i \n}"}]}]},{"block_type":"element","block":"k6pz2ier","search_text":"What we have here is two functions that both accept an int and return an int . These functions will be used as parameters to another function in a short while.","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What we have here is two functions that both accept an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"and return an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":". These functions will be used as parameters to another function in a short while."}]},{"block_type":"element","block":"k6pz2ies","search_text":"The second code segment of funFun.go contains the following code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2iet","search_text":"func funFun(f func(int) int, v int) int { return f(v) } ","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func funFun(f func(int) int, v int) int { \n   return f(v) \n}"}]}]},{"block_type":"element","block":"k6pz2ieu","search_text":"The funFun() function accepts two parameters, a function parameter named f and an int value. The f parameter should be a function that takes one int argument and returns an int value.","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun()"}]},{"block_type":"text","content":"function accepts two parameters, a function parameter named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f"}]},{"block_type":"text","content":"and an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"value. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f"}]},{"block_type":"text","content":"parameter should be a function that takes one"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"argument and returns an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"value."}]},{"block_type":"element","block":"k6pz2iev","search_text":"The last code segment of funFun.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iew","search_text":"func main() { fmt.Println(\"function1:\", funFun(function1, 123)) fmt.Println(\"function2:\", funFun(function2, 123)) fmt.Println(\"Inline:\", funFun(func(i int) int {return i * i *i}, 123)) } ","text_count":187,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   fmt.Println(\"function1:\", funFun(function1, 123)) \n   fmt.Println(\"function2:\", funFun(function2, 123)) \n   fmt.Println(\"Inline:\", funFun(func(i int) int {return i * i  *i}, 123)) \n}"}]}]},{"block_type":"element","block":"k6pz2iex","search_text":"The first fmt.Println() call uses funFun() with function1 without any parentheses as its first parameter, whereas the second fmt.Println() call uses funFun() with function2 as its first parameter.","text_count":196,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"call uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun()"}]},{"block_type":"text","content":"with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function1"}]},{"block_type":"text","content":"without any parentheses as its first parameter, whereas the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"call uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun()"}]},{"block_type":"text","content":"with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function2"}]},{"block_type":"text","content":"as its first parameter."}]},{"block_type":"element","block":"k6pz2iey","search_text":"In the last fmt.Println() statement, something magical happens: the implementation of the function parameter is defined inside the call to funFun() ! Although this method works fine for simple and small function parameters, it might not work that well for functions with many lines of Go code.","text_count":293,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the last"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"statement, something magical happens: the implementation of the function parameter is defined inside the call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun()"}]},{"block_type":"text","content":"! Although this method works fine for simple and small function parameters, it might not work that well for functions with many lines of Go code."}]},{"block_type":"element","block":"k6pz2iez","search_text":"Executing funFun.go will produce the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funFun.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2if0","search_text":"$ go run funFun.go function1: 246 function2: 15129 Inline: 1860867","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run funFun.go\nfunction1: 246\nfunction2: 15129\nInline: 1860867"}]}]},{"block_type":"element","block":"k6pz2if1","search_text":"Developing your own Go packages","text_count":31,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Developing your own Go packages"}]},{"block_type":"element","block":"k6pz2if2","search_text":"The source code of a Go package, which can contain multiple files and multiple directories, can be found within a single directory that is named after the package name with the obvious exception of the main package that can be located anywhere.","text_count":244,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of a Go package, which can contain multiple files and multiple directories, can be found within a single directory that is named after the package name with the obvious exception of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package that can be located anywhere."}]},{"block_type":"element","block":"k6pz2if3","search_text":"For the purposes of this section, a simple Go package named aPackage will be developed. The source file of the package is called aPackage.go , and its source code will be presented in two parts.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the purposes of this section, a simple Go package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aPackage"}]},{"block_type":"text","content":"will be developed. The source file of the package is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aPackage.go"}]},{"block_type":"text","content":", and its source code will be presented in two parts."}]},{"block_type":"element","block":"k6pz2if4","search_text":"The first part of aPackage.go is shown in the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aPackage.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2if5","search_text":"package aPackage import ( \"fmt\" ) func A() { fmt.Println(\"This is function A!\") } ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package aPackage \n\nimport ( \n   \"fmt\" \n) \n \nfunc A() { \n   fmt.Println(\"This is function A!\") \n}"}]}]},{"block_type":"element","block":"k6pz2if6","search_text":"The second code segment of aPackage.go follows next:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aPackage.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2if7","search_text":"func B() { fmt.Println(\"privateConstant:\", privateConstant) } const MyConstant = 123 const privateConstant = 21 ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func B() { \n   fmt.Println(\"privateConstant:\", privateConstant) \n} \n \nconst MyConstant = 123 \nconst privateConstant = 21"}]}]},{"block_type":"element","block":"k6pz2if8","search_text":"As you can see, developing a new Go package is pretty easy! Right now you cannot use that package on its own, and you need to create a package named main with a main() function in it in order to create an executable file. In this case, the name of program that will use aPackage is useAPackage.go , and it's included in the following Go code:","text_count":342,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, developing a new Go package is pretty easy! Right now you cannot use that package on its own, and you need to create a package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"with a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function in it in order to create an executable file. In this case, the name of program that will use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aPackage"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useAPackage.go"}]},{"block_type":"text","content":", and it's included in the following Go code:"}]},{"block_type":"element","block":"k6pz2if9","search_text":"package main import ( \"aPackage\" \"fmt\" ) func main() { fmt.Println(\"Using aPackage!\") aPackage.A() aPackage.B() fmt.Println(aPackage.MyConstant) } ","text_count":147,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"aPackage\" \n   \"fmt\" \n) \n \nfunc main() { \n   fmt.Println(\"Using aPackage!\") \n   aPackage.A() \n   aPackage.B() \n   fmt.Println(aPackage.MyConstant) \n}"}]}]},{"block_type":"element","block":"k6pz2ifa","search_text":"If you try to execute useAPackage.go right now, however, you will get an error message, which means that you are not done yet:","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useAPackage.go"}]},{"block_type":"text","content":"right now, however, you will get an error message, which means that you are not done yet:"}]},{"block_type":"element","block":"k6pz2ifb","search_text":"$ go run useAPackage.go useAPackage.go:4:2: cannot find package \"aPackage\" in any of: /usr/local/Cellar/go/1.9.2/libexec/src/aPackage (from $GOROOT) /Users/mtsouk/go/src/aPackage (from $GOPATH)","text_count":193,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useAPackage.go\nuseAPackage.go:4:2: cannot find package \"aPackage\" in any of:\n      /usr/local/Cellar/go/1.9.2/libexec/src/aPackage (from $GOROOT)\n      /Users/mtsouk/go/src/aPackage (from $GOPATH)"}]}]},{"block_type":"element","block":"k6pz2ifc","search_text":"There is another thing that you will also need to handle. As you already know from Chapter 1, Go and the Operating System , Go requires to execute specific commands from the Unix shell in order to install all external packages, which also includes packages that you have developed. Therefore, you will need to put the preceding package in the appropriate directory and make it available to the current Unix user. Thus, installing one of your own packages involves the execution of the following commands from your favorite Unix shell:","text_count":534,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is another thing that you will also need to handle. As you already know from Chapter 1,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go and the Operating System"}]},{"block_type":"text","content":", Go requires to execute specific commands from the Unix shell in order to install all external packages, which also includes packages that you have developed. Therefore, you will need to put the preceding package in the appropriate directory and make it available to the current Unix user. Thus, installing one of your own packages involves the execution of the following commands from your favorite Unix shell:"}]},{"block_type":"element","block":"k6pz2ifd","search_text":"$ mkdir ~/go/src/aPackage $ cp aPackage.go ~/go/src/aPackage/ $ go install aPackage $ cd ~/go/pkg/darwin_amd64/ $ ls -l aPackage.a -rw-r--r-- 1 mtsouk staff 4980 Dec 22 06:12 aPackage.a","text_count":185,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir ~/go/src/aPackage\n$ cp aPackage.go ~/go/src/aPackage/\n$ go install aPackage\n$ cd ~/go/pkg/darwin_amd64/\n$ ls -l aPackage.a\n-rw-r--r--  1 mtsouk  staff  4980 Dec 22 06:12 aPackage.a"}]}]},{"block_type":"element","block":"k6pz2ife","search_text":"Note If the ~/go directory does not already exist, you will need to create it with the help of the mkdir(1) command. In that case, you will also need to do the same for the ~/go/src directory. ","text_count":193,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go"}]},{"block_type":"text","content":"directory does not already exist, you will need to create it with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mkdir(1)"}]},{"block_type":"text","content":"command. In that case, you will also need to do the same for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go/src"}]},{"block_type":"text","content":"directory."}]}]},{"block_type":"element","block":"k6pz2iff","search_text":"Executing useAPackage.go will create the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useAPackage.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2ifg","search_text":"$ go run useAPackage.go Using aPackage! This is function A! privateConstant: 21 123 ","text_count":84,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useAPackage.go \nUsing aPackage! \nThis is function A! \nprivateConstant: 21 \n123"}]}]},{"block_type":"element","block":"k6pz2ifh","search_text":"Compiling a Go package","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Compiling a Go package"}]},{"block_type":"element","block":"k6pz2ifi","search_text":"Although you cannot execute a Go package if it does not include a main() function, you are still allowed to compile it and create an object file as follows:","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you cannot execute a Go package if it does not include a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, you are still allowed to compile it and create an object file as follows:"}]},{"block_type":"element","block":"k6pz2ifj","search_text":"$ go tool compile aPackage.go $ ls -l aPackage.* -rw-r--r--@ 1 mtsouk staff 201 Dec 22 06:06 aPackage.go -rw-r--r-- 1 mtsouk staff 4677 Dec 22 06:20 aPackage.o","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool compile aPackage.go\n$ ls -l aPackage.*\n-rw-r--r--@ 1 mtsouk  staff   201 Dec 22 06:06 aPackage.go\n-rw-r--r--  1 mtsouk  staff  4677 Dec 22 06:20 aPackage.o"}]}]},{"block_type":"element","block":"k6pz2ifk","search_text":"If you successfully compile a Go package that you are developing using the preceding method, you must also make sure that you do not have any syntax errors in your code.","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you successfully compile a Go package that you are developing using the preceding method, you must also make sure that you do not have any syntax errors in your code."}]},{"block_type":"element","block":"k6pz2ifl","search_text":"Private variables and functions","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Private variables and functions"}]},{"block_type":"element","block":"k6pz2ifm","search_text":"What differentiates private variables and functions from public ones is that private ones can be strictly used and called internally in a package. Controlling which functions, constants, and variables are public or not is also known as encapsulation .","text_count":251,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What differentiates private variables and functions from public ones is that private ones can be strictly used and called internally in a package. Controlling which functions, constants, and variables are public or not is also known as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"encapsulation"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ifn","search_text":"Go follows a simple rule which states that functions, variables, types, and so forth that begin with an uppercase letter are public, whereas functions, variables, types, and so on that begin with a lowercase letter are private. This is the reason that fmt.Println() is named Println() instead of println() . However, this rule does not affect package names that are allowed to begin with uppercase and lowercase letters.","text_count":420,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go follows a simple rule which states that functions, variables, types, and so forth that begin with an uppercase letter are public, whereas functions, variables, types, and so on that begin with a lowercase letter are private. This is the reason that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Println()"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"println()"}]},{"block_type":"text","content":". However, this rule does not affect package names that are allowed to begin with uppercase and lowercase letters."}]},{"block_type":"element","block":"k6pz2ifo","search_text":"The init() function","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The init() function"}]},{"block_type":"element","block":"k6pz2ifp","search_text":"Every Go package can optionally have a function named init() that is automatically executed at the beginning of the execution time.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Every Go package can optionally have a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"that is automatically executed at the beginning of the execution time."}]},{"block_type":"element","block":"k6pz2ifq","search_text":"Note The init() function is a private function by design, which means that it cannot be called from outside the package in which it is contained. Additionally, as the user of a package has no control over the init() function, you should think carefully before using an init() function in public packages. ","text_count":305,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function is a private function by design, which means that it cannot be called from outside the package in which it is contained. Additionally, as the user of a package has no control over the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function, you should think carefully before using an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function in public packages."}]}]},{"block_type":"element","block":"k6pz2ifr","search_text":"I will now present a code example with multiple init() functions from multiple Go packages. Examine the code of the following basic Go package, which is simply called a :","text_count":170,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I will now present a code example with multiple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"functions from multiple Go packages. Examine the code of the following basic Go package, which is simply called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ifs","search_text":"package a import ( \"fmt\" ) func init() { fmt.Println(\"init() a\") } func FromA() { fmt.Println(\"fromA()\") } ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package a \n \nimport ( \n   \"fmt\" \n) \n \nfunc init() { \n   fmt.Println(\"init() a\") \n} \n \nfunc FromA() { \n   fmt.Println(\"fromA()\") \n}"}]}]},{"block_type":"element","block":"k6pz2ift","search_text":"The a package implements an init() function and a public one named FromA() .","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"package implements an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function and a public one named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FromA()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ifu","search_text":"After that, you will need to execute the following commands from your Unix shell so that the package becomes available to the current Unix user:","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After that, you will need to execute the following commands from your Unix shell so that the package becomes available to the current Unix user:"}]},{"block_type":"element","block":"k6pz2ifv","search_text":"$ mkdir ~/go/src/a $ cp a.go ~/go/src/a/ $ go install a","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir ~/go/src/a\n$ cp a.go ~/go/src/a/\n$ go install a"}]}]},{"block_type":"element","block":"k6pz2ifw","search_text":"Now, look at the code of the next Go code package, which is named b :","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now, look at the code of the next Go code package, which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ifx","search_text":"package b import ( \"a\" \"fmt\" ) func init() { fmt.Println(\"init() b\") } func FromB() { fmt.Println(\"fromB()\") a.FromA() } ","text_count":121,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package b \n \nimport ( \n   \"a\" \n   \"fmt\" \n) \n \nfunc init() { \n   fmt.Println(\"init() b\") \n} \n \nfunc FromB() { \n   fmt.Println(\"fromB()\") \n   a.FromA() \n}"}]}]},{"block_type":"element","block":"k6pz2ify","search_text":"What is happening here? Package a uses the fmt standard Go package. However, package b needs to import package a as it uses a.FromA() . Both a and b have an init() function.","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What is happening here? Package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"standard Go package. However, package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"needs to import package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"as it uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a.FromA()"}]},{"block_type":"text","content":". Both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"have an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2ifz","search_text":"As before, you will need to install that package and make it available to the current Unix user by executing the following commands from your Unix shell:","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As before, you will need to install that package and make it available to the current Unix user by executing the following commands from your Unix shell:"}]},{"block_type":"element","block":"k6pz2ig0","search_text":"$ mkdir ~/go/src/b $ cp b.go ~/go/src/b $ go install b","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir ~/go/src/b\n$ cp b.go ~/go/src/b\n$ go install b"}]}]},{"block_type":"element","block":"k6pz2ig1","search_text":"Thus, we currently have two Go packages that both have an init() function. Now try to guess the output that you will get from executing manyInit.go , which has the following code:","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, we currently have two Go packages that both have an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function. Now try to guess the output that you will get from executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyInit.go"}]},{"block_type":"text","content":", which has the following code:"}]},{"block_type":"element","block":"k6pz2ig2","search_text":"package main import ( \"a\" \"b\" \"fmt\" ) func init() { fmt.Println(\"init() manyInit\") } func main() { a.FromA() b.FromB() } ","text_count":121,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"a\" \n   \"b\" \n   \"fmt\" \n) \n \nfunc init() { \n   fmt.Println(\"init() manyInit\") \n} \n \nfunc main() { \n   a.FromA() \n   b.FromB() \n}"}]}]},{"block_type":"element","block":"k6pz2ig3","search_text":"The actual question could have been: How many times is the init() function of package a going to be executed? Executing manyInit.go will generate the following output and shed some light on this question:","text_count":204,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The actual question could have been: How many times is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function of package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"going to be executed? Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyInit.go"}]},{"block_type":"text","content":"will generate the following output and shed some light on this question:"}]},{"block_type":"element","block":"k6pz2ig4","search_text":"$ go run manyInit.go init() a init() b init() manyInit fromA() fromB() fromA()","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run manyInit.go\ninit() a\ninit() b\ninit() manyInit\nfromA()\nfromB()\nfromA()"}]}]},{"block_type":"element","block":"k6pz2ig5","search_text":"The preceding output shows that the init() function of a was executed only once, despite the fact that the a package is imported two times by two different packages. Additionally, as the import block from manyInit.go is executed first, the init() function of package a and package b are executed before the init() function of manyInit.go , which makes perfect sense. The main reason for this is that the init() function of manyInit.go is allowed to use an element from either a or b .","text_count":484,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output shows that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"was executed only once, despite the fact that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"package is imported two times by two different packages. Additionally, as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"block from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyInit.go"}]},{"block_type":"text","content":"is executed first, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function of package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"and package"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"are executed before the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyInit.go"}]},{"block_type":"text","content":", which makes perfect sense. The main reason for this is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"init()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyInit.go"}]},{"block_type":"text","content":"is allowed to use an element from either"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ig6","search_text":"Reading the Go code of a standard Go package","text_count":44,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reading the Go code of a standard Go package"}]},{"block_type":"element","block":"k6pz2ig7","search_text":"In this section, you will learn some techniques for reading the Go code of existing Go packages. Generally speaking, regularly studying Go code developed by experienced programmers is a very good habit that will increase the quality of your own Go code, so do not underestimate its value.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn some techniques for reading the Go code of existing Go packages. Generally speaking, regularly studying Go code developed by experienced programmers is a very good habit that will increase the quality of your own Go code, so do not underestimate its value."}]},{"block_type":"element","block":"k6pz2ig8","search_text":"Now we are going to have a quick look at the Go code of net/url and log/syslog .","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now we are going to have a quick look at the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ig9","search_text":"Exploring the code of the net/url package","text_count":41,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Exploring the code of the net/url package"}]},{"block_type":"element","block":"k6pz2iga","search_text":"On a macOS machine that uses Homebrew, you can find the Go code of the net/url package at /usr/local/Cellar/go/1.9.2/libexec/src/net/url/url.go . If for some reason you cannot locate the source code of the net/url package on your Unix machine, you can execute the following command and wait for its output:","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On a macOS machine that uses Homebrew, you can find the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/usr/local/Cellar/go/1.9.2/libexec/src/net/url/url.go"}]},{"block_type":"text","content":". If for some reason you cannot locate the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"package on your Unix machine, you can execute the following command and wait for its output:"}]},{"block_type":"element","block":"k6pz2igb","search_text":"$ find / -name url.go 2>/dev/null","text_count":33,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ find / -name url.go 2&gt;/dev/null"}]}]},{"block_type":"element","block":"k6pz2igc","search_text":"The output of the preceding command on a Debian Linux machine is as follows:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the preceding command on a Debian Linux machine is as follows:"}]},{"block_type":"element","block":"k6pz2igd","search_text":"/usr/share/go/src/pkg/net/url/url.go /usr/share/go/src/pkg/html/template/url.go","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"/usr/share/go/src/pkg/net/url/url.go\n/usr/share/go/src/pkg/html/template/url.go"}]}]},{"block_type":"element","block":"k6pz2ige","search_text":"Apart from the net/url package, there is also an url.go file that belongs to the html/template standard Go package. However, what interests us is the /usr/share/go/src/pkg/net/url/url.go file. Now that you have located the url.go file, we can start playing with it.","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"package, there is also an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"url.go"}]},{"block_type":"text","content":"file that belongs to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"standard Go package. However, what interests us is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/usr/share/go/src/pkg/net/url/url.go"}]},{"block_type":"text","content":"file. Now that you have located the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"url.go"}]},{"block_type":"text","content":"file, we can start playing with it."}]},{"block_type":"element","block":"k6pz2igf","search_text":"The preamble of the net/url package is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preamble of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"package is as follows:"}]},{"block_type":"element","block":"k6pz2igg","search_text":"// Copyright 2009 The Go Authors. All rights reserved. // Use of this source code is governed by a BSD-style // license that can be found in the LICENSE file. // Package url parses URLs and implements query escaping. package url ","text_count":229,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// Copyright 2009 The Go Authors. All rights reserved. \n// Use of this source code is governed by a BSD-style \n// license that can be found in the LICENSE file. \n \n// Package url parses URLs and implements query escaping. \npackage url"}]}]},{"block_type":"element","block":"k6pz2igh","search_text":"More or less, all packages in the standard Go library have a similar preamble. Now, imagine that you want to get a list of all the functions in the net/url package. Standard Unix command line utilities such as grep(1) are here to help you:","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"More or less, all packages in the standard Go library have a similar preamble. Now, imagine that you want to get a list of all the functions in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":"package. Standard Unix command line utilities such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"grep(1)"}]},{"block_type":"text","content":"are here to help you:"}]},{"block_type":"element","block":"k6pz2igi","search_text":"$ grep '^func' /usr/local/Cellar/go/1.9.2/libexec/src/net/url/url.go func (e *Error) Error() string { return e.Op + \" \" + e.URL + \": \" + e.Err.Error() } func (e *Error) Timeout() bool { func (e *Error) Temporary() bool { func ishex(c byte) bool { func unhex(c byte) byte { func (e EscapeError) Error() string { ... func (u *URL) MarshalBinary() (text []byte, err error) { func (u *URL) UnmarshalBinary(text []byte) error { ","text_count":423,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep '^func' /usr/local/Cellar/go/1.9.2/libexec/src/net/url/url.go\nfunc (e *Error) Error() string { return e.Op + \" \" + e.URL + \": \" + e.Err.Error() }\nfunc (e *Error) Timeout() bool {\nfunc (e *Error) Temporary() bool {\nfunc ishex(c byte) bool {\nfunc unhex(c byte) byte {\nfunc (e EscapeError) Error() string {\n...\nfunc (u *URL) MarshalBinary() (text []byte, err error) {\nfunc (u *URL) UnmarshalBinary(text []byte) error {"}]}]},{"block_type":"element","block":"k6pz2igj","search_text":"Now let's say that you want to look at the implementation of one of the functions found in net/url , and the function that interests you is, say, User() . Its implementation is as follows:","text_count":188,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's say that you want to look at the implementation of one of the functions found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":", and the function that interests you is, say,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"User()"}]},{"block_type":"text","content":". Its implementation is as follows:"}]},{"block_type":"element","block":"k6pz2igk","search_text":"// User returns a Userinfo containing the provided username // and no password set. func User(username string) *Userinfo { return &Userinfo{username, \"\", false} } ","text_count":163,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// User returns a Userinfo containing the provided username \n// and no password set. \nfunc User(username string) *Userinfo { \n        return &amp;Userinfo{username, \"\", false} \n}"}]}]},{"block_type":"element","block":"k6pz2igl","search_text":"The documentation of the User() function states that it returns a Userinfo , which is a structure defined in net/url :","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"User()"}]},{"block_type":"text","content":"function states that it returns a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Userinfo"}]},{"block_type":"text","content":", which is a structure defined in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2igm","search_text":"// The Userinfo type is an immutable encapsulation of username and // password details for a URL. An existing Userinfo value is // guaranteed to have a username set (potentially empty, // as allowed by RFC 2396), and optionally a password. type Userinfo struct { username string password string passwordSet bool } ","text_count":314,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// The Userinfo type is an immutable encapsulation of username and \n// password details for a URL. An existing Userinfo value is \n// guaranteed to have a username set (potentially empty, \n// as allowed by RFC 2396), and optionally a password. \ntype Userinfo struct { \n        username    string \n        password    string \n        passwordSet bool \n}"}]}]},{"block_type":"element","block":"k6pz2ign","search_text":"Now things are becoming clearer. If you continue delving into the code of net/url , you will find more in-depth information about it.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now things are becoming clearer. If you continue delving into the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":", you will find more in-depth information about it."}]},{"block_type":"element","block":"k6pz2igo","search_text":"Tip The general advice here is that if you have doubts about the inner workings of a package in which you are interested, and its documentation does not help you very much, you can always look at its implementation to clarify things. ","text_count":234,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The general advice here is that if you have doubts about the inner workings of a package in which you are interested, and its documentation does not help you very much, you can always look at its implementation to clarify things."}]}]},{"block_type":"element","block":"k6pz2igp","search_text":"The next subsection will look into the Go code of a more interesting package.","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next subsection will look into the Go code of a more interesting package."}]},{"block_type":"element","block":"k6pz2igq","search_text":"Looking at the Go code of the log/syslog package","text_count":48,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Looking at the Go code of the log/syslog package"}]},{"block_type":"element","block":"k6pz2igr","search_text":"This subsection will examine the contents of the log/syslog standard Go package. On a Homebrew Go 1.9.2 installation on a macOS machine, the syslog.go file can be found inside the /usr/local/Cellar/go/1.9.2/libexec/src/log/syslog directory. The full contents of that directory are as follows:","text_count":292,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will examine the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"standard Go package. On a Homebrew Go 1.9.2 installation on a macOS machine, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.go"}]},{"block_type":"text","content":"file can be found inside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/usr/local/Cellar/go/1.9.2/libexec/src/log/syslog"}]},{"block_type":"text","content":"directory. The full contents of that directory are as follows:"}]},{"block_type":"element","block":"k6pz2igs","search_text":"$ ls -l /usr/local/Cellar/go/1.9.2/libexec/src/log/syslog/ total 64 -rw-r--r-- 1 mtsouk admin 1010 Oct 25 21:30 doc.go -rw-r--r-- 1 mtsouk admin 543 Oct 25 21:30 example_test.go -rw-r--r-- 1 mtsouk admin 7567 Oct 25 21:30 syslog.go -rw-r--r-- 1 mtsouk admin 8589 Oct 25 21:30 syslog_test.go -rw-r--r-- 1 mtsouk admin 785 Oct 25 21:30 syslog_Unix.go ","text_count":349,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l /usr/local/Cellar/go/1.9.2/libexec/src/log/syslog/\ntotal 64\n-rw-r--r--  1 mtsouk  admin  1010 Oct 25 21:30 doc.go\n-rw-r--r--  1 mtsouk  admin   543 Oct 25 21:30 example_test.go\n-rw-r--r--  1 mtsouk  admin  7567 Oct 25 21:30 syslog.go\n-rw-r--r--  1 mtsouk  admin  8589 Oct 25 21:30 syslog_test.go\n-rw-r--r--  1 mtsouk  admin   785 Oct 25 21:30 syslog_Unix.go"}]}]},{"block_type":"element","block":"k6pz2igt","search_text":"Now let us try to discover the constants found in the syslog.go file:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let us try to discover the constants found in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syslog.go"}]},{"block_type":"text","content":"file:"}]},{"block_type":"element","block":"k6pz2igu","search_text":"$ grep -n const syslog.go 26:const severityMask = 0x07 27:const facilityMask = 0xf8 29:const ( 44:const (","text_count":105,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep -n const syslog.go\n26:const severityMask = 0x07\n27:const facilityMask = 0xf8\n29:const (\n44:const ("}]}]},{"block_type":"element","block":"k6pz2igv","search_text":"As the third and the fourth const definitions have more than one line, you should go at lines 29 and 44 to have a better look at them. So, the first const definition contains the following constants:","text_count":199,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the third and the fourth"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"definitions have more than one line, you should go at lines 29 and 44 to have a better look at them. So, the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"const"}]},{"block_type":"text","content":"definition contains the following constants:"}]},{"block_type":"element","block":"k6pz2igw","search_text":"const ( // Severity. // From /usr/include/sys/syslog.h. // These are the same on Linux, BSD, and OS X. LOG_EMERG Priority = iota LOG_ALERT LOG_CRIT LOG_ERR LOG_WARNING LOG_NOTICE LOG_INFO LOG_DEBUG ) ","text_count":200,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"const ( \n        // Severity. \n \n        // From /usr/include/sys/syslog.h. \n        // These are the same on Linux, BSD, and OS X. \n        LOG_EMERG Priority = iota \n        LOG_ALERT \n        LOG_CRIT \n        LOG_ERR \n        LOG_WARNING \n        LOG_NOTICE \n        LOG_INFO \n        LOG_DEBUG \n)"}]}]},{"block_type":"element","block":"k6pz2igx","search_text":"Similarly, you can search for new Go type declarations as follows:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, you can search for new Go"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"type"}]},{"block_type":"text","content":"declarations as follows:"}]},{"block_type":"element","block":"k6pz2igy","search_text":"$ grep -n type syslog.go 24:type Priority int 76:type Writer struct { 91:// return a type that satisfies this interface and simply calls the C 93:type serverConn interface { 98:type netConn struct {","text_count":198,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep -n type syslog.go\n24:type Priority int\n76:type Writer struct {\n91:// return a type that satisfies this interface and simply calls the C\n93:type serverConn interface {\n98:type netConn struct {"}]}]},{"block_type":"element","block":"k6pz2igz","search_text":"Now that you know where the type declarations are located, it should be easy to go there and have a more detailed look. So, the definition of the netConn struct , which allows you to send logging data over the network, is as follows:","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you know where the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"type"}]},{"block_type":"text","content":"declarations are located, it should be easy to go there and have a more detailed look. So, the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConn struct"}]},{"block_type":"text","content":", which allows you to send logging data over the network, is as follows:"}]},{"block_type":"element","block":"k6pz2ih0","search_text":"type netConn struct { local bool conn net.Conn } ","text_count":49,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type netConn struct { \n        local bool \n        conn  net.Conn \n}"}]}]},{"block_type":"element","block":"k6pz2ih1","search_text":"Should you wish to go deeper and have a look at the implementation of the functions contained in the log/syslog standard Go package, feel free to continue searching on your own.","text_count":177,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Should you wish to go deeper and have a look at the implementation of the functions contained in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"log/syslog"}]},{"block_type":"text","content":"standard Go package, feel free to continue searching on your own."}]},{"block_type":"element","block":"k6pz2ih2","search_text":"Creating good Go packages","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Creating good Go packages"}]},{"block_type":"element","block":"k6pz2ih3","search_text":"This section will provide some handy advice that will help you generate better Go packages. Up until now, you know that Go packages are organized in directories and can contain public and private elements. Public elements can be use both internally and externally from other packages, whereas private elements can only be used internally in a package.","text_count":351,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will provide some handy advice that will help you generate better Go packages. Up until now, you know that Go packages are organized in directories and can contain public and private elements. Public elements can be use both internally and externally from other packages, whereas private elements can only be used internally in a package."}]},{"block_type":"element","block":"k6pz2ih4","search_text":"Here are several good rules to follow to create superior Go packages:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here are several good rules to follow to create superior Go packages:"}]},{"block_type":"element","block":"k6pz2ih5","search_text":"The first unofficial rule of a successful package is that its elements must be related in some way. Thus, you can create a package for supporting cars, but it would not be a good idea to create a single package for supporting both cars and bicycles. Put simply, it is better to split the functionality of a package unnecessarily into many packages than to add too much functionality to a single Go package. Additionally, packages should be made simple and stylish-but not too simplistic and fragile. A second practical rule is that you should use your own packages first for a reasonable amount of time before giving them to the public. This will help you discover silly bugs and make sure that your packages operate as expected. After that, give them to some fellow developers for additional testing before making them publicly available. Next, try to imagine the kinds of users who will use your packages, and make sure that these types of users will use your packages happily and that your packages will not create more problems for them than they can solve. Unless there is a very good reason, your packages should not export an endless list of functions. Packages that export a short list of functions are understood better and used more easily. After that, try to title your functions using descriptive yet not very long names. Interfaces can improve the usefulness of your functions, so when you think it is appropriate, use an interface instead of a single type as a function parameter or return type. When updating one of your packages, try not to break things and create incompatibilities with older versions unless it is absolutely necessary. This is a really important rule that you should always try to follow. When developing a new Go package, try to use multiple files in order to group similar tasks or concepts. Additionally, try to follow the rules that exist in the Go packages of the standard library. Reading the code of a Go package that belongs to the standard library will help you on this. Do not create a package that already exists from scratch! Make changes to the existing package and maybe create your own version of it. Nobody wants a Go package that prints logging information on the screen. It would be more professional to have a flag for turning on logging when needed. ","text_count":2305,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The first unofficial rule of a successful package is that its elements must be related in some way. Thus, you can create a package for supporting cars, but it would not be a good idea to create a single package for supporting both cars and bicycles. Put simply, it is better to split the functionality of a package unnecessarily into many packages than to add too much functionality to a single Go package. Additionally, packages should be made simple and stylish-but not too simplistic and fragile."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"A second practical rule is that you should use your own packages first for a reasonable amount of time before giving them to the public. This will help you discover silly bugs and make sure that your packages operate as expected. After that, give them to some fellow developers for additional testing before making them publicly available."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Next, try to imagine the kinds of users who will use your packages, and make sure that these types of users will use your packages happily and that your packages will not create more problems for them than they can solve."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Unless there is a very good reason, your packages should not export an endless list of functions. Packages that export a short list of functions are understood better and used more easily. After that, try to title your functions using descriptive yet not very long names."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Interfaces"}]},{"block_type":"text","content":"can improve the usefulness of your functions, so when you think it is appropriate, use an interface instead of a single type as a function parameter or return type."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"When updating one of your packages, try not to break things and create incompatibilities with older versions unless it is absolutely necessary. This is a really important rule that you should always try to follow."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"When developing a new Go package, try to use multiple files in order to group similar tasks or concepts."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Additionally, try to follow the rules that exist in the Go packages of the standard library. Reading the code of a Go package that belongs to the standard library will help you on this."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Do not create a package that already exists from scratch! Make changes to the existing package and maybe create your own version of it."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Nobody wants a Go package that prints logging information on the screen. It would be more professional to have a flag for turning on logging when needed."}]}]},{"block_type":"element","block":"k6pz2ih6","search_text":"","text_count":0,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"&nbsp;"}]},{"block_type":"element","block":"k6pz2ih7","search_text":"The Go code of your package should be in harmony with the other Go code of a program. This means that if you look at a program that uses your packages and your function names stand out in the code in a bad way, it would be better to change the names of your functions. As the name of a package is used almost everywhere, try to use a concise and expressive package name. It is more convenient if you put new Go-type definitions near the place that they will be used for the first time because nobody, including you, wants to search source files for finding definitions of new data types! Try to create test files for your packages, because packages with test files are considered more professional than ones without them-small details make all the difference and give people confidence that you are a serious developer! You will learn more about testing in Chapter 11, Code Testing, Optimization, and Profiling . Finally, do not write a Go package because you do not have anything better to do—in that case, find something better to do and do not waste your time! ","text_count":1064,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The Go code of your package should be in harmony with the other Go code of a program. This means that if you look at a program that uses your packages and your function names stand out in the code in a bad way, it would be better to change the names of your functions. As the name of a package is used almost everywhere, try to use a concise and expressive package name."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"It is more convenient if you put new Go-type definitions near the place that they will be used for the first time because nobody, including you, wants to search source files for finding definitions of new data types!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to create test files for your packages, because packages with test files are considered more professional than ones without them-small details make all the difference and give people confidence that you are a serious developer! You will learn more about testing in Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization, and Profiling"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Finally, do not write a Go package because you do not have anything better to do&mdash;in that case, find something better to do and do not waste your time!"}]}]},{"block_type":"element","block":"k6pz2ih8","search_text":"Tip Always remember that apart from the fact that the actual Go code in a package should be bug-free, the next most important element of a successful package is its documentation , as well as some code examples that clarify its use and showcase the idiosyncrasies of the functions of the package. ","text_count":297,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Always remember that apart from the fact that the actual Go code in a package should be bug-free, the next most important element of a successful package is its"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"documentation"}]},{"block_type":"text","content":", as well as some code examples that clarify its use and showcase the idiosyncrasies of the functions of the package."}]}]},{"block_type":"element","block":"k6pz2ih9","search_text":"The syscall package","text_count":19,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The syscall package"}]},{"block_type":"element","block":"k6pz2iha","search_text":"This section will present a small portion of the functionality of the syscall standard Go package. Note that the syscall package offers a plethora of functions and types related to low-level operating system primitives. Additionally, the syscall package is extensively used by other Go packages such as os , net , and time , which all provide a portable interface to the operating system. This means that the syscall package is not the most portable package in the Go library-that's not its job. Although Unix systems have many similarities, they also exhibit various differences, especially when we talk about their system internals. The job of the syscall package is to deal with all of these incompatibilities as gently as possible. The fact that this is not a secret and is well-documented makes syscall a successful package.","text_count":829,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a small portion of the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package. Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package offers a plethora of functions and types related to low-level operating system primitives. Additionally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package is extensively used by other Go packages such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":", which all provide a portable interface to the operating system. This means that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package is not the most portable package in the Go library-that's not its job. Although Unix systems have many similarities, they also exhibit various differences, especially when we talk about their system internals. The job of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package is to deal with all of these incompatibilities as gently as possible. The fact that this is not a secret and is well-documented makes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"a successful package."}]},{"block_type":"element","block":"k6pz2ihb","search_text":"Strictly speaking, a system call is a programmatic way for an application to request something from the kernel of an operating system. As a consequence, system calls are responsible for accessing and working with most Unix low-level elements such as processes, storage devices, printing data, network interfaces and all kinds of files. Put simply, you cannot work on a Unix system without using system calls! You can inspect the system calls of a Unix process using utilities such as strace(1) and dtrace(1) , which were presented in Chapter 2, Understanding Go Internals .","text_count":573,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"system call"}]},{"block_type":"text","content":"is a programmatic way for an application to request something from the kernel of an operating system. As a consequence, system calls are responsible for accessing and working with most Unix low-level elements such as processes, storage devices, printing data, network interfaces and all kinds of files. Put simply, you cannot work on a Unix system without using system calls! You can inspect the system calls of a Unix process using utilities such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dtrace(1)"}]},{"block_type":"text","content":", which were presented in Chapter 2,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Understanding Go Internals"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ihc","search_text":"The use of the syscall package will be illustrated in the useSyscall.go program, which will be presented in four parts.","text_count":119,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package will be illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"program, which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2ihd","search_text":"Note You might not directly need to use the syscall package unless you are working on pretty low-level stuff. Not all Go packages are for everyone! ","text_count":148,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might not directly need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package unless you are working on pretty low-level stuff. Not all Go packages are for everyone!"}]}]},{"block_type":"element","block":"k6pz2ihe","search_text":"The first code portion of useSyscall.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ihf","search_text":"package main import ( \"fmt\" \"os\" \"syscall\" ) ","text_count":45,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n   \"os\" \n   \"syscall\" \n)"}]}]},{"block_type":"element","block":"k6pz2ihg","search_text":"This is the easy part of the program, where you just import the required Go packages.","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is the easy part of the program, where you just import the required Go packages."}]},{"block_type":"element","block":"k6pz2ihh","search_text":"The second part of useSyscall.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ihi","search_text":"func main() { pid, _, _ := syscall.Syscall(39, 0, 0, 0) fmt.Println(\"My pid is\", pid) uid, _, _ := syscall.Syscall(24, 0, 0, 0) fmt.Println(\"User ID:\", uid) ","text_count":157,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   pid, _, _ := syscall.Syscall(39, 0, 0, 0) \n   fmt.Println(\"My pid is\", pid) \n   uid, _, _ := syscall.Syscall(24, 0, 0, 0) \n   fmt.Println(\"User ID:\", uid)"}]}]},{"block_type":"element","block":"k6pz2ihj","search_text":"In this part, you find out information about the process id and the user id using two syscall.Syscall() calls. The first parameter of the syscall.Syscall() call determines the information that you request.","text_count":205,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you find out information about the process id and the user id using two"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Syscall()"}]},{"block_type":"text","content":"calls. The first parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Syscall()"}]},{"block_type":"text","content":"call determines the information that you request."}]},{"block_type":"element","block":"k6pz2ihk","search_text":"The third code segment of useSyscall.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ihl","search_text":"message := []byte{'H', 'e', 'l', 'l', 'o', '!', '\\n'} fd := 1 syscall.Write(fd, message) ","text_count":89,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"message := []byte{'H', 'e', 'l', 'l', 'o', '!', '\\n'} \n   fd := 1 \n   syscall.Write(fd, message)"}]}]},{"block_type":"element","block":"k6pz2ihm","search_text":"In this part, you print a message on the screen using syscall.Write() . The first parameter is the file descriptor to which you will write and the second parameter is a byte slice that holds the actual message. The syscall.Write() function is portable.","text_count":252,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you print a message on the screen using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Write()"}]},{"block_type":"text","content":". The first parameter is the file descriptor to which you will write and the second parameter is a byte slice that holds the actual message. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Write()"}]},{"block_type":"text","content":"function is portable."}]},{"block_type":"element","block":"k6pz2ihn","search_text":"The last part of the useSyscall.go program is as follows:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2iho","search_text":"fmt.Println(\"Using syscall.Exec()\") command := \"/bin/ls\" env := os.Environ() syscall.Exec(command, []string{\"ls\", \"-a\", \"-x\"}, env) } ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Using syscall.Exec()\") \n   command := \"/bin/ls\" \n   env := os.Environ() \n   syscall.Exec(command, []string{\"ls\", \"-a\", \"-x\"}, env) \n}"}]}]},{"block_type":"element","block":"k6pz2ihp","search_text":"In the last part of the program, you see how to use the syscall.Exec() function for executing an external command. However, you have no control over the output of the command, which is automatically printed on the screen.","text_count":221,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the last part of the program, you see how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Exec()"}]},{"block_type":"text","content":"function for executing an external command. However, you have no control over the output of the command, which is automatically printed on the screen."}]},{"block_type":"element","block":"k6pz2ihq","search_text":"Executing useSyscall.go on macOS High Sierra will generate the following output:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useSyscall.go"}]},{"block_type":"text","content":"on macOS High Sierra will generate the following output:"}]},{"block_type":"element","block":"k6pz2ihr","search_text":"$ go run useSyscall.go My pid is 14602 User ID: 501 Hello! Using syscall.Exec() . .. a.go funFun.go functions.go html.gohtml htmlT.db htmlT.go manyInit.go ptrFun.go returnFunction.go returnNames.go returnPtr.go text.gotext textT.go useAPackage.go useSyscall.go ","text_count":261,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useSyscall.go\nMy pid is 14602\nUser ID: 501\nHello!\nUsing syscall.Exec()\n.                 ..                a.go\nfunFun.go         functions.go      html.gohtml\nhtmlT.db          htmlT.go          manyInit.go\nptrFun.go         returnFunction.go returnNames.go\nreturnPtr.go      text.gotext       textT.go\nuseAPackage.go    useSyscall.go"}]}]},{"block_type":"element","block":"k6pz2ihs","search_text":"Executing the same program on a Debian Linux machine will generate the following output:","text_count":88,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the same program on a Debian Linux machine will generate the following output:"}]},{"block_type":"element","block":"k6pz2iht","search_text":"$ go run useSyscall.go My pid is 20853 User ID: 0 Hello! Using syscall.Exec() . .. a.go funFun.go functions.go html.gohtml htmlT.db htmlT.go manyInit.go ptrFun.go returnFunction.go returnNames.go returnPtr.go text.gotext textT.go useAPackage.go useSyscall.go","text_count":258,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useSyscall.go\nMy pid is 20853\nUser ID: 0\nHello!\nUsing syscall.Exec()\n.                 ..                a.go\nfunFun.go         functions.go      html.gohtml\nhtmlT.db          htmlT.go          manyInit.go\nptrFun.go         returnFunction.go returnNames.go\nreturnPtr.go      text.gotext       textT.go\nuseAPackage.go    useSyscall.go"}]}]},{"block_type":"element","block":"k6pz2ihu","search_text":"So, although most of the output is the same as before, the syscall.Syscall(39, 0, 0, 0) call does not work on Linux because the user id of the Linux user is not 0, which means that this command is not portable!","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, although most of the output is the same as before, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Syscall(39, 0, 0, 0)"}]},{"block_type":"text","content":"call does not work on Linux because the user id of the Linux user is not 0, which means that this command is not portable!"}]},{"block_type":"element","block":"k6pz2ihv","search_text":"If you want to discover which standard Go packages use the syscall package, you can execute the following command from your Unix shell:","text_count":135,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to discover which standard Go packages use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package, you can execute the following command from your Unix shell:"}]},{"block_type":"element","block":"k6pz2ihw","search_text":"$ grep \\\"syscall\\\" `find /usr/local/Cellar/go/1.9.2/libexec/src -name \"*.go\"`","text_count":77,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep \\\"syscall\\\" `find /usr/local/Cellar/go/1.9.2/libexec/src -name \"*.go\"`"}]}]},{"block_type":"element","block":"k6pz2ihx","search_text":"Please replace /usr/local/Cellar/go/1.9.2/libexec/src with the appropriate directory path.","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please replace"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/usr/local/Cellar/go/1.9.2/libexec/src"}]},{"block_type":"text","content":"with the appropriate directory path."}]},{"block_type":"element","block":"k6pz2ihy","search_text":"Finding out how fmt.Println() really works","text_count":42,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Finding out how fmt.Println() really works"}]},{"block_type":"element","block":"k6pz2ihz","search_text":"If you really want to grasp the usefulness of the syscall package, start by reading this subsection. The implementation of the fmt.Println() function, as found in https://golang.org/src/fmt/print.go , is as follows:","text_count":215,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you really want to grasp the usefulness of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package, start by reading this subsection. The implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"function, as found in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/fmt/print.go"},"children":[{"block_type":"text","content":"https://golang.org/src/fmt/print.go"}]},{"block_type":"text","content":", is as follows:"}]},{"block_type":"element","block":"k6pz2ii0","search_text":"func Println(a ...interface{}) (n int, err error) { return Fprintln(os.Stdout, a...) } ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Println(a ...interface{}) (n int, err error) { \n   return Fprintln(os.Stdout, a...) \n}"}]}]},{"block_type":"element","block":"k6pz2ii1","search_text":"This means that, at the end of the day, the fmt.Println() function calls fmt.Fprintln() to do its job. The implementation of fmt.Fprintln() , as found in the same file, follows next:","text_count":182,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that, at the end of the day, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"function calls"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintln()"}]},{"block_type":"text","content":"to do its job. The implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintln()"}]},{"block_type":"text","content":", as found in the same file, follows next:"}]},{"block_type":"element","block":"k6pz2ii2","search_text":"func Fprintln(w io.Writer, a ...interface{}) (n int, err error) { p := newPrinter() p.doPrintln(a) n, err = w.Write(p.buf) p.free() return } ","text_count":141,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Fprintln(w io.Writer, a ...interface{}) (n int, err error) { \n   p := newPrinter() \n   p.doPrintln(a) \n   n, err = w.Write(p.buf) \n   p.free() \n   return \n}"}]}]},{"block_type":"element","block":"k6pz2ii3","search_text":"This means that the actual writing in fmt.Fprintln() is done by the Write() function of the io.Writer interface. In this case, the io.Writer is os.Stdout , which is defined as follows in https://golang.org/src/os/file.go :","text_count":222,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that the actual writing in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintln()"}]},{"block_type":"text","content":"is done by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interface. In this case, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":", which is defined as follows in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ii4","search_text":"var ( Stdin = NewFile(uintptr(syscall.Stdin), \"/dev/stdin\") Stdout = NewFile(uintptr(syscall.Stdout), \"/dev/stdout\") Stderr = NewFile(uintptr(syscall.Stderr), \"/dev/stderr\") ) ","text_count":176,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var ( \n   Stdin  = NewFile(uintptr(syscall.Stdin), \"/dev/stdin\") \n   Stdout = NewFile(uintptr(syscall.Stdout), \"/dev/stdout\") \n   Stderr = NewFile(uintptr(syscall.Stderr), \"/dev/stderr\") \n)"}]}]},{"block_type":"element","block":"k6pz2ii5","search_text":"Now look at the implementation of NewFile() , which can be found inside https://golang.org/src/os/file_plan9.go :","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now look at the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NewFile()"}]},{"block_type":"text","content":", which can be found inside"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file_plan9.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file_plan9.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ii6","search_text":"func NewFile(fd uintptr, name string) *File { fdi := int(fd) if fdi < 0 { return nil } f := &File{&file{fd: fdi, name: name}} runtime.SetFinalizer(f.file, (*file).close) return f } ","text_count":181,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func NewFile(fd uintptr, name string) *File { \n   fdi := int(fd) \n   if fdi &lt; 0 { \n         return nil \n   } \n   f := &amp;File{&amp;file{fd: fdi, name: name}} \n   runtime.SetFinalizer(f.file, (*file).close) \n   return f \n}"}]}]},{"block_type":"element","block":"k6pz2ii7","search_text":"When you see a Go source file named file_plan9.go , you should suspect that it contains commands specific to a Unix variant, which means that it contains code that is not portable!","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When you see a Go source file named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"file_plan9.go"}]},{"block_type":"text","content":", you should suspect that it contains commands specific to a Unix variant, which means that it contains code that is not portable!"}]},{"block_type":"element","block":"k6pz2ii8","search_text":"What we have here is the file structure type that is embedded in the File type, which is the one that is being exported due to its name. So, start looking for functions inside https://golang.org/src/os/file_plan9.go that are applied to a File structure or to a pointer to a File structure and that allow you to write data. As the function we are seeking is named Write() -look at the implementation of Fprintln() -we will have to search all of the source files of the os package to find it:","text_count":490,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What we have here is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"file"}]},{"block_type":"text","content":"structure type that is embedded in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"File"}]},{"block_type":"text","content":"type, which is the one that is being exported due to its name. So, start looking for functions inside"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file_plan9.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file_plan9.go"}]},{"block_type":"text","content":"that are applied to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"File"}]},{"block_type":"text","content":"structure or to a pointer to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"File"}]},{"block_type":"text","content":"structure and that allow you to write data. As the function we are seeking is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"-look at the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Fprintln()"}]},{"block_type":"text","content":"-we will have to search all of the source files of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package to find it:"}]},{"block_type":"element","block":"k6pz2ii9","search_text":"$ grep \"func (f \\*File) Write(\" *.go file.go:func (f *File) Write(b []byte) (n int, err error) {","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ grep \"func (f \\*File) Write(\"  *.go\nfile.go:func (f *File) Write(b []byte) (n int, err error) {"}]}]},{"block_type":"element","block":"k6pz2iia","search_text":"The implementation of Write() as found in https://golang.org/src/os/file.go follows next:","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"as found in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iib","search_text":"func (f *File) Write(b []byte) (n int, err error) { if err := f.checkValid(\"write\"); err != nil { return 0, err } n, e := f.write(b) if n < 0 { n = 0 } if n != len(b) { err = io.ErrShortWrite } epipecheck(f, e) if e != nil { err = f.wrapErr(\"write\", e) } return n, err } ","text_count":271,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (f *File) Write(b []byte) (n int, err error) { \n   if err := f.checkValid(\"write\"); err != nil { \n         return 0, err \n   } \n   n, e := f.write(b) \n   if n &lt; 0 { \n         n = 0 \n   } \n   if n != len(b) { \n         err = io.ErrShortWrite \n   } \n \n   epipecheck(f, e) \n \n   if e != nil { \n         err = f.wrapErr(\"write\", e) \n   } \n \n   return n, err \n}"}]}]},{"block_type":"element","block":"k6pz2iic","search_text":"This means that we now have to search for the write() function. Searching for the write string in https://golang.org/src/os/file_plan9.go reveals the following function inside https://golang.org/src/os/file_plan9.go :","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that we now have to search for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"write()"}]},{"block_type":"text","content":"function. Searching for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"write"}]},{"block_type":"text","content":"string in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file_plan9.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file_plan9.go"}]},{"block_type":"text","content":"reveals the following function inside"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file_plan9.go"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file_plan9.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2iid","search_text":"func (f *File) write(b []byte) (n int, err error) { if len(b) == 0 { return 0, nil } return fixCount(syscall.Write(f.fd, b)) } ","text_count":127,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (f *File) write(b []byte) (n int, err error) { \n   if len(b) == 0 { \n         return 0, nil \n   } \n   return fixCount(syscall.Write(f.fd, b)) \n}"}]}]},{"block_type":"element","block":"k6pz2iie","search_text":"This tells us that, at the end of the day, a call to the fmt.Println() function is implemented using a call to syscall.Write() . This underscores how useful and necessary the syscall package is!","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This tells us that, at the end of the day, a call to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"function is implemented using a call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Write()"}]},{"block_type":"text","content":". This underscores how useful and necessary the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package is!"}]},{"block_type":"element","block":"k6pz2iif","search_text":"Text and HTML templates","text_count":23,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Text and HTML templates"}]},{"block_type":"element","block":"k6pz2iig","search_text":"The subject of this section will surely surprise you in a good way, because both packages presented give you so much flexibility that I am sure you will find many creative ways to use them.","text_count":189,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The subject of this section will surely surprise you in a good way, because both packages presented give you so much flexibility that I am sure you will find many creative ways to use them."}]},{"block_type":"element","block":"k6pz2iih","search_text":"Templates are mainly used for separating the formatting part and the data part of the output. Please note that a Go template can be either a file or a string-the general idea is to use inline strings for smaller templates and external files for bigger ones.","text_count":257,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Templates"}]},{"block_type":"text","content":"are mainly used for separating the formatting part and the data part of the output. Please note that a Go template can be either a file or a string-the general idea is to use inline strings for smaller templates and external files for bigger ones."}]},{"block_type":"element","block":"k6pz2iii","search_text":"Note You cannot import both text/template and html/template on the same Go program because these two packages share the same package name ( template ). If absolutely necessary, you should define an alias for one of them. See the useStrings.go code in Chapter 4, The Uses of Composite Types . ","text_count":292,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You cannot import both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"on the same Go program because these two packages share the same package name ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template"}]},{"block_type":"text","content":"). If absolutely necessary, you should define an alias for one of them. See the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useStrings.go"}]},{"block_type":"text","content":"code in Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2iij","search_text":"Text output is usually presented on your screen, whereas HTML output is seen with the help of a web browser. However, as text output is usually cleaner than HTML output, if you think that you will need to process the output of a Go utility using other Unix command line utilities, you should use text/template instead of html/template .","text_count":336,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Text output is usually presented on your screen, whereas HTML output is seen with the help of a web browser. However, as text output is usually cleaner than HTML output, if you think that you will need to process the output of a Go utility using other Unix command line utilities, you should use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iik","search_text":"Note that both the text/template and html/template packages are good examples of how sophisticated a Go package can be! As you will see shortly, both packages support their own kind of programming language-good software makes complex things look simple!","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that both the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"packages are good examples of how sophisticated a Go package can be! As you will see shortly, both packages support their own kind of programming language-good software makes complex things look simple!"}]},{"block_type":"element","block":"k6pz2iil","search_text":"Generating text output","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Generating text output"}]},{"block_type":"element","block":"k6pz2iim","search_text":"If you need to create plain text output, then using the text/template package is a good choice. The use of the text/template package will be illustrated in textT.go , which will be presented in five parts.","text_count":205,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you need to create plain text output, then using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"package is a good choice. The use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"package will be illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":", which will be presented in five parts."}]},{"block_type":"element","block":"k6pz2iin","search_text":"As templates are usually stored in external files, the example presented will use the text.gotext template file, which will be analyzed in three parts. Data is typically read from text files or from the Internet. However, for reasons of simplicity, the data for textT.go will be hardcoded in the program using a slice.","text_count":318,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As templates are usually stored in external files, the example presented will use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text.gotext"}]},{"block_type":"text","content":"template file, which will be analyzed in three parts. Data is typically read from text files or from the Internet. However, for reasons of simplicity, the data for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"will be hardcoded in the program using a slice."}]},{"block_type":"element","block":"k6pz2iio","search_text":"We will start by looking at the Go code of textT.go . The first code portion of textT.go follows next:","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We will start by looking at the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":". The first code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iip","search_text":"package main import ( \"fmt\" \"os\" \"text/template\" ) ","text_count":51,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"fmt\" \n   \"os\" \n   \"text/template\" \n)"}]}]},{"block_type":"element","block":"k6pz2iiq","search_text":"The second code segment from textT.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iir","search_text":"type Entry struct { Number int Square int } ","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Entry struct { \n   Number int \n   Square int \n}"}]}]},{"block_type":"element","block":"k6pz2iis","search_text":"You will need to define a new data type for storing your data unless you are dealing with very simplistic data.","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will need to define a new data type for storing your data unless you are dealing with very simplistic data."}]},{"block_type":"element","block":"k6pz2iit","search_text":"The third part of textT.go is shown in the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iiu","search_text":"func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"Need the template file!\") return } tFile := arguments[1] DATA := [][]int{{-1, 1}, {-2, 4}, {-3, 9}, {-4, 16}} ","text_count":183,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   arguments := os.Args \n   if len(arguments) != 2 { \n         fmt.Println(\"Need the template file!\") \n         return \n   } \n \n   tFile := arguments[1] \n   DATA := [][]int{{-1, 1}, {-2, 4}, {-3, 9}, {-4, 16}}"}]}]},{"block_type":"element","block":"k6pz2iiv","search_text":"The DATA variable, which is a slice with two dimensions, holds the initial version of your data.","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DATA"}]},{"block_type":"text","content":"variable, which is a slice with two dimensions, holds the initial version of your data."}]},{"block_type":"element","block":"k6pz2iiw","search_text":"The fourth part of textT.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iix","search_text":"var Entries []Entry for _, i := range DATA { if len(i) == 2 { temp := Entry{Number: i[0], Square: i[1]} Entries = append(Entries, temp) } } ","text_count":140,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var Entries []Entry \n \n   for _, i := range DATA { \n         if len(i) == 2 { \n               temp := Entry{Number: i[0], Square: i[1]} \n               Entries = append(Entries, temp) \n         } \n   }"}]}]},{"block_type":"element","block":"k6pz2iiy","search_text":"The preceding code creates a slice of structures from the DATA variable.","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code creates a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"slice of structures"}]},{"block_type":"text","content":"from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DATA"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2iiz","search_text":"The last code segment from textT.go is the following:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2ij0","search_text":"t := template.Must(template.ParseGlob(tFile)) t.Execute(os.Stdout, Entries) } ","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"t := template.Must(template.ParseGlob(tFile)) \n   t.Execute(os.Stdout, Entries) \n}"}]}]},{"block_type":"element","block":"k6pz2ij1","search_text":"The template.Must() function is used for making the required initializations. Its return data type is Template , which is a structure that holds the representation of a parsed template. The template.ParseGlob() reads the external template file. Note that I like to use the gohtml extension for the template files, but you can use any extension that you want-just be consistent. Also, the template.Execute() function does all the work, which includes processing the data and printing the output to the desired file, which in this case is os.Stdout .","text_count":548,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.Must()"}]},{"block_type":"text","content":"function is used for making the required initializations. Its return data type is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Template"}]},{"block_type":"text","content":", which is a structure that holds the representation of a parsed template. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.ParseGlob()"}]},{"block_type":"text","content":"reads the external template file. Note that I like to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gohtml"}]},{"block_type":"text","content":"extension for the template files, but you can use any extension that you want-just be consistent. Also, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.Execute()"}]},{"block_type":"text","content":"function does all the work, which includes processing the data and printing the output to the desired file, which in this case is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdout"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ij2","search_text":"Now it is time to look at the code of the template file. The first part of the text template file is as follows:","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now it is time to look at the code of the template file. The first part of the text template file is as follows:"}]},{"block_type":"element","block":"k6pz2ij3","search_text":"Calculating the squares of some integers ","text_count":41,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"Calculating the squares of some integers"}]}]},{"block_type":"element","block":"k6pz2ij4","search_text":"Note that empty lines in a text template file are significant and will be shown as empty lines in the final output.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that empty lines in a text template file are significant and will be shown as empty lines in the final output."}]},{"block_type":"element","block":"k6pz2ij5","search_text":"The second part of the template is the following:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the template is the following:"}]},{"block_type":"element","block":"k6pz2ij6","search_text":"{{ range . }} The square of {{ printf \"%d\" .Number}} is {{ printf \"%d\" .Square}} ","text_count":81,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"{{ range . }} The square of {{ printf \"%d\" .Number}} is {{ printf \"%d\" .Square}}"}]}]},{"block_type":"element","block":"k6pz2ij7","search_text":"There are many interesting things happening here. The range keyword allows you to iterate over the lines of the input, which is given as a slice of structures. Plain text is printed as such, whereas variables and dynamic text must begin with {{ and end with }} . The fields of the structure are accessed as .Number and .Square . Note the dot character in front of the field name of the Entry data type. Also, the printf command is used for formatting the final output.","text_count":468,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are many interesting things happening here. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"keyword allows you to iterate over the lines of the input, which is given as a slice of structures. Plain text is printed as such, whereas variables and dynamic text must begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{"}]},{"block_type":"text","content":"and end with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"}}"}]},{"block_type":"text","content":". The fields of the structure are accessed as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":".Number"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":".Square"}]},{"block_type":"text","content":". Note the dot character in front of the field name of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Entry"}]},{"block_type":"text","content":"data type. Also, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printf"}]},{"block_type":"text","content":"command is used for formatting the final output."}]},{"block_type":"element","block":"k6pz2ij8","search_text":"The third part of the text.gotext file follows next:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text.gotext"}]},{"block_type":"text","content":"file follows next:"}]},{"block_type":"element","block":"k6pz2ij9","search_text":"{{ end }} ","text_count":10,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"{{ end }}"}]}]},{"block_type":"element","block":"k6pz2ija","search_text":"So, a {{ range }} command is ended with {{ end }} . Accidentally putting {{ end }} in the wrong place will affect your output. Once again, keep in mind that empty lines in text template files are significant and will be shown in the final output.","text_count":246,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{ range }}"}]},{"block_type":"text","content":"command is ended with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{ end }}"}]},{"block_type":"text","content":". Accidentally putting"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{ end }}"}]},{"block_type":"text","content":"in the wrong place will affect your output. Once again, keep in mind that empty lines in text template files are significant and will be shown in the final output."}]},{"block_type":"element","block":"k6pz2ijb","search_text":"Executing textT.go will generate the following type of output:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2ijc","search_text":"$ go run textT.go text.gotext Calculating the squares of some integers The square of -1 is 1 The square of -2 is 4 The square of -3 is 9 The square of -4 is 16 ","text_count":160,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run textT.go text.gotext\nCalculating the squares of some integers\n    \n The square of -1 is 1\n The square of -2 is 4\n The square of -3 is 9\n The square of -4 is 16"}]}]},{"block_type":"element","block":"k6pz2ijd","search_text":"Constructing HTML output","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Constructing HTML output"}]},{"block_type":"element","block":"k6pz2ije","search_text":"This section illustrates the use of the html/template package with an example named htmlT.go . It will be presented in six parts. The philosophy of the html/template package is the same with the text/template package. The main difference between these two packages is that the html/template package generates HTML output that is safe against code injection.","text_count":357,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section illustrates the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"package with an example named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":". It will be presented in six parts. The philosophy of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"package is the same with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"package. The main difference between these two packages is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"package generates HTML output that is safe against code injection."}]},{"block_type":"element","block":"k6pz2ijf","search_text":"Note Although you can create HTML output with the text/template package-after all, HTML is just plain text-if you want to create HTML output, then you should use the html/template package instead. ","text_count":197,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you can create HTML output with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"package-after all, HTML is just plain text-if you want to create HTML output, then you should use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"package instead."}]}]},{"block_type":"element","block":"k6pz2ijg","search_text":"For reasons of simplicity, the example presented below will read data from an SQLite database, but you can use any database that you want, provided that you have or you can write the appropriate Go drivers. To make things even easier, the example will populate a database table before reading from it!","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For reasons of simplicity, the example presented below will read data from an SQLite database, but you can use any database that you want, provided that you have or you can write the appropriate Go drivers. To make things even easier, the example will populate a database table before reading from it!"}]},{"block_type":"element","block":"k6pz2ijh","search_text":"The first code portion from htmlT.go follows next:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iji","search_text":"package main import ( \"database/sql\" \"fmt\" _ \"github.com/mattn/go-sqlite3\" \"html/template\" \"net/http\" \"os\" ) type Entry struct { Number int Double int Square int } var DATA []Entry var tFile string ","text_count":198,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"database/sql\" \n   \"fmt\" \n   _ \"github.com/mattn/go-sqlite3\" \n   \"html/template\" \n   \"net/http\" \n   \"os\" \n) \n \ntype Entry struct { \n   Number int \n   Double int \n   Square int \n} \n \nvar DATA []Entry \nvar tFile string"}]}]},{"block_type":"element","block":"k6pz2ijj","search_text":"You can see a new package named net/http in the import block, which is used for creating HTTP servers and clients in Go. You will learn more about network programming in Go and the use of the net and net/http standard Go packages in Chapter 12, The foundations of Network Programming in Go and Chapter 13, Network Programming – Building Servers and Clients .","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can see a new package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"block, which is used for creating HTTP servers and clients in Go. You will learn more about network programming in Go and the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"standard Go packages in Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The foundations of Network Programming in Go"}]},{"block_type":"text","content":"&nbsp;and Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming &ndash; Building Servers and Clients"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ijk","search_text":"Apart from net/http , you can also see the definition of the Entry data type that will hold the records read from the SQLite3 table as well as two global variables named DATA and tFile , which hold the data that is going to be passed to the template file and the filename of the template file, respectively.","text_count":307,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":", you can also see the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Entry"}]},{"block_type":"text","content":"data type that will hold the records read from the SQLite3 table as well as two global variables named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DATA"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tFile"}]},{"block_type":"text","content":", which hold the data that is going to be passed to the template file and the filename of the template file, respectively."}]},{"block_type":"element","block":"k6pz2ijl","search_text":"Also, you can see the use of the https://github.com/mattn/go-sqlite3 package for communicating with the SQLite3 database with the help of the database/sql interface.","text_count":165,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Also, you can see the use of the"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/mattn/go-sqlite3"},"children":[{"block_type":"text","content":"https://github.com/mattn/go-sqlite3"}]},{"block_type":"text","content":"package for communicating with the SQLite3 database with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"database/sql"}]},{"block_type":"text","content":"interface."}]},{"block_type":"element","block":"k6pz2ijm","search_text":"The second part of htmlT.go is the following:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2ijn","search_text":"func myHandler(w http.ResponseWriter, r *http.Request) { fmt.Printf(\"Host: %s Path: %s\\n\", r.Host, r.URL.Path) myT := template.Must(template.ParseGlob(tFile)) myT.ExecuteTemplate(w, tFile, DATA) } ","text_count":197,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func myHandler(w http.ResponseWriter, r *http.Request) { \n   fmt.Printf(\"Host: %s Path: %s\\n\", r.Host, r.URL.Path) \n   myT := template.Must(template.ParseGlob(tFile)) \n   myT.ExecuteTemplate(w, tFile, DATA) \n}"}]}]},{"block_type":"element","block":"k6pz2ijo","search_text":"The simplicity and the effectiveness of the myHandler() function is phenomenal, especially if you consider the size of the function! The template.ExecuteTemplate() function does all the work for you. Its first parameter is the variable that holds the connection with the HTTP client, its second parameter is the template file that will be used for formatting the data, and its third parameter is the slice of structures with the data that will be processed.","text_count":457,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The simplicity and the effectiveness of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHandler()"}]},{"block_type":"text","content":"function is phenomenal, especially if you consider the size of the function! The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.ExecuteTemplate()"}]},{"block_type":"text","content":"function does all the work for you. Its first parameter is the variable that holds the connection with the HTTP client, its second parameter is the template file that will be used for formatting the data, and its third parameter is the slice of structures with the data that will be processed."}]},{"block_type":"element","block":"k6pz2ijp","search_text":"The third code segment from htmlT.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ijq","search_text":"func main() { arguments := os.Args if len(arguments) != 3 { fmt.Println(\"Need Database File + Template File!\") return } database := arguments[1] tFile = arguments[2] ","text_count":166,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   arguments := os.Args \n   if len(arguments) != 3 { \n         fmt.Println(\"Need Database File + Template File!\") \n         return \n   } \n \n   database := arguments[1] \n   tFile = arguments[2]"}]}]},{"block_type":"element","block":"k6pz2ijr","search_text":"The fourth code portion from htmlT.go is where you start dealing with the database:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"is where you start dealing with the database:"}]},{"block_type":"element","block":"k6pz2ijs","search_text":"db, err := sql.Open(\"sqlite3\", database) if err != nil { fmt.Println(nil) return } fmt.Println(\"Emptying database table.\") _, err = db.Exec(\"DELETE FROM data\") if err != nil { fmt.Println(nil) return } fmt.Println(\"Populating\", database) stmt, _ := db.Prepare(\"INSERT INTO data(number, double, square) values(?,?,?)\") for i := 20; i < 50; i++ { _, _ = stmt.Exec(i, 2*i, i*i) } ","text_count":377,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"db, err := sql.Open(\"sqlite3\", database) \n   if err != nil { \n          fmt.Println(nil) \n          return \n   } \n \n   fmt.Println(\"Emptying database table.\") \n   _, err = db.Exec(\"DELETE FROM data\") \n   if err != nil { \n          fmt.Println(nil) \n          return \n   } \n \n   fmt.Println(\"Populating\", database) \n   stmt, _ := db.Prepare(\"INSERT INTO data(number, double, square) values(?,?,?)\") \n   for i := 20; i &lt; 50; i++ { \n         _, _ = stmt.Exec(i, 2*i, i*i) \n   }"}]}]},{"block_type":"element","block":"k6pz2ijt","search_text":"The sql.Open() function opens the connection with the desired database. With db.Exec() , you can execute database commands without expecting any feedback from them. Also, the db.Prepare() function allows you to execute a database command multiple times by changing only its parameters and calling Exec() afterwards.","text_count":315,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sql.Open()"}]},{"block_type":"text","content":"function opens the connection with the desired database. With"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"db.Exec()"}]},{"block_type":"text","content":", you can execute database commands without expecting any feedback from them. Also, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"db.Prepare()"}]},{"block_type":"text","content":"function allows you to execute a database command multiple times by changing only its parameters and calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Exec()"}]},{"block_type":"text","content":"afterwards."}]},{"block_type":"element","block":"k6pz2iju","search_text":"The fifth part of htmlT.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ijv","search_text":"rows, err := db.Query(\"SELECT * FROM data\") if err != nil { fmt.Println(nil) return } var n int var d int var s int for rows.Next() { err = rows.Scan(&n, &d, &s) temp := Entry{Number: n, Double: d, Square: s} DATA = append(DATA, temp) } ","text_count":237,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"rows, err := db.Query(\"SELECT * FROM data\") \n   if err != nil { \n          fmt.Println(nil) \n          return \n   } \n \n   var n int \n   var d int \n   var s int \n   for rows.Next() { \n         err = rows.Scan(&amp;n, &amp;d, &amp;s) \n         temp := Entry{Number: n, Double: d, Square: s} \n         DATA = append(DATA, temp) \n   }"}]}]},{"block_type":"element","block":"k6pz2ijw","search_text":"In this part of the program, we read the data from the desired table using db.Query() and multiple calls to Next() and Scan() . While reading the data, you put it into a slice of structures and you are done dealing with the database.","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, we read the data from the desired table using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"db.Query()"}]},{"block_type":"text","content":"and multiple calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Next()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Scan()"}]},{"block_type":"text","content":". While reading the data, you put it into a slice of structures and you are done dealing with the database."}]},{"block_type":"element","block":"k6pz2ijx","search_text":"The last part of the program is all about setting up the web server, and it contains the following Go code:","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the program is all about setting up the web server, and it contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ijy","search_text":"http.HandleFunc(\"/\", myHandler) err = http.ListenAndServe(\":8080\", nil) if err != nil { fmt.Println(err) return } } ","text_count":116,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"http.HandleFunc(\"/\", myHandler) \n   err = http.ListenAndServe(\":8080\", nil) \n   if err != nil { \n          fmt.Println(err) \n          return \n   } \n}"}]}]},{"block_type":"element","block":"k6pz2ijz","search_text":"Here, the http.HandleFunc() function tells the web server embedded in the program which URLs will be supported and by which handler function ( myHandler() ). The current handler supports the / URL, which in Go matches all URLs. This saves you from having to create any extra static or dynamic pages.","text_count":299,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.HandleFunc()"}]},{"block_type":"text","content":"function tells the web server embedded in the program which URLs will be supported and by which handler function ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHandler()"}]},{"block_type":"text","content":"). The current handler supports the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/"}]},{"block_type":"text","content":"URL, which in Go matches all URLs. This saves you from having to create any extra static or dynamic pages."}]},{"block_type":"element","block":"k6pz2ik0","search_text":"The code of the htmlT.go program is divided in two virtual parts. The first part is about getting the data from the database and putting it into a slice of structures, whereas the second part, which is similar to textT.go , is about displaying your data in a web browser.","text_count":271,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"program is divided in two virtual parts. The first part is about getting the data from the database and putting it into a slice of structures, whereas the second part, which is similar to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"textT.go"}]},{"block_type":"text","content":", is about displaying your data in a web browser."}]},{"block_type":"element","block":"k6pz2ik1","search_text":"Note The two biggest advantages of SQLite are that you do not need to run a server process for the database server and that SQLite databases are stored in self-contained files, which means that single files hold entire SQLite databases. ","text_count":237,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The two biggest advantages of SQLite are that you do not need to run a server process for the database server and that SQLite databases are stored in self-contained files, which means that single files hold entire SQLite databases."}]}]},{"block_type":"element","block":"k6pz2ik2","search_text":"Note that in order to reduce the Go code and be able to run the htmlT.go program multiple times, you will need to create the database table and the SQLite3 database manually, which is as simple as executing the following commands:","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that in order to reduce the Go code and be able to run the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"program multiple times, you will need to create the database table and the SQLite3 database manually, which is as simple as executing the following commands:"}]},{"block_type":"element","block":"k6pz2ik3","search_text":"$ sqlite3 htmlT.db SQLite version 3.19.3 2017-06-27 16:48:08 Enter \".help\" for usage hints. sqlite> CREATE TABLE data ( ...> number INTEGER PRIMARY KEY, ...> double INTEGER, ...> square INTEGER ); sqlite> ^D $ ls -l htmlT.db -rw-r--r-- 1 mtsouk staff 8192 Dec 26 22:46 htmlT.db ","text_count":278,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sqlite3 htmlT.db\nSQLite version 3.19.3 2017-06-27 16:48:08\nEnter \".help\" for usage hints.\nsqlite&gt; CREATE TABLE data (\n  ...&gt; number INTEGER PRIMARY KEY,\n  ...&gt; double INTEGER,\n  ...&gt; square INTEGER );\nsqlite&gt; ^D\n$ ls -l htmlT.db\n-rw-r--r--  1 mtsouk  staff  8192 Dec 26 22:46 htmlT.db"}]}]},{"block_type":"element","block":"k6pz2ik4","search_text":"The first command is executed from the Unix shell, and it is needed for creating the database file. The second command is executed from the SQLite3 shell and has to do with creating a database table named data , which has three fields named number , double , and square , respectively.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first command is executed from the Unix shell, and it is needed for creating the database file. The second command is executed from the SQLite3 shell and has to do with creating a database table named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":", which has three fields named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"number"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"double"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2ik5","search_text":"Additionally, you are going to need an external template file, which will be named html.gohtml . It is going to be used for the generation of the output of the program.","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you are going to need an external template file, which will be named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":". It is going to be used for the generation of the output of the program."}]},{"block_type":"element","block":"k6pz2ik6","search_text":"The first part of html.gohtml is the following:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2ik7","search_text":"<!doctype html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>Doing Maths in Go!</title> <style> html { font-size: 14px; } table, th, td { border: 2px solid blue; } </style> </head> <body> ","text_count":197,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;!doctype html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n   &lt;meta charset=\"UTF-8\"&gt; \n         &lt;title&gt;Doing Maths in Go!&lt;/title&gt; \n         &lt;style&gt; \n               html { \n                     font-size: 14px; \n               } \n               table, th, td { \n                   border: 2px solid blue; \n               } \n         &lt;/style&gt; \n   &lt;/head&gt; \n   &lt;body&gt;"}]}]},{"block_type":"element","block":"k6pz2ik8","search_text":"The HTML code that a web browser will read is going to be based on the contents of html.gohtml . This means that you will need to create proper HTML output, hence the preceding HTML code, which also includes some in-line CSS code for formatting the generated HTML table.","text_count":270,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The HTML code that a web browser will read is going to be based on the contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":". This means that you will need to create proper HTML output, hence the preceding HTML code, which also includes some in-line CSS code for formatting the generated HTML table."}]},{"block_type":"element","block":"k6pz2ik9","search_text":"The second part of html.gohtml contains the following code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2ika","search_text":"<table> <thead> <tr> <th>Number</th> <th>Double</th> <th>Square</th> </tr> </thead> <tbody> {{ range . }} <tr> <td> {{ .Number }} </td> <td> {{ .Double }} </td> <td> {{ .Square }} </td> </tr> {{ end }} </tbody> </table> ","text_count":220,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;table&gt; \n   &lt;thead&gt; \n         &lt;tr&gt; \n              &lt;th&gt;Number&lt;/th&gt; \n              &lt;th&gt;Double&lt;/th&gt; \n              &lt;th&gt;Square&lt;/th&gt; \n         &lt;/tr&gt; \n   &lt;/thead&gt; \n   &lt;tbody&gt; \n{{ range . }} \n   &lt;tr&gt; \n         &lt;td&gt; {{ .Number }} &lt;/td&gt; \n         &lt;td&gt; {{ .Double }} &lt;/td&gt; \n         &lt;td&gt; {{ .Square }} &lt;/td&gt; \n   &lt;/tr&gt; \n{{ end }} \n   &lt;/tbody&gt; \n&lt;/table&gt;"}]}]},{"block_type":"element","block":"k6pz2ikb","search_text":"As you can see from the preceding code, you still have to use {{ range }} and {{ end }} in order to iterate over the elements of the slice of structures that was passed to template.ExecuteTemplate() . However, this time the html.gohtml template file contains lots of HTML code in order to format the data in the slice of structures better.","text_count":339,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the preceding code, you still have to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{ range }}"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"{{ end }}"}]},{"block_type":"text","content":"in order to iterate over the elements of the slice of structures that was passed to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.ExecuteTemplate()"}]},{"block_type":"text","content":". However, this time the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":"template file contains lots of HTML code in order to format the data in the slice of structures better."}]},{"block_type":"element","block":"k6pz2ikc","search_text":"The last part of the HTML template file is the following:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the HTML template file is the following:"}]},{"block_type":"element","block":"k6pz2ikd","search_text":"</body> </html> ","text_count":16,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;/body&gt; \n&lt;/html&gt;"}]}]},{"block_type":"element","block":"k6pz2ike","search_text":"The last part of html.gohtml is mainly used for properly ending the generated HTML code according to the HTML standards.","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html.gohtml"}]},{"block_type":"text","content":"is mainly used for properly ending the generated HTML code according to the HTML standards."}]},{"block_type":"element","block":"k6pz2ikf","search_text":"Before being able to compile and execute htmlT.go , you will need to download the package that will help the Go programming language to communicate with SQLite3. You can do this by executing the following command:","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Before being able to compile and execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":", you will need to download the package that will help the Go programming language to communicate with SQLite3. You can do this by executing the following command:"}]},{"block_type":"element","block":"k6pz2ikg","search_text":"$ go get github.com/mattn/go-sqlite3","text_count":36,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go get github.com/mattn/go-sqlite3"}]}]},{"block_type":"element","block":"k6pz2ikh","search_text":"As you already know, you can find the source code of the downloaded package inside ~/go/src and its compiled version inside ~/go/pkg/darwin_amd64 if you are on a macOS machine. Otherwise, check the contents of ~/go/pkg to find out your own architecture. Note that the ~ character denotes the home directory of the current user.","text_count":327,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you already know, you can find the source code of the downloaded package inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go/src"}]},{"block_type":"text","content":"and its compiled version inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go/pkg/darwin_amd64"}]},{"block_type":"text","content":"if you are on a macOS machine. Otherwise, check the contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go/pkg"}]},{"block_type":"text","content":"to find out your own architecture. Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~"}]},{"block_type":"text","content":"character denotes the home directory of the current user."}]},{"block_type":"element","block":"k6pz2iki","search_text":"Keep in mind that additional Go packages exist that can help you communicate with an SQLite3 database. However, the one used here is the only one that currently supports the database/sql interface.","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Keep in mind that additional Go packages exist that can help you communicate with an SQLite3 database. However, the one used here is the only one that currently supports the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"database/sql"}]},{"block_type":"text","content":"interface."}]},{"block_type":"element","block":"k6pz2ikj","search_text":"Executing htmlT.go will produce the kind of output on a web browser that you can see in the following screenshot:","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"will produce the kind of output on a web browser that you can see in the following screenshot:"}]},{"block_type":"element","block":"k6pz2ikk","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000015.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2ikl","search_text":"The output of the htmlT.go program","text_count":34,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the htmlT.go program"}]},{"block_type":"element","block":"k6pz2ikm","search_text":"Moreover, htmlT.go will generate the following type of output in your Unix shell, which is mainly debugging information:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Moreover,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"will generate the following type of output in your Unix shell, which is mainly debugging information:"}]},{"block_type":"element","block":"k6pz2ikn","search_text":"$ go run htmlT.go htmlT.db html.gohtml Emptying database table. Populating htmlT.db Host: localhost:8080 Path: / Host: localhost:8080 Path: /favicon.ico Host: localhost:8080 Path: /123","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run htmlT.go htmlT.db html.gohtml\nEmptying database table.\nPopulating htmlT.db\nHost: localhost:8080 Path: /\nHost: localhost:8080 Path: /favicon.ico\nHost: localhost:8080 Path: /123"}]}]},{"block_type":"element","block":"k6pz2iko","search_text":"If you want to see the HTML output of the program from the Unix shell, you can use the wget(1) utility as follows:","text_count":114,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to see the HTML output of the program from the Unix shell, you can use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wget(1)"}]},{"block_type":"text","content":"utility as follows:"}]},{"block_type":"element","block":"k6pz2ikp","search_text":"$ wget -qO- http://localhost:8080 <!doctype html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>Doing Maths in Go!</title> <style> html { font-size: 14px; } table, th, td { border: 2px solid blue; } </style> </head> <body> <table> <thead> <tr> ","text_count":252,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ wget -qO- http://localhost:8080 \n&lt;!doctype html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n   &lt;meta charset=\"UTF-8\"&gt; \n         &lt;title&gt;Doing Maths in Go!&lt;/title&gt; \n         &lt;style&gt; \n               html { \n                      font-size: 14px; \n               } \n               table, th, td { \n                   border: 2px solid blue; \n               } \n         &lt;/style&gt; \n   &lt;/head&gt; \n   &lt;body&gt; \n \n \n&lt;table&gt; \n   &lt;thead&gt; \n         &lt;tr&gt;"}]}]},{"block_type":"element","block":"k6pz2ikq","search_text":"Both text/template and html/template are powerful packages that can save you a lot of time, so I suggest that you use them when they fit the requirements of your applications.","text_count":175,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"are powerful packages that can save you a lot of time, so I suggest that you use them when they fit the requirements of your applications."}]},{"block_type":"element","block":"k6pz2ikr","search_text":"Basic SQLite3 commands","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Basic SQLite3 commands"}]},{"block_type":"element","block":"k6pz2iks","search_text":"This section will help you find your way to SQLite3 by presenting some simple commands.","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will help you find your way to SQLite3 by presenting some simple commands."}]},{"block_type":"element","block":"k6pz2ikt","search_text":"You can create a new table as follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can create a new table as follows:"}]},{"block_type":"element","block":"k6pz2iku","search_text":"sqlite> CREATE TABLE data ( ...> number INTEGER PRIMARY KEY, ...> double INTEGER, ...> square INTEGER ); ","text_count":105,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sqlite&gt; CREATE TABLE data ( \n   ...&gt; number INTEGER PRIMARY KEY, \n   ...&gt; double INTEGER, \n   ...&gt; square INTEGER );"}]}]},{"block_type":"element","block":"k6pz2ikv","search_text":"You can check the contents of a table named data as follows:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can check the contents of a table named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2ikw","search_text":"sqlite> select * from data; 20|40|400 21|42|441 22|44|484 ","text_count":58,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"sqlite&gt; select * from data; \n20|40|400 \n21|42|441 \n22|44|484"}]}]},{"block_type":"element","block":"k6pz2ikx","search_text":"You can completely delete an existing table using the following command:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can completely delete an existing table using the following command:"}]},{"block_type":"element","block":"k6pz2iky","search_text":"$ DROP TABLE ATABLE; ","text_count":21,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ DROP TABLE ATABLE;"}]}]},{"block_type":"element","block":"k6pz2ikz","search_text":"You can delete the data from an existing table as follows:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can delete the data from an existing table as follows:"}]},{"block_type":"element","block":"k6pz2il0","search_text":"$ DELETE FROM ATABLE; ","text_count":22,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ DELETE FROM ATABLE;"}]}]},{"block_type":"element","block":"k6pz2il1","search_text":"Finally, if you want to delete an entire SQLite3 database, you can simply delete its database file using the rm(1) Unix command.","text_count":128,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, if you want to delete an entire SQLite3 database, you can simply delete its database file using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rm(1)"}]},{"block_type":"text","content":"Unix command."}]},{"block_type":"element","block":"k6pz2il2","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2il3","search_text":"You will find the following resources very useful:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will find the following resources very useful:"}]},{"block_type":"element","block":"k6pz2il4","search_text":"Visit the documentation page of the syscall standard Go package at https://golang.org/pkg/syscall/ . This is one of the biggest Go documentation pages that I have ever seen! Visit the documentation page of the text/template package, which can be found at https://golang.org/pkg/text/template/ . Similarly, go to https://golang.org/pkg/html/template/ for the documentation of the html/template package. Visit the home page of SQLite3 at https://www.sqlite.org/ . Watch the Writing Beautiful Packages in Go video by Mat Ryer at https://www.youtube.com/watch?v=cAWlv2SeQus . If you want to know about Plan 9 , look at https://plan9.io/plan9/ . Take the time to look at the find(1) command line tool by visiting its man page ( man 1 find ). ","text_count":737,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/syscall/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/syscall/"}]},{"block_type":"text","content":". This is one of the biggest Go documentation pages that I have ever seen!"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/text/template/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/text/template/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Similarly, go to"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/html/template/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/html/template/"}]},{"block_type":"text","content":"for the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the home page of SQLite3 at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.sqlite.org/"},"children":[{"block_type":"text","content":"https://www.sqlite.org/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Watch the Writing Beautiful Packages in Go video by"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Mat Ryer"}]},{"block_type":"text","content":"at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.youtube.com/watch?v=cAWlv2SeQus"},"children":[{"block_type":"text","content":"https://www.youtube.com/watch?v=cAWlv2SeQus"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you want to know about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Plan 9"}]},{"block_type":"text","content":", look at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://plan9.io/plan9/"},"children":[{"block_type":"text","content":"https://plan9.io/plan9/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Take the time to look at the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"find(1)"}]},{"block_type":"text","content":"command line tool by visiting its man page ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"man 1 find"}]},{"block_type":"text","content":")."}]}]},{"block_type":"element","block":"k6pz2il5","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2il6","search_text":"Seek out more information about the actual implementation of the fmt.Printf() function. Can you write a function that sorts three int values? Try to write two versions of the function: one with named returned values and another without named return values. Which one do you think is better? Can you modify the Go code of htmlT.go in order to use text/template instead of html/template ? Can you modify the Go code of htmlT.go in order to use either https://github.com/feyeleanor/gosqlite3 or the https://github.com/phf/go-sqlite3 package for communicating with the SQLite3 database? Write a Go program like htmlT.go that reads data from a MySQL database. Write down the code changes that you made. ","text_count":698,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Seek out more information about the actual implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you write a function that sorts three"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"values? Try to write two versions of the function: one with named returned values and another without named return values. Which one do you think is better?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"in order to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"in order to use either"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/feyeleanor/gosqlite3"},"children":[{"block_type":"text","content":"https://github.com/feyeleanor/gosqlite3"}]},{"block_type":"text","content":"or the"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/phf/go-sqlite3"},"children":[{"block_type":"text","content":"https://github.com/phf/go-sqlite3"}]},{"block_type":"text","content":"package for communicating with the SQLite3 database?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"htmlT.go"}]},{"block_type":"text","content":"that reads data from a MySQL database. Write down the code changes that you made."}]}]},{"block_type":"element","block":"k6pz2il7","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2il8","search_text":"In this chapter, we presented two primary topics: Go functions and Go packages. We offered you ample advice about developing good Go packages. We also talked about the text/template and html/template packages, which allow you to create plain text and HTML output based on templates. Last, we talked about the syscall standard Go package that offers advanced features.","text_count":367,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, we presented two primary topics: Go functions and Go packages. We offered you ample advice about developing good Go packages. We also talked about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"packages, which allow you to create plain text and HTML output based on templates. Last, we talked about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package that offers advanced features."}]},{"block_type":"element","block":"k6pz2il9","search_text":"In the next chapter, we will discuss two important Go features: interfaces and reflection. Additionally, we will talk about object-oriented programming in Go and Go type methods. All of these topics are pretty advanced, and you might find them difficult at first. However, learning more about them will unquestionably make you a better Go programmer!","text_count":350,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next chapter, we will discuss two important Go features: interfaces and reflection. Additionally, we will talk about object-oriented programming in Go and Go type methods. All of these topics are pretty advanced, and you might find them difficult at first. However, learning more about them will unquestionably make you a better Go programmer!"}]}]},{"title":"Reflection and Interfaces for All Seasons","author":"Mihalis Tsoukalos","block":"k6pz24kw","number":7,"contents":[{"block_type":"element","block":"k6pz2ila","search_text":"In the previous chapter, we talked about developing packages and functions in Go. We also discussed how to work with text and HTML templates with the help of the text/template and html/template packages. Finally, we explained the use of the syscall package.","text_count":257,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we talked about developing packages and functions in Go. We also discussed how to work with text and HTML templates with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"packages. Finally, we explained the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2ilb","search_text":"In this chapter, you will learn three very interesting, handy, and somewhat advanced Go concepts: reflection, interfaces, and type methods. Although Go interfaces are used all of the time, reflection is not, mainly because it is usually unnecessary for your programs to make use of it. Furthermore, you will learn about type assertions and object-oriented programming ( OOP ) in Go.","text_count":382,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn three very interesting, handy, and somewhat advanced Go concepts: reflection, interfaces, and type methods. Although Go interfaces are used all of the time, reflection is not, mainly because it is usually unnecessary for your programs to make use of it. Furthermore, you will learn about type assertions and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"object-oriented programming"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"OOP"}]},{"block_type":"text","content":") in Go."}]},{"block_type":"element","block":"k6pz2ilc","search_text":"In this chapter, you will learn the following topics:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2ild","search_text":"Type methods Go Interfaces Type assertions Developing and using your own interfaces Object-oriented programming the Go way Reflection and the reflect standard Go package ","text_count":170,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Type methods"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Go Interfaces"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Type assertions"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing and using your own interfaces"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Object-oriented programming the Go way"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Reflection and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect"}]},{"block_type":"text","content":"standard Go package"}]}]},{"block_type":"element","block":"k6pz2ile","search_text":"Type methods","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Type methods"}]},{"block_type":"element","block":"k6pz2ilf","search_text":"A Go type method is a function with a special receiver argument. You declare methods as ordinary functions with an additional parameter that appears in front of the function name. This particular parameter connects the function to the type of that extra parameter. As a result, that parameter is called the receiver of the method .","text_count":331,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"type method"}]},{"block_type":"text","content":"is a function with a special receiver argument. You declare methods as ordinary functions with an additional parameter that appears in front of the function name. This particular parameter connects the function to the type of that extra parameter. As a result, that parameter is called the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"receiver of the method"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ilg","search_text":"The following Go code represents the implementation of the Close() function as found in https://golang.org/src/os/file_plan9.go :","text_count":129,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following Go code represents the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Close()"}]},{"block_type":"text","content":"function as found in&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/os/file_plan9.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/os/file_plan9.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ilh","search_text":"func (f *File) Close() error { if err := f.checkValid(\"close\"); err != nil { return err } return f.file.close() } ","text_count":114,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (f *File) Close() error { \n    if err := f.checkValid(\"close\"); err != nil { \n        return err \n    } \n    return f.file.close() \n}"}]}]},{"block_type":"element","block":"k6pz2ili","search_text":"The Close() function is a type method because there is that (f *File) parameter in front of its name and after the func keyword. The f parameter is called the receiver of the method; in object-oriented programming terminology this process can be described as sending a message to an object . In Go, the receiver of a method is defined using a regular variable name—usually using a single letter—without the need to use a dedicated keyword, such as this or self .","text_count":462,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Close()"}]},{"block_type":"text","content":"function is a type method because there is that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"(f *File)"}]},{"block_type":"text","content":"parameter in front of its name and after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"func"}]},{"block_type":"text","content":"keyword. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f"}]},{"block_type":"text","content":"parameter is called the receiver of the method; in object-oriented programming terminology this process can be described as sending a message to an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"object"}]},{"block_type":"text","content":". In Go, the receiver of a method is defined using a regular variable name&mdash;usually using a single letter&mdash;without the need to use a dedicated keyword, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"this"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"self"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ilj","search_text":"Now let's review a complete example using the Go code of the methods.go file, which will be presented in four parts.","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's review a complete example using the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"file, which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2ilk","search_text":"The first part of methods.go is shown in the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ill","search_text":"package main import ( \"fmt\" ) type twoInts struct { X int64 Y int64 } ","text_count":70,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype twoInts struct { \n    X int64 \n    Y int64 \n}"}]}]},{"block_type":"element","block":"k6pz2ilm","search_text":"In the preceding Go code, you can see the definition of a new structure with two fields named twoInts .","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you can see the definition of a new structure with two fields named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoInts"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iln","search_text":"The second code segment of methods.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"&nbsp;follows next:"}]},{"block_type":"element","block":"k6pz2ilo","search_text":"func regularFunction(a, b twoInts) twoInts { temp := twoInts{X: a.X + b.X, Y: a.Y + b.Y} return temp } ","text_count":103,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func regularFunction(a, b twoInts) twoInts { \n    temp := twoInts{X: a.X + b.X, Y: a.Y + b.Y} \n    return temp \n}"}]}]},{"block_type":"element","block":"k6pz2ilp","search_text":"In this part, you define a new function named regularFunction() that accepts two parameters of type twoInts and returns just one twoInts value.","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you define a new function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regularFunction()"}]},{"block_type":"text","content":"that accepts two parameters of type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoInts"}]},{"block_type":"text","content":"and returns just one"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"twoInts"}]},{"block_type":"text","content":"value."}]},{"block_type":"element","block":"k6pz2ilq","search_text":"The third part of the methods.go program contains the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ilr","search_text":"func (a twoInts) method(b twoInts) twoInts { temp := twoInts{X: a.X + b.X, Y: a.Y + b.Y} return temp } ","text_count":103,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (a twoInts) method(b twoInts) twoInts { \n    temp := twoInts{X: a.X + b.X, Y: a.Y + b.Y} \n    return temp \n}"}]}]},{"block_type":"element","block":"k6pz2ils","search_text":"The method() function is equivalent to the regularFunction() function defined in the preceding part of methods.go . However, the method() function is a type method, and you will need to learn a different way for calling it in a moment.","text_count":235,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"method()"}]},{"block_type":"text","content":"function is equivalent to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regularFunction()"}]},{"block_type":"text","content":"function defined in the preceding part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":". However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"method()"}]},{"block_type":"text","content":"function is a type method, and you will need to learn a different way for calling it in a moment."}]},{"block_type":"element","block":"k6pz2ilt","search_text":"Note The really interesting thing here is that the implementation of method() is exactly the same as the implementation of regularFunction() . ","text_count":143,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The really interesting thing here is that the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"method()"}]},{"block_type":"text","content":"is exactly the same as the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regularFunction()"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2ilu","search_text":"The last code segment of methods.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ilv","search_text":"func main() { i := twoInts{X: 1, Y: 2} j := twoInts{X: -5, Y: -2} fmt.Println(regularFunction(i, j)) fmt.Println(i.method(j)) } ","text_count":128,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    i := twoInts{X: 1, Y: 2} \n    j := twoInts{X: -5, Y: -2} \n    fmt.Println(regularFunction(i, j)) \n    fmt.Println(i.method(j)) \n}"}]}]},{"block_type":"element","block":"k6pz2ilw","search_text":"As you can see, the way that you are calling a type method ( i.method(j) ) is different from the way that you would call a conventional function ( regularFunction(i, j) ).","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the way that you are calling a type method ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i.method(j)"}]},{"block_type":"text","content":") is different from the way that you would call a conventional function ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regularFunction(i, j)"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2ilx","search_text":"Executing methods.go will create the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"methods.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2ily","search_text":"$ go run methods.go {-4 0} {-4 0} ","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run methods.go\n{-4 0}\n{-4 0}"}]}]},{"block_type":"element","block":"k6pz2ilz","search_text":"Notice that type methods are also associated with interfaces, which will be the subject of the next section. As a result, you will see more type methods in a little while.","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that type methods are also associated with interfaces, which will be the subject of the next section. As a result, you will see more type methods in a little while."}]},{"block_type":"element","block":"k6pz2im0","search_text":"Go interfaces","text_count":13,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go interfaces"}]},{"block_type":"element","block":"k6pz2im1","search_text":"Strictly speaking, a Go interface type defines the behavior of other types by specifying a set of methods that need to be implemented. For a type to satisfy an interface, it needs to implement all of the methods required by that interface. Put simply, interfaces are abstract types that define a set of functions that need to be implemented so that a type can be considered an instance of the interface. When this happens, we say that the type satisfies this interface. So, an interface is two things: a set of methods and a type, and it is used for defining the behavior of other types.","text_count":587,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a Go"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"interface"}]},{"block_type":"text","content":"type defines the behavior of other types by specifying a set of methods that need to be implemented. For a type to satisfy an interface, it needs to implement all of the methods required by that interface. Put simply, interfaces are"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"abstract types"}]},{"block_type":"text","content":"that define a set of functions that need to be implemented so that a type can be considered an instance of the interface. When this happens, we say that the type satisfies this interface. So, an interface is two things: a set of methods and a type, and it is used for defining the behavior of other types."}]},{"block_type":"element","block":"k6pz2im2","search_text":"The biggest advantage that you receive from having and using an interface is that you can pass a variable of a type that implements that particular interface to any function that expects a parameter of that specific interface. Without that amazing capability, interfaces would only be a formality without any practical or real benefit.","text_count":335,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The biggest advantage that you receive from having and using an interface is that you can pass a variable of a type that implements that particular interface to any function that expects a parameter of that specific interface. Without that amazing capability, interfaces would only be a formality without any practical or real benefit."}]},{"block_type":"element","block":"k6pz2im3","search_text":"Note If you find yourselves defining an interface and its implementation in the same Go package, then you might have been using interfaces the wrong way! ","text_count":154,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you find yourselves defining an interface and its implementation in the same Go package, then you might have been using interfaces the wrong way!"}]}]},{"block_type":"element","block":"k6pz2im4","search_text":"Two very common Go interfaces are io.Reader and io.Writer , which are used in file input and output operations. More specifically, io.Reader is used for reading a file, whereas io.Writer is used for writing to a file.","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Two very common Go interfaces are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":", which are used in file input and output operations. More specifically,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"is used for reading a file, whereas"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"is used for writing to a file."}]},{"block_type":"element","block":"k6pz2im5","search_text":"The definition of io.Reader , as found in https://golang.org/src/io/io.go , is as follows:","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":", as found in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/io/io.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/io/io.go"}]},{"block_type":"text","content":", is as follows:"}]},{"block_type":"element","block":"k6pz2im6","search_text":"type Reader interface { Read(p []byte) (n int, err error) } ","text_count":60,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Reader interface { \n    Read(p []byte) (n int, err error) \n}"}]}]},{"block_type":"element","block":"k6pz2im7","search_text":"In order for a type to satisfy the io.Reader interface, you will need to implement the Read() method as described in the interface.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order for a type to satisfy the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"interface, you will need to implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Read()"}]},{"block_type":"text","content":"method as described in the interface."}]},{"block_type":"element","block":"k6pz2im8","search_text":"Similarly, the definition of io.Writer , as found in https://golang.org/src/io/io.go , is the following:","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, the definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":", as found in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/io/io.go"},"children":[{"block_type":"text","content":"https://golang.org/src/io/io.go"}]},{"block_type":"text","content":", is the following:"}]},{"block_type":"element","block":"k6pz2im9","search_text":"type Writer interface { Write(p []byte) (n int, err error) } ","text_count":61,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Writer interface { \n    Write(p []byte) (n int, err error) \n}"}]}]},{"block_type":"element","block":"k6pz2ima","search_text":"To satisfy the io.Writer interface, you will just need to implement a single method named Write() .","text_count":99,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"To satisfy the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interface, you will just need to implement a single method named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2imb","search_text":"Each one of the io.Reader and io.Writer interfaces requires the implementation of just one method, yet both interface are very powerful. Most likely, their power comes from their simplicity! Generally speaking, interfaces should be as simple as possible.","text_count":254,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each one of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interfaces requires the implementation of just one method, yet both interface are very powerful. Most likely, their power comes from their simplicity! Generally speaking, interfaces should be as simple as possible."}]},{"block_type":"element","block":"k6pz2imc","search_text":"In the following subsections, you will learn how to define an interface on your own and how to use it in other Go packages. Notice that it is not necessary for an interface to be fancy or impressive, as long as it does what you want it to do.","text_count":242,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the following subsections, you will learn how to define an interface on your own and how to use it in other Go packages. Notice that it is not necessary for an interface to be fancy or impressive, as long as it does what you want it to do."}]},{"block_type":"element","block":"k6pz2imd","search_text":"Tip Put simply, interfaces should be utilized when there is a need for making sure that certain conditions will be met and certain behaviors will be anticipated from a Go element. ","text_count":180,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Put simply, interfaces should be utilized when there is a need for making sure that certain conditions will be met and certain behaviors will be anticipated from a Go element."}]}]},{"block_type":"element","block":"k6pz2ime","search_text":"About type assertion","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About type assertion"}]},{"block_type":"element","block":"k6pz2imf","search_text":"A type assertion is the x.(T) notation where x is of interface type and T is a type. Additionally, the actual value stored in x is of type T , and T must satisfy the interface type of x ! The following paragraphs, as well as the code example, will clarify this relatively eccentric definition of type assertion.","text_count":311,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"type assertion"}]},{"block_type":"text","content":"is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x.(T)"}]},{"block_type":"text","content":"notation where"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"is of interface type and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"T"}]},{"block_type":"text","content":"is a type. Additionally, the actual value stored in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"is of type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"T"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"T"}]},{"block_type":"text","content":"must satisfy the interface type of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"! The following paragraphs, as well as the code example, will clarify this relatively eccentric definition of type assertion."}]},{"block_type":"element","block":"k6pz2img","search_text":"Type assertions help you do two things . The first thing is to check whether an interface value keeps a particular type. When used this way, a type assertion returns two values: the underlying value and a bool value. Although the underlying value is what you might want to use, the Boolean value tells you whether the type assertion was successful or not!","text_count":355,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Type assertions help you do"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"two things"}]},{"block_type":"text","content":". The first thing is to check whether an interface value keeps a particular type. When used this way, a type assertion returns two values: the underlying value and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bool"}]},{"block_type":"text","content":"value. Although the underlying value is what you might want to use, the Boolean value tells you whether the type assertion was successful or not!"}]},{"block_type":"element","block":"k6pz2imh","search_text":"The second thing a type assertion does is to allow you to use the concrete value stored in an interface or assign it to a new variable. This means that if there is an int variable in an interface, you can get that value using type assertion.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second thing a type assertion does is to allow you to use the concrete value stored in an interface or assign it to a new variable. This means that if there is an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"variable in an interface, you can get that value using type assertion."}]},{"block_type":"element","block":"k6pz2imi","search_text":"However, if a type assertion is not successful and you do not handle that failure on your own, your program will panic. Now study the Go code of the assertion.go program, which will be presented in two parts. The first part contains the following Go code:","text_count":255,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, if a type assertion is not successful and you do not handle that failure on your own, your program will panic. Now study the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"assertion.go"}]},{"block_type":"text","content":"program, which will be presented in two parts. The first part contains the following Go code:"}]},{"block_type":"element","block":"k6pz2imj","search_text":"package main import ( \"fmt\" ) func main() { var myInt interface{} = 123 k, ok := myInt.(int) if ok { fmt.Println(\"Success:\", k) } v, ok := myInt.(float64) if ok { fmt.Println(v) } else { fmt.Println(\"Failed without panicking!\") } ","text_count":230,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \nfunc main() { \n    var myInt interface{} = 123 \n \n    k, ok := myInt.(int) \n    if ok { \n        fmt.Println(\"Success:\", k) \n    } \n \n    v, ok := myInt.(float64) \n    if ok { \n        fmt.Println(v) \n    } else { \n        fmt.Println(\"Failed without panicking!\") \n    }"}]}]},{"block_type":"element","block":"k6pz2imk","search_text":"First, you declare the myInt variable, which has dynamic type int and value 123 . Then, you use type assertion two times to test the interface of the myInt variable—once for int and once for float64 .","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, you declare the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"variable, which has dynamic type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"and value"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"123"}]},{"block_type":"text","content":". Then, you use type assertion two times to test the interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"variable&mdash;once for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"and once for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float64"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iml","search_text":"As the myInt variable does not contain a float64 value, the myInt.(float64) type assertion will fail unless handled properly. Fortunately, in this case the correct use of the ok variable will save your program from panicking.","text_count":225,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"variable does not contain a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float64"}]},{"block_type":"text","content":"value, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt.(float64)"}]},{"block_type":"text","content":"type assertion will fail unless handled properly. Fortunately, in this case the correct use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ok"}]},{"block_type":"text","content":"variable will save your program from panicking."}]},{"block_type":"element","block":"k6pz2imm","search_text":"The second part of the assertion.go program is shown in the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"assertion.go"}]},{"block_type":"text","content":"program is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2imn","search_text":"i := myInt.(int) fmt.Println(\"No cheking:\", i) j := myInt.(bool) fmt.Println(j) } ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"i := myInt.(int) \n    fmt.Println(\"No cheking:\", i) \n \n    j := myInt.(bool) \n    fmt.Println(j) \n}"}]}]},{"block_type":"element","block":"k6pz2imo","search_text":"There are two type assertions taking place here. The first type assertion is successful, so there will be no problem with that. But let's review this particular type assertion a bit further. The type of variable i will be int , and its value will be 123 , which is the value stored in myInt . So, as int satisfies the myInt interface, which in this case occurs because the myInt interface requires no functions in order to be implemented, the value of myInt.(int) is an int value.","text_count":480,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are two type assertions taking place here. The first type assertion is successful, so there will be no problem with that. But let's review this particular type assertion a bit further. The type of variable"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":", and its value will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"123"}]},{"block_type":"text","content":", which is the value stored in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":". So, as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"satisfies the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"interface, which in this case occurs because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"interface requires no functions in order to be implemented, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt.(int)"}]},{"block_type":"text","content":"is an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"value."}]},{"block_type":"element","block":"k6pz2imp","search_text":"However, the second type assertion, which is myInt.(bool) , will trigger a panic because the underlying value of myInt is not Boolean ( bool ). Therefore, executing assertion.go will generate the following output:","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, the second type assertion, which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt.(bool)"}]},{"block_type":"text","content":", will trigger a panic because the underlying value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInt"}]},{"block_type":"text","content":"is not Boolean ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bool"}]},{"block_type":"text","content":"). Therefore, executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"assertion.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2imq","search_text":"$ go run assertion.go Success: 123 Failed without panicking! No cheking: 123 panic: interface conversion: interface {} is int, not bool goroutine 1 [running]: main.main() /Users/mtsouk/Desktop/masterGo/ch/ch7/code/assertion.go:25 +0x1d9 exit status 2","text_count":250,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run assertion.go\nSuccess: 123\nFailed without panicking!\nNo cheking: 123\npanic: interface conversion: interface {} is int, not bool\n    \ngoroutine 1 [running]:\nmain.main()\n      /Users/mtsouk/Desktop/masterGo/ch/ch7/code/assertion.go:25 +0x1d9\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2imr","search_text":"Go states pretty clearly the reason for panicking: interface {} is int, not bool .","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go states pretty clearly the reason for panicking:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"interface {} is int, not bool"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ims","search_text":"Generally speaking, when working with interfaces, expect to use type assertions as well. You will see more type assertions in the useInterface.go program that will be presented in a short while.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, when working with interfaces, expect to use type assertions as well. You will see more type assertions in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":"program that will be presented in a short while."}]},{"block_type":"element","block":"k6pz2imt","search_text":"Developing your own interfaces","text_count":30,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Developing your own interfaces"}]},{"block_type":"element","block":"k6pz2imu","search_text":"In this section, you will learn how to develop your own interfaces, This is a relatively easy process as long as you know what you want to develop.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to develop your own interfaces, This is a relatively easy process as long as you know what you want to develop."}]},{"block_type":"element","block":"k6pz2imv","search_text":"The technique will be illustrated using the Go code of myInterface.go , which will be presented below. The interface that will be created will help you work with geometric shapes of the plane.","text_count":192,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique will be illustrated using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.go"}]},{"block_type":"text","content":", which will be presented below. The interface that will be created will help you work with geometric shapes of the plane."}]},{"block_type":"element","block":"k6pz2imw","search_text":"The Go code of myInterface.go follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2imx","search_text":"package myInterface type Shape interface { Area() float64 Perimeter() float64 } ","text_count":80,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package myInterface \n \ntype Shape interface { \n    Area() float64 \n    Perimeter() float64 \n}"}]}]},{"block_type":"element","block":"k6pz2imy","search_text":"The definition of the shape interface is truly simple and straightforward, as it requires that you implement just two functions named Area() and Perimeter() , which both return a float64 value. The first function will be used for calculating the area of a shape in the plane and the second one will be used for calculating the perimeter of a shape in the plane. After that, you will need to install the myInterface.go package and make it available to the current user. As you already know, the installation process involves the execution of the following Unix commands:","text_count":569,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"interface is truly simple and straightforward, as it requires that you implement just two functions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Area()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Perimeter()"}]},{"block_type":"text","content":", which both return a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"float64"}]},{"block_type":"text","content":"value. The first function will be used for calculating the area of a shape in the plane and the second one will be used for calculating the perimeter of a shape in the plane. After that, you will need to install the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.go"}]},{"block_type":"text","content":"package and make it available to the current user. As you already know, the installation process involves the execution of the following Unix commands:"}]},{"block_type":"element","block":"k6pz2imz","search_text":"$ mkdir ~/go/src/myInterface $ cp myInterface.go ~/go/src/myInterface $ go install myInterface ","text_count":95,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir ~/go/src/myInterface\n$ cp myInterface.go ~/go/src/myInterface\n$ go install myInterface"}]}]},{"block_type":"element","block":"k6pz2in0","search_text":"Using a Go interface","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using a Go interface"}]},{"block_type":"element","block":"k6pz2in1","search_text":"This subsection will teach you how to use the interface defined in myInterface.go in a Go program named useInterface.go , which will be presented in five parts.","text_count":160,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will teach you how to use the interface defined in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.go"}]},{"block_type":"text","content":"in a Go program named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":", which will be presented in five parts."}]},{"block_type":"element","block":"k6pz2in2","search_text":"The first part of useInterface.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2in3","search_text":"package main import ( \"fmt\" \"math\" \"myInterface\" ) type square struct { X float64 } type circle struct { R float64 } ","text_count":117,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math\" \n    \"myInterface\" \n) \n \ntype square struct { \n    X float64 \n} \n \ntype circle struct { \n    R float64 \n}"}]}]},{"block_type":"element","block":"k6pz2in4","search_text":"As the desired interface is defined in its own package, it should come as no surprise that you are importing the myInterface package.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the desired interface is defined in its own package, it should come as no surprise that you are importing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2in5","search_text":"The second code portion of useInterface.go contains the following code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2in6","search_text":"func (s square) Area() float64 { return s.X * s.X } func (s square) Perimeter() float64 { return 4 * s.X } ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (s square) Area() float64 { \n    return s.X * s.X \n} \n \nfunc (s square) Perimeter() float64 { \n    return 4 * s.X \n}"}]}]},{"block_type":"element","block":"k6pz2in7","search_text":"In this part, you implement the shape interface for the square type.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"interface for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":"type."}]},{"block_type":"element","block":"k6pz2in8","search_text":"The third part contains the following Go code:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part contains the following Go code:"}]},{"block_type":"element","block":"k6pz2in9","search_text":"func (s circle) Area() float64 { return s.R * s.R * math.Pi } func (s circle) Perimeter() float64 { return 2 * s.R * math.Pi } ","text_count":127,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (s circle) Area() float64 { \n    return s.R * s.R * math.Pi \n} \n \nfunc (s circle) Perimeter() float64 { \n    return 2 * s.R * math.Pi \n}"}]}]},{"block_type":"element","block":"k6pz2ina","search_text":"In this part, you implement the shape interface for the circle type.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"interface for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"circle"}]},{"block_type":"text","content":"type."}]},{"block_type":"element","block":"k6pz2inb","search_text":"The fourth part of useInterface.go is shown in the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2inc","search_text":"func Calculate(x myInterface.Shape) { _, ok := x.(circle) if ok { fmt.Println(\"Is a circle!\") } v, ok := x.(square) if ok { fmt.Println(\"Is a square:\", v) } fmt.Println(x.Area()) fmt.Println(x.Perimeter()) } ","text_count":208,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Calculate(x myInterface.Shape) { \n    _, ok := x.(circle) \n    if ok { \n        fmt.Println(\"Is a circle!\") \n    } \n \n    v, ok := x.(square) \n    if ok { \n        fmt.Println(\"Is a square:\", v) \n    } \n \n    fmt.Println(x.Area()) \n    fmt.Println(x.Perimeter()) \n}"}]}]},{"block_type":"element","block":"k6pz2ind","search_text":"Thus, in the preceding code, you implement one function that requires a single shape parameter ( myInterface.Shape ). The magic here should be obvious once you understand that it requires any shape parameter, which is any parameter whose type implements the shape interface!","text_count":274,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, in the preceding code, you implement one function that requires a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"parameter ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.Shape"}]},{"block_type":"text","content":"). The magic here should be obvious once you understand that it requires any"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"parameter, which is any parameter whose type implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"interface!"}]},{"block_type":"element","block":"k6pz2ine","search_text":"The code at the beginning of the function shows how you can differentiate between the various data types that implement the desired interface. In the second block, you see how you can find the values stored in a square parameter. You can use this technique for any type that implements the myInterface.Shape interface.","text_count":318,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code at the beginning of the function shows how you can differentiate between the various data types that implement the desired interface. In the second block, you see how you can find the values stored in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":"parameter. You can use this technique for any type that implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.Shape"}]},{"block_type":"text","content":"interface."}]},{"block_type":"element","block":"k6pz2inf","search_text":"The last code segment includes the following code:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment includes the following code:"}]},{"block_type":"element","block":"k6pz2ing","search_text":"func main() { x := square{X: 10} fmt.Println(\"Perimeter:\", x.Perimeter()) Calculate(x) y := circle{R: 5} Calculate(y) } ","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    x := square{X: 10} \n    fmt.Println(\"Perimeter:\", x.Perimeter()) \n    Calculate(x) \n    y := circle{R: 5} \n    Calculate(y) \n}"}]}]},{"block_type":"element","block":"k6pz2inh","search_text":"In this part, you see how you can use both circle and square variables as parameters to the Calculate() function that you implemented earlier.","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see how you can use both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"circle"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"square"}]},{"block_type":"text","content":"variables as parameters to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Calculate()"}]},{"block_type":"text","content":"function that you implemented earlier."}]},{"block_type":"element","block":"k6pz2ini","search_text":"If you execute useInterface.go , you will get the following as output:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":", you will get the following as output:"}]},{"block_type":"element","block":"k6pz2inj","search_text":"$ go run useInterface.go Perimeter: 40 Is a square: {10} 100 40 Is a circle! 78.53981633974483 31.41592653589793 ","text_count":113,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run useInterface.go\nPerimeter: 40\nIs a square: {10}\n100\n40\nIs a circle!\n78.53981633974483\n31.41592653589793"}]}]},{"block_type":"element","block":"k6pz2ink","search_text":"Using switch with interface and data types","text_count":42,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Using switch with interface and data types"}]},{"block_type":"element","block":"k6pz2inl","search_text":"In this subsection, you will learn how to use the switch statement to differentiate between different data types using the Go code of switch.go , which will be presented in four parts. The Go code of switch.go is partially based on useInterface.go , but it will add another type named rectangle and it will not need to implement the methods of any interface.","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement to differentiate between different data types using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":", which will be presented in four parts. The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is partially based on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useInterface.go"}]},{"block_type":"text","content":", but it will add another type named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rectangle"}]},{"block_type":"text","content":"and it will not need to implement the methods of any interface."}]},{"block_type":"element","block":"k6pz2inm","search_text":"The first part of the switch.go program follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"program follows next:"}]},{"block_type":"element","block":"k6pz2inn","search_text":"package main import ( \"fmt\" ) ","text_count":30,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2ino","search_text":"As the code in switch.go will not work with the interface defined in myInterface.go , there is no need to import the myInterface package.","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"will not work with the interface defined in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface.go"}]},{"block_type":"text","content":", there is no need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myInterface"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2inp","search_text":"The second part of switch.go is where you define the three types that will be used in the program:","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"is where you define the three types that will be used in the program:"}]},{"block_type":"element","block":"k6pz2inq","search_text":"type square struct { X float64 } type circle struct { R float64 } type rectangle struct { X float64 Y float64 } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type square struct { \n    X float64 \n} \n \ntype circle struct { \n    R float64 \n} \n \ntype rectangle struct { \n    X float64 \n    Y float64 \n}"}]}]},{"block_type":"element","block":"k6pz2inr","search_text":"All three types are pretty simple.","text_count":34,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All three types are pretty simple."}]},{"block_type":"element","block":"k6pz2ins","search_text":"The third code segment of switch.go comes with the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"comes with the following Go code:"}]},{"block_type":"element","block":"k6pz2int","search_text":"func tellInterface(x interface{}) { switch v := x.(type) { case square: fmt.Println(\"This is a square!\") case circle: fmt.Printf(\"%v is a circle!\\n\", v) case rectangle: fmt.Println(\"This is a rectangle!\") default: fmt.Printf(\"Unknown type %T!\\n\", v) } } ","text_count":254,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func tellInterface(x interface{}) { \n    switch v := x.(type) { \n    case square: \n        fmt.Println(\"This is a square!\") \n    case circle: \n        fmt.Printf(\"%v is a circle!\\n\", v) \n    case rectangle: \n        fmt.Println(\"This is a rectangle!\") \n    default: \n        fmt.Printf(\"Unknown type %T!\\n\", v) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2inu","search_text":"Here you can see the implementation of a function named tellInterface() with a single parameter named x and type interface{} .","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see the implementation of a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tellInterface()"}]},{"block_type":"text","content":"with a single parameter named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"and type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"interface{}"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2inv","search_text":"The trick presented here will help you differentiate between the different data types of the x parameter. All of the magic is performed by the use of the x.(type) statement that returns the type of the x element. The %v verb used in fmt.Printf() allows you to acquire the value of the type.","text_count":290,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The trick presented here will help you differentiate between the different data types of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"parameter. All of the magic is performed by the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x.(type)"}]},{"block_type":"text","content":"statement that returns the type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"element. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"%v"}]},{"block_type":"text","content":"verb used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"allows you to acquire the value of the type."}]},{"block_type":"element","block":"k6pz2inw","search_text":"The last part of switch.go contains the implementation of the main() function:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2inx","search_text":"func main() { x := circle{R: 10} tellInterface(x) y := rectangle{X: 4, Y: 1} tellInterface(y) z := square{X: 4} tellInterface(z) tellInterface(10) } ","text_count":149,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    x := circle{R: 10} \n    tellInterface(x) \n    y := rectangle{X: 4, Y: 1} \n    tellInterface(y) \n    z := square{X: 4} \n    tellInterface(z) \n    tellInterface(10) \n}"}]}]},{"block_type":"element","block":"k6pz2iny","search_text":"Executing switch.go will generate the following type of output:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2inz","search_text":"$ go run switch.go {10} is a circle! This is a rectangle! This is a square! Unknown type int! ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run switch.go\n{10} is a circle!\nThis is a rectangle!\nThis is a square!\nUnknown type int!"}]}]},{"block_type":"element","block":"k6pz2io0","search_text":"Reflection","text_count":10,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reflection"}]},{"block_type":"element","block":"k6pz2io1","search_text":"Reflection is an advanced Go feature that allows you to dynamically learn the type of an arbitrary object as well as information about its structure. Go offers the reflect package for working with reflection. What you should remember is that you will most likely not need to use reflection in each one of your Go programs.","text_count":322,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Reflection"}]},{"block_type":"text","content":"is an advanced Go feature that allows you to dynamically learn the type of an arbitrary object as well as information about its structure. Go offers the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect"}]},{"block_type":"text","content":"package for working with reflection. What you should remember is that you will most likely not need to use reflection in each one of your Go programs."}]},{"block_type":"element","block":"k6pz2io2","search_text":"The first two questions that might arise are why is reflection necessary and when should I use it?","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first two questions that might arise are why is reflection necessary and when should I use it?"}]},{"block_type":"element","block":"k6pz2io3","search_text":"Reflection is necessary for the implementation of packages such as fmt , text/template , and html/template . In the fmt package, reflection saves you from having to deal explicitly with every data type that exists. However, even if you had the patience to write code for working with every data type that you knew, you still would not be able to work with all possible types! In this case, reflection makes it possible for the methods of the fmt package to find the structure and to work with new types!","text_count":503,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Reflection is necessary for the implementation of packages such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"text/template"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":". In the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package, reflection saves you from having to deal explicitly with every data type that exists. However, even if you had the patience to write code for working with every data type that you knew, you still would not be able to work with all possible types! In this case, reflection makes it possible for the methods of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package to find the structure and to work with new types!"}]},{"block_type":"element","block":"k6pz2io4","search_text":"Consequently, you might need to use reflection when you want to be as generic as possible, or when you want to make sure that you will be able to deal with data types that do not exist at the time that you are writing your code. Additionally, reflection is handy when working with values of types that do not implement a common interface.","text_count":338,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Consequently, you might need to use reflection when you want to be as generic as possible, or when you want to make sure that you will be able to deal with data types that do not exist at the time that you are writing your code. Additionally, reflection is handy when working with values of types that do not implement a common interface."}]},{"block_type":"element","block":"k6pz2io5","search_text":"Note Reflection helps you work with unknown types and unknown values of types. ","text_count":79,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Reflection helps you work with unknown types and unknown values of types."}]}]},{"block_type":"element","block":"k6pz2io6","search_text":"The stars of the reflect package are two types named reflect.Value and reflect.Type . The former type is used for storing values of any type, whereas the latter type is used for representing Go types.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The stars of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect"}]},{"block_type":"text","content":"package are two types named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Type"}]},{"block_type":"text","content":". The former type is used for storing values of any type, whereas the latter type is used for representing Go types."}]},{"block_type":"element","block":"k6pz2io7","search_text":"A simple Reflection example","text_count":27,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A simple Reflection example"}]},{"block_type":"element","block":"k6pz2io8","search_text":"This section will present a relatively simple reflection example in order to start feeling comfortable with this advanced Go feature.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a relatively simple reflection example in order to start feeling comfortable with this advanced Go feature."}]},{"block_type":"element","block":"k6pz2io9","search_text":"The name of the Go source file is reflection.go , and it will be presented in four parts. The purpose of reflection.go is to examine an \"unknown\" structure variable and to find out more about it at runtime. For added interest, the program will define two new struct types. Based on these two types, it will also define two new variables; however, it will examine only one of them. If the program has no command-line arguments, it will examine the first one; otherwise, it will explore the second one. For practical purposes, this means that the program will not know in advance the kind of struct variable it will have to process.","text_count":630,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go source file is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The purpose of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"is to examine an \"unknown\" structure variable and to find out more about it at runtime. For added interest, the program will define two new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"types. Based on these two types, it will also define two new variables; however, it will examine only one of them. If the program has no command-line arguments, it will examine the first one; otherwise, it will explore the second one. For practical purposes, this means that the program will not know in advance the kind of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"variable it will have to process."}]},{"block_type":"element","block":"k6pz2ioa","search_text":"The first part of reflection.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iob","search_text":"package main import ( \"fmt\" \"os\" \"reflect\" ) type a struct { X int Y float64 Z string } type b struct { F int G int H string I float64 } ","text_count":137,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"reflect\" \n) \n \ntype a struct { \n    X int \n    Y float64 \n    Z string \n} \n \ntype b struct { \n    F int \n    G int \n    H string \n    I float64 \n}"}]}]},{"block_type":"element","block":"k6pz2ioc","search_text":"In this part of the program, you can see the definition of the struct data types that will be used.","text_count":99,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, you can see the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"data types that will be used."}]},{"block_type":"element","block":"k6pz2iod","search_text":"The second code segment of reflection.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ioe","search_text":"func main() { x := 100 xRefl := reflect.ValueOf(&x).Elem() xType := xRefl.Type() fmt.Printf(\"The type of x is %s.\\n\", xType) ","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    x := 100 \n    xRefl := reflect.ValueOf(&amp;x).Elem() \n    xType := xRefl.Type() \n    fmt.Printf(\"The type of x is %s.\\n\", xType)"}]}]},{"block_type":"element","block":"k6pz2iof","search_text":"The preceding Go code presents a small and simplistic reflection example. First you declare a variable named x , and then you call the reflect.ValueOf(&x).Elem() function. Next you call xRefl.Type() in order to get the type of the variable, which is stored in xType . These three lines of code illustrate how you can get the data type of a variable using reflection. However, if all you care about is the data type of a variable, you can just call reflect.TypeOf(x) instead.","text_count":474,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding Go code presents a small and simplistic reflection example. First you declare a variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":", and then you call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.ValueOf(&amp;x).Elem()"}]},{"block_type":"text","content":"function. Next you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xRefl.Type()"}]},{"block_type":"text","content":"in order to get the type of the variable, which is stored in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xType"}]},{"block_type":"text","content":". These three lines of code illustrate how you can get the data type of a variable using reflection. However, if all you care about is the data type of a variable, you can just call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.TypeOf(x)"}]},{"block_type":"text","content":"instead."}]},{"block_type":"element","block":"k6pz2iog","search_text":"The third code portion of reflection.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ioh","search_text":"A := a{100, 200.12, \"Struct a\"} B := b{1, 2, \"Struct b\", -1.2} var r reflect.Value arguments := os.Args if len(arguments) == 1 { r = reflect.ValueOf(&A).Elem() } else { r = reflect.ValueOf(&B).Elem() } ","text_count":202,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"A := a{100, 200.12, \"Struct a\"} \n    B := b{1, 2, \"Struct b\", -1.2} \n    var r reflect.Value \n \n    arguments := os.Args \n    if len(arguments) == 1 { \n        r = reflect.ValueOf(&amp;A).Elem() \n    } else { \n        r = reflect.ValueOf(&amp;B).Elem() \n    }"}]}]},{"block_type":"element","block":"k6pz2ioi","search_text":"In this part, you declare two variables named A and B . The type of the A variable is a , and the type of the B variable is b . The type of the r variable should be reflect.Value because this is what the reflect.ValueOf() function returns. The Elem() method returns the value contained in the reflection interface ( reflect.Value ).","text_count":332,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you declare two variables named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B"}]},{"block_type":"text","content":". The type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A"}]},{"block_type":"text","content":"variable is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":", and the type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B"}]},{"block_type":"text","content":"variable is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":". The type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"variable should be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":"because this is what the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.ValueOf()"}]},{"block_type":"text","content":"function returns. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Elem()"}]},{"block_type":"text","content":"method returns the value contained in the reflection interface ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2ioj","search_text":"The last part of the reflection.go code follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"code follows next:"}]},{"block_type":"element","block":"k6pz2iok","search_text":"iType := r.Type() fmt.Printf(\"i Type: %s\\n\", iType) fmt.Printf(\"The %d fields of %s are:\\n\", r.NumField(), iType) for i := 0; i < r.NumField(); i++ { fmt.Printf(\"Field name: %s \", iType.Field(i).Name) fmt.Printf(\"with type: %s \", r.Field(i).Type()) fmt.Printf(\"and value %v\\n\", r.Field(i).Interface()) } } ","text_count":306,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"iType := r.Type() \n    fmt.Printf(\"i Type: %s\\n\", iType) \n    fmt.Printf(\"The %d fields of %s are:\\n\", r.NumField(), iType) \n \n    for i := 0; i &lt; r.NumField(); i++ { \n        fmt.Printf(\"Field name: %s \", iType.Field(i).Name) \n        fmt.Printf(\"with type: %s \", r.Field(i).Type()) \n        fmt.Printf(\"and value %v\\n\", r.Field(i).Interface()) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2iol","search_text":"In this part of the program, you use the appropriate functions of the reflect package in order to obtain the desired information. The NumField() method returns the number of fields in a reflect.Value structure, whereas the Field() function returns the field of the structure that is specified by its parameter. The Interface() function returns the value of a field of the reflect.Value structure as an interface.","text_count":412,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part of the program, you use the appropriate functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect"}]},{"block_type":"text","content":"package in order to obtain the desired information. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NumField()"}]},{"block_type":"text","content":"method returns the number of fields in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":"structure, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Field()"}]},{"block_type":"text","content":"function returns the field of the structure that is specified by its parameter. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Interface()"}]},{"block_type":"text","content":"function returns the value of a field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":"structure as an interface."}]},{"block_type":"element","block":"k6pz2iom","search_text":"Executing reflection.go two times will generate the following output:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"two times will generate the following output:"}]},{"block_type":"element","block":"k6pz2ion","search_text":"$ go run reflection.go 1 The type of x is int. i Type: main.b The 4 fields of main.b are: Field name: F with type: int and value 1 Field name: G with type: int and value 2 Field name: H with type: string and value Struct b Field name: I with type: float64 and value -1.2 $ go run reflection.go The type of x is int. i Type: main.a The 3 fields of main.a are: Field name: X with type: int and value 100 Field name: Y with type: float64 and value 200.12 Field name: Z with type: string and value Struct a ","text_count":503,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run reflection.go 1\nThe type of x is int.\ni Type: main.b\nThe 4 fields of main.b are:\nField name: F with type: int and value 1\nField name: G with type: int and value 2\nField name: H with type: string and value Struct b\nField name: I with type: float64 and value -1.2\n$ go run reflection.go\nThe type of x is int.\ni Type: main.a\nThe 3 fields of main.a are:\nField name: X with type: int and value 100\nField name: Y with type: float64 and value 200.12\nField name: Z with type: string and value Struct a"}]}]},{"block_type":"element","block":"k6pz2ioo","search_text":"It is important to see that Go uses its internal representation to print the data types of variables A and B , which is main.a and main.b , respectively. However, this is not the case with variable x , which is an int .","text_count":219,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is important to see that Go uses its internal representation to print the data types of variables"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B"}]},{"block_type":"text","content":", which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.a"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.b"}]},{"block_type":"text","content":", respectively. However, this is not the case with variable"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":", which is an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iop","search_text":"A more advanced reflection example","text_count":34,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A more advanced reflection example"}]},{"block_type":"element","block":"k6pz2ioq","search_text":"In this section, we will explore more advanced uses of reflection as illustrated in relatively small code blocks using the Go code of advRefl.go .","text_count":146,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, we will&nbsp;explore more advanced uses of reflection as illustrated in relatively small code blocks using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ior","search_text":"The advRefl.go program will be presented in five parts. The first part of the code follows next:","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"program will be presented in five parts. The first part of the code follows next:"}]},{"block_type":"element","block":"k6pz2ios","search_text":"package main import ( \"fmt\" \"os\" \"reflect\" ) type t1 int type t2 int ","text_count":69,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"reflect\" \n) \n \ntype t1 int \ntype t2 int"}]}]},{"block_type":"element","block":"k6pz2iot","search_text":"Note that although both t1 and t2 types are based on int and therefore are essentially the same type as int , Go treats them as totally different types. Their internal representation after Go parses the code of the program will be main.t1 and main.t2 , respectively.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that although both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t1"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t2"}]},{"block_type":"text","content":"types are based on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"and therefore are essentially the same type as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":", Go treats them as totally different types. Their internal representation after Go parses the code of the program will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.t1"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.t2"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2iou","search_text":"The second code portion of advRefl.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iov","search_text":"type a struct { X int Y float64 Text string } func (a1 a) compareStruct(a2 a) bool { r1 := reflect.ValueOf(&a1).Elem() r2 := reflect.ValueOf(&a2).Elem() for i := 0; i < r1.NumField(); i++ { if r1.Field(i).Interface() != r2.Field(i).Interface() { return false } } return true } ","text_count":277,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type a struct { \n    X    int \n    Y    float64 \n    Text string \n} \n \nfunc (a1 a) compareStruct(a2 a) bool { \n    r1 := reflect.ValueOf(&amp;a1).Elem() \n    r2 := reflect.ValueOf(&amp;a2).Elem() \n \n    for i := 0; i &lt; r1.NumField(); i++ { \n        if r1.Field(i).Interface() != r2.Field(i).Interface() { \n            return false \n        } \n    } \n    return true \n}"}]}]},{"block_type":"element","block":"k6pz2iow","search_text":"In this code segment, we define a Go structure type named a and implement a Go function named compareStruct() . The purpose of this function is to find out whether two variables of the a type are exactly the same or not. As you can see, compareStruct() uses Go code from reflection.go to perform its task.","text_count":305,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, we define a Go structure type named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"and implement a Go function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"compareStruct()"}]},{"block_type":"text","content":". The purpose of this function is to find out whether two variables of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"type are exactly the same or not. As you can see,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"compareStruct()"}]},{"block_type":"text","content":"uses Go code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflection.go"}]},{"block_type":"text","content":"to perform its task."}]},{"block_type":"element","block":"k6pz2iox","search_text":"The third code segment of advRefl.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ioy","search_text":"func printMethods(i interface{}) { r := reflect.ValueOf(i) t := r.Type() fmt.Printf(\"Type to examine: %s\\n\", t) for j := 0; j < r.NumMethod(); j++ { m := r.Method(j).Type() fmt.Println(t.Method(j).Name, \"-->\", m) } } ","text_count":217,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func printMethods(i interface{}) { \n    r := reflect.ValueOf(i) \n    t := r.Type() \n    fmt.Printf(\"Type to examine: %s\\n\", t) \n \n    for j := 0; j &lt; r.NumMethod(); j++ { \n        m := r.Method(j).Type() \n        fmt.Println(t.Method(j).Name, \"--&gt;\", m) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ioz","search_text":"The printMethods() function prints the methods of a variable. The variable type that will be used in advRefl.go for illustrating printMethods() will be os.File .","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printMethods()"}]},{"block_type":"text","content":"function prints the methods of a variable. The variable type that will be used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"for illustrating"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printMethods()"}]},{"block_type":"text","content":"will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.File"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ip0","search_text":"The fourth code segment of advRefl.go contains the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ip1","search_text":"func main() { x1 := t1(100) x2 := t2(100) fmt.Printf(\"The type of x1 is %s\\n\", reflect.TypeOf(x1)) fmt.Printf(\"The type of x2 is %s\\n\", reflect.TypeOf(x2)) var p struct{} r := reflect.New(reflect.ValueOf(&p).Type()).Elem() fmt.Printf(\"The type of r is %s\\n\", reflect.TypeOf(r)) ","text_count":278,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    x1 := t1(100) \n    x2 := t2(100) \n    fmt.Printf(\"The type of x1 is %s\\n\", reflect.TypeOf(x1)) \n    fmt.Printf(\"The type of x2 is %s\\n\", reflect.TypeOf(x2)) \n \n    var p struct{} \n    r := reflect.New(reflect.ValueOf(&amp;p).Type()).Elem() \n    fmt.Printf(\"The type of r is %s\\n\", reflect.TypeOf(r))"}]}]},{"block_type":"element","block":"k6pz2ip2","search_text":"The last code portion of advRefl.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ip3","search_text":"a1 := a{1, 2.1, \"A1\"} a2 := a{1, -2, \"A2\"} if a1.compareStruct(a1) { fmt.Println(\"Equal!\") } if !a1.compareStruct(a2) { fmt.Println(\"Not Equal!\") } var f *os.File printMethods(f) } ","text_count":181,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"a1 := a{1, 2.1, \"A1\"} \n    a2 := a{1, -2, \"A2\"} \n \n    if a1.compareStruct(a1) { \n        fmt.Println(\"Equal!\") \n    } \n \n    if !a1.compareStruct(a2) { \n        fmt.Println(\"Not Equal!\") \n    } \n \n    var f *os.File \n    printMethods(f) \n}"}]}]},{"block_type":"element","block":"k6pz2ip4","search_text":"As you will see in a short while, the a1.compareStruct(a1) call returns true because we are comparing a1 with itself, whereas the a1.compareStruct(a2) call will return false because the a1 and a2 variables have different values.","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see in a short while, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a1.compareStruct(a1)"}]},{"block_type":"text","content":"call returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"because we are comparing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a1"}]},{"block_type":"text","content":"with itself, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a1.compareStruct(a2)"}]},{"block_type":"text","content":"call will return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a1"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a2"}]},{"block_type":"text","content":"variables have different values."}]},{"block_type":"element","block":"k6pz2ip5","search_text":"Executing advRefl.go will create the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advRefl.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2ip6","search_text":"$ go run advRefl.go The type of x1 is main.t1 The type of x2 is main.t2 The type of r is reflect.Value Equal! Not Equal! Type to examine: *os.File Chdir --> func() error Chmod --> func(os.FileMode) error Chown --> func(int, int) error Close --> func() error Fd --> func() uintptr Name --> func() string Read --> func([]uint8) (int, error) ReadAt --> func([]uint8, int64) (int, error) Readdir --> func(int) ([]os.FileInfo, error) Readdirnames --> func(int) ([]string, error) Seek --> func(int64, int) (int64, error) Stat --> func() (os.FileInfo, error) Sync --> func() error Truncate --> func(int64) error Write --> func([]uint8) (int, error) WriteAt --> func([]uint8, int64) (int, error) WriteString --> func(string) (int, error) ","text_count":730,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run advRefl.go\nThe type of x1 is main.t1\nThe type of x2 is main.t2\nThe type of r is reflect.Value\nEqual!\nNot Equal!\nType to examine: *os.File\nChdir --&gt; func() error\nChmod --&gt; func(os.FileMode) error\nChown --&gt; func(int, int) error\nClose --&gt; func() error\nFd --&gt; func() uintptr\nName --&gt; func() string\nRead --&gt; func([]uint8) (int, error)\nReadAt --&gt; func([]uint8, int64) (int, error)\nReaddir --&gt; func(int) ([]os.FileInfo, error)\nReaddirnames --&gt; func(int) ([]string, error)\nSeek --&gt; func(int64, int) (int64, error)\nStat --&gt; func() (os.FileInfo, error)\nSync --&gt; func() error\nTruncate --&gt; func(int64) error\nWrite --&gt; func([]uint8) (int, error)\nWriteAt --&gt; func([]uint8, int64) (int, error)\nWriteString --&gt; func(string) (int, error)"}]}]},{"block_type":"element","block":"k6pz2ip7","search_text":"You can see that the type of the r variable, which is returned by reflect.New() , will be reflect.Value . Additionally, the output of the printMethods() method tells us that the *os.File type supports a plethora of methods, such as Chdir() , Chmod() , and so on.","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can see that the type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"variable, which is returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.New()"}]},{"block_type":"text","content":", will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect.Value"}]},{"block_type":"text","content":". Additionally, the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"printMethods()"}]},{"block_type":"text","content":"method tells us that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*os.File"}]},{"block_type":"text","content":"type supports a plethora of methods, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Chdir()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Chmod()"}]},{"block_type":"text","content":", and so on."}]},{"block_type":"element","block":"k6pz2ip8","search_text":"The three disadvantages of reflection","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The three disadvantages of reflection"}]},{"block_type":"element","block":"k6pz2ip9","search_text":"Without a doubt, reflection is a powerful Go feature. However, as it happens with all tools, reflection should be used sparingly for three main reasons.","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Without a doubt, reflection is a powerful Go feature. However, as it happens with all tools, reflection should be used sparingly for three main reasons."}]},{"block_type":"element","block":"k6pz2ipa","search_text":"The first reason is that extensive use of reflection will make your programs hard to read and maintain. A potential solution to this problem is good documentation; however, developers are famous for not having the time to write the required documentation.","text_count":255,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first reason is that extensive use of reflection will make your programs hard to read and maintain. A potential solution to this problem is good documentation; however, developers are famous for not having the time to write the required documentation."}]},{"block_type":"element","block":"k6pz2ipb","search_text":"The second reason is that the Go code which uses reflection will make your programs slower. Generally speaking, Go code that is made to work with a particular data type will always be faster than Go code that uses reflection to work dynamically with any Go data type. Additionally, such dynamic code will make it difficult for tools to refactor or analyze your code.","text_count":366,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second reason is that the Go code which uses reflection will make your programs slower. Generally speaking, Go code that is made to work with a particular data type will always be faster than Go code that uses reflection to work dynamically with any Go data type. Additionally, such dynamic code will make it difficult for tools to refactor or analyze your code."}]},{"block_type":"element","block":"k6pz2ipc","search_text":"The last reason is that reflection errors cannot be caught at build time and are reported at runtime as a panic. This means that reflection errors can potentially crash your programs! This can happen months or even years after the development of a Go program! One solution to this problem is extensive testing before a dangerous function call. However, this will add even more Go code to your programs, which will make them even slower.","text_count":436,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last reason is that reflection errors cannot be caught at build time and are reported at runtime as a panic. This means that reflection errors can potentially crash your programs! This can happen months or even years after the development of a Go program! One solution to this problem is extensive testing before a dangerous function call. However, this will add even more Go code to your programs, which will make them even slower."}]},{"block_type":"element","block":"k6pz2ipd","search_text":"Object-oriented programming in Go!","text_count":34,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Object-oriented programming in Go!"}]},{"block_type":"element","block":"k6pz2ipe","search_text":"You should know by now that Go lacks inheritance, but that it supports composition and that Go interfaces provide a kind of polymorphism. So, although Go is not an object-oriented programming language, it has some features that let you mimic object-oriented programming.","text_count":270,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should know by now that Go lacks inheritance, but that it supports composition and that Go interfaces provide a kind of polymorphism. So, although Go is not an object-oriented programming&nbsp;language, it has some features that let you mimic object-oriented programming."}]},{"block_type":"element","block":"k6pz2ipf","search_text":"Tip If you really want to develop applications using object-oriented methodology, then choosing Go might not be your best option. As I am not really into Java , I would suggest looking at C++ or Python instead. On the other hand, Go prohibits you from building complicated and deep type hierarchies that are hard to work with and maintain! ","text_count":340,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you really want to develop applications using object-oriented methodology, then choosing Go might not be your best option. As I am not really into"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Java"}]},{"block_type":"text","content":", I would suggest looking at"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C++"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Python"}]},{"block_type":"text","content":"instead. On the other hand, Go prohibits you from building complicated and deep type hierarchies that are hard to work with and maintain!"}]}]},{"block_type":"element","block":"k6pz2ipg","search_text":"First let me explain the two techniques that will be used in the Go program in this section. The first technique uses methods in order to associate a function with a type. This means that, in some way, you can consider that the function and type construct an object.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First let me explain the two techniques that will be used in the Go program in this section. The first technique uses methods in order to associate a function with a type. This means that, in some way, you can consider that the function and type construct an object."}]},{"block_type":"element","block":"k6pz2iph","search_text":"With the second technique, you embed a type into a new structure type in order to create a kind of hierarchy.","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"With the second technique, you embed a type into a new structure type in order to create a kind of hierarchy."}]},{"block_type":"element","block":"k6pz2ipi","search_text":"There is also a third technique where you use a Go interface to make two or more elements— objects of the same class . This technique will not be illustrated in this section, as it has been demonstrated earlier in this chapter. The key point here is that a Go interface allows you to define a common behavior between different elements in a way such that all of these different elements share the characteristics of an object. This might allow you to say that these different elements are objects of the same class. However, objects and classes of an actual object-oriented programming language can do many more things.","text_count":619,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is also a third technique where you use a Go interface to make two or more elements&mdash;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"objects of the same class"}]},{"block_type":"text","content":". This technique will not be illustrated in this section, as it has been demonstrated earlier in this chapter. The key point here is that a Go interface allows you to define a common behavior between different elements in a way such that all of these different elements share the characteristics of an object. This might allow you to say that these different elements are objects of the same class. However, objects and classes of an actual object-oriented programming language can do many more things."}]},{"block_type":"element","block":"k6pz2ipj","search_text":"The first two techniques will be illustrated in the program ooo.go , which will be presented in four parts. The first code segment of ooo.go contains the following Go code:","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first two techniques will be illustrated in the program"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":", which will be presented in four parts. The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ipk","search_text":"package main import ( \"fmt\" ) type a struct { XX int YY int } type b struct { AA string XX int } ","text_count":97,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype a struct { \n    XX int \n    YY int \n} \n \ntype b struct { \n    AA string \n    XX int \n}"}]}]},{"block_type":"element","block":"k6pz2ipl","search_text":"The second part of the ooo.go program is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2ipm","search_text":"type c struct { A a B b } ","text_count":26,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type c struct { \n    A a \n    B b \n}"}]}]},{"block_type":"element","block":"k6pz2ipn","search_text":"Composition allows you to create a structure in your Go elements using multiple struct types. In this case, data type C groups an a variable and a b variable.","text_count":158,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Composition allows you to create a structure in your Go elements using multiple"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"types. In this case, data type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"groups an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"variable and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2ipo","search_text":"The third portion of ooo.go is shown in the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ipp","search_text":"func (A a) A() { fmt.Println(\"Function A() for A\") } func (B b) A() { fmt.Println(\"Function A() for B\") } ","text_count":106,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (A a) A() { \n    fmt.Println(\"Function A() for A\") \n} \n \nfunc (B b) A() { \n    fmt.Println(\"Function A() for B\") \n}"}]}]},{"block_type":"element","block":"k6pz2ipq","search_text":"The two methods defined here can have the same name ( A() ) because they have different function headers. The first method works with a variables, whereas the second method works with b variables. This technique allows you to share the same function name between multiple types.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The two methods defined here can have the same name ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":") because they have different function headers. The first method works with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"variables, whereas the second method works with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"variables. This technique allows you to share the same function name between multiple types."}]},{"block_type":"element","block":"k6pz2ipr","search_text":"The last part of ooo.go follows next:","text_count":37,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2ips","search_text":"func main() { var i c i.A.A() i.B.A() } ","text_count":40,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var i c \n    i.A.A() \n    i.B.A() \n}"}]}]},{"block_type":"element","block":"k6pz2ipt","search_text":"All the Go code in ooo.go is pretty simplistic when compared with the code of an object-oriented programming language, which would implement abstract classes and inheritance . However, it is more than adequate for generating types and elements with a structure in them, as well as having different data types with the same method names.","text_count":336,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All the Go code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"is pretty simplistic when compared with the code of an object-oriented programming language, which would implement"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"abstract classes"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"inheritance"}]},{"block_type":"text","content":". However, it is more than adequate for generating types and elements with a structure in them, as well as having different data types with the same method names."}]},{"block_type":"element","block":"k6pz2ipu","search_text":"Executing ooo.go will generate the following output:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ooo.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2ipv","search_text":"$ go run ooo.go Function A() for A Function A() for B","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run ooo.go\nFunction A() for A\nFunction A() for B"}]}]},{"block_type":"element","block":"k6pz2ipw","search_text":"As the following code illustrates, however, composition is not inheritance, and the first type knows nothing about the changes made to the shared() function by the second type:","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the following code illustrates, however, composition is not inheritance, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first"}]},{"block_type":"text","content":"type knows nothing about the changes made to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shared()"}]},{"block_type":"text","content":"function by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second"}]},{"block_type":"text","content":"type:"}]},{"block_type":"element","block":"k6pz2ipx","search_text":"package main import ( \"fmt\" ) type first struct{} func (a first) F() { a.shared() } func (a first) shared() { fmt.Println(\"This is shared() from first!\") } type second struct { first } func (a second) shared() { fmt.Println(\"This is shared() from second!\") } func main() { first{}.F() second{}.shared() i := second{} j := i.first j.F() } ","text_count":338,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n) \n \ntype first struct{} \n \nfunc (a first) F() { \n    a.shared() \n} \n \nfunc (a first) shared() { \n    fmt.Println(\"This is shared() from first!\") \n} \n \ntype second struct { \n    first \n} \n \nfunc (a second) shared() { \n    fmt.Println(\"This is shared() from second!\") \n} \n \nfunc main() { \n    first{}.F() \n    second{}.shared() \n    i := second{} \n    j := i.first \n    j.F() \n}"}]}]},{"block_type":"element","block":"k6pz2ipy","search_text":"Note that type second embeds type first , and the two types share a function, named shared() .","text_count":94,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second"}]},{"block_type":"text","content":"embeds type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first"}]},{"block_type":"text","content":", and the two types share a function, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shared()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ipz","search_text":"Saving the former Go code as goCoIn.go and executing it will generate the following output:","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Saving the former Go code as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goCoIn.go"}]},{"block_type":"text","content":"and executing it will generate the following output:"}]},{"block_type":"element","block":"k6pz2iq0","search_text":"$ go run goCoIn.go This is shared() from first! This is shared() from second! This is shared() from first! ","text_count":107,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run goCoIn.go\nThis is shared() from first!\nThis is shared() from second!\nThis is shared() from first!"}]}]},{"block_type":"element","block":"k6pz2iq1","search_text":"Although the calls to first{}.F() and second{}.shared() generated the expected results, the call to j.F() still calls first.shared() instead of the second.shared() function, despite the fact that type second changed the implementation of the shared() function. This is called method overriding in object-oriented terminology.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first{}.F()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second{}.shared()"}]},{"block_type":"text","content":"generated the expected results, the call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j.F()"}]},{"block_type":"text","content":"still calls"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first.shared()"}]},{"block_type":"text","content":"instead of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second.shared()"}]},{"block_type":"text","content":"function, despite the fact that type"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second"}]},{"block_type":"text","content":"changed the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shared()"}]},{"block_type":"text","content":"function. This is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"method overriding"}]},{"block_type":"text","content":"in object-oriented terminology."}]},{"block_type":"element","block":"k6pz2iq2","search_text":"Note that the j.F() call can be written as (i.first).F() or as (second{}.first).F() without the need to define too many variables. Breaking it into three lines of code makes it a little easier to understand!","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"j.F()"}]},{"block_type":"text","content":"call can be written as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"(i.first).F()"}]},{"block_type":"text","content":"or as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"(second{}.first).F()"}]},{"block_type":"text","content":"without the need to define too many variables. Breaking it into three lines of code makes it a little easier to understand!"}]},{"block_type":"element","block":"k6pz2iq3","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2iq4","search_text":"You will find the following two resources very handy:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will find the following two resources very handy:"}]},{"block_type":"element","block":"k6pz2iq5","search_text":"Visit the documentation page of the reflect Go standard package, which can be found at https://golang.org/pkg/reflect/ . This package has many more capabilities than the ones presented in this chapter. If you are really into reflection or you want to learn more about it, you can refer to the reflectwalk library by Mitchell Hashimoto at https://github.com/mitchellh/reflectwalk . The reflectwalk library allows you to walk complex values in Go using reflection. If you have the time, explore the Go code of the library! ","text_count":521,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the reflect Go standard package, which can be found at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/reflect/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/reflect/"}]},{"block_type":"text","content":". This package has many more capabilities than the ones presented in this chapter."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are really into reflection or you want to learn more about it, you can refer to the"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"reflectwalk"}]},{"block_type":"text","content":"library by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mitchell Hashimoto"}]},{"block_type":"text","content":"at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/mitchellh/reflectwalk","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/mitchellh/reflectwalk"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflectwalk"}]},{"block_type":"text","content":"library allows you to walk complex values in Go using reflection. If you have the time, explore the Go code of the library!"}]}]},{"block_type":"element","block":"k6pz2iq6","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2iq7","search_text":"Write your own interface, and use it in another Go program. Then state why your interface is useful. Write an interface for calculating the volume of shapes with three dimensions, such as cubes and spheres. Write an interface for calculating the length of line segments and the distance between two points in the plane. Explore reflection using your own example. How does reflection work on Go maps? If you are good in mathematics, try to write an interface that implements the four basic mathematical operations for both real numbers and complex numbers. Do not use the complex64 and complex128 standard Go types—define your own structure for supporting complex numbers. ","text_count":672,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write your own interface, and use it in another Go program. Then state why your interface is useful."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write an interface for calculating the volume of shapes with three dimensions, such as cubes and spheres."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write an interface for calculating the length of line segments and the distance between two points in the plane."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Explore reflection using your own example."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"How does reflection work on Go maps?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are good in mathematics, try to write an interface that implements the four basic mathematical operations for both real numbers and complex numbers. Do not use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"complex64"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"complex128"}]},{"block_type":"text","content":"standard Go types&mdash;define your own structure for supporting complex numbers."}]}]},{"block_type":"element","block":"k6pz2iq8","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2iq9","search_text":"In this chapter, you learned about interfaces, which are like contracts, and also about type methods, type assertion, and reflection in Go. You also learned about creating Go code that follows the principles of object-oriented programming.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you learned about interfaces, which are like contracts, and also about type methods, type assertion, and reflection in Go. You also learned about creating Go code that follows the principles of object-oriented programming."}]},{"block_type":"element","block":"k6pz2iqa","search_text":"Although reflection is a very powerful Go feature, it might slow down your Go programs because it adds a layer of complexity at runtime. Additionally, your Go programs could crash if you use reflection carelessly.","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although reflection is a very powerful Go feature, it might slow down your Go programs because it adds a layer of complexity at runtime. Additionally, your Go programs could crash if you use reflection carelessly."}]},{"block_type":"element","block":"k6pz2iqb","search_text":"If you will remember just one thing from this chapter, it should be that Go is not an object-oriented programming language, but that it can mimic some of the functionality offered by object-programming languages, such as Java and C++. This means that if you plan to develop software using the object-oriented paradigm all of the time, it would be best if you choose a programming language other than Go. Nevertheless, object-oriented programming is not a panacea, and you might create a better, cleaner, and more robust design if you choose a programming language such as Go!","text_count":575,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you will remember just one thing from this chapter, it should be that Go is not an object-oriented programming language, but that it can mimic some of the functionality offered by object-programming languages, such as Java and C++. This means that if you plan to develop software using the object-oriented paradigm all of the time, it would be best if you choose a programming language other than Go. Nevertheless, object-oriented programming is not a panacea, and you might create a better, cleaner, and more robust design if you choose a programming language such as Go!"}]},{"block_type":"element","block":"k6pz2iqc","search_text":"Although there might have been more theory in this chapter than you expected, the next chapter will pay off your patience, as it will address systems programming in Go. File I/O, working with Unix system files, handling Unix signals, and supporting Unix pipes will be discussed. Additionally, the next chapter will talk about using the flag package to support multiple command-line arguments and options in your command-line tools, traversing directory structures, Unix file permissions, and some advanced uses of the functionality offered by the syscall standard Go package.","text_count":575,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although there might have been more theory in this chapter than you expected, the next chapter will pay off your patience, as it will address systems programming in Go. File I/O, working with Unix system files, handling Unix signals, and supporting Unix pipes will be discussed. Additionally, the next chapter will talk about using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package to support multiple command-line arguments and options in your command-line tools, traversing directory structures, Unix file permissions, and some advanced uses of the functionality offered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2iqd","search_text":"If you are really into systems programming with Go, it might be a good idea to read my book, Go Systems Programming, Packt Publishing , 2017 .","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are really into systems programming with Go, it might be a good idea to read my book,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming,"}]},{"block_type":"text","content":"&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Packt Publishing"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"2017"}]},{"block_type":"text","content":"."}]}]},{"title":"Telling a Unix System What to Do","author":"Mihalis Tsoukalos","block":"k6pz24ln","number":8,"contents":[{"block_type":"element","block":"k6pz2iqe","search_text":"In the previous chapter, we talked about two advanced, but somewhat theoretical, Go topics: interfaces and reflection. The Go code that you will find in this chapter is anything but theoretical!","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we talked about two advanced, but somewhat theoretical, Go topics: interfaces and reflection. The Go code that you will find in this chapter is anything but theoretical!"}]},{"block_type":"element","block":"k6pz2iqf","search_text":"The subject of this chapter is systems programming because, after all, Go is a serious systems programming language that was born out of frustration; its spiritual fathers were unsatisfied with the programming language choices they had for creating systems software, so they decided to create a new programming language!","text_count":320,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The subject of this chapter is"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"systems programming"}]},{"block_type":"text","content":"because, after all, Go is a serious systems programming language that was born out of frustration; its spiritual fathers were unsatisfied with the programming language choices they had for creating systems software, so they decided to create a new programming language!"}]},{"block_type":"element","block":"k6pz2iqg","search_text":"Tip If you are really into Systems programming with Go, then Go Systems Programming, Packt Publishing, 2017 , truly will definitely help you along in your journey. However, this chapter contains some interesting and somewhat advanced topics that cannot be found in my Go Systems Programming book. ","text_count":297,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are really into"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Systems programming"}]},{"block_type":"text","content":"with Go, then"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming,&nbsp;Packt Publishing, 2017"}]},{"block_type":"text","content":", truly will definitely help you along in your journey. However, this chapter contains some interesting and somewhat advanced topics that cannot be found in my Go Systems Programming book."}]}]},{"block_type":"element","block":"k6pz2iqh","search_text":"In this chapter of Mastering Go , you will learn about the following topics:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn about the following topics:"}]},{"block_type":"element","block":"k6pz2iqi","search_text":"Unix Processes The flag package The use of io.Reader and io.Writer interfaces Handling Unix signals in Go with the help of the os/signal package Supporting Unix pipes in your Unix system utilities Reading text files Reading CSV files Writing to files The bytes package ","text_count":269,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Unix Processes"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interfaces"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Handling Unix&nbsp;"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"signals"}]},{"block_type":"text","content":"in Go with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os/signal"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Supporting Unix"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pipes"}]},{"block_type":"text","content":"in your Unix system utilities"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Reading text files"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Reading CSV files"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Writing to files"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes"}]},{"block_type":"text","content":"package"}]}]},{"block_type":"element","block":"k6pz2iqj","search_text":"Advanced uses of the syscall package Traversing directory structures Unix file permissions ","text_count":91,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Advanced uses of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Traversing directory structures"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Unix file permissions"}]}]},{"block_type":"element","block":"k6pz2iqk","search_text":"About Unix processes","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About Unix processes"}]},{"block_type":"element","block":"k6pz2iql","search_text":"Strictly speaking, a process is an execution environment that contains instructions, user data and system data parts, and other types of resources that are obtained during runtime. On the other hand, a program is a binary file that contains instructions and data that are used for initializing the instruction and user data parts of a process. Each running Unix process is uniquely identified by an unsigned integer, which is called the process ID of the process.","text_count":463,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Strictly speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"process"}]},{"block_type":"text","content":"is an execution environment that contains instructions, user data and system data parts, and other types of resources that are obtained during runtime. On the other hand, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"program"}]},{"block_type":"text","content":"is a binary file that contains instructions and data that are used for initializing the instruction and user data parts of a process. Each running Unix process is uniquely identified by an unsigned integer, which is called the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"process ID"}]},{"block_type":"text","content":"of the process."}]},{"block_type":"element","block":"k6pz2iqm","search_text":"There are three categories of processes: user processes, daemon processes, and kernel processes. User processes run in user space and usually have no special access rights. Kernel processes are executed in kernel space only and can fully access all kernel data structures. Daemon processes are programs that can be found in the user space and run in the background without the need for a terminal.","text_count":397,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are three categories of processes: user processes, daemon processes, and kernel processes."},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"User processes"}]},{"block_type":"text","content":"run in user space and usually have no special access rights."},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Kernel processes"}]},{"block_type":"text","content":"are executed in kernel space only and can fully access all kernel data structures."},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Daemon processes"}]},{"block_type":"text","content":"are programs that can be found in the user space and run in the background without the need for a terminal."}]},{"block_type":"element","block":"k6pz2iqn","search_text":"Note The C way for creating new processes involves calling the fork() system call. The return value of fork() allows the programmer to differentiate between the parent and child process. In contrast, Go does not support a similar functionality but offers goroutines. ","text_count":267,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The C way for creating new processes involves calling the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fork()"}]},{"block_type":"text","content":"system call. The return value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fork()"}]},{"block_type":"text","content":"allows the programmer to differentiate between the parent and child process. In contrast, Go does not support a similar functionality but offers goroutines."}]}]},{"block_type":"element","block":"k6pz2iqo","search_text":"The flag package","text_count":16,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The flag package"}]},{"block_type":"element","block":"k6pz2iqp","search_text":"Flags are specially-formatted strings that are passed into a program to control its behavior. Dealing with flags on your own might become very difficult if you want to support multiple flags. Thus, if you are developing Unix system command-line utilities, you will find the flag package very interesting and useful-if not downright irreplaceable. Among its other characteristics, the flag package makes no assumptions about the order of the command-line arguments and options, and it prints helpful messages in case there is an error in the way the command-line utility was executed.","text_count":583,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Flags are specially-formatted strings that are passed into a program to control its behavior. Dealing with flags on your own might become very difficult if you want to support multiple flags. Thus, if you are developing Unix system command-line utilities, you will find the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package very interesting and useful-if not downright irreplaceable. Among its other characteristics, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package makes no assumptions about the order of the command-line arguments and options, and it prints helpful messages in case there is an error in the way the command-line utility was executed."}]},{"block_type":"element","block":"k6pz2iqq","search_text":"Note The biggest advantage of the flag package is that it is part of the standard Go library, which means that it has been extensively tested and debugged. ","text_count":156,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The biggest advantage of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package is that it is part of the standard Go library, which means that it has been extensively tested and debugged."}]}]},{"block_type":"element","block":"k6pz2iqr","search_text":"I will present two Go programs that use the flag package: a simple one and a more advanced one.","text_count":95,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I will present two Go programs that use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package: a simple one and a more advanced one."}]},{"block_type":"element","block":"k6pz2iqs","search_text":"The first one, named simpleFlag.go , will be offered in four parts. The simpleFlag.go program will recognize two command-line options: the first one will be a Boolean option and the second one will require an integer value.","text_count":223,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first one, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":", will be offered in four parts. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"program will recognize two command-line options: the first one will be a Boolean option and the second one will require an integer value."}]},{"block_type":"element","block":"k6pz2iqt","search_text":"The first part of simpleFlag.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iqu","search_text":"package main import ( \"flag\" \"fmt\" ) ","text_count":37,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"flag\" \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2iqv","search_text":"The second code portion from simpleFlag.go is as follows:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iqw","search_text":"func main() { minusK := flag.Bool(\"k\", true, \"k\") minusO := flag.Int(\"O\", 1, \"O\") flag.Parse() ","text_count":95,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    minusK := flag.Bool(\"k\", true, \"k\") \n    minusO := flag.Int(\"O\", 1, \"O\") \n    flag.Parse()"}]}]},{"block_type":"element","block":"k6pz2iqx","search_text":"The flag.Bool(\"k\", true, \"k\") statement defines a Boolean command-line option named k with the default value of true . The last parameter of the statement is the usage string that will be displayed with the usage information of the program. Similarly, the flag.Int() function adds support for an integer command-line option.","text_count":324,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Bool(\"k\", true, \"k\")"}]},{"block_type":"text","content":"statement defines a Boolean command-line option named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"with the default value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":". The last parameter of the statement is the usage string that will be displayed with the usage information of the program. Similarly, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Int()"}]},{"block_type":"text","content":"function adds support for an integer command-line option."}]},{"block_type":"element","block":"k6pz2iqy","search_text":"Note You always need to call flag.Parse() after defining the command-line options that you want to support. ","text_count":108,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You always need to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Parse()"}]},{"block_type":"text","content":"after defining the command-line options that you want to support."}]}]},{"block_type":"element","block":"k6pz2iqz","search_text":"The third part of the simpleFlag.go program contains the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ir0","search_text":"valueK := *minusK valueO := *minusO valueO++ ","text_count":45,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"valueK := *minusK \n    valueO := *minusO \n    valueO++"}]}]},{"block_type":"element","block":"k6pz2ir1","search_text":"In the preceding Go code, you see how you can obtain the values of your options. The good thing here is that the flag package automatically converts the input associated with the flag.Int() flag to an integer value. This means that you do not have to do that on your own. Additionally, the flag package makes sure that it was given an acceptable integer value.","text_count":360,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you see how you can obtain the values of your options. The good thing here is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package automatically converts the input associated with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Int()"}]},{"block_type":"text","content":"flag to an integer value. This means that you do not have to do that on your own. Additionally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package makes sure that it was given an acceptable integer value."}]},{"block_type":"element","block":"k6pz2ir2","search_text":"The remaining Go code from simpleFlag.go follows next:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2ir3","search_text":"fmt.Println(\"-k:\", valueK) fmt.Println(\"-O:\", valueO) } ","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"-k:\", valueK) \n    fmt.Println(\"-O:\", valueO) \n}"}]}]},{"block_type":"element","block":"k6pz2ir4","search_text":"After getting the values of the desired parameters, you are now ready to use them.","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After getting the values of the desired parameters, you are now ready to use them."}]},{"block_type":"element","block":"k6pz2ir5","search_text":"Interacting with simpleFlag.go will create the following type of output:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Interacting with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ir6","search_text":"$ go run simpleFlag.go -O 100 -k: true -O: 101 $ go run simpleFlag.go -O=100 -k: true -O: 101 $ go run simpleFlag.go -O=100 -k -k: true -O: 101 $ go run simpleFlag.go -O=100 -k false -k: true -O: 101 $ go run simpleFlag.go -O=100 -k=false -k: false -O: 101 ","text_count":257,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run simpleFlag.go -O 100\n-k: true\n-O: 101\n$ go run simpleFlag.go -O=100\n-k: true\n-O: 101\n$ go run simpleFlag.go -O=100 -k\n-k: true\n-O: 101\n$ go run simpleFlag.go -O=100 -k false\n-k: true\n-O: 101\n$ go run simpleFlag.go -O=100 -k=false\n-k: false\n-O: 101"}]}]},{"block_type":"element","block":"k6pz2ir7","search_text":"If there is an error in the way simpleFlag.go was executed, you will get the following type of error message from the flag package:","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If there is an error in the way"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleFlag.go"}]},{"block_type":"text","content":"was executed, you will get the following type of error message from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package:"}]},{"block_type":"element","block":"k6pz2ir8","search_text":"$ go run simpleFlag.go -O=notAnInteger invalid value \"notAnInteger\" for flag -O: strconv.ParseInt: parsing \"notAnInteger\": invalid syntax Usage of /var/folders/sk/ltk8cnw50lzdtr2hxcj5sv2m0000gn/T/go-build020625525/command-line arguments/_obj/exe/simpleFlag: -O int O (default 1) -k k (default true) exit status 2 ","text_count":313,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run simpleFlag.go -O=notAnInteger\ninvalid value \"notAnInteger\" for flag -O: strconv.ParseInt: parsing \"notAnInteger\": invalid syntax\nUsage of /var/folders/sk/ltk8cnw50lzdtr2hxcj5sv2m0000gn/T/go-build020625525/command-line arguments/_obj/exe/simpleFlag:\n  -O int\n    O (default 1)\n  -k  k (default true)\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2ir9","search_text":"Notice the convenient usage message that is automatically printed when there is an error in the command-line options given to your program.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice the convenient usage message that is automatically printed when there is an error in the command-line options given to your program."}]},{"block_type":"element","block":"k6pz2ira","search_text":"Now it is time to present a more realistic and advanced program that uses the flag package. Its name is funWithFlag.go , and it will be presented in five parts. The funWithFlag.go utility will recognize various kinds of options, including one that accepts multiple values which are separated by commas. Additionally, it will illustrate how you can access the command-line arguments that are located at the end of the executable and that do not belong to any option.","text_count":465,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now it is time to present a more realistic and advanced program that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package. Its name is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":", and it will be presented in five parts. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"utility will recognize various kinds of options, including one that accepts multiple values which are separated by commas. Additionally, it will illustrate how you can access the command-line arguments that are located at the end of the executable and that do not belong to any option."}]},{"block_type":"element","block":"k6pz2irb","search_text":"The flag.Var() function used in funWithFlag.go creates a flag of any type that satisfies the flag.Value interface, which is defined as follows:","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Var()"}]},{"block_type":"text","content":"function used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"creates a flag of any type that satisfies the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Value"}]},{"block_type":"text","content":"interface, which is defined as follows:"}]},{"block_type":"element","block":"k6pz2irc","search_text":"type Value interface { String() string Set(string) error } ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Value interface { \n    String() string \n    Set(string) error \n}"}]}]},{"block_type":"element","block":"k6pz2ird","search_text":"The first part of funWithFlag.go contains the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ire","search_text":"package main import ( \"flag\" \"fmt\" \"strings\" ) type NamesFlag struct { Names []string } ","text_count":88,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"flag\" \n    \"fmt\" \n    \"strings\" \n) \n \ntype NamesFlag struct { \n    Names []string \n}"}]}]},{"block_type":"element","block":"k6pz2irf","search_text":"The NamesFlag structure will be used in a short while for the flag.Value interface.","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NamesFlag"}]},{"block_type":"text","content":"structure will be used in a short while for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Value"}]},{"block_type":"text","content":"interface."}]},{"block_type":"element","block":"k6pz2irg","search_text":"The second part of funWithFlag.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2irh","search_text":"func (s *NamesFlag) GetNames() []string { return s.Names } func (s *NamesFlag) String() string { return fmt.Sprint(s.Names) } ","text_count":126,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (s *NamesFlag) GetNames() []string { \n    return s.Names \n} \n \nfunc (s *NamesFlag) String() string { \n    return fmt.Sprint(s.Names) \n}"}]}]},{"block_type":"element","block":"k6pz2iri","search_text":"The third code portion from funWithFlag.go contains the following code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2irj","search_text":"func (s *NamesFlag) Set(v string) error { if len(s.Names) > 0 { return fmt.Errorf(\"Cannot use names flag more than once!\") } names := strings.Split(v, \",\") for _, item := range names { s.Names = append(s.Names, item) } return nil } ","text_count":232,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func (s *NamesFlag) Set(v string) error { \n    if len(s.Names) &gt; 0 { \n        return fmt.Errorf(\"Cannot use names flag more than once!\") \n    } \n \n    names := strings.Split(v, \",\") \n    for _, item := range names { \n        s.Names = append(s.Names, item) \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2irk","search_text":"First, the Set() method makes sure that the related command-line option is not already set. After that, it gets the input and separates its arguments using the strings.Split() function. Then the arguments are saved in the Names field of the NamesFlag structure.","text_count":261,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Set()"}]},{"block_type":"text","content":"method makes sure that the related command-line option is not already set. After that, it gets the input and separates its arguments using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Split()"}]},{"block_type":"text","content":"function. Then the arguments are saved in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Names"}]},{"block_type":"text","content":"field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NamesFlag"}]},{"block_type":"text","content":"structure."}]},{"block_type":"element","block":"k6pz2irl","search_text":"The fourth code segment from funWithFlag.go is shown in the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2irm","search_text":"func main() { var manyNames NamesFlag minusK := flag.Int(\"k\", 0, \"An int\") minusO := flag.String(\"o\", \"Mihalis\", \"The name\") flag.Var(&manyNames, \"names\", \"Comma-separated list\") flag.Parse() fmt.Println(\"-k:\", *minusK) fmt.Println(\"-o:\", *minusO) ","text_count":248,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var manyNames NamesFlag \n    minusK := flag.Int(\"k\", 0, \"An int\") \n    minusO := flag.String(\"o\", \"Mihalis\", \"The name\") \n    flag.Var(&amp;manyNames, \"names\", \"Comma-separated list\") \n \n    flag.Parse() \n    fmt.Println(\"-k:\", *minusK) \n    fmt.Println(\"-o:\", *minusO)"}]}]},{"block_type":"element","block":"k6pz2irn","search_text":"The last part of the funWithFlag.go utility follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"utility follows next:"}]},{"block_type":"element","block":"k6pz2iro","search_text":"for i, item := range manyNames.GetNames() { fmt.Println(i, item) } fmt.Println(\"Remaining command-line arguments:\") for index, val := range flag.Args() { fmt.Println(index, \":\", val) } } ","text_count":187,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i, item := range manyNames.GetNames() { \n        fmt.Println(i, item) \n    } \n \n    fmt.Println(\"Remaining command-line arguments:\") \n    for index, val := range flag.Args() { \n        fmt.Println(index, \":\", val) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2irp","search_text":"The flag.Args() slice keeps the command-line arguments left, while the manyNames variable holds the values from the flag.Var() command-line option.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Args()"}]},{"block_type":"text","content":"slice keeps the command-line arguments left, while the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"manyNames"}]},{"block_type":"text","content":"variable holds the values from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag.Var()"}]},{"block_type":"text","content":"command-line option."}]},{"block_type":"element","block":"k6pz2irq","search_text":"Executing funWithFlag.go will create the following type of output:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"funWithFlag.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2irr","search_text":"$ go run funWithFlag.go -names=Mihalis,Jim,Athina 1 two Three -k: 0 -o: Mihalis 0 Mihalis 1 Jim 2 Athina Remaining command-line arguments: 0 : 1 1 : two 2 : Three $ go run funWithFlag.go -Invalid=Marietta 1 two Three flag provided but not defined: -Invalid Usage of funWithFlag: -k int An int -names value Comma-separated list -o string The name (default \"Mihalis\") exit status 2 $ go run funWithFlag.go -names=Marietta -names=Mihalis invalid value \"Mihalis\" for flag -names: Cannot use names flag more than once! Usage of funWithFlag: -k int An int -names value Comma-separated list -o string The name (default \"Mihalis\") exit status 2 ","text_count":637,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run funWithFlag.go -names=Mihalis,Jim,Athina 1 two Three\n-k: 0\n-o: Mihalis\n0 Mihalis\n1 Jim\n2 Athina\nRemaining command-line arguments:\n0 : 1\n1 : two\n2 : Three\n$ go run funWithFlag.go -Invalid=Marietta 1 two Three\nflag provided but not defined: -Invalid\nUsage of funWithFlag:\n  -k int\n      An int\n  -names value\n      Comma-separated list\n  -o string\n      The name (default \"Mihalis\")\nexit status 2\n$ go run funWithFlag.go -names=Marietta -names=Mihalis\ninvalid value \"Mihalis\" for flag -names: Cannot use names flag more than once!\nUsage of funWithFlag:\n  -k int\n      An int\n  -names value\n      Comma-separated list\n  -o string\n      The name (default \"Mihalis\")\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2irs","search_text":"Tip Unless you are developing a trivial command-line utility that requires no command-line options, you will most likely need to use the flag package for processing the command-line arguments of your program. ","text_count":209,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Unless you are developing a trivial command-line utility that requires no command-line options, you will most likely need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package for processing the command-line arguments of your program."}]}]},{"block_type":"element","block":"k6pz2irt","search_text":"The io.Reader and io.Writer interfaces","text_count":38,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The io.Reader and io.Writer interfaces"}]},{"block_type":"element","block":"k6pz2iru","search_text":"As stated in the previous chapter, compliance with the io.Reader interface requires the implementation of the Read() method, whereas if you want to satisfy the io.Writer interface guidelines, you will need to implement the Write() method. Both these interfaces are very popular in Go, and we will put them to use in a little while.","text_count":331,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As stated in the previous chapter, compliance with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"interface requires the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Read()"}]},{"block_type":"text","content":"method, whereas if you want to satisfy the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interface guidelines, you will need to implement the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"method. Both these interfaces are very popular in Go, and we will put them to use in a little while."}]},{"block_type":"element","block":"k6pz2irv","search_text":"Buffered and unbuffered file input and output","text_count":45,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Buffered and unbuffered file input and output"}]},{"block_type":"element","block":"k6pz2irw","search_text":"Buffered file input and output happens when there is a buffer for temporarily storing data before reading data or writing data. Thus, instead of reading a file byte by byte, you read many bytes at once. You put it in a buffer and wait for someone to read it in the desired way. Unbuffered file input and output happens when there is no buffer to temporarily store data before actually reading or writing it.","text_count":407,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Buffered file input and output happens when there is a buffer for temporarily storing data before reading data or writing data. Thus, instead of reading a file byte by byte, you read many bytes at once. You put it in a buffer and wait for someone to read it in the desired way. Unbuffered file input and output happens when there is no buffer to temporarily store data before actually reading or writing it."}]},{"block_type":"element","block":"k6pz2irx","search_text":"The next question that you might ask is how to decide when to use buffered and when to use unbuffered file input and output. When dealing with critical data, unbuffered file input and output is generally a better choice because buffered reads might result in out-of-date data and buffered writes might result in data loss when the power of your computer is interrupted. However, most of the time, there is no definitive answer to that question. This means that you can use whatever makes your tasks easier to implement.","text_count":519,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next question that you might ask is how to decide when to use buffered and when to use unbuffered file input and output. When dealing with critical data, unbuffered file input and output is generally a better choice because buffered reads might result in out-of-date data and buffered writes might result in data loss when the power of your computer is interrupted. However, most of the time, there is no definitive answer to that question. This means that you can use whatever makes your tasks easier to implement."}]},{"block_type":"element","block":"k6pz2iry","search_text":"The bufio package","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The bufio package"}]},{"block_type":"element","block":"k6pz2irz","search_text":"As the name suggests, the bufio package is about buffered input and output. However, the bufio package still uses (internally) the io.Reader and io.Writer objects, which it wraps in order to create the bufio.Reader and bufio.Writer objects, respectively.","text_count":254,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the name suggests, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package is about buffered input and output. However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package still uses (internally) the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"objects, which it wraps in order to create the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.Writer"}]},{"block_type":"text","content":"objects, respectively."}]},{"block_type":"element","block":"k6pz2is0","search_text":"As you will see in the forthcoming sections, the bufio package is very popular for reading text files.","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see in the forthcoming sections, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package is very popular for reading text files."}]},{"block_type":"element","block":"k6pz2is1","search_text":"Reading text files","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reading text files"}]},{"block_type":"element","block":"k6pz2is2","search_text":"A text file is the most common kind of file that you can find on a Unix system. In this section, you will learn how to read text files in three ways: line by line, word by word, and character by character. As you will see, reading a text file line by line is the easiest method to access a text file, while reading a text file word by word is the most difficult method of all.","text_count":376,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A text file is the most common kind of file that you can find on a Unix system. In this section, you will learn how to read text files in three ways: line by line, word by word, and character by character. As you will see, reading a text file line by line is the easiest method to access a text file, while reading a text file word by word is the most difficult method of all."}]},{"block_type":"element","block":"k6pz2is3","search_text":"If you look closely at the byLine.go , byWord.go , and byCharacter.go programs, you will see many similarities in their Go code. First, all three utilities read the input file line by line. Second, all three utilities have the same main() function, with the exception of the function that is called in the for loop of the main() function. Last, the three functions that process the input text files are almost identical, except for the part that implements the actual functionality of the function.","text_count":498,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you look closely at the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"programs, you will see many similarities in their Go code. First, all three utilities read the input file line by line. Second, all three utilities have the same"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, with the exception of the function that is called in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function. Last, the three functions that process the input text files are almost identical, except for the part that implements the actual functionality of the function."}]},{"block_type":"element","block":"k6pz2is4","search_text":"Reading a text file line by line","text_count":32,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading a text file line by line"}]},{"block_type":"element","block":"k6pz2is5","search_text":"Going line by line is the most common method of reading a text file. This is the main reason it is being shown first. The Go code of byLine.go , which will be presented in three parts, will help you understand the technique.","text_count":224,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Going line by line is the most common method of reading a text file. This is the main reason it is being shown first. The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":", which will be presented in three parts, will help you understand the technique."}]},{"block_type":"element","block":"k6pz2is6","search_text":"The first code segment from byLine.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2is7","search_text":"package main import ( \"bufio\" \"flag\" \"fmt\" \"io\" \"os\" ) ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"flag\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2is8","search_text":"As you can see by the presence of the bufio package, we will use buffered input.","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see by the presence of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio"}]},{"block_type":"text","content":"package, we will use buffered input."}]},{"block_type":"element","block":"k6pz2is9","search_text":"The second part of byLine.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2isa","search_text":"func lineByLine(file string) error { var err error f, err := os.Open(file) if err != nil { return err } defer f.Close() r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break } else if err != nil { fmt.Printf(\"error reading file %s\", err) break } fmt.Print(line) } return nil } ","text_count":310,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func lineByLine(file string) error { \n    var err error \n \n    f, err := os.Open(file) \n    if err != nil { \n        return err \n    } \n    defer f.Close() \n \n    r := bufio.NewReader(f) \n    for { \n        line, err := r.ReadString('\\n') \n        if err == io.EOF { \n            break \n        } else if err != nil { \n            fmt.Printf(\"error reading file %s\", err) \n            break \n        } \n        fmt.Print(line) \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2isb","search_text":"All the magic happens in the lineByLine() function. After making sure that you can open the given filename for reading, you create a new reader using bufio.NewReader() . Then you use that reader with bufio.ReadString() in order to read the input file line by line. The trick is done by the parameter of bufio.ReadString() , which is a character that tells bufio.ReadString() to keep reading until that character is found. Constantly calling bufio.ReadString() when that parameter is the newline character results in reading the input file line by line! Note that the use of fmt.Print() for printing the read line instead of fmt.Println() shows that the newline character is included in each input line.","text_count":702,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All the magic happens in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lineByLine()"}]},{"block_type":"text","content":"function. After making sure that you can open the given filename for reading, you create a new reader using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.NewReader()"}]},{"block_type":"text","content":". Then you use that reader with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"in order to read the input file line by line. The trick is done by the parameter of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":", which is a character that tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"to keep reading until that character is found. Constantly calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ReadString()"}]},{"block_type":"text","content":"when that parameter is the newline character results in reading the input file line by line! Note that the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"for printing the read line instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println()"}]},{"block_type":"text","content":"shows that the newline character is included in each input line."}]},{"block_type":"element","block":"k6pz2isc","search_text":"The third part of byLine.go follows next:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2isd","search_text":"func main() { flag.Parse() if len(flag.Args()) == 0 { fmt.Printf(\"usage: byLine <file1> [<file2> ...]\\n\") return } for _, file := range flag.Args() { err := lineByLine(file) if err != nil { fmt.Println(err) } } } ","text_count":213,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    flag.Parse() \n    if len(flag.Args()) == 0 { \n        fmt.Printf(\"usage: byLine &lt;file1&gt; [&lt;file2&gt; ...]\\n\") \n        return \n    } \n \n    for _, file := range flag.Args() { \n        err := lineByLine(file) \n        if err != nil { \n            fmt.Println(err) \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ise","search_text":"Executing byLine.go and processing its output with wc(1) will generate the following type of output:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":"and processing its output with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2isf","search_text":"$ go run byLine.go /tmp/swtag.log /tmp/adobegc.log | wc 4761 88521 568402","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run byLine.go /tmp/swtag.log /tmp/adobegc.log | wc\n        4761   88521  568402"}]}]},{"block_type":"element","block":"k6pz2isg","search_text":"The following command will verify the accuracy of the preceding output:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following command will verify the accuracy of the preceding output:"}]},{"block_type":"element","block":"k6pz2ish","search_text":"$ wc /tmp/swtag.log /tmp/adobegc.log 131 693 8440 /tmp/swtag.log 4630 87828 559962 /tmp/adobegc.log 4761 88521 568402 total ","text_count":124,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ wc /tmp/swtag.log /tmp/adobegc.log\n         131     693    8440 /tmp/swtag.log\n        4630   87828  559962 /tmp/adobegc.log\n        4761   88521  568402 total"}]}]},{"block_type":"element","block":"k6pz2isi","search_text":"Reading a text file word by word","text_count":32,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading a text file word by word"}]},{"block_type":"element","block":"k6pz2isj","search_text":"The technique presented in this subsection will be demonstrated by the byWord.go file, which is shown in four parts. As you will see in the Go code, separating the words of a line can be tricky. The first part of this utility is as follows:","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique presented in this subsection will be demonstrated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"file, which is shown in four parts. As you will see in the Go code, separating the words of a line can be tricky. The first part of this utility is as follows:"}]},{"block_type":"element","block":"k6pz2isk","search_text":"package main import ( \"bufio\" \"flag\" \"fmt\" \"io\" \"os\" \"regexp\" ) ","text_count":64,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"flag\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n    \"regexp\" \n)"}]}]},{"block_type":"element","block":"k6pz2isl","search_text":"The second code portion of byWord.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ism","search_text":"func wordByWord(file string) error { var err error f, err := os.Open(file) if err != nil { return err } defer f.Close() r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break } else if err != nil { fmt.Printf(\"error reading file %s\", err) return err } ","text_count":284,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func wordByWord(file string) error { \n    var err error \n    f, err := os.Open(file) \n    if err != nil { \n        return err \n    } \n    defer f.Close() \n \n    r := bufio.NewReader(f) \n    for { \n        line, err := r.ReadString('\\n') \n        if err == io.EOF { \n            break \n        } else if err != nil { \n            fmt.Printf(\"error reading file %s\", err) \n            return err \n        }"}]}]},{"block_type":"element","block":"k6pz2isn","search_text":"This part of the wordByWord() function is the same as the lineByLine() function of the byLine.go utility.","text_count":105,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wordByWord()"}]},{"block_type":"text","content":"function is the same as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lineByLine()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byLine.go"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2iso","search_text":"The third part of byWord.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2isp","search_text":"r := regexp.MustCompile(\"[^\\\\s]+\") words := r.FindAllString(line, -1) for i := 0; i < len(words); i++ { fmt.Println(words[i]) } } return nil } ","text_count":143,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r := regexp.MustCompile(\"[^\\\\s]+\") \n        words := r.FindAllString(line, -1) \n        for i := 0; i &lt; len(words); i++ { \n            fmt.Println(words[i]) \n        } \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2isq","search_text":"The remaining code of the wordByWord() function is totally new, and it uses regular expressions to separate the words found in each line of the input. The regular expression defined in the regexp.MustCompile(\"[^\\\\s]+\") statement states that empty characters will separate one word from another.","text_count":294,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wordByWord()"}]},{"block_type":"text","content":"function is totally new, and it uses regular expressions to separate the words found in each line of the input. The regular expression defined in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"regexp.MustCompile(\"[^\\\\s]+\")"}]},{"block_type":"text","content":"statement states that empty characters will separate one word from another."}]},{"block_type":"element","block":"k6pz2isr","search_text":"The last code segment of byWord.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iss","search_text":"func main() { flag.Parse() if len(flag.Args()) == 0 { fmt.Printf(\"usage: byWord <file1> [<file2> ...]\\n\") return } for _, file := range flag.Args() { err := wordByWord(file) if err != nil { fmt.Println(err) } } } ","text_count":213,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    flag.Parse() \n    if len(flag.Args()) == 0 { \n        fmt.Printf(\"usage: byWord &lt;file1&gt; [&lt;file2&gt; ...]\\n\") \n        return \n    } \n \n    for _, file := range flag.Args() { \n        err := wordByWord(file) \n        if err != nil { \n            fmt.Println(err) \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ist","search_text":"Executing byWord.go will produce the following type of output:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"will produce the following type of output:"}]},{"block_type":"element","block":"k6pz2isu","search_text":"$ go run byWord.go /tmp/adobegc.log 01/08/18 20:25:09:669 | [INFO] ","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run byWord.go /tmp/adobegc.log\n01/08/18\n20:25:09:669\n|\n[INFO]"}]}]},{"block_type":"element","block":"k6pz2isv","search_text":"You can verify the validity of byWord.go with the help of the wc(1) utility:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can verify the validity of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"utility:"}]},{"block_type":"element","block":"k6pz2isw","search_text":"$ go run byWord.go /tmp/adobegc.log | wc 91591 91591 559005 $ wc /tmp/adobegc.log 4831 91591 583454 /tmp/adobegc.log","text_count":116,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run byWord.go /tmp/adobegc.log | wc\n    91591   91591  559005\n$ wc /tmp/adobegc.log\n    4831   91591  583454 /tmp/adobegc.log"}]}]},{"block_type":"element","block":"k6pz2isx","search_text":"As you can see, the number of words calculated by wc(1) is the same as the number of lines and words that you took from the execution of byWord.go .","text_count":148,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the number of words calculated by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"is the same as the number of lines and words that you took from the execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2isy","search_text":"Reading a text file character by character","text_count":42,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading a text file character by character"}]},{"block_type":"element","block":"k6pz2isz","search_text":"In this section, you will learn how to read a text file character by character, which is a pretty rare requirement unless you want to create a text editor. The relevant Go code will be saved as byCharacter.go , which will be presented in four parts.","text_count":249,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to read a text file character by character, which is a pretty rare requirement unless you want to create a text editor. The relevant Go code will be saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":", which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2it0","search_text":"The first part of byCharacter.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2it1","search_text":"package main import ( \"bufio\" \"flag\" \"fmt\" \"io\" \"os\" ) ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"flag\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2it2","search_text":"As you can see, you will not need to use regular expressions for this task.","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, you will not need to use regular expressions for this task."}]},{"block_type":"element","block":"k6pz2it3","search_text":"The second code segment from byCharacter.go is as follows:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2it4","search_text":"func charByChar(file string) error { var err error f, err := os.Open(file) if err != nil { return err } defer f.Close() r := bufio.NewReader(f) for { line, err := r.ReadString('\\n') if err == io.EOF { break } else if err != nil { fmt.Printf(\"error reading file %s\", err) return err } ","text_count":284,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func charByChar(file string) error { \n    var err error \n    f, err := os.Open(file) \n    if err != nil { \n        return err \n    } \n    defer f.Close() \n \n    r := bufio.NewReader(f) \n    for { \n        line, err := r.ReadString('\\n') \n        if err == io.EOF { \n            break \n        } else if err != nil { \n            fmt.Printf(\"error reading file %s\", err) \n            return err \n        }"}]}]},{"block_type":"element","block":"k6pz2it5","search_text":"The third part of byCharacter.go is where the logic of the program is found:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"is where the logic of the program is found:"}]},{"block_type":"element","block":"k6pz2it6","search_text":"for _, x := range line { fmt.Println(string(x)) } } return nil } ","text_count":65,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, x := range line { \n            fmt.Println(string(x)) \n        } \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2it7","search_text":"Here you take each line that you read and split it using range . The range returns two values: You discard the first, which is the location of the current character in the line variable, and you use the second. However, that value is a not a character-that is the reason why you have to convert it into a character using the string() function.","text_count":343,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you take each line that you read and split it using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":". The&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"range"}]},{"block_type":"text","content":"&nbsp;returns two values: You discard the first, which is the location of the current character in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"line"}]},{"block_type":"text","content":"variable, and you use the second. However, that value is a not a character-that is the reason why you have to convert it into a character using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"string()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2it8","search_text":"Note that due to the fmt.Println(string(x)) statement, each character is printed in a distinct line, which means that the output of the program will be large. If you want a more compressed output, you should use the fmt.Print() function instead.","text_count":245,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that due to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(string(x))"}]},{"block_type":"text","content":"statement, each character is printed in a distinct line, which means that the output of the program will be large. If you want a more compressed output, you should use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Print()"}]},{"block_type":"text","content":"function instead."}]},{"block_type":"element","block":"k6pz2it9","search_text":"The last part of byCharacter.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ita","search_text":"func main() { flag.Parse() if len(flag.Args()) == 0 { fmt.Printf(\"usage: byChar <file1> [<file2> ...]\\n\") return } for _, file := range flag.Args() { err := charByChar(file) if err != nil { fmt.Println(err) } } } ","text_count":213,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    flag.Parse() \n    if len(flag.Args()) == 0 { \n        fmt.Printf(\"usage: byChar &lt;file1&gt; [&lt;file2&gt; ...]\\n\") \n        return \n    } \n \n    for _, file := range flag.Args() { \n        err := charByChar(file) \n        if err != nil { \n            fmt.Println(err) \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2itb","search_text":"The execution of byCharacter.go will generate the following type of output:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byCharacter.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2itc","search_text":"$ go run byCharacter.go /tmp/adobegc.log 0 1 / 0 8 / 1 8","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run byCharacter.go /tmp/adobegc.log\n0\n1\n/\n0\n8\n/\n1\n8"}]}]},{"block_type":"element","block":"k6pz2itd","search_text":"Note that the Go code presented here can be used for counting the number of characters found in the input file, which can help you implement a Go version of the handy wc(1) command-line utility.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the Go code presented here can be used for counting the number of characters found in the input file, which can help you implement a Go version of the handy"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"command-line utility."}]},{"block_type":"element","block":"k6pz2ite","search_text":"Reading from /dev/random","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading from /dev/random"}]},{"block_type":"element","block":"k6pz2itf","search_text":"In this section, you will learn how to read from the /dev/random system device. The purpose of the /dev/random system device is to generate random data, which you might use for testing your programs or, in this case, you will plant the seed for a random number generator. Getting data from /dev/random can be a little bit tricky, and this is the main reason for specifically discussing it here.","text_count":394,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to read from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"system device. The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"system device is to generate random data, which you might use for testing your programs or, in this case, you will plant the seed for a random number generator. Getting data from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"can be a little bit tricky, and this is the main reason for specifically discussing it here."}]},{"block_type":"element","block":"k6pz2itg","search_text":"On a macOS High Sierra machine, the /dev/random file has the following permissions:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On a macOS High Sierra machine, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"file has the following permissions:"}]},{"block_type":"element","block":"k6pz2ith","search_text":"$ ls -l /dev/random crw-rw-rw- 1 root wheel 14, 0 Jan 8 20:24 /dev/random","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l /dev/random\ncrw-rw-rw-  1 root  wheel   14,   0 Jan  8 20:24 /dev/random"}]}]},{"block_type":"element","block":"k6pz2iti","search_text":"Similarly, on a Debian Linux machine, the /dev/random system device has the following Unix file permissions:","text_count":108,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, on a Debian Linux machine, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"system device has the following Unix file permissions:"}]},{"block_type":"element","block":"k6pz2itj","search_text":"$ ls -l /dev/random crw-rw-rw- 1 root root 1, 8 Jan 13 12:19 /dev/random","text_count":72,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l /dev/random\ncrw-rw-rw- 1 root root 1, 8 Jan 13 12:19 /dev/random"}]}]},{"block_type":"element","block":"k6pz2itk","search_text":"This means that the /dev/random file has analogous file permissions on both Unix variants. The only difference between these two Unix variants is the group that owns the file, which is wheel on macOS and root on Debian Linux, respectively.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"file has analogous file permissions on both Unix variants. The only difference between these two Unix variants is the group that owns the file, which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wheel"}]},{"block_type":"text","content":"on macOS and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"root"}]},{"block_type":"text","content":"on Debian Linux, respectively."}]},{"block_type":"element","block":"k6pz2itl","search_text":"The name of the program for this topic is devRandom.go , and it will be presented in three parts. The first part of the program is as follows:","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program for this topic is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"devRandom.go"}]},{"block_type":"text","content":", and it will be presented in three parts. The first part of the program is as follows:"}]},{"block_type":"element","block":"k6pz2itm","search_text":"package main import ( \"encoding/binary\" \"fmt\" \"os\" ) ","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"encoding/binary\" \n    \"fmt\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2itn","search_text":"In order to read from /dev/random , you will need to import the encoding/binary standard Go package, because /dev/random returns binary data that needs to be decoded.","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to read from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":", you will need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/binary"}]},{"block_type":"text","content":"standard Go package, because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"returns binary data that needs to be decoded."}]},{"block_type":"element","block":"k6pz2ito","search_text":"The second code portion of devRandom.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"devRandom.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2itp","search_text":"func main() { f, err := os.Open(\"/dev/random\") defer f.Close() if err != nil { fmt.Println(err) return } ","text_count":105,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    f, err := os.Open(\"/dev/random\") \n    defer f.Close() \n \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2itq","search_text":"You open /dev/random as usual because everything in Unix is a file.","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You open"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"as usual because everything in Unix is a file."}]},{"block_type":"element","block":"k6pz2itr","search_text":"The last code segment of devRandom.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"devRandom.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2its","search_text":"var seed int64 binary.Read(f, binary.LittleEndian, &seed) fmt.Println(\"Seed:\", seed) } ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var seed int64 \n    binary.Read(f, binary.LittleEndian, &amp;seed) \n    fmt.Println(\"Seed:\", seed) \n}"}]}]},{"block_type":"element","block":"k6pz2itt","search_text":"You need the binary.Read() function, which requires three parameters, in order to read from the /dev/random system device. The value of the second parameter ( binary.LittleEndian ) specifies that you want to use the little endian byte order. The other option is binary.BigEndian , which is used when your computer is using the big endian byte order.","text_count":349,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You need the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binary.Read()"}]},{"block_type":"text","content":"function, which requires three parameters, in order to read from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/dev/random"}]},{"block_type":"text","content":"system device. The value of the second parameter ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binary.LittleEndian"}]},{"block_type":"text","content":") specifies that you want to use the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"little endian"}]},{"block_type":"text","content":"byte order. The other option is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"binary.BigEndian"}]},{"block_type":"text","content":", which is used when your computer is using the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"big endian"}]},{"block_type":"text","content":"byte order."}]},{"block_type":"element","block":"k6pz2itu","search_text":"Executing devRandom.go will generate the following type of output:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"devRandom.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2itv","search_text":"$ go run devRandom.go Seed: -2044736418491485077 $ go run devRandom.go Seed: -5174854372517490328 $ go run devRandom.go Seed: 7702177874251412774","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run devRandom.go\nSeed: -2044736418491485077\n$ go run devRandom.go\nSeed: -5174854372517490328\n$ go run devRandom.go\nSeed: 7702177874251412774"}]}]},{"block_type":"element","block":"k6pz2itw","search_text":"Reading the amount of data you want from a file","text_count":47,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reading the amount of data you want from a file"}]},{"block_type":"element","block":"k6pz2itx","search_text":"In this section, you will learn how to read exactly the amount of data you want. This technique is particularly useful when reading binary files, where you have to decode the data you read in a particular way. Nevertheless, this technique still works with text files.","text_count":267,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to read exactly the amount of data you want. This technique is particularly useful when reading binary files, where you have to decode the data you read in a particular way. Nevertheless, this technique still works with text files."}]},{"block_type":"element","block":"k6pz2ity","search_text":"The logic behind this technique is not that difficult: You create a byte slice with the size you need and use that byte slice for reading. To make this more interesting, this functionality is going to be implemented as a function with two parameters. One parameter will be used for specifying the amount of data that you want you read, and the other parameter, which will have the *os.File type, will be used for accessing the desired file. The return value of that function will be the data you have read.","text_count":506,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The logic behind this technique is not that difficult: You create a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slice"}]},{"block_type":"text","content":"with the size you need and use that byte slice for reading. To make this more interesting, this functionality is going to be implemented as a function with two parameters. One parameter will be used for specifying the amount of data that you want you read, and the other parameter, which will have the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*os.File"}]},{"block_type":"text","content":"type, will be used for accessing the desired file. The return value of that function will be the data you have read."}]},{"block_type":"element","block":"k6pz2itz","search_text":"The name of the Go program for this topic will be readSize.go , and it will be presented in four parts. The utility will accept a single parameter, which will be the size of the byte slice.","text_count":189,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go program for this topic will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The utility will accept a single parameter, which will be the size of the byte slice."}]},{"block_type":"element","block":"k6pz2iu0","search_text":"Tip This particular program, when used with the present technique, can help you copy any file using the buffer size you want. ","text_count":126,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This particular program, when used with the present technique, can help you copy any file using the buffer size you want."}]}]},{"block_type":"element","block":"k6pz2iu1","search_text":"The first part of readSize.go has the expected preamble:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"has the expected preamble:"}]},{"block_type":"element","block":"k6pz2iu2","search_text":"package main import ( \"fmt\" \"io\" \"os\" \"strconv\" ) ","text_count":50,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"os\" \n    \"strconv\" \n)"}]}]},{"block_type":"element","block":"k6pz2iu3","search_text":"The second part of readSize.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iu4","search_text":"func readSize(f *os.File, size int) []byte { buffer := make([]byte, size) n, err := f.Read(buffer) if err == io.EOF { return nil } if err != nil { fmt.Println(err) return nil } return buffer[0:n] } ","text_count":198,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func readSize(f *os.File, size int) []byte { \n    buffer := make([]byte, size) \n \n    n, err := f.Read(buffer) \n    if err == io.EOF { \n        return nil \n    } \n \n    if err != nil { \n        fmt.Println(err) \n        return nil \n    } \n \n    return buffer[0:n] \n}"}]}]},{"block_type":"element","block":"k6pz2iu5","search_text":"This is the function discussed earlier. Although the code is straightforward, there is one point that needs an explanation. The io.Reader.Read() method returns two parameters: the number of bytes read as well as an error variable. The readSize() function uses the former return value of io.Read() in order to return a byte slice of that size. Although this is a tiny detail, and it is only significant when you reach the end of the file, it ensures that the output of the utility will be same as the input and that it will not contain any extra characters. Finally, there is code that checks for io.EOF , which is an error that signifies that you have reached the end of a file. When that kind of error occurs, the function returns.","text_count":732,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is the function discussed earlier. Although the code is straightforward, there is one point that needs an explanation. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader.Read()"}]},{"block_type":"text","content":"method returns two parameters: the number of bytes read as well as an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize()"}]},{"block_type":"text","content":"function uses the former return value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Read()"}]},{"block_type":"text","content":"in order to return a byte slice of that size. Although this is a tiny detail, and it is only significant when you reach the end of the file, it ensures that the output of the utility will be same as the input and that it will not contain any extra characters. Finally, there is code that checks for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.EOF"}]},{"block_type":"text","content":", which is an error that signifies that you have reached the end of a file. When that kind of error occurs, the function returns."}]},{"block_type":"element","block":"k6pz2iu6","search_text":"The third code portion of this utility is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of this utility is as follows:"}]},{"block_type":"element","block":"k6pz2iu7","search_text":"func main() { arguments := os.Args if len(arguments) != 3 { fmt.Println(\"<buffer size> <filename>\") return } bufferSize, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } file := os.Args[2] f, err := os.Open(file) if err != nil { fmt.Println(err) return } defer f.Close() ","text_count":296,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) != 3 { \n        fmt.Println(\"&lt;buffer size&gt; &lt;filename&gt;\") \n        return \n    } \n \n    bufferSize, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }  \n \n    file := os.Args[2] \n    f, err := os.Open(file) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    defer f.Close()"}]}]},{"block_type":"element","block":"k6pz2iu8","search_text":"The last code segment of readSize.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iu9","search_text":"for { readData := readSize(f, bufferSize) if readData != nil { fmt.Print(string(readData)) } else { break } } } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        readData := readSize(f, bufferSize) \n        if readData != nil { \n            fmt.Print(string(readData)) \n        } else { \n            break \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2iua","search_text":"So, here you keep reading your input file until readSize() returns an error or nil .","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, here you keep reading your input file until"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize()"}]},{"block_type":"text","content":"returns an error or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iub","search_text":"Executing readSize.go by telling it to process a binary file and handling its output with wc(1) will validate the correctness of the program:","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"by telling it to process a binary file and handling its output with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"will validate the correctness of the program:"}]},{"block_type":"element","block":"k6pz2iuc","search_text":"$ go run readSize.go 1000 /bin/ls | wc 80 1032 38688 $ wc /bin/ls 80 1032 38688 /bin/ls","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run readSize.go 1000 /bin/ls | wc\n    80    1032   38688\n$ wc /bin/ls\n    80    1032   38688 /bin/ls"}]}]},{"block_type":"element","block":"k6pz2iud","search_text":"Why are we using binary format?","text_count":31,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Why are we using binary format?"}]},{"block_type":"element","block":"k6pz2iue","search_text":"In the previous section, the readSize.go utility illustrated how you can read a file byte by byte, which is a technique that best applies to binary files. So, you might ask why read data in binary format when text formats are so much easier to understand? The main reason is space reduction. Imagine that you want to store the number 20 as a string to a file. It is easy to understand that you will need two bytes for storing 20 using ASCII characters, one for storing 2 and another for storing 0. Storing 20 in binary format requires just one byte, since 20 can be represented as 00010100 in binary or as 0x14 in hexadecimal.","text_count":626,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous section, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"utility illustrated how you can read a file byte by byte, which is a technique that best applies to binary files. So, you might ask why read data in binary format when text formats are so much easier to understand? The main reason is space reduction. Imagine that you want to store the number 20 as a string to a file. It is easy to understand that you will need two bytes for storing 20 using ASCII characters, one for storing 2 and another for storing 0. Storing 20 in binary format requires just one byte, since 20 can be represented as 00010100 in binary or as 0x14 in hexadecimal."}]},{"block_type":"element","block":"k6pz2iuf","search_text":"This difference might look insignificant when you are dealing with small amounts of data, but it could be pretty substantial when dealing with data found in applications such as database servers.","text_count":195,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This difference might look insignificant when you are dealing with small amounts of data, but it could be pretty substantial when dealing with data found in applications such as database servers."}]},{"block_type":"element","block":"k6pz2iug","search_text":"Reading CSV files","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reading CSV files"}]},{"block_type":"element","block":"k6pz2iuh","search_text":"CSV files are plain text files with a format. In this section, you will learn how to read a text file that contains points of a plane, which means that each line will contain a pair of coordinates. Additionally, you are also going to use an external Go library named Glot, which will help you create a plot of the points that you read from the CSV file. Note that Glot uses Gnuplot , which means that you will need to install Gnuplot on your Unix machine in order to use Glot.","text_count":476,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"CSV files"}]},{"block_type":"text","content":"are plain text files with a format. In this section, you will learn how to read a text file that contains points of a plane, which means that each line will contain a pair of coordinates. Additionally, you are also going to use an external Go library named Glot, which will help you create a plot of the points that you read from the CSV file. Note that"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Glot"}]},{"block_type":"text","content":"uses"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Gnuplot"}]},{"block_type":"text","content":", which means that you will need to install Gnuplot on your Unix machine in order to use Glot."}]},{"block_type":"element","block":"k6pz2iui","search_text":"The name of the source file for this topic is CSVplot.go , and it is going to be presented in five parts. The first code segment is as follows:","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the source file for this topic is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":", and it is going to be presented in five parts. The first code segment is as follows:"}]},{"block_type":"element","block":"k6pz2iuj","search_text":"package main import ( \"encoding/csv\" \"fmt\" \"github.com/Arafatk/glot\" \"os\" \"strconv\" ) ","text_count":86,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"encoding/csv\" \n    \"fmt\" \n    \"github.com/Arafatk/glot\" \n    \"os\" \n    \"strconv\" \n)"}]}]},{"block_type":"element","block":"k6pz2iuk","search_text":"The second part of CSVplot.go is shown in the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iul","search_text":"func main() { if len(os.Args) != 2 { fmt.Println(\"Need a data file!\") return } file := os.Args[1] _, err := os.Stat(file) if err != nil { fmt.Println(\"Cannot stat\", file) return } ","text_count":180,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n        fmt.Println(\"Need a data file!\") \n        return \n    } \n \n    file := os.Args[1] \n    _, err := os.Stat(file) \n    if err != nil { \n        fmt.Println(\"Cannot stat\", file) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2ium","search_text":"In this part, you see a technique for checking whether a file already exists or not using the powerful os.Stat() function.","text_count":122,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see a technique for checking whether a file already exists or not using the powerful"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stat()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2iun","search_text":"The third part of CSVplot.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iuo","search_text":"f, err := os.Open(file) if err != nil { fmt.Println(\"Cannot open\", file) fmt.Println(err) return } defer f.Close() reader := csv.NewReader(f) reader.FieldsPerRecord = -1 allRecords, err := reader.ReadAll() if err != nil { fmt.Println(err) return } ","text_count":248,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f, err := os.Open(file) \n    if err != nil { \n        fmt.Println(\"Cannot open\", file) \n        fmt.Println(err) \n        return \n    } \n    defer f.Close() \n \n    reader := csv.NewReader(f) \n    reader.FieldsPerRecord = -1 \n    allRecords, err := reader.ReadAll() \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2iup","search_text":"The fourth code segment of CSVplot.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iuq","search_text":"xP := []float64{} yP := []float64{} for _, rec := range allRecords { x, _ := strconv.ParseFloat(rec[0], 64) y, _ := strconv.ParseFloat(rec[1], 64) xP = append(xP, x) yP = append(yP, y) } points := [][]float64{} points = append(points, xP) points = append(points, yP) fmt.Println(points) ","text_count":287,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"xP := []float64{} \n    yP := []float64{} \n    for _, rec := range allRecords { \n        x, _ := strconv.ParseFloat(rec[0], 64) \n        y, _ := strconv.ParseFloat(rec[1], 64) \n        xP = append(xP, x) \n        yP = append(yP, y) \n    } \n \n    points := [][]float64{} \n    points = append(points, xP) \n    points = append(points, yP) \n    fmt.Println(points)"}]}]},{"block_type":"element","block":"k6pz2iur","search_text":"Here you convert the string values you read into numbers and put them into a slice with two dimensions named points .","text_count":117,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you convert the string values you read into numbers and put them into a slice with two dimensions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"points"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ius","search_text":"The last part of CSVplot.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iut","search_text":"dimensions := 2 persist := true debug := false plot, _ := glot.NewPlot(dimensions, persist, debug) plot.SetTitle(\"Using Glot with CSV data\") plot.SetXLabel(\"X-Axis\") plot.SetYLabel(\"Y-Axis\") style := \"circle\" plot.AddPointGroup(\"Circle:\", style, points) plot.SavePlot(\"output.png\") } ","text_count":284,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"dimensions := 2 \n    persist := true \n    debug := false \n    plot, _ := glot.NewPlot(dimensions, persist, debug) \n \n    plot.SetTitle(\"Using Glot with CSV data\") \n    plot.SetXLabel(\"X-Axis\") \n    plot.SetYLabel(\"Y-Axis\") \n    style := \"circle\" \n    plot.AddPointGroup(\"Circle:\", style, points) \n    plot.SavePlot(\"output.png\") \n}"}]}]},{"block_type":"element","block":"k6pz2iuu","search_text":"In the preceding Go code, you saw how you can create a PNG file with the help of the Glot library and its glot.SavePlot() function.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you saw how you can create a PNG file with the help of the Glot library and its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"glot.SavePlot()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2iuv","search_text":"As you can guess, you will need to download the Glot Go library before being able to compile and execute the CSVplot.go source code, which requires the execution of the following command from your favorite Unix shell:","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can guess, you will need to download the Glot Go library before being able to compile and execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"source code, which requires the execution of the following command from your favorite Unix shell:"}]},{"block_type":"element","block":"k6pz2iuw","search_text":"$ go get github.com/Arafatk/glot","text_count":32,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go get github.com/Arafatk/glot"}]}]},{"block_type":"element","block":"k6pz2iux","search_text":"You can see the results of the preceding command by looking inside ~/go directory:","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can see the results of the preceding command by looking inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go"}]},{"block_type":"text","content":"directory:"}]},{"block_type":"element","block":"k6pz2iuy","search_text":"$ ls -l ~/go/pkg/darwin_amd64/github.com/Arafatk/ total 240 -rw-r--r-- 1 mtsouk staff 119750 Jan 22 22:12 glot.a $ ls -l ~/go/src/github.com/Arafatk/glot/ total 120 -rw-r--r-- 1 mtsouk staff 1818 Jan 22 22:12 README.md -rw-r--r-- 1 mtsouk staff 6092 Jan 22 22:12 common.go -rw-r--r-- 1 mtsouk staff 552 Jan 22 22:12 common_test.go -rw-r--r-- 1 mtsouk staff 3162 Jan 22 22:12 core.go -rw-r--r-- 1 mtsouk staff 138 Jan 22 22:12 core_test.go -rw-r--r-- 1 mtsouk staff 3049 Jan 22 22:12 function.go -rw-r--r-- 1 mtsouk staff 511 Jan 22 22:12 function_test.go -rw-r--r-- 1 mtsouk staff 4955 Jan 22 22:12 glot.go -rw-r--r-- 1 mtsouk staff 220 Jan 22 22:12 glot_test.go -rw-r--r-- 1 mtsouk staff 10536 Jan 22 22:12 pointgroup.go -rw-r--r-- 1 mtsouk staff 378 Jan 22 22:12 pointgroup_test.go","text_count":783,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l ~/go/pkg/darwin_amd64/github.com/Arafatk/\ntotal 240\n-rw-r--r--  1 mtsouk  staff  119750 Jan 22 22:12 glot.a\n$ ls -l ~/go/src/github.com/Arafatk/glot/\ntotal 120\n-rw-r--r--  1 mtsouk  staff   1818 Jan 22 22:12 README.md\n-rw-r--r--  1 mtsouk  staff   6092 Jan 22 22:12 common.go\n-rw-r--r--  1 mtsouk  staff    552 Jan 22 22:12 common_test.go\n-rw-r--r--  1 mtsouk  staff   3162 Jan 22 22:12 core.go\n-rw-r--r--  1 mtsouk  staff    138 Jan 22 22:12 core_test.go\n-rw-r--r--  1 mtsouk  staff   3049 Jan 22 22:12 function.go\n-rw-r--r--  1 mtsouk  staff    511 Jan 22 22:12 function_test.go\n-rw-r--r--  1 mtsouk  staff   4955 Jan 22 22:12 glot.go\n-rw-r--r--  1 mtsouk  staff    220 Jan 22 22:12 glot_test.go\n-rw-r--r--  1 mtsouk  staff  10536 Jan 22 22:12 pointgroup.go\n-rw-r--r--  1 mtsouk  staff    378 Jan 22 22:12 pointgroup_test.go"}]}]},{"block_type":"element","block":"k6pz2iuz","search_text":"The CSV data file containing the points that will be plotted has the following format:","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The CSV data file containing the points that will be plotted has the following format:"}]},{"block_type":"element","block":"k6pz2iv0","search_text":"$ cat /tmp/dataFile 1,2 2,3 3,3 4,4 5,8 6,5 -1,12 -2,10 -3,10 -4,10","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cat /tmp/dataFile\n1,2\n2,3\n3,3\n4,4\n5,8\n6,5\n-1,12\n-2,10\n-3,10\n-4,10"}]}]},{"block_type":"element","block":"k6pz2iv1","search_text":"Executing CSVplot.go will generate the following kind of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"will generate the following kind of output:"}]},{"block_type":"element","block":"k6pz2iv2","search_text":"$ go run CSVplot.go /tmp/doesNoExist Cannot stat /tmp/doesNoExist $ go run CSVplot.go /tmp/dataFile [[1 2 3 4 5 6 -1 -2 -3 -4] [2 3 3 4 8 5 12 10 10 10]]","text_count":153,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run CSVplot.go /tmp/doesNoExist\nCannot stat /tmp/doesNoExist\n$ go run CSVplot.go /tmp/dataFile\n[[1 2 3 4 5 6 -1 -2 -3 -4] [2 3 3 4 8 5 12 10 10 10]]"}]}]},{"block_type":"element","block":"k6pz2iv3","search_text":"You can see the results of CSVplot.go in a much better format in the following figure:","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can see the results of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CSVplot.go"}]},{"block_type":"text","content":"in a much better format in the following figure:"}]},{"block_type":"element","block":"k6pz2iv4","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000013.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2iv5","search_text":"The type of graphical output you can get from Glot.","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The type of graphical output you can get from Glot."}]},{"block_type":"element","block":"k6pz2iv6","search_text":"Writing to a file","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Writing to a file"}]},{"block_type":"element","block":"k6pz2iv7","search_text":"Generally speaking, you can use the functionality of the io.Writer interface for writing data to files on a disk. Nevertheless, the Go code of save.go will show you five ways to write data to a file. The save.go program will be presented in six parts.","text_count":251,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, you can use the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interface for writing data to files on a disk. Nevertheless, the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"will show you five ways to write data to a file. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"program will be presented in six parts."}]},{"block_type":"element","block":"k6pz2iv8","search_text":"The first part of save.go is as follows:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iv9","search_text":"package main import ( \"bufio\" \"fmt\" \"io\" \"io/ioutil\" \"os\" ) ","text_count":60,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n   \"bufio\" \n   \"fmt\" \n   \"io\" \n   \"io/ioutil\" \n   \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2iva","search_text":"The second code portion of save.go is shown in the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ivb","search_text":"func main() { s := []byte(\"Data to write\\n\") f1, err := os.Create(\"f1.txt\") if err != nil { fmt.Println(\"Cannot create file\", err) return } defer f1.Close() fmt.Fprintf(f1, string(s)) ","text_count":184,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    s := []byte(\"Data to write\\n\") \n \n    f1, err := os.Create(\"f1.txt\") \n    if err != nil { \n        fmt.Println(\"Cannot create file\", err) \n        return \n    } \n    defer f1.Close() \n    fmt.Fprintf(f1, string(s))"}]}]},{"block_type":"element","block":"k6pz2ivc","search_text":"Notice that the s byte slice will be used in every line that involves writing presented in this Go program. Additionally, the fmt.Fprintf() function used here can help you write data to your own log files using the format you want. In this case, fmt.Fprintf() writes your data to the file identified by f1 .","text_count":307,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s"}]},{"block_type":"text","content":"byte slice will be used in every line that involves writing presented in this Go program. Additionally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintf()"}]},{"block_type":"text","content":"function used here can help you write data to your own log files using the format you want. In this case,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintf()"}]},{"block_type":"text","content":"writes your data to the file identified by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ivd","search_text":"The third part of save.go contains the following Go code:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ive","search_text":"f2, err := os.Create(\"f2.txt\") if err != nil { fmt.Println(\"Cannot create file\", err) return } defer f2.Close() n, err := f2.WriteString(string(s)) fmt.Printf(\"wrote %d bytes\\n\", n) ","text_count":182,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f2, err := os.Create(\"f2.txt\") \n    if err != nil { \n        fmt.Println(\"Cannot create file\", err) \n        return \n    } \n    defer f2.Close() \n    n, err := f2.WriteString(string(s)) \n    fmt.Printf(\"wrote %d bytes\\n\", n)"}]}]},{"block_type":"element","block":"k6pz2ivf","search_text":"In this case, f2.WriteString() is used for writing your data to a file.","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2.WriteString()"}]},{"block_type":"text","content":"is used for writing your data to a file."}]},{"block_type":"element","block":"k6pz2ivg","search_text":"The fourth code segment of save.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2ivh","search_text":"f3, err := os.Create(\"f3.txt\") if err != nil { fmt.Println(err) return } w := bufio.NewWriter(f3) n, err = w.WriteString(string(s)) fmt.Printf(\"wrote %d bytesn\", \\n) w.Flush() ","text_count":176,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f3, err := os.Create(\"f3.txt\") \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    w := bufio.NewWriter(f3) \n    n, err = w.WriteString(string(s)) \n    fmt.Printf(\"wrote %d bytesn\", \\n) \n    w.Flush()"}]}]},{"block_type":"element","block":"k6pz2ivi","search_text":"In this case, bufio.NewWriter() opens a file for writing and bufio.WriteString() writes the data.","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.NewWriter()"}]},{"block_type":"text","content":"opens a file for writing and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.WriteString()"}]},{"block_type":"text","content":"writes the data."}]},{"block_type":"element","block":"k6pz2ivj","search_text":"The fifth part of save.go will teach you another method for writing to a file:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"will teach you another method for writing to a file:"}]},{"block_type":"element","block":"k6pz2ivk","search_text":"f4 := \"f4.txt\" err = ioutil.WriteFile(f4, s, 0644) if err != nil { fmt.Println(err) return } ","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f4 := \"f4.txt\" \n    err = ioutil.WriteFile(f4, s, 0644) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2ivl","search_text":"This method needs just a single function call named ioutil.WriteFile() for writing your data, and it does not require the use of os.Create() .","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This method needs just a single function call named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ioutil.WriteFile()"}]},{"block_type":"text","content":"for writing your data, and it does not require the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Create()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ivm","search_text":"The last code segment of save.go is as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ivn","search_text":"f5, err := os.Create(\"f5.txt\") if err != nil { fmt.Println(err) return } n, err = io.WriteString(f5, string(s)) if err != nil { fmt.Println(err) return } fmt.Printf(\"wrote %d bytes\\n\", n) } ","text_count":190,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"f5, err := os.Create(\"f5.txt\") \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    n, err = io.WriteString(f5, string(s)) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    fmt.Printf(\"wrote %d bytes\\n\", n) \n}"}]}]},{"block_type":"element","block":"k6pz2ivo","search_text":"The last technique uses io.WriteString() to write the desired data to a file.","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last technique uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriteString()"}]},{"block_type":"text","content":"to write the desired data to a file."}]},{"block_type":"element","block":"k6pz2ivp","search_text":"Executing save.go will create the following type of output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ivq","search_text":"$ go run save.go wrote 14 bytes wrote 14 bytes wrote 14 bytes $ ls -l f?.txt -rw-r--r-- 1 mtsouk staff 14 Jan 23 20:30 f1.txt -rw-r--r-- 1 mtsouk staff 14 Jan 23 20:30 f2.txt -rw-r--r-- 1 mtsouk staff 14 Jan 23 20:30 f3.txt -rw-r--r-- 1 mtsouk staff 14 Jan 23 20:30 f4.txt -rw-r--r-- 1 mtsouk staff 14 Jan 23 20:30 f5.txt $ cat f?.txt Data to write Data to write Data to write Data to write Data to write ","text_count":405,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run save.go\nwrote 14 bytes\nwrote 14 bytes\nwrote 14 bytes\n$ ls -l f?.txt\n-rw-r--r--  1 mtsouk  staff  14 Jan 23 20:30 f1.txt\n-rw-r--r--  1 mtsouk  staff  14 Jan 23 20:30 f2.txt\n-rw-r--r--  1 mtsouk  staff  14 Jan 23 20:30 f3.txt\n-rw-r--r--  1 mtsouk  staff  14 Jan 23 20:30 f4.txt\n-rw-r--r--  1 mtsouk  staff  14 Jan 23 20:30 f5.txt\n$ cat f?.txt\nData to write\nData to write\nData to write\nData to write\nData to write"}]}]},{"block_type":"element","block":"k6pz2ivr","search_text":"The next section will show you how to save data to a file with the help of a specialized function of a package that is in the standard Go library.","text_count":146,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next section will show you how to save data to a file with the help of a specialized function of a package that is in the standard Go library."}]},{"block_type":"element","block":"k6pz2ivs","search_text":"Loading and saving data on disk","text_count":31,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Loading and saving data on disk"}]},{"block_type":"element","block":"k6pz2ivt","search_text":"Do you remember the keyValue.go application from Chapter 4, The Uses of Composite Types Well, it was far from complete, so in this section you will learn how to save the data of a key-value store on disk and how to load it back into memory when you next start your application.","text_count":277,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Do you remember the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"application from Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":"&nbsp;Well, it was far from complete, so in this section you will learn how to save the data of a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"key-value store"}]},{"block_type":"text","content":"on disk and how to load it back into memory when you next start your application."}]},{"block_type":"element","block":"k6pz2ivu","search_text":"We are going to create two new functions, one named save() for saving data to disk and another named load() for retrieving the data from disk. Thus, we will only present the code differences between keyValue.go and kvSaveLoad.go using the diff(1) Unix command-line utility.","text_count":273,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We are going to create two new functions, one named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"for saving data to disk and another named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"for retrieving the data from disk. Thus, we will only present the code differences between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"diff(1)"}]},{"block_type":"text","content":"Unix command-line utility."}]},{"block_type":"element","block":"k6pz2ivv","search_text":"Tip The diff(1) Unix command-line utility can be very convenient when you want to spot the differences between two text files. You can learn more about it by executing man 1 diff at the command-line of your favorite Unix shell. ","text_count":228,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"diff(1)"}]},{"block_type":"text","content":"Unix command-line utility can be very convenient when you want to spot the differences between two text files. You can learn more about it by executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"man 1 diff"}]},{"block_type":"text","content":"at the command-line of your favorite Unix shell."}]}]},{"block_type":"element","block":"k6pz2ivw","search_text":"If you think about the task to be implemented here, you will recognize that what you need is an easy way to save the contents of a Go map to disk, as well as a way to load the data from a file and put it into a Go map.","text_count":218,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you think about the task to be implemented here, you will recognize that what you need is an easy way to save the contents of a Go map to disk, as well as a way to load the data from a file and put it into a Go map."}]},{"block_type":"element","block":"k6pz2ivx","search_text":"The process of converting your data into a stream of bytes is called serialization . The process of reading a data file and converting it into an object is called deserialization . The encoding/gob standard Go package will be used for the program kvSaveLoad.go . It will help the serialization and deserialization process. The encoding/gob package uses the gob format for storing its data. The official name for such formats is stream encoding . The good thing about the gob format is that Go does all of the dirty work, so that you don't have to worry about the encoding and decoding stages.","text_count":592,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The process of converting your data into a stream of bytes is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"serialization"}]},{"block_type":"text","content":". The process of reading a data file and converting it into an object is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"deserialization"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/gob"}]},{"block_type":"text","content":"standard Go package will be used for the program"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":". It will help the serialization and deserialization process. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/gob"}]},{"block_type":"text","content":"package uses the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"gob format"}]},{"block_type":"text","content":"for storing its data. The official name for such formats is"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"stream encoding"}]},{"block_type":"text","content":". The good thing about the gob format is that Go does all of the dirty work, so that you don't have to worry about the encoding and decoding stages."}]},{"block_type":"element","block":"k6pz2ivy","search_text":"Other Go packages that can help you serialize and deserialize data are encoding/xml , which uses the XML format , and encoding/json , which uses the JSON format .","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Other Go packages that can help you serialize and deserialize data are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/xml"}]},{"block_type":"text","content":", which uses the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"XML format"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/json"}]},{"block_type":"text","content":", which uses the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"JSON format"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2ivz","search_text":"The following output will reveal the code changes between kvSaveLoad.go and keyValue.go without including the implementations of save() and load() functions that will be fully presented here:","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following output will reveal the code changes between"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"without including the implementations of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"functions that will be fully presented here:"}]},{"block_type":"element","block":"k6pz2iw0","search_text":"$ diff keyValue.go kvSaveLoad.go 4a5 > \"encoding/gob\" 16a18,55 > var DATAFILE = \"/tmp/dataFile.gob\" > func save() error { > > return nil > } > > func load() error { > > } 59a99,104 > > err := load() > if err != nil { > fmt.Println(err) > } > 88a134,137 > err = save() > if err != nil { > fmt.Println(err) > } ","text_count":309,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ diff keyValue.go kvSaveLoad.go\n4a5\n&gt;     \"encoding/gob\"\n16a18,55\n&gt; var DATAFILE = \"/tmp/dataFile.gob\"\n&gt; func save() error {\n&gt;\n&gt;     return nil\n&gt; }\n&gt;\n&gt; func load() error {\n&gt;\n&gt; }\n59a99,104\n&gt;\n&gt;     err := load()\n&gt;     if err != nil {\n&gt;           fmt.Println(err)\n&gt;     }\n&gt;\n88a134,137\n&gt;                 err = save()\n&gt;                 if err != nil {\n&gt;                       fmt.Println(err)\n&gt;                 }"}]}]},{"block_type":"element","block":"k6pz2iw1","search_text":"An important part of the diff(1) output is the definition of the DATAFILE global variable that holds the path to the file that is used by the key-value store. Apart from this, you see where the load() function is called as well as the point where the save() function is called. The load() function is used first in the main() function, while the save() function is executed when the user issues the STOP command.","text_count":412,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"An important part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"diff(1)"}]},{"block_type":"text","content":"output is the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DATAFILE"}]},{"block_type":"text","content":"global variable that holds the path to the file that is used by the key-value store. Apart from this, you see where the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"function is called as well as the point where the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function is called. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"function is used first in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, while the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function is executed when the user issues the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"STOP"}]},{"block_type":"text","content":"command."}]},{"block_type":"element","block":"k6pz2iw2","search_text":"Each time you execute kvSaveLoad.go , the program checks whether there is data to be read by trying to read the default data file. If there is no data file to read, you will start with an empty key-value store. When the program is about to terminate, it writes all of its data on the disk using the save() function.","text_count":315,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each time you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":", the program checks whether there is data to be read by trying to read the default data file. If there is no data file to read, you will start with an empty key-value store. When the program is about to terminate, it writes all of its data on the disk using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2iw3","search_text":"The save() function has the following implementation:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function has the following implementation:"}]},{"block_type":"element","block":"k6pz2iw4","search_text":"func save() error { fmt.Println(\"Saving\", DATAFILE) err := os.Remove(DATAFILE) if err != nil { fmt.Println(err) } saveTo, err := os.Create(DATAFILE) if err != nil { fmt.Println(\"Cannot create\", DATAFILE) return err } defer saveTo.Close() encoder := gob.NewEncoder(saveTo) err = encoder.Encode(DATA) if err != nil { fmt.Println(\"Cannot save to\", DATAFILE) return err } return nil } ","text_count":381,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func save() error { \n    fmt.Println(\"Saving\", DATAFILE) \n    err := os.Remove(DATAFILE) \n    if err != nil { \n        fmt.Println(err) \n    } \n \n    saveTo, err := os.Create(DATAFILE) \n    if err != nil { \n        fmt.Println(\"Cannot create\", DATAFILE) \n        return err \n    } \n    defer saveTo.Close() \n \n    encoder := gob.NewEncoder(saveTo) \n    err = encoder.Encode(DATA) \n    if err != nil { \n        fmt.Println(\"Cannot save to\", DATAFILE) \n        return err \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2iw5","search_text":"Note that the first thing the save() function does is to delete the existing data file using the os.Remove() function in order to create it later on.","text_count":149,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the first thing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function does is to delete the existing data file using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Remove()"}]},{"block_type":"text","content":"function in order to create it later on."}]},{"block_type":"element","block":"k6pz2iw6","search_text":"One of the most critical tasks the save() function does is to make sure that you can actually create and write to the desired file. Although there are many ways to do this, the save() function uses the simplest way, which is by checking the error value returned by the os.Create() function. If that value is not nil , then there is a problem and the save() function finishes without saving any data.","text_count":399,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One of the most critical tasks the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function does is to make sure that you can actually create and write to the desired file. Although there are many ways to do this, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function uses the simplest way, which is by checking the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value returned by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Create()"}]},{"block_type":"text","content":"function. If that value is not"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", then there is a problem and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function finishes without saving any data."}]},{"block_type":"element","block":"k6pz2iw7","search_text":"The load() function is implemented as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"function is implemented as follows:"}]},{"block_type":"element","block":"k6pz2iw8","search_text":"func load() error { fmt.Println(\"Loading\", DATAFILE) loadFrom, err := os.Open(DATAFILE) defer loadFrom.Close() if err != nil { fmt.Println(\"Empty key/value store!\") return err } decoder := gob.NewDecoder(loadFrom) decoder.Decode(&DATA) return nil } ","text_count":249,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func load() error { \n    fmt.Println(\"Loading\", DATAFILE) \n    loadFrom, err := os.Open(DATAFILE) \n    defer loadFrom.Close() \n    if err != nil { \n        fmt.Println(\"Empty key/value store!\") \n        return err \n    } \n \n    decoder := gob.NewDecoder(loadFrom) \n    decoder.Decode(&amp;DATA) \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2iw9","search_text":"One of the tasks of the load() function is to make sure that the file which you are trying to read is actually there and that you can read it without any problems. Once again, the load() function uses the simplest approach, which is to look at the return value of the os.Open() function. If the error value returned is equal to nil , then everything is fine.","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One of the tasks of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"function is to make sure that the file which you are trying to read is actually there and that you can read it without any problems. Once again, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"load()"}]},{"block_type":"text","content":"function uses the simplest approach, which is to look at the return value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Open()"}]},{"block_type":"text","content":"function. If the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value returned is equal to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", then everything is fine."}]},{"block_type":"element","block":"k6pz2iwa","search_text":"It is also important to close the file after reading the data from it, as it will be overwritten by the save() function later on. The release of the file is accomplished by the defer loadFrom.Close() statement.","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is also important to close the file after reading the data from it, as it will be overwritten by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function later on. The release of the file is accomplished by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer loadFrom.Close()"}]},{"block_type":"text","content":"statement."}]},{"block_type":"element","block":"k6pz2iwb","search_text":"Executing kvSaveLoad.go will generate the following type of output:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2iwc","search_text":"$ go run kvSaveLoad.go Loading /tmp/dataFile.gob Empty key/value store! open /tmp/dataFile.gob: no such file or directory ADD 1 2 3 ADD 4 5 6 STOP Saving /tmp/dataFile.gob remove /tmp/dataFile.gob: no such file or directory $ go run kvSaveLoad.go Loading /tmp/dataFile.gob PRINT key: 1 value: {2 3 } key: 4 value: {5 6 } DELETE 1 PRINT key: 4 value: {5 6 } STOP Saving /tmp/dataFile.gob rMacBook:code mtsouk$ go run kvSaveLoad.go Loading /tmp/dataFile.gob PRINT key: 4 value: {5 6 } STOP Saving /tmp/dataFile.gob $ ls -l /tmp/dataFile.gob -rw-r--r-- 1 mtsouk wheel 80 Jan 22 11:22 /tmp/dataFile.gob $ file /tmp/dataFile.gob /tmp/dataFile.gob: data ","text_count":648,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run kvSaveLoad.go\nLoading /tmp/dataFile.gob\nEmpty key/value store!\nopen /tmp/dataFile.gob: no such file or directory\nADD 1 2 3\nADD 4 5 6\nSTOP\nSaving /tmp/dataFile.gob\nremove /tmp/dataFile.gob: no such file or directory\n$ go run kvSaveLoad.go\nLoading /tmp/dataFile.gob\nPRINT\nkey: 1 value: {2 3 }\nkey: 4 value: {5 6 }\nDELETE 1\nPRINT\nkey: 4 value: {5 6 }\nSTOP\nSaving /tmp/dataFile.gob\nrMacBook:code mtsouk$ go run kvSaveLoad.go\nLoading /tmp/dataFile.gob\nPRINT\nkey: 4 value: {5 6 }\nSTOP\nSaving /tmp/dataFile.gob\n$ ls -l /tmp/dataFile.gob\n-rw-r--r--  1 mtsouk  wheel  80 Jan 22 11:22 /tmp/dataFile.gob\n$ file /tmp/dataFile.gob\n/tmp/dataFile.gob: data"}]}]},{"block_type":"element","block":"k6pz2iwd","search_text":"In Chapter 13, Network Programming - Building Servers and Clients, you are going to see the final version of the key-value store, which will be able to operate over a TCP/IP connection and will serve multiple network clients using goroutines .","text_count":243,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming - Building Servers and Clients,"}]},{"block_type":"text","content":"&nbsp;you are going to see the final version of the key-value store, which will be able to operate over a TCP/IP connection and will serve multiple network clients using"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutines"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iwe","search_text":"The strings package revisited","text_count":29,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The strings package revisited"}]},{"block_type":"element","block":"k6pz2iwf","search_text":"We first talked about the handy strings package back in Chapter 4, The Uses of Composite Types . This section will address the functions of the strings package that are related to file input and output.","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We first talked about the handy"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package back in Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types"}]},{"block_type":"text","content":". This section will address the functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package that are related to file input and output."}]},{"block_type":"element","block":"k6pz2iwg","search_text":"The first part of str.go is shown in the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"str.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iwh","search_text":"package main import ( \"fmt\" \"io\" \"os\" \"strings\" ) ","text_count":50,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"os\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2iwi","search_text":"The second code segment of str.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"str.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iwj","search_text":"func main() { r := strings.NewReader(\"test\") fmt.Println(\"r length:\", r.Len()) ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n \n    r := strings.NewReader(\"test\") \n    fmt.Println(\"r length:\", r.Len())"}]}]},{"block_type":"element","block":"k6pz2iwk","search_text":"The strings.NewReader() function creates a read-only Reader from a string. The strings.Reader object implements the io.Reader , io.ReaderAt , io.Seeker , io.WriterTo , io.ByteScanner , and io.RuneScanner interfaces.","text_count":215,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.NewReader()"}]},{"block_type":"text","content":"function creates a read-only"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Reader"}]},{"block_type":"text","content":"from a string. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Reader"}]},{"block_type":"text","content":"object implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.ReaderAt"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Seeker"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.WriterTo"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.ByteScanner"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.RuneScanner"}]},{"block_type":"text","content":"interfaces."}]},{"block_type":"element","block":"k6pz2iwl","search_text":"The third part of str.go follows next:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"str.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iwm","search_text":"b := make([]byte, 1) for { n, err := r.Read(b) if err == io.EOF { break } if err != nil { fmt.Println(err) continue } fmt.Printf(\"Read %s Bytes: %d\\n\", b, n) } ","text_count":160,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"b := make([]byte, 1) \n    for { \n        n, err := r.Read(b) \n        if err == io.EOF { \n            break \n        } \n \n        if err != nil { \n            fmt.Println(err) \n            continue \n        } \n        fmt.Printf(\"Read %s Bytes: %d\\n\", b, n) \n    }"}]}]},{"block_type":"element","block":"k6pz2iwn","search_text":"Here you can see how you to use strings.Reader as an io.Reader interface in order to read a string byte by byte using the Read() function.","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see how you to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.Reader"}]},{"block_type":"text","content":"as an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"interface in order to read a string byte by byte using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Read()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2iwo","search_text":"The last code portion of str.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"str.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iwp","search_text":"s := strings.NewReader(\"This is an error!\\n\") fmt.Println(\"r length:\", s.Len()) n, err := s.WriteTo(os.Stderr) if err != nil { fmt.Println(err) return } fmt.Printf(\"Wrote %d bytes to os.Stderr\\n\", n) } ","text_count":202,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"s := strings.NewReader(\"This is an error!\\n\") \n    fmt.Println(\"r length:\", s.Len()) \n    n, err := s.WriteTo(os.Stderr) \n \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    fmt.Printf(\"Wrote %d bytes to os.Stderr\\n\", n) \n}"}]}]},{"block_type":"element","block":"k6pz2iwq","search_text":"In this code segment, you can see how you can write to standard error with the help of the strings package.","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code segment, you can see how you can write to standard error with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2iwr","search_text":"Executing str.go will generate the following output:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"str.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2iws","search_text":"$ go run str.go r length: 4 Read t Bytes: 1 Read e Bytes: 1 Read s Bytes: 1 Read t Bytes: 1 r length: 18 This is an error! Wrote 18 bytes to os.Stderr $ go run str.go 2>/dev/null r length: 4 Read t Bytes: 1 Read e Bytes: 1 Read s Bytes: 1 Read t Bytes: 1 r length: 18 Wrote 18 bytes to os.Stderr","text_count":295,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run str.go\nr length: 4\nRead t Bytes: 1\nRead e Bytes: 1\nRead s Bytes: 1\nRead t Bytes: 1\nr length: 18\nThis is an error!\nWrote 18 bytes to os.Stderr\n$ go run str.go 2&gt;/dev/null\nr length: 4\nRead t Bytes: 1\nRead e Bytes: 1\nRead s Bytes: 1\nRead t Bytes: 1\nr length: 18\nWrote 18 bytes to os.Stderr"}]}]},{"block_type":"element","block":"k6pz2iwt","search_text":"About the bytes package","text_count":23,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About the bytes package"}]},{"block_type":"element","block":"k6pz2iwu","search_text":"The bytes standard Go package contains functions for working with byte slices in the same way that the strings standard Go package helps you work with strings . The name of the Go source code file is bytes.go , and it will be presented in three code portions.","text_count":259,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes"}]},{"block_type":"text","content":"standard Go package contains functions for working with"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slices"}]},{"block_type":"text","content":"in the same way that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":"standard Go package helps you work with"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"strings"}]},{"block_type":"text","content":". The name of the Go source code file is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.go"}]},{"block_type":"text","content":", and it will be presented in three code portions."}]},{"block_type":"element","block":"k6pz2iwv","search_text":"Note This section is not included in my Go Systems Programming , Packt Publising , 2017 book. ","text_count":94,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section is not included in my"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Packt Publising"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"2017"}]},{"block_type":"text","content":"book."}]}]},{"block_type":"element","block":"k6pz2iww","search_text":"The first part of bytes.go follows next:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iwx","search_text":"package main import ( \"bytes\" \"fmt\" \"io\" \"os\" ) ","text_count":48,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bytes\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2iwy","search_text":"The second code portion of bytes.go contains the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iwz","search_text":"func main() { var buffer bytes.Buffer buffer.Write([]byte(\"This is\")) fmt.Fprintf(&buffer, \" a string!\\n\") buffer.WriteTo(os.Stdout) buffer.WriteTo(os.Stdout) ","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var buffer bytes.Buffer \n    buffer.Write([]byte(\"This is\")) \n    fmt.Fprintf(&amp;buffer, \" a string!\\n\") \n    buffer.WriteTo(os.Stdout) \n    buffer.WriteTo(os.Stdout)"}]}]},{"block_type":"element","block":"k6pz2ix0","search_text":"First, you create a new bytes.Buffer variable, and you put data into it using buffer.Write() and fmt.Fprintf() . Then you call buffer.WriteTo() two times.","text_count":154,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, you create a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.Buffer"}]},{"block_type":"text","content":"variable, and you put data into it using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer.Write()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Fprintf()"}]},{"block_type":"text","content":". Then you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer.WriteTo()"}]},{"block_type":"text","content":"two times."}]},{"block_type":"element","block":"k6pz2ix1","search_text":"The first buffer.WriteTo() call will print the contents of the buffer variable. However, the second call to buffer.WriteTo() has nothing to print because the buffer variable will be empty after the first buffer.WriteTo() call.","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer.WriteTo()"}]},{"block_type":"text","content":"call will print the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer"}]},{"block_type":"text","content":"variable. However, the second call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer.WriteTo()"}]},{"block_type":"text","content":"has nothing to print because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer"}]},{"block_type":"text","content":"variable will be empty after the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer.WriteTo()"}]},{"block_type":"text","content":"call."}]},{"block_type":"element","block":"k6pz2ix2","search_text":"The last part of bytes.go is as follows:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ix3","search_text":"buffer.Reset() buffer.Write([]byte(\"Mastering Go!\")) r := bytes.NewReader([]byte(buffer.String())) fmt.Println(buffer.String()) for { b := make([]byte, 3) n, err := r.Read(b) if err == io.EOF { break } if err != nil { fmt.Println(err) continue } fmt.Printf(\"Read %s Bytes: %d\\n\", b, n) } } ","text_count":290,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"buffer.Reset() \n    buffer.Write([]byte(\"Mastering Go!\")) \n    r := bytes.NewReader([]byte(buffer.String())) \n    fmt.Println(buffer.String()) \n    for { \n        b := make([]byte, 3) \n            n, err := r.Read(b) \n            if err == io.EOF { \n                break \n            } \n \n            if err != nil { \n                fmt.Println(err) \n                continue \n            } \n            fmt.Printf(\"Read %s Bytes: %d\\n\", b, n) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ix4","search_text":"The Reset() method resets the buffer variable, and the Write() method puts some data into it again. Then you create a new reader using bytes.NewReader() , and after that you use the Read() method of the io.Reader interface to read the data found in the buffer variable.","text_count":269,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Reset()"}]},{"block_type":"text","content":"method resets the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer"}]},{"block_type":"text","content":"variable, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write()"}]},{"block_type":"text","content":"method puts some data into it again. Then you create a new reader using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.NewReader()"}]},{"block_type":"text","content":", and after that you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Read()"}]},{"block_type":"text","content":"method of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"interface to read the data found in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"buffer"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2ix5","search_text":"Executing bytes.go will create the following type of output:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ix6","search_text":"$ go run bytes.go This is a string! Mastering Go! Read Mas Bytes: 3 Read ter Bytes: 3 Read ing Bytes: 3 Read Go Bytes: 3 Read ! Bytes: 1 ","text_count":137,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run bytes.go\nThis is a string!\nMastering Go!\nRead Mas Bytes: 3\nRead ter Bytes: 3\nRead ing Bytes: 3\nRead  Go Bytes: 3\nRead ! Bytes: 1"}]}]},{"block_type":"element","block":"k6pz2ix7","search_text":"File permissions","text_count":16,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"File permissions"}]},{"block_type":"element","block":"k6pz2ix8","search_text":"A popular topic in Unix systems programming is Unix file permissions. In this section, you will learn how to print the permissions of any file, provided that you have adequate Unix permission to do so! The name of the program is permissions.go , and it will be presented in three parts.","text_count":286,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A popular topic in Unix systems programming is Unix file permissions. In this section, you will learn how to print the permissions of any file, provided that you have adequate Unix permission to do so! The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"permissions.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2ix9","search_text":"The first part of permissions.go contains the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"permissions.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ixa","search_text":"package main import ( \"fmt\" \"os\" ) ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2ixb","search_text":"The second code segment of permissions.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"permissions.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2ixc","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Printf(\"usage: permissions filename\\n\") return } ","text_count":113,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Printf(\"usage: permissions filename\\n\") \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2ixd","search_text":"The last part of this utility follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of this utility follows next:"}]},{"block_type":"element","block":"k6pz2ixe","search_text":"filename := arguments[1] info, _ := os.Stat(filename) mode := info.Mode() fmt.Println(filename, \"mode is\", mode.String()[1:10]) } ","text_count":130,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"filename := arguments[1] \n    info, _ := os.Stat(filename) \n    mode := info.Mode() \n    fmt.Println(filename, \"mode is\", mode.String()[1:10]) \n}"}]}]},{"block_type":"element","block":"k6pz2ixf","search_text":"The call to os.Stat(filename) returns a big structure with lots of data. As we are only interested in the permissions of the file, we will call the Mode() method and print its output. Actually, we are printing a part of the output denoted by mode.String()[1:10] because this is where the data that interests us is found.","text_count":320,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stat(filename)"}]},{"block_type":"text","content":"returns a big structure with lots of data. As we are only interested in the permissions of the file, we will call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Mode()"}]},{"block_type":"text","content":"method and print its output. Actually, we are printing a part of the output denoted by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mode.String()[1:10]"}]},{"block_type":"text","content":"because this is where the data that interests us is found."}]},{"block_type":"element","block":"k6pz2ixg","search_text":"Executing permissions.go will create the following type of output:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"permissions.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2ixh","search_text":"$ go run permissions.go /tmp/adobegc.log /tmp/adobegc.log mode is rw-rw-rw- $ go run permissions.go /dev/random /dev/random mode is crw-rw-rw","text_count":141,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run permissions.go /tmp/adobegc.log\n/tmp/adobegc.log mode is rw-rw-rw-\n$ go run permissions.go /dev/random\n/dev/random mode is crw-rw-rw"}]}]},{"block_type":"element","block":"k6pz2ixi","search_text":"The output of the ls(1) utility verifies the correctness of permissions.go :","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ls(1)"}]},{"block_type":"text","content":"utility verifies the correctness of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"permissions.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ixj","search_text":"$ ls -l /dev/random /tmp/adobegc.log crw-rw-rw- 1 root wheel 14, 0 Jan 8 20:24 /dev/random -rw-rw-rw- 1 root wheel 583454 Jan 16 19:12 /tmp/adobegc.log","text_count":151,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ls -l /dev/random /tmp/adobegc.log\ncrw-rw-rw-  1 root  wheel   14,   0 Jan  8 20:24 /dev/random\n-rw-rw-rw-  1 root  wheel    583454 Jan 16 19:12 /tmp/adobegc.log"}]}]},{"block_type":"element","block":"k6pz2ixk","search_text":"Handling Unix signals","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Handling Unix signals"}]},{"block_type":"element","block":"k6pz2ixl","search_text":"Go provides the os/signal package to programmers to help them work with signals. This section will show you how to use it for Unix signal handling.","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go provides the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os/signal"}]},{"block_type":"text","content":"package to programmers to help them work with signals. This section will show you how to use it for Unix signal handling."}]},{"block_type":"element","block":"k6pz2ixm","search_text":"First let's present some useful information about Unix signals. Have you ever pressed Ctrl + C in order to stop a running program? If your answer is Yes , then you are already familiar with signals because Ctrl + C sends the SIGINT signal to a program. Strictly speaking, Unix Signals are software interrupts that can be accessed either by name or by number, and they offer a way to handle asynchronous events on a Unix system. There are two ways to send a signal: by name or by number. Generally speaking, it is safer to send a signal by name because you are is less likely to send the wrong signal accidentally.","text_count":613,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First let's present some useful information about Unix signals. Have you ever pressed"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Ctrl"}]},{"block_type":"text","content":"+"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"in order to stop a running program? If your answer is"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Yes"}]},{"block_type":"text","content":", then you are already familiar with signals because"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Ctrl"}]},{"block_type":"text","content":"+"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"sends the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"SIGINT signal"}]},{"block_type":"text","content":"to a program. Strictly speaking, Unix"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Signals"}]},{"block_type":"text","content":"are software interrupts that can be accessed either by name or by number, and they offer a way to handle asynchronous events on a Unix system. There are two ways to send a signal: by name or by number. Generally speaking, it is safer to send a signal by name because you are is less likely to send the wrong signal accidentally."}]},{"block_type":"element","block":"k6pz2ixn","search_text":"A program cannot handle all of the available signals: some signals cannot be caught, nor can they be ignored. The SIGKILL and SIGSTOP signals cannot be caught, blocked, or ignored. The reason for this is that they provide the kernel and the root user a way of stopping any process they want. The SIGKILL signal, which is also known by the number 9, is usually called in extreme conditions where you need to act fast. Thus, it is the only signal that is usually called by number, simply because it is quicker to do so.","text_count":517,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A program cannot handle all of the available signals: some signals cannot be caught, nor can they be ignored. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGKILL"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGSTOP"}]},{"block_type":"text","content":"signals cannot be caught, blocked, or ignored. The reason for this is that they provide the kernel and the root user a way of stopping any process they want. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGKILL"}]},{"block_type":"text","content":"signal, which is also known by the number 9, is usually called in extreme conditions where you need to act fast. Thus, it is the only signal that is usually called by number, simply because it is quicker to do so."}]},{"block_type":"element","block":"k6pz2ixo","search_text":"Note signal.SIGINFO is not available on Linux machines, which means that if you find it in a Go program that you want to run on a Linux machine, you need to replace it with another signal, or your Go program will not be able to compile and execute. ","text_count":249,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"signal.SIGINFO"}]},{"block_type":"text","content":"is not available on Linux machines, which means that if you find it in a Go program that you want to run on a Linux machine, you need to replace it with another signal, or your Go program will not be able to compile and execute."}]}]},{"block_type":"element","block":"k6pz2ixp","search_text":"The most common way to send a signal to a process is by using the kill(1) utility. By default, kill(1) sends the SIGTERM signal. If you want to find all of the supported signals on your Unix machine, you should execute the kill -l command.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The most common way to send a signal to a process is by using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kill(1)"}]},{"block_type":"text","content":"utility. By default,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kill(1)"}]},{"block_type":"text","content":"sends the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGTERM"}]},{"block_type":"text","content":"signal. If you want to find all of the supported signals on your Unix machine, you should execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kill -l"}]},{"block_type":"text","content":"command."}]},{"block_type":"element","block":"k6pz2ixq","search_text":"If you try to send a signal to a process without having the required permissions, kill(1) will not do the job and you will get an error message similar to the following:","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to send a signal to a process without having the required permissions,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kill(1)"}]},{"block_type":"text","content":"will not do the job and you will get an error message similar to the following:"}]},{"block_type":"element","block":"k6pz2ixr","search_text":"$ kill 1210 -bash: kill: (1210) - Operation not permitted","text_count":57,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ kill 1210\n-bash: kill: (1210) - Operation not permitted"}]}]},{"block_type":"element","block":"k6pz2ixs","search_text":"Handling two signals","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Handling two signals"}]},{"block_type":"element","block":"k6pz2ixt","search_text":"In this subsection, you will learn how to handle two signals in a Go program using the code found in handleTwo.go , which will be presented in four parts. The signals that will be handled by handleTwo.go are SIGINFO and SIGINT , which in Golang are named syscall.SIGINFO and os.Interrupt , respectively.","text_count":303,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to handle two signals in a Go program using the code found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":", which will be presented in four parts. The signals that will be handled by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGINFO"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGINT"}]},{"block_type":"text","content":", which in Golang are named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SIGINFO"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Interrupt"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2ixu","search_text":"Note If you look at the documentation of the os package, you will find that the only two signals that are guaranteed to be present on all systems are syscall.SIGKILL and syscall.SIGINT , which in Go are also defined as os.Kill and os.Interrupt , respectively. ","text_count":260,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you look at the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":"package, you will find that the only two signals that are guaranteed to be present on all systems are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SIGKILL"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SIGINT"}]},{"block_type":"text","content":", which in Go are also defined as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Kill"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Interrupt"}]},{"block_type":"text","content":", respectively."}]}]},{"block_type":"element","block":"k6pz2ixv","search_text":"The first part of handleTwo.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ixw","search_text":"package main import ( \"fmt\" \"os\" \"os/signal\" \"syscall\" \"time\" ) ","text_count":64,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"os/signal\" \n    \"syscall\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2ixx","search_text":"The second part of the handleTwo.go program follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"program follows next:"}]},{"block_type":"element","block":"k6pz2ixy","search_text":"func handleSignal(signal os.Signal) { fmt.Println(\"handleSignal() Caught:\", signal) } ","text_count":86,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func handleSignal(signal os.Signal) { \n    fmt.Println(\"handleSignal() Caught:\", signal) \n}"}]}]},{"block_type":"element","block":"k6pz2ixz","search_text":"The handleSignal() function will be used for handling the syscall.SIGINFO signal, while the os.Interrupt signal will be handled inline.","text_count":135,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleSignal()"}]},{"block_type":"text","content":"function will be used for handling the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SIGINFO"}]},{"block_type":"text","content":"signal, while the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Interrupt"}]},{"block_type":"text","content":"signal will be handled inline."}]},{"block_type":"element","block":"k6pz2iy0","search_text":"The third code segment of handleTwo.go is shown in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iy1","search_text":"func main() { sigs := make(chan os.Signal, 1) signal.Notify(sigs, os.Interrupt, syscall.SIGINFO) go func() { for { sig := <-sigs switch sig { case os.Interrupt: fmt.Println(\"Caught:\", sig) case syscall.SIGINFO: handleSignal(sig) return } } }() ","text_count":244,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    sigs := make(chan os.Signal, 1) \n    signal.Notify(sigs, os.Interrupt, syscall.SIGINFO) \n    go func() { \n        for { \n            sig := &lt;-sigs \n                switch sig { \n                case os.Interrupt: \n                    fmt.Println(\"Caught:\", sig) \n                case syscall.SIGINFO: \n                    handleSignal(sig) \n                    return \n                } \n        } \n    }()"}]}]},{"block_type":"element","block":"k6pz2iy2","search_text":"This technique works as follows: first you define a channel named sigs that helps you pass data around. Then you call signal.Notify() in order to state the signals that interest you. Next, you implement an anonymous function that runs as a goroutine in order to act when you receive any one of the signals you care about. You will have to wait for Chapter 9, Go Concurrency - Goroutines, Channels, and Pipelines, to learn more about goroutines and channels.","text_count":457,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This technique works as follows: first you define a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"channel"}]},{"block_type":"text","content":"named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sigs"}]},{"block_type":"text","content":"that helps you pass data around. Then you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"signal.Notify()"}]},{"block_type":"text","content":"in order to state the signals that interest you. Next, you implement an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"anonymous function"}]},{"block_type":"text","content":"that runs as a goroutine in order to act when you receive any one of the signals you care about. You will have to wait for Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency -&nbsp;Goroutines, Channels, and Pipelines,&nbsp;"}]},{"block_type":"text","content":"to learn more about goroutines and channels."}]},{"block_type":"element","block":"k6pz2iy3","search_text":"The last portion of the handleTwo.go program is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last portion of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2iy4","search_text":"for { fmt.Printf(\".\") time.Sleep(20 * time.Second) } } ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        fmt.Printf(\".\") \n        time.Sleep(20 * time.Second) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2iy5","search_text":"The time.Sleep() call is used to prohibit the program from terminating, as it has no real work to do. In an actual application, there would be no need to use similar code.","text_count":171,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call is used to prohibit the program from terminating, as it has no real work to do. In an actual application, there would be no need to use similar code."}]},{"block_type":"element","block":"k6pz2iy6","search_text":"As we need the process ID of a program in order to send signals to it using the kill(1) utility, we will first compile handleTwo.go and run the executable file instead of using go run handleTwo.go . Working with handleTwo will generate the following type of output:","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As we need the process ID of a program in order to send signals to it using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kill(1)"}]},{"block_type":"text","content":"utility, we will first compile"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"and run the executable file instead of using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":". Working with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2iy7","search_text":"$ go build handleTwo.go $ ls -l handleTwo -rwxr-xr-x 1 mtsouk staff 2005200 Jan 18 07:49 handleTwo $ ./handleTwo .^CCaught: interrupt .Caught: interrupt handleSignal() Caught: information request .Killed: 9","text_count":206,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build handleTwo.go\n$ ls -l handleTwo\n-rwxr-xr-x  1 mtsouk  staff  2005200 Jan 18 07:49 handleTwo\n$ ./handleTwo\n.^CCaught: interrupt\n.Caught: interrupt\nhandleSignal() Caught: information request\n.Killed: 9"}]}]},{"block_type":"element","block":"k6pz2iy8","search_text":"Note that you will need an additional terminal in order to interact with handleTwo.go and obtain the preceding output. You will execute the following commands in that Terminal:","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that you will need an additional terminal in order to interact with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"and obtain the preceding output. You will execute the following commands in that Terminal:"}]},{"block_type":"element","block":"k6pz2iy9","search_text":"$ ps ax | grep ./handleTwo | grep -v grep 47988 s003 S+ 0:00.00 ./handleTwo $ kill -s INT 47988 $ kill -s INFO 47988 $ kill -s USR1 47988 $ kill -9 47988","text_count":153,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ps ax | grep ./handleTwo | grep -v grep\n47988 s003  S+     0:00.00 ./handleTwo\n$ kill -s INT 47988\n$ kill -s INFO 47988\n$ kill -s USR1 47988\n$ kill -9 47988"}]}]},{"block_type":"element","block":"k6pz2iya","search_text":"The first command is used for finding the process ID of the handleTwo executable, while the remaining commands are used for sending the desired signals to that process. The SIGUSR1 signal is ignored, and it does not appear in the output.","text_count":237,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first command is used for finding the process ID of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo"}]},{"block_type":"text","content":"executable, while the remaining commands are used for sending the desired signals to that process. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGUSR1"}]},{"block_type":"text","content":"signal is ignored, and it does not appear in the output."}]},{"block_type":"element","block":"k6pz2iyb","search_text":"The problem with handleTwo.go is that if it gets a signal which is not programmed to handle, it will ignore it. Thus, in the next section you will see a technique that uses a relatively different approach in order to handle signals in a more efficient way.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The problem with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleTwo.go"}]},{"block_type":"text","content":"is that if it gets a signal which is not programmed to handle, it will ignore it. Thus, in the next section you will see a technique that uses a relatively different approach in order to handle signals in a more efficient way."}]},{"block_type":"element","block":"k6pz2iyc","search_text":"Handling all signals","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Handling all signals"}]},{"block_type":"element","block":"k6pz2iyd","search_text":"In this subsection, you will learn how to handle all signals but respond only to the ones that really interest you. This is a much better and safer technique than the one presented in the previous subsection. The technique will be illustrated using the Go code of handleAll.go , which will be presented in four parts.","text_count":317,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to handle all signals but respond only to the ones that really interest you. This is a much better and safer technique than the one presented in the previous subsection. The technique will be illustrated using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":", which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2iye","search_text":"The first part of handleAll.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iyf","search_text":"package main import ( \"fmt\" \"os\" \"os/signal\" \"syscall\" \"time\" ) func handle(signal os.Signal) { fmt.Println(\"Received:\", signal) } ","text_count":131,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"os/signal\" \n    \"syscall\" \n    \"time\" \n) \n \nfunc handle(signal os.Signal) { \n    fmt.Println(\"Received:\", signal) \n}"}]}]},{"block_type":"element","block":"k6pz2iyg","search_text":"The second code segment from handleAll.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2iyh","search_text":"func main() { sigs := make(chan os.Signal, 1) signal.Notify(sigs) ","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    sigs := make(chan os.Signal, 1) \n    signal.Notify(sigs)"}]}]},{"block_type":"element","block":"k6pz2iyi","search_text":"So, all the magic happens due to the signal.Notify(sigs) statement. As no signals are specified, all incoming signals will be handled!","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, all the magic happens due to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"signal.Notify(sigs)"}]},{"block_type":"text","content":"statement. As no signals are specified, all incoming signals will be handled!"}]},{"block_type":"element","block":"k6pz2iyj","search_text":"Note You are allowed to call signal.Notify() multiple times in the same program using different channels and the same signals. In that case, each relevant channel will receive a copy of the signals which it was programmed to handle! ","text_count":233,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You are allowed to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"signal.Notify()"}]},{"block_type":"text","content":"multiple times in the same program using different channels and the same signals. In that case, each relevant channel will receive a copy of the signals which it was programmed to handle!"}]}]},{"block_type":"element","block":"k6pz2iyk","search_text":"The third code portion of the handleAll.go utility follows next:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":"utility follows next:"}]},{"block_type":"element","block":"k6pz2iyl","search_text":"go func() { for { sig := <-sigs switch sig { case os.Interrupt: handle(sig) case syscall.SIGTERM: handle(sig) os.Exit(0) case syscall.SIGUSR2: fmt.Println(\"Handling syscall.SIGUSR2!\") default:","text_count":192,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go func() { \n        for { \n            sig := &lt;-sigs \n            switch sig { \n            case os.Interrupt: \n                handle(sig) \n            case syscall.SIGTERM: \n                handle(sig) \n                os.Exit(0) \n            case syscall.SIGUSR2: \n                fmt.Println(\"Handling syscall.SIGUSR2!\") \n            default:"}]}]},{"block_type":"element","block":"k6pz2iym","search_text":"fmt.Println(\"Ignoring:\", sig) } } }() ","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Ignoring:\", sig) \n        } \n    } \n}()"}]}]},{"block_type":"element","block":"k6pz2iyn","search_text":"It is very convenient to use one of the signals in order to exit your program. This gives you the opportunity to do some housekeeping in your program when needed. In this case, the syscall.SIGTERM signal is used for that purpose. This does not prevent you from using SIGKILL to kill a program, though!","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is very convenient to use one of the signals in order to exit your program. This gives you the opportunity to do some housekeeping in your program when needed. In this case, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SIGTERM"}]},{"block_type":"text","content":"signal is used for that purpose. This does not prevent you from using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SIGKILL"}]},{"block_type":"text","content":"to kill a program, though!"}]},{"block_type":"element","block":"k6pz2iyo","search_text":"The remaining Go code for handleAll.go follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":"follows:"}]},{"block_type":"element","block":"k6pz2iyp","search_text":"for { fmt.Printf(\".\") time.Sleep(30 * time.Second) } } ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        fmt.Printf(\".\") \n        time.Sleep(30 * time.Second) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2iyq","search_text":"You still need to call time.Sleep() to prevent your program from terminating immediately.","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You still need to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"to prevent your program from terminating immediately."}]},{"block_type":"element","block":"k6pz2iyr","search_text":"Once again, it would be better to build an executable file for handleAll.go using the go build tool. Executing handleAll and interacting with it from another terminal will generate the following type of output:","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, it would be better to build an executable file for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll.go"}]},{"block_type":"text","content":"using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"tool. Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleAll"}]},{"block_type":"text","content":"and interacting with it from another terminal will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2iys","search_text":"$ go build handleAll.go $ ls -l handleAll -rwxr-xr-x 1 mtsouk staff 2005216 Jan 18 08:25 handleAll $ ./handleAll .Ignoring: hangup Handling syscall.SIGUSR2! Ignoring: user defined signal 1 Received: interrupt ^CReceived: interrupt Received: terminated","text_count":251,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go build handleAll.go\n$ ls -l handleAll\n-rwxr-xr-x  1 mtsouk  staff  2005216 Jan 18 08:25 handleAll\n$ ./handleAll\n.Ignoring: hangup\nHandling syscall.SIGUSR2!\nIgnoring: user defined signal 1\nReceived: interrupt\n^CReceived: interrupt\nReceived: terminated"}]}]},{"block_type":"element","block":"k6pz2iyt","search_text":"The commands issued from the second terminal are as follows:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The commands issued from the second terminal are as follows:"}]},{"block_type":"element","block":"k6pz2iyu","search_text":"$ ps ax | grep ./handleAll | grep -v grep 49902 s003 S+ 0:00.00 ./handleAll $ kill -s HUP 49902 $ kill -s USR2 49902 $ kill -s USR1 49902 $ kill -s INT 49902 $ kill -s TERM 49902","text_count":178,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ps ax | grep ./handleAll | grep -v grep\n49902 s003  S+     0:00.00 ./handleAll\n$ kill -s HUP 49902\n$ kill -s USR2 49902\n$ kill -s USR1 49902\n$ kill -s INT 49902\n$ kill -s TERM 49902"}]}]},{"block_type":"element","block":"k6pz2iyv","search_text":"Programming Unix pipes in Go","text_count":28,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Programming Unix pipes in Go"}]},{"block_type":"element","block":"k6pz2iyw","search_text":"According to the Unix philosophy, Unix command-line utilities should do one job and perform that job well! In practice, this means that instead of developing huge utilities that do lots of jobs, you should develop multiple smaller programs, which when combined, should perform the desired job. The most common way for two or more Unix command-line utilities to communicate is by using pipes. In a Unix pipe , the output of a command-line utility becomes the input of another command-line utility. This process may involve more than two programs! The symbol that is used for Unix pipes is the | character.","text_count":604,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"According to the Unix philosophy, Unix command-line utilities should do one job and perform that job well! In practice, this means that instead of developing huge utilities that do lots of jobs, you should develop multiple smaller programs, which when combined, should perform the desired job. The most common way for two or more Unix command-line utilities to communicate is by using pipes. In a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unix pipe"}]},{"block_type":"text","content":", the output of a command-line utility becomes the input of another command-line utility. This process may involve more than two programs! The symbol that is used for Unix pipes is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"|"}]},{"block_type":"text","content":"character."}]},{"block_type":"element","block":"k6pz2iyx","search_text":"Pipes have two serious limitations: first, they usually communicate in one direction, and second, they can only be used between processes that have a common ancestor. The general idea behind the implementation of Unix pipes is that if you do not have a file to process, you should wait to get your input from standard input. Similarly, if you are not told to save your output to a file, you should write your output to standard output, either for the user to see it or for another program to process it.","text_count":503,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Pipes have two serious limitations: first, they usually communicate in one direction, and second, they can only be used between processes that have a common ancestor. The general idea behind the implementation of Unix pipes is that if you do not have a file to process, you should wait to get your input from standard input. Similarly, if you are not told to save your output to a file, you should write your output to standard output, either for the user to see it or for another program to process it."}]},{"block_type":"element","block":"k6pz2iyy","search_text":"In Chapter 1, Go and the Operating System, you learned how to read from standard input and how to write to standard output. If you have doubts about these two operations, it would be a good time to review the Go code of stdOUT.go and stdIN.go .","text_count":244,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 1,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go and the Operating System,"}]},{"block_type":"text","content":"&nbsp;you learned how to read from standard input and how to write to standard output. If you have doubts about these two operations, it would be a good time to review the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdOUT.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"stdIN.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2iyz","search_text":"Implementing the cat(1) utility in Go","text_count":37,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Implementing the cat(1) utility in Go"}]},{"block_type":"element","block":"k6pz2iz0","search_text":"In this section, you will see a Go version of the cat(1) utility. You will most likely be surprised by the length of the program!","text_count":129,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see a Go version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat(1)"}]},{"block_type":"text","content":"utility. You will most likely be surprised by the length of the program!"}]},{"block_type":"element","block":"k6pz2iz1","search_text":"The source code of cat.go will be presented in three parts. The first part of cat.go follows next:","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"will be presented in three parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2iz2","search_text":"package main import ( \"bufio\" \"fmt\" \"io\" \"os\" ) ","text_count":48,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"io\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2iz3","search_text":"The second code segment of cat.go contains the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2iz4","search_text":"func printFile(filename string) error { f, err := os.Open(filename) if err != nil { return err } defer f.Close() scanner := bufio.NewScanner(f) for scanner.Scan() { io.WriteString(os.Stdout, scanner.Text()) io.WriteString(os.Stdout, \"\\n\") } return nil } ","text_count":254,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func printFile(filename string) error { \n    f, err := os.Open(filename) \n    if err != nil { \n        return err \n    } \n    defer f.Close() \n    scanner := bufio.NewScanner(f) \n    for scanner.Scan() { \n        io.WriteString(os.Stdout, scanner.Text()) \n        io.WriteString(os.Stdout, \"\\n\") \n    } \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2iz5","search_text":"In this part, you can see the implementation of a function whose purpose is to print the contents of a file in the standard output.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you can see the implementation of a function whose purpose is to print the contents of a file in the standard output."}]},{"block_type":"element","block":"k6pz2iz6","search_text":"The last part of cat.go is as follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2iz7","search_text":"func main() { filename := \"\" arguments := os.Args if len(arguments) == 1 { io.Copy(os.Stdout, os.Stdin) return } for i := 1; i < len(arguments); i++ { filename = arguments[i] err := printFile(filename) if err != nil { fmt.Println(err) } } } ","text_count":241,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    filename := \"\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        io.Copy(os.Stdout, os.Stdin) \n        return \n    } \n \n    for i := 1; i &lt; len(arguments); i++ { \n        filename = arguments[i] \n        err := printFile(filename) \n        if err != nil { \n            fmt.Println(err) \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2iz8","search_text":"The preceding code contains all of the magic of cat.go , because this is where you define how the program will behave. First of all, if you execute cat.go without any command-line arguments, then the program will just copy standard input to standard output as defined by the io.Copy(os.Stdout, os.Stdin) statement. However, if there are command-line arguments, then the program will process them all in the same order that they were given.","text_count":439,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code contains all of the magic of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":", because this is where you define how the program will behave. First of all, if you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"without any command-line arguments, then the program will just copy standard input to standard output as defined by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Copy(os.Stdout, os.Stdin)"}]},{"block_type":"text","content":"statement. However, if there are command-line arguments, then the program will process them all in the same order that they were given."}]},{"block_type":"element","block":"k6pz2iz9","search_text":"Executing cat.go will create the following type of output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2iza","search_text":"$ go run cat.go Mastering Go! Mastering Go! 1 2 3 4 1 2 3 4","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cat.go\nMastering Go!\nMastering Go!\n1 2 3 4\n1 2 3 4"}]}]},{"block_type":"element","block":"k6pz2izb","search_text":"However, things get really interesting if you execute cat.go using Unix pipes:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, things get really interesting if you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"using Unix pipes:"}]},{"block_type":"element","block":"k6pz2izc","search_text":"$ go run cat.go /tmp/1.log /tmp/2.log | wc 2367 44464 279292 $ go run cat.go /tmp/1.log /tmp/2.log | go run cat.go | wc 2367 44464 279292","text_count":137,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cat.go /tmp/1.log /tmp/2.log | wc\n    2367   44464  279292\n$ go run cat.go /tmp/1.log /tmp/2.log | go run cat.go | wc\n    2367   44464  279292"}]}]},{"block_type":"element","block":"k6pz2izd","search_text":"cat.go is also able to print multiple files on your screen:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"is also able to print multiple files on your screen:"}]},{"block_type":"element","block":"k6pz2ize","search_text":"$ go run cat.go 1.txt 1 1.txt 2367 44464 279292 2367 44464 279292 open 1: no such file or directory 2367 44464 279292 2367 44464 279292","text_count":135,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cat.go 1.txt 1 1.txt\n    2367   44464  279292\n    2367   44464  279292\nopen 1: no such file or directory\n    2367   44464  279292\n    2367   44464  279292"}]}]},{"block_type":"element","block":"k6pz2izf","search_text":"Please note that if you try to execute cat.go as go run cat.go cat.go and expect that you will get the contents of cat.go on your screen, the process will fail and you will get the following error message instead:","text_count":213,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please note that if you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run cat.go cat.go"}]},{"block_type":"text","content":"and expect that you will get the contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"on your screen, the process will fail and you will get the following error message instead:"}]},{"block_type":"element","block":"k6pz2izg","search_text":"package main: case-insensitive file name collision: \"cat.go\" and \"cat.go\"","text_count":73,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main: case-insensitive file name collision: \"cat.go\" and \"cat.go\""}]}]},{"block_type":"element","block":"k6pz2izh","search_text":"The reason for this is that Go does not understand that the second cat.go should be used as a command-line argument to the go run cat.go command. Instead go run tries to compile cat.go twice, which causes the error message. The solution to this problem is to execute go build cat.go first, and then use cat.go or any other Go source file as the argument to the generated executable file.","text_count":387,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for this is that Go does not understand that the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"should be used as a command-line argument to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run cat.go"}]},{"block_type":"text","content":"command. Instead"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"tries to compile"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"twice, which causes the error message. The solution to this problem is to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build cat.go"}]},{"block_type":"text","content":"first, and then use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"or any other Go source file as the argument to the generated executable file."}]},{"block_type":"element","block":"k6pz2izi","search_text":"Traversing directory trees","text_count":26,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Traversing directory trees"}]},{"block_type":"element","block":"k6pz2izj","search_text":"This section will present a relatively simple version of the find(1) command-line utility written in Go.","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a relatively simple version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"find(1)"}]},{"block_type":"text","content":"command-line utility written in Go."}]},{"block_type":"element","block":"k6pz2izk","search_text":"The name of the program is goFind.go , and it will be presented in four parts. The code of goFind.go will support two command-line options. The -d option prints a star character in front of paths that are directories, while the -f parameter prints a plus character in front of paths that are regular files.","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"will support two command-line options. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-d"}]},{"block_type":"text","content":"option prints a star character in front of paths that are directories, while the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-f"}]},{"block_type":"text","content":"parameter prints a plus character in front of paths that are regular files."}]},{"block_type":"element","block":"k6pz2izl","search_text":"The first code portion of goFind.go is shown in the following Go code:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2izm","search_text":"package main import ( \"flag\" \"fmt\" \"os\" \"path/filepath\" ) ","text_count":58,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"flag\" \n    \"fmt\" \n    \"os\" \n    \"path/filepath\" \n)"}]}]},{"block_type":"element","block":"k6pz2izn","search_text":"As you can see, the goFind.go program uses the flag package for efficiently dealing with its command-line parameters.","text_count":117,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"program uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package for efficiently dealing with its command-line parameters."}]},{"block_type":"element","block":"k6pz2izo","search_text":"The second part of goFind.go contains the following code:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2izp","search_text":"var minusD bool = false var minusF bool = false func walk(path string, info os.FileInfo, err error) error { fileInfo, err := os.Stat(path) if err != nil { return err } mode := fileInfo.Mode() if mode.IsRegular() && minusF { fmt.Println(\"+\", path) return nil } if mode.IsDir() && minusD { fmt.Println(\"*\", path) return nil } fmt.Println(path) return nil } ","text_count":355,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var minusD bool = false \nvar minusF bool = false \n \nfunc walk(path string, info os.FileInfo, err error) error { \n    fileInfo, err := os.Stat(path) \n    if err != nil { \n        return err \n    } \n \n    mode := fileInfo.Mode() \n    if mode.IsRegular() &amp;&amp; minusF { \n        fmt.Println(\"+\", path) \n        return nil \n    } \n \n    if mode.IsDir() &amp;&amp; minusD { \n        fmt.Println(\"*\", path) \n        return nil \n    } \n \n    fmt.Println(path) \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2izq","search_text":"As both minusD and minusF should be accessible from everywhere in the program, including the walk() function, I have decided to make both of them global variables. The IsDir() function helps you identify directories and IsRegular() helps you identify regular files.","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"minusD"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"minusF"}]},{"block_type":"text","content":"should be accessible from everywhere in the program, including the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"walk()"}]},{"block_type":"text","content":"function, I have decided to make both of them global variables. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"IsDir()"}]},{"block_type":"text","content":"function helps you identify directories and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"IsRegular()"}]},{"block_type":"text","content":"helps you identify regular files."}]},{"block_type":"element","block":"k6pz2izr","search_text":"The third code segment of goFind.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2izs","search_text":"func main() { starD := flag.Bool(\"d\", false, \"Signify directories\") plusF := flag.Bool(\"f\", false, \"Signify regular files\") flag.Parse() flags := flag.Args() Path := \".\" if len(flags) == 1 { Path = flags[0] } ","text_count":209,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    starD := flag.Bool(\"d\", false, \"Signify directories\") \n    plusF := flag.Bool(\"f\", false, \"Signify regular files\") \n    flag.Parse() \n    flags := flag.Args() \n \n    Path := \".\" \n    if len(flags) == 1 { \n        Path = flags[0] \n    }"}]}]},{"block_type":"element","block":"k6pz2izt","search_text":"The last part of goFind.go is shown in the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2izu","search_text":"minusD = *starD minusF = *plusF err := filepath.Walk(Path, walk) if err != nil { fmt.Println(err) os.Exit(1) } } ","text_count":113,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"minusD = *starD \n    minusF = *plusF \n \n    err := filepath.Walk(Path, walk) \n    if err != nil { \n        fmt.Println(err) \n        os.Exit(1) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2izv","search_text":"Executing goFind.go will create the following type of output:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2izw","search_text":"$ go run goFind.go -d -f /tmp/ * /tmp/ + /tmp/.keystone_install_lock * /tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D * /tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116 + /tmp/ExmanProcessMutex + /tmp/adobegc.log /tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk * /tmp/com.apple.launchd.h3Izgq45dz /tmp/com.apple.launchd.h3Izgq45dz/Listeners * /tmp/lilo.46843 + /tmp/swtag.log /tmp/textmate-501.sock $ go run goFind.go -f /tmp/ /tmp/ + /tmp/.keystone_install_lock /tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D /tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116 + /tmp/ExmanProcessMutex + /tmp/adobegc.log /tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk /tmp/com.apple.launchd.h3Izgq45dz /tmp/com.apple.launchd.h3Izgq45dz/Listeners /tmp/lilo.46843 + /tmp/swtag.log /tmp/textmate-501.sock $ go run goFind.go /tmp/ /tmp/ /tmp/.keystone_install_lock /tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D /tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116 /tmp/ExmanProcessMutex /tmp/adobegc.log /tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk /tmp/com.apple.launchd.h3Izgq45dz /tmp/com.apple.launchd.h3Izgq45dz/Listeners /tmp/lilo.46843 /tmp/swtag.log /tmp/textmate-501.sock ","text_count":1106,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run goFind.go -d -f /tmp/\n* /tmp/\n+ /tmp/.keystone_install_lock\n* /tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D\n* /tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116\n+ /tmp/ExmanProcessMutex\n+ /tmp/adobegc.log\n/tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk\n* /tmp/com.apple.launchd.h3Izgq45dz\n/tmp/com.apple.launchd.h3Izgq45dz/Listeners\n* /tmp/lilo.46843\n+ /tmp/swtag.log\n/tmp/textmate-501.sock\n$ go run goFind.go -f /tmp/\n/tmp/\n+ /tmp/.keystone_install_lock\n/tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D\n/tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116\n+ /tmp/ExmanProcessMutex\n+ /tmp/adobegc.log\n/tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk\n/tmp/com.apple.launchd.h3Izgq45dz\n/tmp/com.apple.launchd.h3Izgq45dz/Listeners\n/tmp/lilo.46843\n+ /tmp/swtag.log\n/tmp/textmate-501.sock\n$ go run goFind.go /tmp/\n/tmp/\n/tmp/.keystone_install_lock\n/tmp/5580C65A-E7E2-4B27-AD91-506F85545E1D\n/tmp/569A57CB-8FD3-4879-A6A3-B86116CB0116\n/tmp/ExmanProcessMutex\n/tmp/adobegc.log\n/tmp/com.adobe.AdobeIPCBroker.ctrl-mtsouk\n/tmp/com.apple.launchd.h3Izgq45dz\n/tmp/com.apple.launchd.h3Izgq45dz/Listeners\n/tmp/lilo.46843\n/tmp/swtag.log\n/tmp/textmate-501.sock"}]}]},{"block_type":"element","block":"k6pz2izx","search_text":"The output of goFind.go contains every kind of file that can be found under the specified root directory, including sockets and symbolic links. If you make the necessary changes to the walk() function, you can tell goFind.go to print only the information that really interests you. This is left as an exercise for you to do it on your own.","text_count":339,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"contains every kind of file that can be found under the specified root directory, including sockets and symbolic links. If you make the necessary changes to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"walk()"}]},{"block_type":"text","content":"function, you can tell"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"to print only the information that really interests you. This is left as an exercise for you to do it on your own."}]},{"block_type":"element","block":"k6pz2izy","search_text":"Note Now imagine how difficult it would be to implement the same program using the standard library functions of the C programming language! ","text_count":141,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now imagine how difficult it would be to implement the same program using the standard library functions of the C programming language!"}]}]},{"block_type":"element","block":"k6pz2izz","search_text":"Using eBPF from Go","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Using eBPF from Go"}]},{"block_type":"element","block":"k6pz2j00","search_text":"eBPF stands for enhanced Berkeley Packet Filter, and it is an in-kernel virtual machine that is integrated into the Linux kernel and can be used for Linux tracing. In order to be able to use eBPF, you will need to have a kernel compiled with the CONFIG_BPF_SYSCALL option, which is automatically activated on Ubuntu Linux.","text_count":322,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"eBPF"}]},{"block_type":"text","content":"stands for enhanced Berkeley Packet Filter, and it is an in-kernel virtual machine that is integrated into the Linux kernel and can be used for Linux tracing. In order to be able to use eBPF, you will need to have a kernel compiled with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CONFIG_BPF_SYSCALL"}]},{"block_type":"text","content":"option, which is automatically activated on Ubuntu Linux."}]},{"block_type":"element","block":"k6pz2j01","search_text":"Note eBPF works on Linux machines with relatively new kernel versions but does not work on macOS or Mac OS X machines. ","text_count":119,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"eBPF works on Linux machines with relatively new kernel versions but does not work on macOS or Mac OS X machines."}]}]},{"block_type":"element","block":"k6pz2j02","search_text":"You can learn more about eBPF at https://github.com/iovisor/bcc and about eBPF and Go at https://kinvolk.io/blog/2016/11/introducing-gobpf---using-ebpf-from-go/ . The gobpf package can be found at https://github.com/iovisor/gobpf/ .","text_count":232,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about eBPF at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/iovisor/bcc"},"children":[{"block_type":"text","content":"https://github.com/iovisor/bcc"}]},{"block_type":"text","content":"and about eBPF and Go at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://kinvolk.io/blog/2016/11/introducing-gobpf---using-ebpf-from-go/"},"children":[{"block_type":"text","content":"https://kinvolk.io/blog/2016/11/introducing-gobpf---using-ebpf-from-go/"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gobpf"}]},{"block_type":"text","content":"package can be found at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/iovisor/gobpf/"},"children":[{"block_type":"text","content":"https://github.com/iovisor/gobpf/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j03","search_text":"Unfortunately, further discussion of eBPF and Go is beyond the scope of this book.","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Unfortunately, further discussion of eBPF and Go is beyond the scope of this book."}]},{"block_type":"element","block":"k6pz2j04","search_text":"About syscall.PtraceRegs","text_count":24,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About syscall.PtraceRegs"}]},{"block_type":"element","block":"k6pz2j05","search_text":"You might have assumed that you are done dealing with the syscall standard Go package, however you are mistaken! In this section, we will work with syscall.PtraceRegs , which is a structure that holds information about the state of the registers.","text_count":246,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might have assumed that you are done dealing with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"standard Go package, however you are mistaken! In this section, we will work with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceRegs"}]},{"block_type":"text","content":", which is a structure that holds information about the state of the registers."}]},{"block_type":"element","block":"k6pz2j06","search_text":"Note This section is not included in my Go Systems Programming book, Packt Publishing, 2017. ","text_count":93,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section is not included in my"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming book, Packt Publishing,"}]},{"block_type":"text","content":"2017."}]}]},{"block_type":"element","block":"k6pz2j07","search_text":"You will learn now how to print the values of all of the following registers on your screen using the Go code of ptraceRegs.go , which will be presented in four parts. The star of the ptraceRegs.go utility is the syscall.PtraceGetRegs() function-there are also the syscall.PtraceSetRegs() , syscall.PtraceAttach() , syscall.PtracePeekData() , and syscall.PtracePokeData() functions that can help you work with registers, but these functions will not be used in ptraceRegs.go .","text_count":476,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn now how to print the values of all of the following registers on your screen using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":", which will be presented in four parts. The star of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"utility is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceGetRegs()"}]},{"block_type":"text","content":"function-there are also the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceSetRegs()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceAttach()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtracePeekData()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtracePokeData()"}]},{"block_type":"text","content":"functions that can help you work with registers, but these functions will not be used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j08","search_text":"The first part of the ptraceRegs.go utility follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"utility follows next:"}]},{"block_type":"element","block":"k6pz2j09","search_text":"package main import ( \"fmt\" \"os\" \"os/exec\" \"syscall\" \"time\" ) ","text_count":62,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"os/exec\" \n    \"syscall\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j0a","search_text":"The second code portion of ptraceRegs.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j0b","search_text":"func main() { var r syscall.PtraceRegs cmd := exec.Command(os.Args[1], os.Args[2:]...) cmd.Stdout = os.Stdout cmd.Stderr = os.Stderr ","text_count":133,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var r syscall.PtraceRegs \n    cmd := exec.Command(os.Args[1], os.Args[2:]...) \n \n    cmd.Stdout = os.Stdout \n    cmd.Stderr = os.Stderr"}]}]},{"block_type":"element","block":"k6pz2j0c","search_text":"The third part of ptraceRegs.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j0d","search_text":"cmd.SysProcAttr = &syscall.SysProcAttr{Ptrace: true} err := cmd.Start() if err != nil { fmt.Println(\"Start:\", err) return } err = cmd.Wait() fmt.Printf(\"State: %v\\n\", err) wpid := cmd.Process.Pid ","text_count":196,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"cmd.SysProcAttr = &amp;syscall.SysProcAttr{Ptrace: true} \n    err := cmd.Start() \n    if err != nil { \n        fmt.Println(\"Start:\", err) \n        return \n    } \n \n    err = cmd.Wait() \n    fmt.Printf(\"State: %v\\n\", err) \n    wpid := cmd.Process.Pid"}]}]},{"block_type":"element","block":"k6pz2j0e","search_text":"In the preceding Go code, you call an external command, which is specified in the command-line arguments of the program, and you find its process ID, which will be used in the syscall.PtraceGetRegs() call. The &syscall.SysProcAttr{Ptrace: true} statement specifies that you want to use ptrace on the child process.","text_count":314,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you call an external command, which is specified in the command-line arguments of the program, and you find its process ID, which will be used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceGetRegs()"}]},{"block_type":"text","content":"call. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&amp;syscall.SysProcAttr{Ptrace: true}"}]},{"block_type":"text","content":"statement specifies that you want to use ptrace on the child process."}]},{"block_type":"element","block":"k6pz2j0f","search_text":"The last code segment of ptraceRegs.go follows next:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j0g","search_text":"err = syscall.PtraceGetRegs(wpid, &r) if err != nil { fmt.Println(\"PtraceGetRegs:\", err) return } fmt.Printf(\"Registers: %#v\\n\", r) fmt.Printf(\"R15=%d, Gs=%d\\n\", r.R15, r.Gs) time.Sleep(2 * time.Second) } ","text_count":205,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err = syscall.PtraceGetRegs(wpid, &amp;r) \n    if err != nil { \n        fmt.Println(\"PtraceGetRegs:\", err) \n        return \n    } \n    fmt.Printf(\"Registers: %#v\\n\", r)\n    fmt.Printf(\"R15=%d, Gs=%d\\n\", r.R15, r.Gs) \n \n    time.Sleep(2 * time.Second) \n}"}]}]},{"block_type":"element","block":"k6pz2j0h","search_text":"Here you call syscall.PtraceGetRegs() , and you print the results that are stored in the r variable, which should be passed as a pointer.","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceGetRegs()"}]},{"block_type":"text","content":", and you print the results that are stored in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"variable, which should be passed as a pointer."}]},{"block_type":"element","block":"k6pz2j0i","search_text":"Executing ptraceRegs.go on a macOS High Sierra machine will generate the following output:","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine will generate the following output:"}]},{"block_type":"element","block":"k6pz2j0j","search_text":"$ go run ptraceRegs.go # command-line-arguments ./ptraceRegs.go:11:8: undefined: syscall.PtraceRegs ./ptraceRegs.go:14:9: undefined: syscall.PtraceGetRegs","text_count":154,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run ptraceRegs.go\n# command-line-arguments\n./ptraceRegs.go:11:8: undefined: syscall.PtraceRegs\n./ptraceRegs.go:14:9: undefined: syscall.PtraceGetRegs"}]}]},{"block_type":"element","block":"k6pz2j0k","search_text":"This means that this program will not work on machines running macOS and OS X.","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This means that this program will not work on machines running macOS and OS X."}]},{"block_type":"element","block":"k6pz2j0l","search_text":"Executing ptraceRegs.go on a Debian Linux machine will create the following output:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ptraceRegs.go"}]},{"block_type":"text","content":"on a Debian Linux machine will create the following output:"}]},{"block_type":"element","block":"k6pz2j0m","search_text":"$ go version go version go1.3.3 linux/amd64 $ go run ptraceRegs.go echo \"Mastering Go!\" State: stop signal: trace/breakpoint trap Registers: syscall.PtraceRegs{R15:0x0, R14:0x0, R13:0x0, R12:0x0, Rbp:0x0, Rbx:0x0, R11:0x0, R10:0x0, R9:0x0, R8:0x0, Rax:0x0, Rcx:0x0, Rdx:0x0, Rsi:0x0, Rdi:0x0, Orig_rax:0x3b, Rip:0x7f8b1200e130, Cs:0x33, Eflags:0x200, Rsp:0x7ffd9d53f320, Ss:0x2b, Fs_base:0x0, Gs_base:0x0, Ds:0x0, Es:0x0, Fs:0x0, Gs:0x0} R15=0, Gs=0 Mastering Go! ","text_count":464,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go version\ngo version go1.3.3 linux/amd64\n$ go run ptraceRegs.go echo \"Mastering Go!\"\nState: stop signal: trace/breakpoint trap\nRegisters: syscall.PtraceRegs{R15:0x0, R14:0x0, R13:0x0, R12:0x0, Rbp:0x0, Rbx:0x0, R11:0x0, R10:0x0, R9:0x0, R8:0x0, Rax:0x0, Rcx:0x0, Rdx:0x0, Rsi:0x0, Rdi:0x0, Orig_rax:0x3b, Rip:0x7f8b1200e130, Cs:0x33, Eflags:0x200, Rsp:0x7ffd9d53f320, Ss:0x2b, Fs_base:0x0, Gs_base:0x0, Ds:0x0, Es:0x0, Fs:0x0, Gs:0x0}\nR15=0, Gs=0\nMastering Go!"}]}]},{"block_type":"element","block":"k6pz2j0n","search_text":"You can also find the list of registers in the documentation page of the syscall package.","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can also find the list of registers in the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2j0o","search_text":"Tracing system calls","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Tracing system calls"}]},{"block_type":"element","block":"k6pz2j0p","search_text":"This section will present a pretty advanced technique that uses the syscall package and allows you to monitor the system calls executed in a Go program.","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a pretty advanced technique that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package and allows you to monitor the system calls executed in a Go program."}]},{"block_type":"element","block":"k6pz2j0q","search_text":"Note This section is not included in my Go Systems Programming book, Packt Publishing, 2017. ","text_count":93,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section is not included in my"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Systems Programming book, Packt Publishing, 2017."}]}]}]},{"block_type":"element","block":"k6pz2j0r","search_text":"The name of the Go utility is traceSyscall.go , and it is going to be presented in five code segments. The first part of traceSyscall.go follows next:","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":", and it is going to be presented in five code segments. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j0s","search_text":"package main import ( \"bufio\" \"fmt\" \"os\" \"os/exec\" \"strings\" \"syscall\" ) var maxSyscalls = 0 const SYSCALLFILE = \"SYSCALLS\" ","text_count":124,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"os\" \n    \"os/exec\" \n    \"strings\" \n    \"syscall\" \n) \n \nvar maxSyscalls = 0 \n \nconst SYSCALLFILE = \"SYSCALLS\""}]}]},{"block_type":"element","block":"k6pz2j0t","search_text":"You will learn more about the purpose of the SYSCALLFILE variable in a short while.","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about the purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SYSCALLFILE"}]},{"block_type":"text","content":"variable in a short while."}]},{"block_type":"element","block":"k6pz2j0u","search_text":"The second code segment from traceSyscall.go is the following:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2j0v","search_text":"func main() { var SYSTEMCALLS []string f, err := os.Open(SYSCALLFILE) defer f.Close() if err != nil { fmt.Println(err) return } scanner := bufio.NewScanner(f) for scanner.Scan() { line := scanner.Text() line = strings.Replace(line, \" \", \"\", -1) line = strings.Replace(line, \"SYS_\", \"\", -1) temp := strings.ToLower(strings.Split(line, \"=\")[0]) SYSTEMCALLS = append(SYSTEMCALLS, temp) maxSyscalls++ } ","text_count":399,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var SYSTEMCALLS []string \n    f, err := os.Open(SYSCALLFILE) \n    defer f.Close() \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    scanner := bufio.NewScanner(f) \n    for scanner.Scan() { \n        line := scanner.Text() \n        line = strings.Replace(line, \" \", \"\", -1) \n        line = strings.Replace(line, \"SYS_\", \"\", -1) \n        temp := strings.ToLower(strings.Split(line, \"=\")[0]) \n        SYSTEMCALLS = append(SYSTEMCALLS, temp) \n        maxSyscalls++ \n    }"}]}]},{"block_type":"element","block":"k6pz2j0w","search_text":"Note that the information of the SYSCALLS text file is taken from the documentation of the syscall package, and it associates each system call with a number, which is the internal Go representation of the system call. This file is mainly used for printing the names of the system calls used by the program that is being traced.","text_count":327,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the information of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SYSCALLS"}]},{"block_type":"text","content":"text file is taken from the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package, and it associates each system call with a number, which is the internal Go representation of the system call. This file is mainly used for printing the names of the system calls used by the program that is being traced."}]},{"block_type":"element","block":"k6pz2j0x","search_text":"The format of the SYSCALLS text file is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The format of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SYSCALLS"}]},{"block_type":"text","content":"text file is as follows:"}]},{"block_type":"element","block":"k6pz2j0y","search_text":"SYS_READ = 0 SYS_WRITE = 1 SYS_OPEN = 2 SYS_CLOSE = 3 SYS_STAT = 4","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"SYS_READ = 0\nSYS_WRITE = 1\nSYS_OPEN = 2\nSYS_CLOSE = 3\nSYS_STAT = 4"}]}]},{"block_type":"element","block":"k6pz2j0z","search_text":"After reading the text file, the program creates a slice named SYSTEMCALLS for storing that information.","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After reading the text file, the program creates a slice named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SYSTEMCALLS"}]},{"block_type":"text","content":"for storing that information."}]},{"block_type":"element","block":"k6pz2j10","search_text":"The third part of traceSyscall.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j11","search_text":"COUNTER := make([]int, maxSyscalls) var regs syscall.PtraceRegs cmd := exec.Command(os.Args[1], os.Args[2:]...) cmd.Stdin = os.Stdin cmd.Stdout = os.Stdout cmd.Stderr = os.Stderr cmd.SysProcAttr = &syscall.SysProcAttr{Ptrace: true} err = cmd.Start() err = cmd.Wait() if err != nil { fmt.Println(\"Wait:\", err) } pid := cmd.Process.Pid fmt.Println(\"Process ID:\", pid) ","text_count":366,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"COUNTER := make([]int, maxSyscalls) \n    var regs syscall.PtraceRegs \n    cmd := exec.Command(os.Args[1], os.Args[2:]...) \n \n    cmd.Stdin = os.Stdin \n    cmd.Stdout = os.Stdout \n    cmd.Stderr = os.Stderr \n    cmd.SysProcAttr = &amp;syscall.SysProcAttr{Ptrace: true} \n \n    err = cmd.Start() \n    err = cmd.Wait() \n    if err != nil { \n        fmt.Println(\"Wait:\", err) \n    } \n \n    pid := cmd.Process.Pid \n    fmt.Println(\"Process ID:\", pid)"}]}]},{"block_type":"element","block":"k6pz2j12","search_text":"The COUNTER slice stores the number of times each system call is found in the program that is being traced.","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"COUNTER"}]},{"block_type":"text","content":"slice stores the number of times each system call is found in the program that is being traced."}]},{"block_type":"element","block":"k6pz2j13","search_text":"The fourth code segment of traceSyscall.go contains the following Go code:","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j14","search_text":"before := true forCount := 0 for { if before { err := syscall.PtraceGetRegs(pid, &regs) if err != nil { break } if regs.Orig_rax > uint64(maxSyscalls) { fmt.Println(\"Unknown:\", regs.Orig_rax) return } COUNTER[regs.Orig_rax]++ forCount++ } err = syscall.PtraceSyscall(pid, 0) if err != nil { fmt.Println(\"PtraceSyscall:\", err) return } _, err = syscall.Wait4(pid, nil, 0, nil) if err != nil { fmt.Println(\"Wait4:\", err) return } before = !before } ","text_count":447,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"before := true \n    forCount := 0 \n    for { \n        if before { \n            err := syscall.PtraceGetRegs(pid, &amp;regs) \n            if err != nil { \n                break \n            } \n            if regs.Orig_rax &gt; uint64(maxSyscalls) { \n                fmt.Println(\"Unknown:\", regs.Orig_rax) \n                return \n            } \n \n            COUNTER[regs.Orig_rax]++ \n            forCount++ \n        } \n \n        err = syscall.PtraceSyscall(pid, 0) \n        if err != nil { \n            fmt.Println(\"PtraceSyscall:\", err) \n            return \n        } \n \n        _, err = syscall.Wait4(pid, nil, 0, nil) \n        if err != nil { \n            fmt.Println(\"Wait4:\", err) \n            return \n        } \n        before = !before \n    }"}]}]},{"block_type":"element","block":"k6pz2j15","search_text":"The syscall.PtraceSyscall() function tells Go to continue the execution of the program that is being traced, but to stop when that program enters or exits a system call, which is exactly what we want! As each system call is traced before being called and right after it has finished its job, we use the before variable in order to count each system call only once.","text_count":364,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.PtraceSyscall()"}]},{"block_type":"text","content":"function tells Go to continue the execution of the program that is being traced, but to stop when that program enters or exits a system call, which is exactly what we want! As each system call is traced before being called and right after it has finished its job, we use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"before"}]},{"block_type":"text","content":"variable in order to count each system call only once."}]},{"block_type":"element","block":"k6pz2j16","search_text":"The last part of traceSyscall.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j17","search_text":"for i, x := range COUNTER { if x != 0 { fmt.Println(SYSTEMCALLS[i], \"->\", x) } } fmt.Println(\"Total System Calls:\", forCount) } ","text_count":128,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i, x := range COUNTER { \n        if x != 0 { \n            fmt.Println(SYSTEMCALLS[i], \"-&gt;\", x) \n        } \n    } \n    fmt.Println(\"Total System Calls:\", forCount) \n }"}]}]},{"block_type":"element","block":"k6pz2j18","search_text":"In this part, we print the contents of the COUNTER slice. The SYSTEMCALLS slice is used here for finding out the name of a system call when we know its numerical Go representation.","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, we print the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"COUNTER"}]},{"block_type":"text","content":"slice. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SYSTEMCALLS"}]},{"block_type":"text","content":"slice is used here for finding out the name of a system call when we know its numerical Go representation."}]},{"block_type":"element","block":"k6pz2j19","search_text":"Executing traceSyscall.go on a macOS High Sierra machine will create the following output:","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine will create the following output:"}]},{"block_type":"element","block":"k6pz2j1a","search_text":"$ go run traceSyscall.go # command-line-arguments ./traceSyscall.go:36:11: undefined: syscall.PtraceRegs ./traceSyscall.go:57:11: undefined: syscall.PtraceGetRegs ./traceSyscall.go:70:9: undefined: syscall.PtraceSyscall","text_count":219,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run traceSyscall.go\n# command-line-arguments\n./traceSyscall.go:36:11: undefined: syscall.PtraceRegs\n./traceSyscall.go:57:11: undefined: syscall.PtraceGetRegs\n./traceSyscall.go:70:9: undefined: syscall.PtraceSyscall"}]}]},{"block_type":"element","block":"k6pz2j1b","search_text":"Once again, the traceSyscall.go utility will not run on macOS and Mac OS X.","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"utility will not run on macOS and Mac OS X."}]},{"block_type":"element","block":"k6pz2j1c","search_text":"Executing the same program on a Debian Linux machine will create the following output:","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the same program on a Debian Linux machine will create the following output:"}]},{"block_type":"element","block":"k6pz2j1d","search_text":"$ go run traceSyscall.go ls /tmp/ Wait: stop signal: trace/breakpoint trap Process ID: 5657 go-build084836422 test.go upload_progress_cache read -> 11 write -> 1 open -> 37 close -> 27 stat -> 1 fstat -> 25 mmap -> 39 mprotect -> 16 munmap -> 4 brk -> 3 rt_sigaction -> 2 rt_sigprocmask -> 1 ioctl -> 2 access -> 9 execve -> 1 getdents -> 2 getrlimit -> 1 statfs -> 2 arch_prctl -> 1 futex -> 1 set_tid_address -> 1 openat -> 1 set_robust_list -> 1 Total System Calls: 189","text_count":472,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run traceSyscall.go ls /tmp/\nWait: stop signal: trace/breakpoint trap\nProcess ID: 5657\ngo-build084836422  test.go  upload_progress_cache\nread -&gt; 11\nwrite -&gt; 1\nopen -&gt; 37\nclose -&gt; 27\nstat -&gt; 1\nfstat -&gt; 25\nmmap -&gt; 39\nmprotect -&gt; 16\nmunmap -&gt; 4\nbrk -&gt; 3\nrt_sigaction -&gt; 2\nrt_sigprocmask -&gt; 1\nioctl -&gt; 2\naccess -&gt; 9\nexecve -&gt; 1\ngetdents -&gt; 2\ngetrlimit -&gt; 1\nstatfs -&gt; 2\narch_prctl -&gt; 1\nfutex -&gt; 1\nset_tid_address -&gt; 1\nopenat -&gt; 1\nset_robust_list -&gt; 1\nTotal System Calls: 189"}]}]},{"block_type":"element","block":"k6pz2j1e","search_text":"At the end of the program, traceSyscall.go prints the number of times each system call was called in the program! The correctness of traceSyscall.go is verified by the output of the strace -c utility.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the end of the program,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"prints the number of times each system call was called in the program! The correctness of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"is verified by the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strace -c"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2j1f","search_text":"$ strace -c ls /tmp test.go upload_progress_cache % time seconds usecs/call calls errors syscall ------ ----------- ----------- --------- --------- ---------------- 0.00 0.000000 0 11 read 0.00 0.000000 0 1 write 0.00 0.000000 0 37 13 open 0.00 0.000000 0 27 close 0.00 0.000000 0 1 stat 0.00 0.000000 0 25 fstat 0.00 0.000000 0 39 mmap 0.00 0.000000 0 16 mprotect 0.00 0.000000 0 4 munmap 0.00 0.000000 0 3 brk 0.00 0.000000 0 2 rt_sigaction 0.00 0.000000 0 1 rt_sigprocmask 0.00 0.000000 0 2 ioctl 0.00 0.000000 0 9 9 access 0.00 0.000000 0 1 execve 0.00 0.000000 0 2 getdents 0.00 0.000000 0 1 getrlimit 0.00 0.000000 0 2 2 statfs 0.00 0.000000 0 1 arch_prctl 0.00 0.000000 0 1 futex 0.00 0.000000 0 1 set_tid_address 0.00 0.000000 0 1 openat 0.00 0.000000 0 1 set_robust_list ------ ----------- ----------- --------- --------- ------------- 100.00 0.000000 189 24 total","text_count":873,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ strace -c ls /tmp\ntest.go  upload_progress_cache\n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n  0.00    0.000000           0        11           read\n  0.00    0.000000           0         1           write\n  0.00    0.000000           0        37        13 open\n  0.00    0.000000           0        27           close\n  0.00    0.000000           0         1           stat\n  0.00    0.000000           0        25           fstat\n  0.00    0.000000           0        39           mmap\n  0.00    0.000000           0        16           mprotect\n  0.00    0.000000           0         4           munmap\n  0.00    0.000000           0         3           brk\n  0.00    0.000000           0         2           rt_sigaction\n  0.00    0.000000           0         1           rt_sigprocmask\n  0.00    0.000000           0         2           ioctl\n  0.00    0.000000           0         9         9 access\n  0.00    0.000000           0         1           execve\n  0.00    0.000000           0         2           getdents\n  0.00    0.000000           0         1           getrlimit\n  0.00    0.000000           0         2         2 statfs\n  0.00    0.000000           0         1           arch_prctl\n  0.00    0.000000           0         1           futex\n  0.00    0.000000           0         1           set_tid_address\n  0.00    0.000000           0         1           openat\n  0.00    0.000000           0         1           set_robust_list\n  ------ ----------- ----------- --------- --------- -------------\n  100.00    0.000000                   189        24 total"}]}]},{"block_type":"element","block":"k6pz2j1g","search_text":"User ID and group ID","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"User ID and group ID"}]},{"block_type":"element","block":"k6pz2j1h","search_text":"In the last section of this chapter, you will learn how to find the user ID of the current user as well as the group IDs to which the current user belongs. Both user ID and group IDs are positive integers kept in Unix system files.","text_count":231,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the last section of this chapter, you will learn how to find the user ID of the current user as well as the group IDs to which the current user belongs. Both user ID and group IDs are positive integers kept in Unix system files."}]},{"block_type":"element","block":"k6pz2j1i","search_text":"The name of the utility is ids.go , and it will be presented in two parts. The first part of the utility follows next:","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ids.go"}]},{"block_type":"text","content":", and it will be presented in two parts. The first part of the utility follows next:"}]},{"block_type":"element","block":"k6pz2j1j","search_text":"package main import ( \"fmt\" \"os\" \"os/user\" ) func main() { fmt.Println(\"User id:\", os.Getuid()) ","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"os/user\" \n) \n \nfunc main() { \n    fmt.Println(\"User id:\", os.Getuid())"}]}]},{"block_type":"element","block":"k6pz2j1k","search_text":"Finding the user ID of the current user is as simple as calling the os.Getuid() function.","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finding the user ID of the current user is as simple as calling the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Getuid()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2j1l","search_text":"The second part of ids.go is as follows:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ids.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j1m","search_text":"var u *user.User u, _ = user.Current() fmt.Print(\"Group ids: \") groupIDs, _ := u.GroupIds() for _, i := range groupIDs { fmt.Print(i, \" \") } fmt.Println() } ","text_count":157,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var u *user.User \n    u, _ = user.Current() \n    fmt.Print(\"Group ids: \") \n    groupIDs, _ := u.GroupIds() \n    for _, i := range groupIDs { \n        fmt.Print(i, \" \") \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2j1n","search_text":"On the other hand, finding the group IDs to which a user belongs is a much trickier task.","text_count":89,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the other hand, finding the group IDs to which a user belongs is a much trickier task."}]},{"block_type":"element","block":"k6pz2j1o","search_text":"Executing ids.go will generate the following type of output:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ids.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2j1p","search_text":"$ go run ids.go User id: 501 Group ids: 20 701 12 61 79 80 81 98 33 100 204 250 395 398 399","text_count":91,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run ids.go\nUser id: 501\nGroup ids: 20 701 12 61 79 80 81 98 33 100 204 250 395 398 399"}]}]},{"block_type":"element","block":"k6pz2j1q","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2j1r","search_text":"You will find the following web links very useful:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will find the following web links very useful:"}]},{"block_type":"element","block":"k6pz2j1s","search_text":"Read the documentation page of the io package, which can be found at https://golang.org/pkg/io/ . You can learn more about the Glot plotting library by visiting its official web page at https://github.com/Arafatk/glot . You can learn more about the encoding/binary standard package by visiting https://golang.org/pkg/encoding/binary/ . Check the documentation page of the encoding/gob package, which can be found at https://golang.org/pkg/encoding/gob/ . You can learn about eBPF at http://www.brendangregg.com/ebpf.html . You can also watch https://www.youtube.com/watch?v=JRFNIKUROPE and https://www.youtube.com/watch?v=w8nFRoFJ6EQ . You can learn about Endianness in many places including https://en.wikipedia.org/wiki/Endianness . Visit the documentation page of the flag package, which can be found at https://golang.org/pkg/flag/ . ","text_count":838,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Read the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/io/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/io/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the Glot plotting library by visiting its official web page at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/Arafatk/glot"},"children":[{"block_type":"text","content":"https://github.com/Arafatk/glot"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/binary"}]},{"block_type":"text","content":"standard package by visiting&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/encoding/binary/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/encoding/binary/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Check the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/gob"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/encoding/gob/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/encoding/gob/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can learn about eBPF at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.brendangregg.com/ebpf.html"},"children":[{"block_type":"text","content":"http://www.brendangregg.com/ebpf.html"}]},{"block_type":"text","content":". You can also watch"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.youtube.com/watch?v=JRFNIKUROPE"},"children":[{"block_type":"text","content":"https://www.youtube.com/watch?v=JRFNIKUROPE and https://www.youtube.com/watch?v=w8nFRoFJ6EQ"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can learn about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Endianness"}]},{"block_type":"text","content":"in many places including&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://en.wikipedia.org/wiki/Endianness."},"children":[{"block_type":"text","content":"https://en.wikipedia.org/wiki/Endianness"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/flag/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/flag/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2j1t","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2j1u","search_text":"Write a Go program that takes three arguments, the name of a text file, and two strings. This utility should then replace every occurrence of the first string in the file with the second string. For reasons of security, the final output will be printed on screen, which means that the original text file will remain intact. Use the encoding/gob package to serialize and deserialize a Go map as well as a slice of structures. Create a Go program that handles any three signals you choose. Create a utility in Go that replaces all tab characters found in a text file with a given number of spaces that is specified as a command-line parameter to the program. Once again, the output will be printed on the screen. Develop a utility that reads a text file line by line and removes the space characters from each line using the strings.TrimSpace() function. Modify kvSaveLoad.go in order to support a single command-line argument, which is the filename that you will use both to load and save your data. Can you create a Go version of the wc(1) utility? Look at the manual page of wc(1) to find out about the command-line options that it supports. Modify the code of goFind.go in order to print regular files only. This means that it should not print directories, sockets, and symbolic links. Can you write a program that uses Glot to plot a function? Modify traceSyscall.go in order to display each system call at the time it is being traced. Modify cat.go just to do io.Copy(os.Stdout, f) in order to copy the contents of a file straight out instead of scanning it all. You can also use bufio.NewScanner() and bufio.ScanWords to read a line word by word. Find out how, and create a new version of the byWord.go utility. ","text_count":1717,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Write a Go program that takes three arguments, the name of a text file, and two strings. This utility should then replace every occurrence of the first string in the file with the second string. For reasons of security, the final output will be printed on screen, which means that the original text file will remain intact."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"encoding/gob"}]},{"block_type":"text","content":"package to serialize and deserialize a Go map as well as a slice of structures."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Create a Go program that handles any three signals you choose."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Create a utility in Go that replaces all tab characters found in a text file with a given number of spaces that is specified as a command-line parameter to the program. Once again, the output will be printed on the screen."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop a utility that reads a text file line by line and removes the space characters from each line using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strings.TrimSpace()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"in order to support a single command-line argument, which is the filename that you will use both to load and save your data."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you create a Go version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"utility? Look at the manual page of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"to find out about the command-line options that it supports."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goFind.go"}]},{"block_type":"text","content":"in order to print regular files only. This means that it should not print directories, sockets, and symbolic links."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Can you write a program that uses"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Glot"}]},{"block_type":"text","content":"to plot a function?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceSyscall.go"}]},{"block_type":"text","content":"in order to display each system call at the time it is being traced."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cat.go"}]},{"block_type":"text","content":"just to do"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Copy(os.Stdout, f)"}]},{"block_type":"text","content":"in order to copy the contents of a file straight out instead of scanning it all."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can also use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.NewScanner()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.ScanWords"}]},{"block_type":"text","content":"to read a line word by word. Find out how, and create a new version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"utility."}]}]},{"block_type":"element","block":"k6pz2j1v","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2j1w","search_text":"This amazing chapter talked about many interesting topics including reading files, writing to files, and the use of the flag package, Nevertheless, there are many more topics related to systems programming not mentioned in this chapter, such as working with directories, copying, deleting, and renaming files, dealing with Unix users, groups and Unix processes, working with environment variables such as PATH, changing Unix file permissions, generating sparse files , reading and saving JSON data, locking and creating files, using and rotating your own log files, as well as the information found in the structure returned by the os.Stat() call.","text_count":647,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This amazing chapter talked about many interesting topics including reading files, writing to files, and the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package, Nevertheless, there are many more topics related to systems programming not mentioned in this chapter, such as working with directories, copying, deleting, and renaming files, dealing with Unix users, groups and Unix processes, working with environment variables such as PATH, changing Unix file permissions, generating"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"sparse files"}]},{"block_type":"text","content":", reading and saving JSON data, locking and creating files, using and rotating your own log files, as well as the information found in the structure returned by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stat()"}]},{"block_type":"text","content":"call."}]},{"block_type":"element","block":"k6pz2j1x","search_text":"At the end of this chapter, we presented two advanced utilities written in Go. The first one allowed you to inspect the state of the registers, while the second one showed you a technique that allows you to trace the system calls of any program.","text_count":245,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the end of this chapter, we presented two advanced utilities written in Go. The first one allowed you to inspect the state of the registers, while the second one showed you a technique that allows you to trace the system calls of any program."}]},{"block_type":"element","block":"k6pz2j1y","search_text":"I am pretty sure that the next chapter will also astonish you, as it talks about goroutines, channels, and pipelines, which are unique and powerful Go features.","text_count":160,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I am pretty sure that the next chapter will also astonish you, as it talks about goroutines, channels, and pipelines, which are unique and powerful Go features."}]}]},{"title":"Go Concurrency &ndash; Goroutines, Channels, and Pipelines","author":"Mihalis Tsoukalos","block":"k6pz24ni","number":9,"contents":[{"block_type":"element","block":"k6pz2j1z","search_text":"The previous chapter discussed systems programming in Go, which encompasses the Go functions and techniques that allow you to communicate with the operating system. Two of the areas of systems programming that were not covered in the previous chapter are concurrent programming and creating and manage multiple threads. Both these topics will be addressed in this chapter and the next one.","text_count":389,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The previous chapter discussed systems programming in Go, which encompasses the Go functions and techniques that allow you to communicate with the operating system. Two of the areas of systems programming that were not covered in the previous chapter are concurrent programming and creating and manage multiple threads. Both these topics will be addressed in this chapter and the next one."}]},{"block_type":"element","block":"k6pz2j20","search_text":"Go offers its own unique and innovative way of achieving concurrency, which comes in the form of goroutines and channels . Goroutines are the smallest Go entities that can be executed on their own in a Go program, while channels can get data from goroutines in a concurrent and efficient way and thus allow goroutines to have a point of reference and communicate with each other. Everything in Go is executed using goroutines; this makes perfect sense since Go is a concurrent programming language by design. Therefore, when a Go program starts its execution, its single goroutine calls the main() function, which starts the actual program execution.","text_count":650,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go offers its own unique and innovative way of achieving concurrency, which comes in the form of"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutines"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"channels"}]},{"block_type":"text","content":". Goroutines are the smallest Go entities that can be executed on their own in a Go program, while channels can get data from goroutines in a concurrent and efficient way and thus allow goroutines to have a point of reference and communicate with each other. Everything in Go is executed using goroutines; this makes perfect sense since Go is a concurrent programming language by design. Therefore, when a Go program starts its execution, its single goroutine calls the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, which starts the actual program execution."}]},{"block_type":"element","block":"k6pz2j21","search_text":"The contents and the code of this chapter will be pretty simple, and you should have no problem following and understanding them, as I left the more advanced parts of goroutines and channels for Chapter 10, Go Concurrency – Advanced Topics .","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The contents and the code of this chapter will be pretty simple, and you should have no problem following and understanding them, as I left the more advanced parts of goroutines and channels for Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Advanced Topics"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j22","search_text":"In this chapter, you will learn the following topics:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2j23","search_text":"The differences between processes, threads, and goroutines The Go scheduler Concurrency and parallelism Creating goroutines Creating channels Reading or receiving data from a channel Writing or sending data to a channel Creating pipelines Waiting for your goroutines to finish ","text_count":277,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The differences between processes, threads, and goroutines"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go scheduler"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Concurrency and parallelism"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Creating goroutines"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Creating channels"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Reading or receiving data from a channel"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Writing or sending data to a channel"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Creating pipelines"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Waiting for your goroutines to finish"}]}]}]},{"block_type":"element","block":"k6pz2j24","search_text":"About processes, threads, and goroutines","text_count":40,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About processes, threads, and goroutines"}]},{"block_type":"element","block":"k6pz2j25","search_text":"A process is an execution environment that contains instructions and user-data and system-data parts, as well as other types of resources that are obtained during runtime, whereas a program is a file that contains the instructions and data that are used for initializing the instruction and user-data parts of a process.","text_count":320,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"process"}]},{"block_type":"text","content":"is an execution environment that contains instructions and user-data and system-data parts, as well as other types of resources that are obtained during runtime, whereas a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"program"}]},{"block_type":"text","content":"is a file that contains the instructions and data that are used for initializing the instruction and user-data parts of a process."}]},{"block_type":"element","block":"k6pz2j26","search_text":"A thread is a smaller and lighter entity than a process or a program. Threads are created by processes and have their own flow of control and stack. A quick and simplistic way to differentiate a thread from a process is to consider a process as the running binary file and a thread as a subset of a process.","text_count":307,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"thread"}]},{"block_type":"text","content":"is a smaller and lighter entity than a process or a program. Threads are created by processes and have their own flow of control and stack. A quick and simplistic way to differentiate a thread from a process is to consider a process as the running binary file and a thread as a subset of a process."}]},{"block_type":"element","block":"k6pz2j27","search_text":"A goroutine is the minimum Go entity that can be executed concurrently. The use of the word minimum is very important here, as goroutines are not autonomous entities like Unix processes—goroutines live in threads that live in Unix processes. The main advantage of goroutines is that they are extremely lightweight and running thousands or hundreds of thousands of them is no problem.","text_count":383,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"goroutine"}]},{"block_type":"text","content":"is the minimum Go entity that can be executed concurrently. The use of the word"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"minimum"}]},{"block_type":"text","content":"is very important here, as goroutines are not autonomous entities like Unix processes&mdash;goroutines live in threads that live in Unix processes. The main advantage of goroutines is that they are extremely lightweight and running thousands or hundreds of thousands of them is no problem."}]},{"block_type":"element","block":"k6pz2j28","search_text":"The good thing is that goroutines are lighter than threads, which, in turn are lighter than processes. In practice, this means that a process can have multiple threads as well as lots of goroutines, whereas a goroutine needs the environment of a process in order to exist. So, in order to create a goroutine, you will need to have a process with at least one thread-Unix takes care of the process and thread management, while Go and the developer need to take care of the goroutines.","text_count":483,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good thing is that goroutines are lighter than threads, which, in turn are lighter than processes. In practice, this means that a process can have multiple threads as well as lots of goroutines, whereas a goroutine needs the environment of a process in order to exist. So, in order to create a goroutine, you will need to have a process with at least one thread-Unix takes care of the process and thread management, while Go and the developer need to take care of the goroutines."}]},{"block_type":"element","block":"k6pz2j29","search_text":"Now that you know the basics of processes, programs, threads, and goroutines, let's talk a little bit about the Go scheduler .","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now that you know the basics of processes, programs, threads, and goroutines, let's talk a little bit about the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go scheduler"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j2a","search_text":"The Go scheduler","text_count":16,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The Go scheduler"}]},{"block_type":"element","block":"k6pz2j2b","search_text":"The Unix kernel scheduler is responsible for the execution of the threads of a program. On the other hand, the Go runtime has its own scheduler, which is responsible for the execution of the goroutines using a technique known as m:n scheduling , where m goroutines are executed using n operating system threads using multiplexing. The Go scheduler is the Go component responsible for the way and the order in which the goroutines of a Go program get executed. This makes the Go scheduler a really important part of the Go programming language, as everything in a Go program is executed as a goroutine.","text_count":601,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Unix kernel scheduler is responsible for the execution of the threads of a program. On the other hand, the Go runtime has its own scheduler, which is responsible for the execution of the goroutines using a technique known as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"m:n scheduling"}]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":","}]},{"block_type":"text","content":"where"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"m"}]},{"block_type":"text","content":"goroutines are executed using"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"operating system threads using multiplexing. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go scheduler"}]},{"block_type":"text","content":"is the Go component responsible for the way and the order in which the goroutines of a Go program get executed. This makes the Go scheduler a really important part of the Go programming language, as everything in a Go program is executed as a goroutine."}]},{"block_type":"element","block":"k6pz2j2c","search_text":"Be aware that as the Go scheduler only deals with the goroutines of a single program, its operation is much simpler, cheaper, and faster than the operation of the kernel scheduler.","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Be aware that as the Go scheduler only deals with the goroutines of a single program, its operation is much simpler, cheaper, and faster than the operation of the kernel scheduler."}]},{"block_type":"element","block":"k6pz2j2d","search_text":"Chapter 10, Go Concurrency–Advanced Topics , will talk about the way the Go scheduler operates in much more detail.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Go Concurrency&ndash;Advanced Topics"}]},{"block_type":"text","content":",&nbsp;will talk about the way the Go scheduler operates in much more detail."}]},{"block_type":"element","block":"k6pz2j2e","search_text":"Concurrency and parallelism","text_count":27,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Concurrency and parallelism"}]},{"block_type":"element","block":"k6pz2j2f","search_text":"It is a very common misconception that concurrency is the same thing as parallelism —this is just not true! Parallelism is the simultaneous execution of multiple entities of some kind, whereas concurrency is a way of structuring your components so that they can be executed independently when possible.","text_count":302,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is a very common misconception that"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"concurrency"}]},{"block_type":"text","content":"is the same thing as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"parallelism"}]},{"block_type":"text","content":"&mdash;this is just not true! Parallelism is the simultaneous execution of multiple entities of some kind, whereas concurrency is a way of structuring your components so that they can be executed independently when possible."}]},{"block_type":"element","block":"k6pz2j2g","search_text":"It is only when you build software components concurrently that you can safely execute them in parallel, when and if your operating system and your hardware permit it. The Erlang programming language did this a long time ago—long before CPUs had multiple cores and computers had lots of RAM.","text_count":291,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is only when you build software components concurrently that you can safely execute them in parallel, when and if your operating system and your hardware permit it. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Erlang"}]},{"block_type":"text","content":"programming language did this a long time ago&mdash;long before CPUs had multiple cores and computers had lots of RAM."}]},{"block_type":"element","block":"k6pz2j2h","search_text":"In a valid concurrent design, adding concurrent entities makes the whole system run faster because more things can run in parallel. So, the desired parallelism comes from a better concurrent expression and implementation of the problem. The developer is responsible for taking concurrency into account during the design phase of a system and benefit from a potential parallel execution of the components of the system. So, the developer should not think about parallelism, but about breaking things into independent components that solve the initial problem when combined.","text_count":572,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In a valid concurrent design, adding concurrent entities makes the whole system run faster because more things can run in parallel. So, the desired parallelism comes from a better concurrent expression and implementation of the problem. The developer is responsible for taking concurrency into account during the design phase of a system and benefit from a potential parallel execution of the components of the system. So, the developer should not think about parallelism, but about breaking things into independent components that solve the initial problem when combined."}]},{"block_type":"element","block":"k6pz2j2i","search_text":"Even if you cannot run your functions in parallel on a Unix machine, a valid concurrent design will still improve the design and the maintainability of your programs. In other words, concurrency is better than parallelism!","text_count":222,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Even if you cannot run your functions in parallel on a Unix machine, a valid concurrent design will still improve the design and the maintainability of your programs. In other words, concurrency is better than parallelism!"}]},{"block_type":"element","block":"k6pz2j2j","search_text":"Goroutines","text_count":10,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Goroutines"}]},{"block_type":"element","block":"k6pz2j2k","search_text":"You can define a new goroutine using the go keyword followed by a function name or the full definition of an anonymous function . The go keyword makes the function call to return immediately, while the function starts running in the background as a goroutine and the rest of the program continues its execution.","text_count":311,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can define a new goroutine using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"keyword followed by a function name or the full definition of an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"anonymous function"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"keyword makes the function call to return immediately, while the function starts running in the background as a goroutine and the rest of the program continues its execution."}]},{"block_type":"element","block":"k6pz2j2l","search_text":"However, as you will see in a moment, you cannot control or make any assumptions about the order in which your goroutines are going to be executed because this depends on the scheduler of the operating system, the Go scheduler, and the load of the operating system.","text_count":265,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, as you will see in a moment, you cannot control or make any assumptions about the order in which your goroutines are going to be executed because this depends on the scheduler of the operating system, the Go scheduler, and the load of the operating system."}]},{"block_type":"element","block":"k6pz2j2m","search_text":"Creating a goroutine","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Creating a goroutine"}]},{"block_type":"element","block":"k6pz2j2n","search_text":"In this subsection, you will learn two ways for creating goroutines. The first one is using regular functions, while the second method is using anonymous functions—these two ways are equivalent.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn two ways for creating goroutines. The first one is using regular functions, while the second method is using anonymous functions&mdash;these two ways are equivalent."}]},{"block_type":"element","block":"k6pz2j2o","search_text":"The name of the program covered in this section is simple.go , and it is presented in three parts.","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program covered in this section is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":", and it is presented in three parts."}]},{"block_type":"element","block":"k6pz2j2p","search_text":"The first part of simple.go is the following Go code:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"is the following Go code:"}]},{"block_type":"element","block":"k6pz2j2q","search_text":"package main import ( \"fmt\" \"time\" ) func function() { for i := 0; i < 10; i++ { fmt.Print(i) } fmt.Println() } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n) \n \nfunc function() { \n    for i := 0; i &lt; 10; i++ { \n        fmt.Print(i) \n    } \n    fmt.Println() \n}"}]}]},{"block_type":"element","block":"k6pz2j2r","search_text":"Apart from the import block, the preceding code defines a function named function() that will be used in a short while.","text_count":119,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"block, the preceding code defines a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function()"}]},{"block_type":"text","content":"that will be used in a short while."}]},{"block_type":"element","block":"k6pz2j2s","search_text":"The second part of simple.go follows next:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j2t","search_text":"func main() { go function() ","text_count":28,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    go function()"}]}]},{"block_type":"element","block":"k6pz2j2u","search_text":"The preceding code starts with function() as a goroutine. After this, the program continues its execution, while function() begins to run in the background.","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code starts with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function()"}]},{"block_type":"text","content":"as a goroutine. After this, the program continues its execution, while"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function()"}]},{"block_type":"text","content":"begins to run in the background."}]},{"block_type":"element","block":"k6pz2j2v","search_text":"The last code portion of simple.go is shown in the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j2w","search_text":"go func() { for i := 10; i < 20; i++ { fmt.Print(i, \" \") } }() time.Sleep(1 * time.Second) } ","text_count":93,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go func() { \n    for i := 10; i &lt; 20; i++ { \n        fmt.Print(i, \" \") \n    } \n}() \n \n    time.Sleep(1 * time.Second) \n}"}]}]},{"block_type":"element","block":"k6pz2j2x","search_text":"With this code, you create a goroutine using an anonymous function. This method works best for relatively small functions. However, if you have lots of code, it is considered better practice to create a regular function and execute it using the go keyword.","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"With this code, you create a goroutine using an anonymous function. This method works best for relatively small functions. However, if you have lots of code, it is considered better practice to create a regular function and execute it using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"keyword."}]},{"block_type":"element","block":"k6pz2j2y","search_text":"As you will see in the next section, you can create multiple goroutines any way you wish, including using a for loop.","text_count":117,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see in the next section, you can create multiple goroutines any way you wish, including using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2j2z","search_text":"Executing simple.go two times will generate the following type of output:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"two times will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2j30","search_text":"$ go run simple.go 10 11 12 13 14 0123456789 15 16 17 18 19 $ go run simple.go 10 11 12 13 14 15 16 17 18 19 0123456789 ","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run simple.go\n10 11 12 13 14 0123456789\n15 16 17 18 19\n$ go run simple.go\n10 11 12 13 14 15 16 17 18 19 0123456789"}]}]},{"block_type":"element","block":"k6pz2j31","search_text":"Although what you really want from your programs is to generate the same output for the same input, the output you get from simple.go is not always the same. The preceding output supports the fact that you cannot control the order in which your goroutines will be executed without taking extra care. This means writing extra code specifically for this to occur. In Chapter 10, Go Concurrency – Advanced Topics , you will learn how to control the order in which your goroutines are executed as well as how to print the results of one goroutine before printing the results of the following one.","text_count":592,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although what you really want from your programs is to generate the same output for the same input, the output you get from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"is not always the same. The preceding output supports the fact that you cannot control the order in which your goroutines will be executed without taking extra care. This means writing extra code specifically for this to occur. In Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Advanced Topics"}]},{"block_type":"text","content":",&nbsp;you will learn how to control the order in which your goroutines are executed as well as how to print the results of one goroutine before printing the results of the following one."}]},{"block_type":"element","block":"k6pz2j32","search_text":"Creating multiple goroutines","text_count":28,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Creating multiple goroutines"}]},{"block_type":"element","block":"k6pz2j33","search_text":"In this subsection, you will learn how to create a variable number of goroutines. The program reviewed in this section is called create.go . It will be presented in four parts, and it will allow you to create a dynamic number of goroutines. The number of goroutines will be given as a command-line argument to the program, which uses the flag package to process its command-line argument.","text_count":388,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to create a variable number of goroutines. The program reviewed in this section is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":". It will be presented in four parts, and it will allow you to create a dynamic number of goroutines. The number of goroutines will be given as a command-line argument to the program, which uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"flag"}]},{"block_type":"text","content":"package to process its command-line argument."}]},{"block_type":"element","block":"k6pz2j34","search_text":"The first code part of create.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j35","search_text":"package main import ( \"flag\" \"fmt\" \"time\" ) ","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"flag\" \n    \"fmt\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j36","search_text":"The second code segment from create.go contains the following Go code:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j37","search_text":"func main() { n := flag.Int(\"n\", 10, \"Number of goroutines\") flag.Parse() count := *n fmt.Printf(\"Going to create %d goroutines.\\n\", count) ","text_count":140,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    n := flag.Int(\"n\", 10, \"Number of goroutines\") \n    flag.Parse() \n \n    count := *n \n    fmt.Printf(\"Going to create %d goroutines.\\n\", count)"}]}]},{"block_type":"element","block":"k6pz2j38","search_text":"The preceding code reads the value of the n command-line option, which determines the number of goroutines that will be created.","text_count":128,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code reads the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"command-line option, which determines the number of goroutines that will be created."}]},{"block_type":"element","block":"k6pz2j39","search_text":"The third code portion of create.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j3a","search_text":"for i := 0; i < count; i++ { go func(x int) { fmt.Printf(\"%d \", x) }(i) } ","text_count":74,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; count; i++ { \n        go func(x int) { \n            fmt.Printf(\"%d \", x) \n        }(i) \n    }"}]}]},{"block_type":"element","block":"k6pz2j3b","search_text":"A for loop is used for creating the desired number of goroutines. Once again, you should remember that you cannot make any assumptions about the order in which they are going to be created and executed.","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop is used for creating the desired number of goroutines. Once again, you should remember that you cannot make any assumptions about the order in which they are going to be created and executed."}]},{"block_type":"element","block":"k6pz2j3c","search_text":"The last part of the Go code from create.go is the following:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the Go code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":"is the following:"}]},{"block_type":"element","block":"k6pz2j3d","search_text":"time.Sleep(time.Second) fmt.Println(\"\\nExiting...\") } ","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"time.Sleep(time.Second) \n    fmt.Println(\"\\nExiting...\") \n}"}]}]},{"block_type":"element","block":"k6pz2j3e","search_text":"The purpose of the time.Sleep() statement is to give the goroutines enough time to finish their jobs so that their output can be seen on the screen. In a real program, you will not need a time.Sleep() statement, as you both want to finish as soon as possible and, moreover, you will learn a better technique to make your program wait for the various goroutines to finish before the main() function returns.","text_count":406,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"statement is to give the goroutines enough time to finish their jobs so that their output can be seen on the screen. In a real program, you will not need a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"statement, as you both want to finish as soon as possible and, moreover, you will learn a better technique to make your program wait for the various goroutines to finish before the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function returns."}]},{"block_type":"element","block":"k6pz2j3f","search_text":"Executing create.go multiple times will generate the following type of output:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":"multiple times will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2j3g","search_text":"$ go run create.go -n 100 Going to create 100 goroutines. 5 3 2 4 19 9 0 1 7 11 10 12 13 14 15 31 16 20 17 22 8 18 28 29 21 52 30 45 25 24 49 38 41 46 6 56 57 54 23 26 53 27 59 47 69 66 51 44 71 48 74 33 35 73 39 37 58 40 50 78 85 86 90 67 72 91 32 64 65 95 75 97 99 93 36 60 34 77 94 61 88 89 83 84 43 80 82 87 81 68 92 62 55 98 96 63 76 79 42 70 Exiting... $ go run create.go -n 100 Going to create 100 goroutines. 2 5 3 16 6 7 8 9 1 22 10 12 13 17 11 18 15 14 19 20 31 23 26 21 29 24 30 25 37 32 36 38 35 33 45 41 43 42 40 39 34 44 48 46 47 56 53 50 0 49 55 59 58 28 54 27 60 4 57 51 52 64 61 65 72 62 63 67 69 66 74 73 71 75 89 70 76 84 85 68 79 80 93 97 83 82 99 78 88 91 92 77 81 95 94 98 87 90 96 86 Exiting... ","text_count":718,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run create.go -n 100\nGoing to create 100 goroutines.\n5 3 2 4 19 9 0 1 7 11 10 12 13 14 15 31 16 20 17 22 8 18 28 29 21 52 30 45 25 24 49 38 41 46 6 56 57 54 23 26 53 27 59 47 69 66 51 44 71 48 74 33 35 73 39 37 58 40 50 78 85 86 90 67 72 91 32 64 65 95 75 97 99 93 36 60 34 77 94 61 88 89 83 84 43 80 82 87 81 68 92 62 55 98 96 63 76 79 42 70\nExiting...\n$ go run create.go -n 100\nGoing to create 100 goroutines.\n2 5 3 16 6 7 8 9 1 22 10 12 13 17 11 18 15 14 19 20 31 23 26 21 29 24 30 25 37 32 36 38 35 33 45 41 43 42 40 39 34 44 48 46 47 56 53 50 0 49 55 59 58 28 54 27 60 4 57 51 52 64 61 65 72 62 63 67 69 66 74 73 71 75 89 70 76 84 85 68 79 80 93 97 83 82 99 78 88 91 92 77 81 95 94 98 87 90 96 86\nExiting..."}]}]},{"block_type":"element","block":"k6pz2j3h","search_text":"Once again, you can see that the output is nondeterministic and messy in the sense that you will have to search the output to find what you are looking for. Additionally, if you do not use a suitable delay in the time.Sleep() call, you will not be able to see the output of the goroutines. The time.Second might be OK for now, but this kind of code can cause nasty and unpredictable bugs down the road.","text_count":402,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, you can see that the output is nondeterministic and messy in the sense that you will have to search the output to find what you are looking for. Additionally, if you do not use a suitable delay in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call, you will not be able to see the output of the goroutines. The&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Second"}]},{"block_type":"text","content":"might be OK for now, but this kind of code can cause nasty and unpredictable bugs down the road."}]},{"block_type":"element","block":"k6pz2j3i","search_text":"In the next section, you will learn how to give your goroutines enough time to finish what they are doing before your program ends without the need to call time.Sleep() .","text_count":170,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next section, you will learn how to give your goroutines enough time to finish what they are doing before your program ends without the need to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j3j","search_text":"Waiting for your goroutines to finish","text_count":37,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Waiting for your goroutines to finish"}]},{"block_type":"element","block":"k6pz2j3k","search_text":"This section will present a way that prevents the main() function from ending while it is waiting for its goroutines to finish, using the sync package. The logic of the syncGo.go program will be based on create.go , which was presented in the previous section.","text_count":260,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a way that prevents the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function from ending while it is waiting for its goroutines to finish, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package. The logic of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"program will be based on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create.go"}]},{"block_type":"text","content":", which was presented in the previous section."}]},{"block_type":"element","block":"k6pz2j3l","search_text":"The first part of syncGo.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j3m","search_text":"package main import ( \"flag\" \"fmt\" \"sync\" ) ","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"flag\" \n    \"fmt\" \n    \"sync\" \n)"}]}]},{"block_type":"element","block":"k6pz2j3n","search_text":"As you can see in the preceding code block, there is no need for importing and using the time package, as we will use the functionality of the sync package and wait for as long as necessary for all the goroutines to end.","text_count":220,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see in the preceding code block, there is no need for importing and using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package, as we will use the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package and wait for as long as necessary for all the goroutines to end."}]},{"block_type":"element","block":"k6pz2j3o","search_text":"Note In Chapter 10, Go Concurrency – Advanced Topics, you will study two techniques for timing out goroutines when they are taking longer than expected. ","text_count":153,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Go&nbsp;Concurrency &ndash; Advanced Topics,"}]},{"block_type":"text","content":"&nbsp;you will study two techniques for timing out goroutines when they are taking longer than expected."}]}]},{"block_type":"element","block":"k6pz2j3p","search_text":"The second code segment of syncGo.go is shown in the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j3q","search_text":"func main() { n := flag.Int(\"n\", 20, \"Number of goroutines\") flag.Parse() count := *n fmt.Printf(\"Going to create %d goroutines.\\n\", count) var waitGroup sync.WaitGroup ","text_count":169,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    n := flag.Int(\"n\", 20, \"Number of goroutines\") \n    flag.Parse() \n    count := *n \n    fmt.Printf(\"Going to create %d goroutines.\\n\", count) \n \n    var waitGroup sync.WaitGroup"}]}]},{"block_type":"element","block":"k6pz2j3r","search_text":"In the preceding Go code, you define a sync.WaitGroup variable. If you look at the source code of the sync Go package, and more specifically at the waitgroup.go file that is located inside the sync directory, you will see that the sync.WaitGroup type is nothing more than a structure with three fields:","text_count":302,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you define a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"variable. If you look at the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"Go package, and more specifically at the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"waitgroup.go"}]},{"block_type":"text","content":"file that is located inside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"directory, you will see that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"type is nothing more than a structure with three fields:"}]},{"block_type":"element","block":"k6pz2j3s","search_text":"type WaitGroup struct { noCopy noCopy state1 [12]byte sema uint32 } ","text_count":68,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type WaitGroup struct { \n        noCopy noCopy \n        state1 [12]byte \n        sema   uint32 \n    }"}]}]},{"block_type":"element","block":"k6pz2j3t","search_text":"The output of syncGo.go will reveal more information about the way the sync.WaitGroup variables work. The number of goroutines that belong to a sync.WaitGroup group is defined by one or multiple calls to the sync.Add() function.","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"will reveal more information about the way the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"variables work. The number of goroutines that belong to a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"group is defined by one or multiple calls to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2j3u","search_text":"The third part of syncGo.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j3v","search_text":"fmt.Printf(\"%#v\\n\", waitGroup) for i := 0; i < count; i++ { waitGroup.Add(1) go func(x int) { defer waitGroup.Done() fmt.Printf(\"%d \", x) }(i) } ","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Printf(\"%#v\\n\", waitGroup) \n    for i := 0; i &lt; count; i++ { \n        waitGroup.Add(1) \n        go func(x int) { \n            defer waitGroup.Done() \n            fmt.Printf(\"%d \", x) \n        }(i) \n    }"}]}]},{"block_type":"element","block":"k6pz2j3w","search_text":"Here you create the desired number of goroutines using a for loop. (You could have used multiple sequential Go statements instead.)","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you create the desired number of goroutines using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. (You could have used multiple sequential Go statements instead.)"}]},{"block_type":"element","block":"k6pz2j3x","search_text":"Each call to sync.Add() increases a counter in a sync.WaitGroup variable. Notice that it is really important to call sync.Add(1) before the go statement in order to prevent any race conditions. When each goroutine finishes its job, the sync.Done() function will be executed, which will decrease the same counter.","text_count":312,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Each call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"increases a counter in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"variable. Notice that it is really important to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add(1)"}]},{"block_type":"text","content":"before the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go"}]},{"block_type":"text","content":"statement in order to prevent any race conditions. When each goroutine finishes its job, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"function will be executed, which will decrease the same counter."}]},{"block_type":"element","block":"k6pz2j3y","search_text":"The last code portion of syncGo.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j3z","search_text":"fmt.Printf(\"%#v\\n\", waitGroup) waitGroup.Wait() fmt.Println(\"\\nExiting...\") } ","text_count":78,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Printf(\"%#v\\n\", waitGroup) \n    waitGroup.Wait() \n    fmt.Println(\"\\nExiting...\") \n}"}]}]},{"block_type":"element","block":"k6pz2j40","search_text":"The sync.Wait() call blocks until the counter in the relevant sync.WaitGroup variable is zero, giving your goroutines time to finish.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Wait()"}]},{"block_type":"text","content":"call blocks until the counter in the relevant"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"variable is zero, giving your goroutines time to finish."}]},{"block_type":"element","block":"k6pz2j41","search_text":"Executing syncGo.go will create the following output:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2j42","search_text":"$ go run syncGo.go Going to create 20 goroutines. sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x14, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 19 7 8 9 10 11 12 13 14 15 16 17 0 1 2 5 18 4 6 3 Exiting... $ go run syncGo.go -n 30 Going to create 30 goroutines. sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 1 0 4 5 17 7 8 9 10 11 12 13 2 sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x17, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 29 15 6 27 24 25 16 22 14 23 18 26 3 19 20 28 21 Exiting... $ go run syncGo.go -n 30 Going to create 30 goroutines. sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x1e, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 29 1 7 8 2 9 10 11 12 4 13 15 0 6 5 22 25 23 16 28 26 20 19 24 21 14 3 17 18 27 Exiting...","text_count":1157,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run syncGo.go\nGoing to create 20 goroutines.\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x14, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\n19 7 8 9 10 11 12 13 14 15 16 17 0 1 2 5 18 4 6 3\nExiting...\n$ go run syncGo.go -n 30\nGoing to create 30 goroutines.\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\n1 0 4 5 17 7 8 9 10 11 12 13 2 sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x17, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\n29 15 6 27 24 25 16 22 14 23 18 26 3 19 20 28 21\nExiting...\n$ go run syncGo.go -n 30\nGoing to create 30 goroutines.\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x1e, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\n29 1 7 8 2 9 10 11 12 4 13 15 0 6 5 22 25 23 16 28 26 20 19 24 21 14 3 17 18 27\nExiting..."}]}]},{"block_type":"element","block":"k6pz2j43","search_text":"The output of syncGo.go still varies from execution to execution, especially if you are dealing with a large number of goroutines. Most of the time this is acceptable; however, there are times when this is not the desired behavior. Additionally, when the number of goroutines is 30, some of the goroutines have finished their job before the second fmt.Printf(\"%#v\\n\", waitGroup) statement. Finally, note that one of the elements of the state1 field in sync.WaitGroup is the one that holds the counter which increases and decreases according to the sync.Add() and sync.Done() calls.","text_count":581,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"still varies from execution to execution, especially if you are dealing with a large number of goroutines. Most of the time this is acceptable; however, there are times when this is not the desired behavior. Additionally, when the number of goroutines is 30, some of the goroutines have finished their job before the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf(\"%#v\\n\", waitGroup)"}]},{"block_type":"text","content":"statement. Finally, note that one of the elements of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"state1"}]},{"block_type":"text","content":"field in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"is the one that holds the counter which increases and decreases according to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"calls."}]},{"block_type":"element","block":"k6pz2j44","search_text":"What if the number of Add() and Done() calls do not agree?","text_count":58,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"What if the number of Add() and Done() calls do not agree?"}]},{"block_type":"element","block":"k6pz2j45","search_text":"When the number of the sync.Add() and sync.Done() calls are equal, everything will be fine in your programs. However, this section will tell you what will happen when these two numbers do not agree with each other.","text_count":214,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When the number of the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"&nbsp;and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"calls are equal, everything will be fine in your programs. However, this section will tell you what will happen when these two numbers do not agree with each other."}]},{"block_type":"element","block":"k6pz2j46","search_text":"If you have executed more sync.Add() calls than sync.Done() calls, in this case, by adding a waitGroup.Add(1) statement before the first fmt.Printf(\"%#v\\n\", waitGroup) statement of the syncGo.go program, then the output of the go run command will be similar to the following:","text_count":275,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you have executed more"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"calls than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"calls, in this case, by adding a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"waitGroup.Add(1)"}]},{"block_type":"text","content":"statement before the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf(\"%#v\\n\", waitGroup)"}]},{"block_type":"text","content":"statement of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"program, then the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"command will be similar to the following:"}]},{"block_type":"element","block":"k6pz2j47","search_text":"$ go run syncGo.go Going to create 20 goroutines. sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x15, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 19 10 11 12 13 17 18 8 5 4 6 14 1 0 7 3 2 15 9 16 fatal error: all goroutines are asleep - deadlock! goroutine 1 [semacquire]: sync.runtime_Semacquire(0xc4200120bc) /usr/local/Cellar/go/1.9.3/libexec/src/runtime/sema.go:56 +0x39 sync.(*WaitGroup).Wait(0xc4200120b0) /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:131 +0x72 main.main() /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:28 +0x2d7 exit status 2 ","text_count":723,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run syncGo.go \nGoing to create 20 goroutines. \nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} \nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x15, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} \n19 10 11 12 13 17 18 8 5 4 6 14 1 0 7 3 2 15 9 16 fatal error: all goroutines are asleep - deadlock! \n \ngoroutine 1 [semacquire]: \nsync.runtime_Semacquire(0xc4200120bc) \n        /usr/local/Cellar/go/1.9.3/libexec/src/runtime/sema.go:56 +0x39 \nsync.(*WaitGroup).Wait(0xc4200120b0) \n        /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:131 +0x72 \nmain.main() \n        /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:28 +0x2d7 \nexit status 2"}]}]},{"block_type":"element","block":"k6pz2j48","search_text":"The error message is pretty clear: fatal error: all goroutines are asleep - deadlock! So, this happened because you told your program to wait for n+1 goroutines by calling the sync.Add(1) function n+1 times while only n sync.Done() statements were executed by your n goroutines! As a result, the sync.Wait() call will wait indefinitely for one or more calls to sync.Done() without any luck, which is obviously a deadlock situation.","text_count":431,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The error message is pretty clear:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fatal error: all goroutines are asleep - deadlock!"}]},{"block_type":"text","content":"So, this happened because you told your program to wait for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n+1"}]},{"block_type":"text","content":"goroutines by calling the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add(1)"}]},{"block_type":"text","content":"&nbsp;function&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n+1"}]},{"block_type":"text","content":"times while only"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n sync.Done()"}]},{"block_type":"text","content":"statements were executed by your"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"goroutines! As a result, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Wait()"}]},{"block_type":"text","content":"call will wait indefinitely for one or more calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"without any luck, which is obviously a deadlock situation."}]},{"block_type":"element","block":"k6pz2j49","search_text":"If you have made fewer sync.Add() calls than sync.Done() calls, which can be emulated by adding a waitGroup.Done() statement after the for loop of the syncGo.go program, then the go run output will be similar to the following:","text_count":226,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you have made fewer"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"calls than"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"calls, which can be emulated by adding a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"waitGroup.Done()"}]},{"block_type":"text","content":"statement after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syncGo.go"}]},{"block_type":"text","content":"program, then the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run"}]},{"block_type":"text","content":"output will be similar to the following:"}]},{"block_type":"element","block":"k6pz2j4a","search_text":"$ go run syncGo.go Going to create 20 goroutines. sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} sync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x12, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0} 19 6 1 2 9 7 8 15 13 0 14 16 17 3 11 4 5 12 18 10 panic: sync: negative WaitGroup counter goroutine 22 [running]: sync.(*WaitGroup).Add(0xc4200120b0, 0xffffffffffffffff) /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:75 +0x134 sync.(*WaitGroup).Done(0xc4200120b0) /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:100 +0x34 main.main.func1(0xc4200120b0, 0x11) /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:25 +0xd8 created by main.main /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:21 +0x206 exit status 2 ","text_count":838,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run syncGo.go\nGoing to create 20 goroutines.\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\nsync.WaitGroup{noCopy:sync.noCopy{}, state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x12, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}\n19 6 1 2 9 7 8 15 13 0 14 16 17 3 11 4 5 12 18 10 panic: sync: negative WaitGroup counter\n    \ngoroutine 22 [running]:\nsync.(*WaitGroup).Add(0xc4200120b0, 0xffffffffffffffff)\n        /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:75 +0x134\nsync.(*WaitGroup).Done(0xc4200120b0)\n        /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:100 +0x34\nmain.main.func1(0xc4200120b0, 0x11)\n        /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:25 +0xd8\ncreated by main.main\n        /Users/mtsouk/Desktop/masterGo/ch/ch9/code/syncGo.go:21 +0x206\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2j4b","search_text":"Once again, the root of the problem is stated pretty clearly: panic: sync: negative WaitGroup counter .","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, the root of the problem is stated pretty clearly:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic: sync: negative WaitGroup counter"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j4c","search_text":"Although the error messages are very descriptive in both cases and will help you solve the real problem, you should be very careful with the number of sync.Add() and sync.Done() calls that you put into your programs. Additionally, notice that in the second error case ( panic: sync: negative WaitGroup counter ), the problem might not appear all of the time.","text_count":358,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the error messages are very descriptive in both cases and will help you solve the real problem, you should be very careful with the number of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"calls that you put into your programs. Additionally, notice that in the second error case ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"panic: sync: negative WaitGroup counter"}]},{"block_type":"text","content":"), the problem might not appear all of the time."}]},{"block_type":"element","block":"k6pz2j4d","search_text":"Channels","text_count":8,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Channels"}]},{"block_type":"element","block":"k6pz2j4e","search_text":"A channel is a communication mechanism that allows goroutines to exchange data, among other things. However, there are some definite rules here. First, each channel allows the exchange of a particular data type, which is also called the element type of the channel, and second, for a channel to operate properly, you will need someone to receive what is sent via the channel. You should declare a new channel using the chan keyword, and you can close a channel using the close() function.","text_count":488,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"channel"}]},{"block_type":"text","content":"is a communication mechanism that allows goroutines to exchange data, among other things. However, there are some definite rules here. First, each channel allows the exchange of a particular data type, which is also called the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"element type"}]},{"block_type":"text","content":"of the channel, and second, for a channel to operate properly, you will need someone to receive what is sent via the channel. You should declare a new channel using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chan"}]},{"block_type":"text","content":"keyword, and you can close a channel using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"close()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2j4f","search_text":"Finally, a very important detail: when you are using a channel as a function parameter, you can specify its direction; that is, whether it is going to be used for sending or receiving. In my opinion, if you know the purpose of a channel in advance, you should use this capability because it will make your programs more robust as well as safer because you will not be able to send data accidentally to a channel from which you should only receive data or receive data from a channel to which you should only be sending data. As a result, if you declare that a channel function parameter will be used for reading only and you try to write to it, you will get an error message that will most likely save you from nasty bugs. We will talk about this later on in this chapter.","text_count":772,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, a very important detail: when you are using a channel as a function parameter, you can specify its direction; that is, whether it is going to be used for sending or receiving. In my opinion, if you know the purpose of a channel in advance, you should use this capability because it will make your programs more robust as well as safer because you will not be able to send data accidentally to a channel from which you should only receive data or receive data from a channel to which you should only be sending data. As a result, if you declare that a channel function parameter will be used for reading only and you try to write to it, you will get an error message that will most likely save you from nasty bugs. We will talk about this later on in this chapter."}]},{"block_type":"element","block":"k6pz2j4g","search_text":"Note Although you will learn many things about channels in this chapter, you will have to wait for Chapter 10, Go Concurrency –Advanced Topics , to fully understand the power and flexibility that channels offer to the Go developer. ","text_count":232,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you will learn many things about channels in this chapter, you will have to wait for Chapter 10,&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go&nbsp;Concurrency&nbsp;&ndash;Advanced Topics"}]},{"block_type":"text","content":", to fully understand the power and flexibility that channels offer to the Go developer."}]}]},{"block_type":"element","block":"k6pz2j4h","search_text":"Writing to a channel","text_count":20,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Writing to a channel"}]},{"block_type":"element","block":"k6pz2j4i","search_text":"The code in this subsection will teach you how to write to a channel. Writing the x value to the c channel is as easy as writing c <- x . The arrow shows the direction of the value, and you will have no problem with this statement as long as both x and c have the same type. The example code in this section is saved in writeCh.go , and it will be presented in three parts.","text_count":373,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code in this subsection will teach you how to write to a channel. Writing the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"&nbsp;value&nbsp;to the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;is as easy as writing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c &lt;- x"}]},{"block_type":"text","content":". The arrow shows the direction of the value, and you will have no problem with this statement as long as both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"have the same type. The example code in this section is saved in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2j4j","search_text":"The first code segment from writeCh.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j4k","search_text":"package main import ( \"fmt\" \"time\" ) func writeToChannel(c chan int, x int) { fmt.Println(x) c <- x close(c) fmt.Println(x) } ","text_count":126,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n) \n \nfunc writeToChannel(c chan int, x int) { \n    fmt.Println(x) \n    c &lt;- x \n    close(c) \n    fmt.Println(x) \n}"}]}]},{"block_type":"element","block":"k6pz2j4l","search_text":"The chan keyword is used for declaring that the c function parameter will be a channel, and it should be followed by the type of the channel ( int ). The c <- x statement allows you to write the x value to the c channel, and the close() function closes the channel; that is, it makes communicating with it impossible.","text_count":317,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chan"}]},{"block_type":"text","content":"keyword is used for declaring that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"function parameter will be a channel, and it should be followed by the type of the channel ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"). The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c &lt;- x"}]},{"block_type":"text","content":"statement allows you to write the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"x"}]},{"block_type":"text","content":"&nbsp;value&nbsp;to the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"&nbsp;channel, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"close()"}]},{"block_type":"text","content":"function closes the channel; that is, it makes communicating with it impossible."}]},{"block_type":"element","block":"k6pz2j4m","search_text":"The second part of writeCh.go contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j4n","search_text":"func main() { c := make(chan int) ","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    c := make(chan int)"}]}]},{"block_type":"element","block":"k6pz2j4o","search_text":"In the preceding code, you will find the definition of a channel variable which is named c , and for the first time in this chapter you're using the make() function as well as the chan keyword. All channels have a type associated with them.","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you will find the definition of a channel variable which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":", and for the first time in this chapter you're using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"make()"}]},{"block_type":"text","content":"function as well as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chan"}]},{"block_type":"text","content":"keyword. All channels have a type associated with them."}]},{"block_type":"element","block":"k6pz2j4p","search_text":"The remaining code from writeCh.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j4q","search_text":"go writeToChannel(c, 10) time.Sleep(1 * time.Second) } ","text_count":55,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go writeToChannel(c, 10) \n    time.Sleep(1 * time.Second) \n}"}]}]},{"block_type":"element","block":"k6pz2j4r","search_text":"Here you execute the writeToChannel() function as a goroutine and call time.Sleep() in order to give enough time to the writeToChannel() function to execute.","text_count":157,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeToChannel()"}]},{"block_type":"text","content":"function as a goroutine and call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"in order to give enough time to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeToChannel()"}]},{"block_type":"text","content":"function to execute."}]},{"block_type":"element","block":"k6pz2j4s","search_text":"Executing writeCh.go will create the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2j4t","search_text":"$ go run writeCh.go 10","text_count":22,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run writeCh.go\n10"}]}]},{"block_type":"element","block":"k6pz2j4u","search_text":"The strange thing here is that the writeToChannel() function printed the given value only once. The cause of this unexpected output is that the second fmt.Println(x) statement is never executed. The reason for this is pretty simple once you understand how channels work: the c <- x statement is blocking the execution of the rest of the writeChannel() function because nobody is reading what was written to the c channel. Therefore, when the time.Sleep(1 * time.Second) statement finishes, the program terminates without waiting for writeChannel() .","text_count":549,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The strange thing here is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeToChannel()"}]},{"block_type":"text","content":"function printed the given value only once. The cause of this unexpected output is that the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(x)"}]},{"block_type":"text","content":"statement is never executed. The reason for this is pretty simple once you understand how channels work: the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c &lt;- x"}]},{"block_type":"text","content":"statement is blocking the execution of the rest of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeChannel()"}]},{"block_type":"text","content":"function because nobody is reading what was written to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"channel. Therefore, when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(1 * time.Second)"}]},{"block_type":"text","content":"statement finishes, the program terminates without waiting for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeChannel()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2j4v","search_text":"The next section will illustrate how to read data from a channel.","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next section will illustrate how to read data from a channel."}]},{"block_type":"element","block":"k6pz2j4w","search_text":"Reading from a channel","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Reading from a channel"}]},{"block_type":"element","block":"k6pz2j4x","search_text":"In this subsection, you will learn how to read from a channel. You can read a single value from a channel named c by executing <-c . In this case, the direction is from the channel to the outer world.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to read from a channel. You can read a single value from a channel named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"by executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;-c"}]},{"block_type":"text","content":". In this case, the direction is from the channel to the outer world."}]},{"block_type":"element","block":"k6pz2j4y","search_text":"The name of the program that I will use to help you understand how to read from a channel is readCh.go , and it will be presented in three parts.","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program that I will use to help you understand how to read from a channel is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2j4z","search_text":"The first code segment from readCh.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j50","search_text":"package main import ( \"fmt\" \"time\" ) func writeToChannel(c chan int, x int) { fmt.Println(\"1\", x) c <- x close(c) fmt.Println(\"2\", x) } ","text_count":136,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n) \n \nfunc writeToChannel(c chan int, x int) { \n    fmt.Println(\"1\", x) \n    c &lt;- x \n    close(c) \n    fmt.Println(\"2\", x) \n}"}]}]},{"block_type":"element","block":"k6pz2j51","search_text":"The implementation of the writeToChannel() function is the same as before.","text_count":74,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeToChannel()"}]},{"block_type":"text","content":"function is the same as before."}]},{"block_type":"element","block":"k6pz2j52","search_text":"The second part of readCh.go follows next:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j53","search_text":"func main() { c := make(chan int) go writeToChannel(c, 10) time.Sleep(1 * time.Second) fmt.Println(\"Read:\", <-c) time.Sleep(1 * time.Second) ","text_count":141,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    c := make(chan int) \n    go writeToChannel(c, 10) \n    time.Sleep(1 * time.Second) \n    fmt.Println(\"Read:\", &lt;-c) \n    time.Sleep(1 * time.Second)"}]}]},{"block_type":"element","block":"k6pz2j54","search_text":"In the preceding code, you read from the c channel using the <-c notation. If you want to store that value to a variable named k instead of just printing it, you can use a k := <-c statement. The second time.Sleep(1 * time.Second) statement gives you the time to read from the channel.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you read from the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;-c"}]},{"block_type":"text","content":"notation. If you want to store that value to a variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"instead of just printing it, you can use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k := &lt;-c"}]},{"block_type":"text","content":"statement. The second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(1 * time.Second)"}]},{"block_type":"text","content":"statement gives you the time to read from the channel."}]},{"block_type":"element","block":"k6pz2j55","search_text":"The last code portion of readCh.go contains the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j56","search_text":"_, ok := <-c if ok { fmt.Println(\"Channel is open!\") } else { fmt.Println(\"Channel is closed!\") } } ","text_count":100,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"_, ok := &lt;-c \n    if ok { \n        fmt.Println(\"Channel is open!\") \n    } else { \n        fmt.Println(\"Channel is closed!\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j57","search_text":"In the preceding code, you can see a technique for determining whether a given channel is open or not. The current Go code works fine when the channel is closed; however, if the channel were open, the Go code presented here would have discarded the read value of the channel because of the use of the _ character in the _, ok := <-c statement. Use a proper variable name instead of _ if you also want to read the value of the channel in case it is open.","text_count":453,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see a technique for determining whether a given channel is open or not. The current Go code works fine when the channel is closed; however, if the channel were open, the Go code presented here would have discarded the read value of the channel because of the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_"}]},{"block_type":"text","content":"character in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_, ok := &lt;-c"}]},{"block_type":"text","content":"statement. Use a proper variable name instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_"}]},{"block_type":"text","content":"if you also want to read the value of the channel in case it is open."}]},{"block_type":"element","block":"k6pz2j58","search_text":"Executing readCh.go will generate the following output:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2j59","search_text":"$ go run readCh.go 1 10 Read: 10 2 10 Channel is closed! $ go run readCh.go 1 10 2 10 Read: 10 Channel is closed! ","text_count":114,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run readCh.go\n1 10\nRead: 10\n2 10\nChannel is closed!\n$ go run readCh.go\n1 10\n2 10\nRead: 10\nChannel is closed!"}]}]},{"block_type":"element","block":"k6pz2j5a","search_text":"Although the output is still not deterministic, both the fmt.Println(x) statements of the writeToChannel() function are executed because the channel is unblocked when you read from it.","text_count":184,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the output is still not deterministic, both the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Println(x)"}]},{"block_type":"text","content":"statements of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeToChannel()"}]},{"block_type":"text","content":"function are executed because the channel is unblocked when you read from it."}]},{"block_type":"element","block":"k6pz2j5b","search_text":"Channels as function parameters","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Channels as function parameters"}]},{"block_type":"element","block":"k6pz2j5c","search_text":"Although neither readCh.go nor writeCh.go used this feature, Go allows you to specify the direction of a channel when used as a function parameter; that is, whether it will be used for reading or writing. These two types of channels are called unidirectional channels , whereas, by default, channels are bidirectional.","text_count":318,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although neither"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readCh.go"}]},{"block_type":"text","content":"nor"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeCh.go"}]},{"block_type":"text","content":"used this feature, Go allows you to specify the direction of a channel when used as a function parameter; that is, whether it will be used for reading or writing. These two types of channels are called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"unidirectional channels"}]},{"block_type":"text","content":", whereas, by default, channels are bidirectional."}]},{"block_type":"element","block":"k6pz2j5d","search_text":"Examine the Go code of the following two functions:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Examine the Go code of the following two functions:"}]},{"block_type":"element","block":"k6pz2j5e","search_text":"func f1(c chan int, x int) { fmt.Println(x) c <- x } func f2(c chan<- int, x int) { fmt.Println(x) c <- x } ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f1(c chan int, x int) { \n    fmt.Println(x) \n    c &lt;- x \n} \nfunc f2(c chan&lt;- int, x int) { \n    fmt.Println(x) \n    c &lt;- x \n}"}]}]},{"block_type":"element","block":"k6pz2j5f","search_text":"Although both functions implement the same functionality, their definitions are slightly different. The difference is created by the <- symbol found on the right of the chan keyword in the definition of the f2() function. This denotes that the c channel can be used for writing only. If the code of a Go function attempts to read from a write-only channel ( send-only channel ) parameter, the Go compiler will generate the following error message:","text_count":447,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although both functions implement the same functionality, their definitions are slightly different. The difference is created by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;-"}]},{"block_type":"text","content":"symbol found on the right of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chan"}]},{"block_type":"text","content":"keyword in the definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"function. This denotes that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"channel can be used for writing only. If the code of a Go function attempts to read from a write-only channel ("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"send-only channel"}]},{"block_type":"text","content":") parameter, the Go compiler will generate the following error message:"}]},{"block_type":"element","block":"k6pz2j5g","search_text":"# command-line-arguments a.go:19:11: invalid operation: range in (receive from send-only type chan<- int)","text_count":105,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"# command-line-arguments\na.go:19:11: invalid operation: range in (receive from send-only type chan&lt;- int)"}]}]},{"block_type":"element","block":"k6pz2j5h","search_text":"Similarly, you can have the following function definitions:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, you can have the following function definitions:"}]},{"block_type":"element","block":"k6pz2j5i","search_text":"func f1(out chan<- int64, in <-chan int64) { fmt.Println(x) c <- x } func f2(out chan int64, in chan int64) { fmt.Println(x) c <- x } ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f1(out chan&lt;- int64, in &lt;-chan int64) { \n    fmt.Println(x) \n    c &lt;- x \n} \n \nfunc f2(out chan int64, in chan int64) { \n    fmt.Println(x) \n    c &lt;- x \n}"}]}]},{"block_type":"element","block":"k6pz2j5j","search_text":"The definition of f2() combines a read-only channel named in with a write-only channel named out . If you accidentally try to write and close a read-only channel ( receive-only channel ) parameter of a function, you will get the following error message:","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"combines a read-only channel named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"in"}]},{"block_type":"text","content":"with a write-only channel named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":". If you accidentally try to write and close a read-only channel ("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"receive-only channel"}]},{"block_type":"text","content":") parameter of a function, you will get the following error message:"}]},{"block_type":"element","block":"k6pz2j5k","search_text":"# command-line-arguments a.go:13:7: invalid operation: out <- i (send to receive-only type <-chan int) a.go:15:7: invalid operation: close(out) (cannot close receive-only channel)","text_count":179,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"# command-line-arguments\na.go:13:7: invalid operation: out &lt;- i (send to receive-only type &lt;-chan int)\na.go:15:7: invalid operation: close(out) (cannot close receive-only channel)"}]}]},{"block_type":"element","block":"k6pz2j5l","search_text":"Pipelines","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Pipelines"}]},{"block_type":"element","block":"k6pz2j5m","search_text":"A pipeline is a virtual method for connecting goroutines and channels so that the output of one goroutine becomes the input of another goroutine, using channels to transfer your data.","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"pipeline"}]},{"block_type":"text","content":"is a virtual method for connecting goroutines and channels so that the output of one goroutine becomes the input of another goroutine, using channels to transfer your data."}]},{"block_type":"element","block":"k6pz2j5n","search_text":"One of the benefits that you get from using pipelines is that there is a constant data flow in your program, as no goroutine and channel have to wait for everything to be completed in order to start their execution. Additionally, you are using fewer variables and therefore less memory space because you do not have to save everything as a variable. Finally, the use of pipelines simplifies the design of the program and improves its maintainability.","text_count":450,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One of the benefits that you get from using pipelines is that there is a constant data flow in your program, as no goroutine and channel have to wait for everything to be completed in order to start their execution. Additionally, you are using fewer variables and therefore less memory space because you do not have to save everything as a variable. Finally, the use of pipelines simplifies the design of the program and improves its maintainability."}]},{"block_type":"element","block":"k6pz2j5o","search_text":"Pipelines will be illustrated using the code of pipeline.go . This program will be presented in six parts. The task performed by the pipeline.go program is to generate random numbers in a given range and stop when any number in the random sequence appears a second time. However, before terminating, the program will print the sum of all random numbers that appeared up to the point where the first random number appeared a second time. You will need three functions for connecting the channels of the program. The logic of the program is found in these three functions, but the data flows in the channels of the pipeline.","text_count":622,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Pipelines will be illustrated using the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":". This program will be presented in six parts. The task performed by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"program is to generate random numbers in a given range and stop when any number in the random sequence appears a second time. However, before terminating, the program will print the sum of all random numbers that appeared up to the point where the first random number appeared a second time. You will need three functions for connecting the channels of the program. The logic of the program is found in these three functions, but the data flows in the channels of the pipeline."}]},{"block_type":"element","block":"k6pz2j5p","search_text":"This program will have two channels. The first channel (channel A) will be used for getting the random numbers from the first function and sending them to the second function. The second channel (channel B) will be used by the second function for sending the acceptable random numbers to the third function. The third function will be responsible for getting the data from channel B, calculating it, and presenting the results.","text_count":427,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This program will have two channels. The first channel (channel A) will be used for getting the random numbers from the first function and sending them to the second function. The second channel (channel B) will be used by the second function for sending the acceptable random numbers to the third function. The third function will be responsible for getting the data from channel B, calculating it, and presenting the results."}]},{"block_type":"element","block":"k6pz2j5q","search_text":"The first code segment of pipeline.go contains the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j5r","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" \"time\" ) var CLOSEA = false var DATA = make(map[int]bool) ","text_count":113,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n) \n \nvar CLOSEA = false \n \nvar DATA = make(map[int]bool)"}]}]},{"block_type":"element","block":"k6pz2j5s","search_text":"As the second() function will need a way to tell the first() function to close the first channel, I will use a global variable named CLOSEA for that. The CLOSEA variable is only checked by the first() function, and it can only be altered by the second() function.","text_count":263,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function will need a way to tell the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":"function to close the first channel, I will use a global variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CLOSEA"}]},{"block_type":"text","content":"for that. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CLOSEA"}]},{"block_type":"text","content":"variable is only checked by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":"function, and it can only be altered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2j5t","search_text":"The second part of pipeline.go as shown in the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"as shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j5u","search_text":"func random(min, max int) int { return rand.Intn(max-min) + min } func first(min, max int, out chan<- int) { for { if CLOSEA { close(out) return } out <- random(min, max) } } ","text_count":175,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func random(min, max int) int { \n    return rand.Intn(max-min) + min \n} \n \nfunc first(min, max int, out chan&lt;- int) { \n    for { \n        if CLOSEA { \n            close(out) \n            return \n        } \n        out &lt;- random(min, max) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j5v","search_text":"The preceding code presents the implementation of two functions named random() and first() . You are already familiar with the random() function that generates random numbers in a given range. However, the first() function is really interesting as it keeps running using a for loop until a Boolean variable ( CLOSEA ) becomes true . In that case, it will close its out channel.","text_count":377,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code presents the implementation of two functions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"random()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":". You are already familiar with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"random()"}]},{"block_type":"text","content":"function that generates random numbers in a given range. However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":"function is really interesting as it keeps running using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop until a Boolean variable ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CLOSEA"}]},{"block_type":"text","content":") becomes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":". In that case, it will close its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":"channel."}]},{"block_type":"element","block":"k6pz2j5w","search_text":"The third code segment of pipeline.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j5x","search_text":"func second(out chan<- int, in <-chan int) { for x := range in { fmt.Print(x, \" \") _, ok := DATA[x] if ok { CLOSEA = true } else { DATA[x] = true out <- x } } fmt.Println() close(out) } ","text_count":186,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func second(out chan&lt;- int, in &lt;-chan int) { \n    for x := range in { \n        fmt.Print(x, \" \") \n        _, ok := DATA[x] \n        if ok { \n            CLOSEA = true \n        } else { \n            DATA[x] = true \n                out &lt;- x \n        } \n    } \n    fmt.Println() \n    close(out) \n}"}]}]},{"block_type":"element","block":"k6pz2j5y","search_text":"The second() function receives data from the in channel and keeps sending it to the out channel. However, as soon as the second() function finds a random number that already exists in the DATA map, it sets the CLOSEA global variable to true and stops sending any more numbers to the out channel. After that, it closes the out channel.","text_count":334,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function receives data from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"in"}]},{"block_type":"text","content":"channel and keeps sending it to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":"channel. However, as soon as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function finds a random number that already exists in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DATA"}]},{"block_type":"text","content":"map, it sets the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"CLOSEA"}]},{"block_type":"text","content":"global variable to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"and stops sending any more numbers to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":"channel. After that, it closes the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":"channel."}]},{"block_type":"element","block":"k6pz2j5z","search_text":"The fourth code portion of pipeline.go is shown in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j60","search_text":"func third(in <-chan int) { var sum int sum = 0 for x2 := range in { sum = sum + x2 } fmt.Printf(\"The sum of the random numbers is %d\\n\", sum) } ","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func third(in &lt;-chan int) { \n    var sum int \n    sum = 0 \n    for x2 := range in { \n        sum = sum + x2 \n    } \n    fmt.Printf(\"The sum of the random numbers is %d\\n\", sum) \n}"}]}]},{"block_type":"element","block":"k6pz2j61","search_text":"The third() function keeps reading from the in function parameter channel. When that channel is closed by the second() function, the for loop will stop getting any more data and the function will display its output. At this point, it should become clear that the second() function controls many things.","text_count":302,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"third()"}]},{"block_type":"text","content":"function keeps reading from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"in"}]},{"block_type":"text","content":"function parameter channel. When that channel is closed by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop will stop getting any more data and the function will display its output. At this point, it should become clear that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function controls many things."}]},{"block_type":"element","block":"k6pz2j62","search_text":"The fifth code segment of pipeline.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j63","search_text":"func main() { if len(os.Args) != 3 { fmt.Println(\"Need two integer parameters!\") os.Exit(1) } n1, _ := strconv.Atoi(os.Args[1]) n2, _ := strconv.Atoi(os.Args[2]) if n1 > n2 { fmt.Printf(\"%d should be smaller than %d\\n\", n1, n2) return } ","text_count":237,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 3 { \n        fmt.Println(\"Need two integer parameters!\") \n        os.Exit(1) \n    } \n \n    n1, _ := strconv.Atoi(os.Args[1]) \n    n2, _ := strconv.Atoi(os.Args[2]) \n \n    if n1 &gt; n2 { \n        fmt.Printf(\"%d should be smaller than %d\\n\", n1, n2) \n        return \n   }"}]}]},{"block_type":"element","block":"k6pz2j64","search_text":"The last part of the of the pipeline.go program follows next:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"program follows next:"}]},{"block_type":"element","block":"k6pz2j65","search_text":"rand.Seed(time.Now().UnixNano()) A := make(chan int) B := make(chan int) go first(n1, n2, A) go second(B, A) third(B) } ","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"rand.Seed(time.Now().UnixNano()) \n    A := make(chan int) \n    B := make(chan int) \n \n    go first(n1, n2, A) \n    go second(B, A) \n    third(B) \n}"}]}]},{"block_type":"element","block":"k6pz2j66","search_text":"Here you define the required channels, and you execute two goroutines and one function. The third() function is what prevents main() from returning, because it is not executed as a goroutine.","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you define the required channels, and you execute two goroutines and one function. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"third()"}]},{"block_type":"text","content":"function is what prevents"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"from returning, because it is not executed as a goroutine."}]},{"block_type":"element","block":"k6pz2j67","search_text":"Executing pipeline.go will produce the following type of output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"will produce the following type of output:"}]},{"block_type":"element","block":"k6pz2j68","search_text":"$ go run pipeline.go 1 10 2 2 The sum of the random numbers is 2 $ go run pipeline.go 1 10 9 7 8 4 3 3 The sum of the random numbers is 31 $ go run pipeline.go 1 10 1 6 9 7 1 The sum of the random numbers is 23 $ go run pipeline.go 10 20 16 19 16 The sum of the random numbers is 35 $ go run pipeline.go 10 20 10 16 17 11 15 10 The sum of the random numbers is 69 $ go run pipeline.go 10 20 12 11 14 15 10 15 The sum of the random numbers is 62 ","text_count":445,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run pipeline.go 1 10\n2 2\nThe sum of the random numbers is 2\n$ go run pipeline.go 1 10\n9 7 8 4 3 3\nThe sum of the random numbers is 31\n$ go run pipeline.go 1 10\n1 6 9 7 1\nThe sum of the random numbers is 23\n$ go run pipeline.go 10 20\n16 19 16\nThe sum of the random numbers is 35\n$ go run pipeline.go 10 20\n10 16 17 11 15 10\nThe sum of the random numbers is 69\n$ go run pipeline.go 10 20\n12 11 14 15 10 15\nThe sum of the random numbers is 62"}]}]},{"block_type":"element","block":"k6pz2j69","search_text":"The important point here is that although the first() function keeps generating random numbers at its own pace and the second() function will print all of them on your screen, the unwanted random numbers, that is, the random numbers that have already appeared, will not be sent to the third() function, and therefore, will not be included in the final sum!","text_count":356,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The important point here is that although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":"function keeps generating random numbers at its own pace and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"second()"}]},{"block_type":"text","content":"function will print all of them on your screen, the unwanted random numbers, that is, the random numbers that have already appeared, will not be sent to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"third()"}]},{"block_type":"text","content":"function, and therefore, will not be included in the final sum!"}]},{"block_type":"element","block":"k6pz2j6a","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2j6b","search_text":"Visit the following useful resources:","text_count":37,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the following useful resources:"}]},{"block_type":"element","block":"k6pz2j6c","search_text":"The documentation page of the sync package, which can be found at https://golang.org/pkg/sync/ . The documentation page of the sync package once more. Pay close attention to the sync.Mutex and sync.RWMutex types that will appear in the next chapter. ","text_count":250,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/sync/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/sync/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package once more. Pay close attention to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"types that will appear in the next chapter."}]}]}]},{"block_type":"element","block":"k6pz2j6d","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2j6e","search_text":"Create a pipeline that reads text files, finds the number of occurrences of a given phrase in each text file, and calculates the total number of occurrences of the phrase in all files. Create a pipeline for calculating the sum of the squares of all of the natural numbers in a given range. Remove the time.Sleep(1 * time.Second) statement from the simple.go program and see what happens. Why does this happen? Modify the Go code of pipeline.go in order to create a pipeline with five functions and the appropriate number of channels. Modify the Go code of pipeline.go in order to find out what will happen when you forget to close the out channel of the first() function. ","text_count":672,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Create a pipeline that reads text files, finds the number of occurrences of a given phrase in each text file, and calculates the total number of occurrences of the phrase in all files."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Create a pipeline for calculating the sum of the squares of all of the natural numbers in a given range."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Remove the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(1 * time.Second)"}]},{"block_type":"text","content":"&nbsp;statement from the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simple.go"}]},{"block_type":"text","content":"&nbsp;program and see what happens. Why does this happen?"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"&nbsp;in order to create a pipeline with five functions and the appropriate number of channels."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pipeline.go"}]},{"block_type":"text","content":"in order to find out what will happen when you forget to close the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"out"}]},{"block_type":"text","content":"channel of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"first()"}]},{"block_type":"text","content":"function."}]}]}]},{"block_type":"element","block":"k6pz2j6f","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2j6g","search_text":"In this chapter, you learned many unique Go features, including goroutines, channels, and pipelines. Additionally, you found out how to give your goroutines enough time to finish their jobs using the functionality offered by the sync package. Finally, you learned that channels can be used as parameters to Go functions. This allows developers to create pipelines where your data can flow.","text_count":389,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, you learned many unique Go features, including goroutines, channels, and pipelines. Additionally, you found out how to give your goroutines enough time to finish their jobs using the functionality offered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package. Finally, you learned that channels can be used as parameters to Go functions. This allows developers to create pipelines where your data can flow."}]},{"block_type":"element","block":"k6pz2j6h","search_text":"The next chapter will continue talking about Go concurrency by introducing the formidable select keyword. This keyword helps Go channels perform many interesting jobs, and I think that you will be truly amazed by its power. After this, you will see two techniques that allow you to time out one or more goroutines that are stalled for some reason. Afterwards, you will learn about nil channels, signal channels, channel of channels, and buffered channels, as well as the context package.","text_count":487,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next chapter will continue talking about Go concurrency by introducing the formidable"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword. This keyword helps Go channels perform many interesting jobs, and I think that you will be truly amazed by its power. After this, you will see two techniques that allow you to time out one or more goroutines that are stalled for some reason. Afterwards, you will learn about nil channels, signal channels, channel of channels, and buffered channels, as well as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2j6i","search_text":"You will also learn about shared memory in the next chapter, which is the traditional way of sharing information among the threads of the same Unix process which also applies to goroutines. Nevertheless, shared memory is not that popular among Go programmers because Go offers better, safer, and faster ways for goroutines to exchange data.","text_count":340,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will also learn about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"shared memory"}]},{"block_type":"text","content":"in the next chapter, which is the traditional way of sharing information among the threads of the same Unix process which also applies to goroutines. Nevertheless, shared memory is not that popular among Go programmers because Go offers better, safer, and faster ways for goroutines to exchange data."}]}]},{"title":"Go Concurrency &ndash; Advanced Topics","author":"Mihalis Tsoukalos","block":"k6pz24o7","number":10,"contents":[{"block_type":"element","block":"k6pz2j6j","search_text":"The previous chapter introduced goroutines, which is the most important feature of Go, channels, and pipelines. This chapter will continue from the point where the previous one left off in order to learn more about goroutines, channels, and the select keyword before discussing shared variables and the sync.Mutex and sync.RWMutex types. This chapter also includes code examples that demonstrate the use of signal channels, buffered channels, nil channels, and channels of channels. Additionally, early on in this chapter, you will learn two techniques for timing out a goroutine after a given amount of time, because nobody can guarantee that all goroutines will finish before a desired time. The chapter will end by examining race conditions, the context standard Go package, and worker pools.","text_count":795,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The previous chapter introduced goroutines, which is the most important feature of Go, channels, and pipelines. This chapter will continue from the point where the previous one left off in order to learn more about goroutines, channels, and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword before discussing&nbsp;shared variables and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"types. This chapter also includes code examples that demonstrate the use of signal channels, buffered channels, nil channels, and channels of channels. Additionally, early on in this chapter, you will learn two techniques for timing out a goroutine after a given amount of time, because nobody can guarantee that all goroutines will finish before a desired time. The chapter will end by examining race conditions, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"standard Go package, and worker pools."}]},{"block_type":"element","block":"k6pz2j6k","search_text":"In this chapter of Mastering Go , you will learn the following topics:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2j6l","search_text":"The select keyword How the Go scheduler works Two techniques that allow you to time-out a goroutine which takes longer than expected to finish Signals channels Buffered channels Nil channels Monitor goroutines Channels of channels Shared memory and mutexes The sync.Mutex and the sync.RWMutex types The context package and its functionality Worker pools Detecting race conditions ","text_count":380,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"How the Go scheduler works"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Two techniques that allow you to time-out a goroutine which takes longer than expected to finish"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Signals channels"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Buffered channels"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Nil channels"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Monitor goroutines"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Channels of channels"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Shared memory and mutexes"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"types"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package and its functionality"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Worker pools"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Detecting race conditions"}]}]},{"block_type":"element","block":"k6pz2j6m","search_text":"The Go scheduler revisited","text_count":26,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The Go scheduler revisited"}]},{"block_type":"element","block":"k6pz2j6n","search_text":"A scheduler is responsible for distributing the amount of work to be done over the available resources in an efficient way. In this section, we will examine the way that the Go scheduler operates in much greater depth than in the previous chapter. As you already know, Go works using the m:n scheduler (or M:N scheduler ) that schedules goroutines—which are lighter than OS threads—using OS threads. First, though, let's review the necessary theory and the definition of some useful terms.","text_count":489,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"scheduler"}]},{"block_type":"text","content":"is responsible for distributing the amount of work to be done over the available resources in an efficient way. In this section, we will examine the way that the Go scheduler operates in much greater depth than in the previous chapter. As you already know, Go works using the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"m:n scheduler"}]},{"block_type":"text","content":"(or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"M:N scheduler"}]},{"block_type":"text","content":") that schedules goroutines&mdash;which are lighter than OS threads&mdash;using OS threads. First, though, let's review the necessary theory and the definition of some useful terms."}]},{"block_type":"element","block":"k6pz2j6o","search_text":"Go uses the fork-join concurrency model. The fork part of the model states that a child branch can be created at any point of a program. Analogously, the join part of the Go concurrency model is where the child branch will end and join with its parent. Among other things, both sync.Wait() statements and channels that collect the results of goroutines are join points, whereas any new goroutine creates a child branch.","text_count":419,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go uses the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"fork-join concurrency"}]},{"block_type":"text","content":"model. The fork part of the model states that a child branch can be created at any point of a program. Analogously, the join part of the Go concurrency model is where the child branch will end and join with its parent. Among other things, both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Wait()"}]},{"block_type":"text","content":"statements and channels that collect the results of goroutines are join points, whereas any new goroutine creates a child branch."}]},{"block_type":"element","block":"k6pz2j6p","search_text":"Note The fork phase of the fork-join model and the fork(2) C system call are two totally different things. ","text_count":107,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fork phase of the fork-join model and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fork(2)"}]},{"block_type":"text","content":"C system call are two totally different things."}]}]},{"block_type":"element","block":"k6pz2j6q","search_text":"The fair scheduling strategy , which is pretty straightforward and has a simple implementation, shares evenly all the load between the available processors. At first, this might look like the perfect strategy because it does not have to take many things into consideration while keeping all processors equally occupied. It turns out that this is not exactly the case because most of the distributed tasks usually depend on other tasks. Therefore, at the end of the day, some processors are underutilized, or equivalently, some processors are utilized more than others.","text_count":568,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"fair scheduling strategy"}]},{"block_type":"text","content":", which is pretty straightforward and has a simple implementation, shares evenly all the load between the available processors. At first, this might look like the perfect strategy because it does not have to take many things into consideration while keeping all processors equally occupied. It turns out that this is not exactly the case because most of the distributed tasks usually depend on other tasks. Therefore, at the end of the day, some processors are underutilized, or equivalently, some processors are utilized more than others."}]},{"block_type":"element","block":"k6pz2j6r","search_text":"A goroutine in Go is a task , whereas everything after the calling statement of a goroutine is a continuation . In the work stealing strategy used by Go scheduler, a (logical) processor that is underutilized looks for additional work from other processors. When it finds such jobs, it steals them from the other processor(s), hence the name, work stealing strategy . Additionally, the work-stealing algorithm of Go queues and steals continuations. A stalling join , as is suggested by its name, is a point where a thread of execution stalls at a join and starts looking for other work to do. Although both task stealing and continuation stealing have stalling joins, continuations happen more often than tasks; therefore, the Go algorithm works with continuations rather than tasks.","text_count":782,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A goroutine in Go is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"task"}]},{"block_type":"text","content":", whereas everything after the calling statement of a goroutine is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"continuation"}]},{"block_type":"text","content":". In the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"work stealing strategy"}]},{"block_type":"text","content":"used by Go scheduler, a (logical) processor that is underutilized looks for additional work from other processors. When it finds such jobs, it steals them from the other processor(s), hence the name,&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"work stealing strategy"}]},{"block_type":"text","content":". Additionally, the work-stealing algorithm of Go queues and steals continuations. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"stalling join"}]},{"block_type":"text","content":", as is suggested by its name, is a point where a thread of execution stalls at a join and starts looking for other work to do. Although both task stealing and continuation stealing have stalling joins, continuations happen more often than tasks; therefore, the Go algorithm works with continuations rather than tasks."}]},{"block_type":"element","block":"k6pz2j6s","search_text":"The main disadvantage of continuation stealing is that it requires extra work from the compiler of the programming language. Fortunately, Go provides that extra help and therefore uses continuation stealing in its work-stealing algorithm.","text_count":238,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main disadvantage of continuation stealing is that it requires extra work from the compiler of the programming language. Fortunately, Go provides that extra help and therefore uses"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"continuation stealing"}]},{"block_type":"text","content":"in its work-stealing algorithm."}]},{"block_type":"element","block":"k6pz2j6t","search_text":"One of the benefits of continuation stealing is that you get the same results when using just functions or a single thread with multiple goroutines. This makes perfect sense as only one thing is executed at any given time in both cases.","text_count":236,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One of the benefits of continuation stealing is that you get the same results when using just functions or a single thread with multiple goroutines. This makes perfect sense as only one thing is executed at any given time in both cases."}]},{"block_type":"element","block":"k6pz2j6u","search_text":"Now, let's return back to the m:n scheduling algorithm used in Go. Strictly speaking, at any time, you have m goroutines that are executed, and therefore scheduled to run, on n OS threads, using the most GOMAXPROCS number of logical processors. You will learn about GOMAXPROCS shortly.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now, let's return back to the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"m:n scheduling"}]},{"block_type":"text","content":"algorithm used in Go. Strictly speaking, at any time, you have"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"m"}]},{"block_type":"text","content":"goroutines that are executed, and therefore scheduled to run, on"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"OS threads, using the most"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"number of logical processors. You will learn about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"shortly."}]},{"block_type":"element","block":"k6pz2j6v","search_text":"The Go scheduler works using three main kinds of entities: OS threads (M) that are related to the operating system in use, goroutines (G), and logical processors (P). The number of processors that can be used by a Go program is specified by the GOMAXPROCS environment variable —at any given time there are most GOMAXPROCS processors.","text_count":333,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go scheduler works using three main kinds of entities: OS threads (M) that are related to the operating system in use, goroutines (G), and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"logical processors"}]},{"block_type":"text","content":"(P). The number of processors that can be used by a Go program is specified by the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS environment variable"}]},{"block_type":"text","content":"&mdash;at any given time there are most"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"processors."}]},{"block_type":"element","block":"k6pz2j6w","search_text":"The following figure illustrates this point:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following figure illustrates this point:"}]},{"block_type":"element","block":"k6pz2j6x","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000010.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2j6y","search_text":"How the Go scheduler works","text_count":26,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"How the Go scheduler works"}]},{"block_type":"element","block":"k6pz2j6z","search_text":"What the illustration tells us is that there are two different kinds of queues: a global queue and a local queue attached to each logical processor. Goroutines from the global queue are assigned to the queue of a logical processor in order to be executed. As a result, the Go scheduler needs to check the global queue in order to avoid executing goroutines that are only located at the local queue of each logical processor. However, the global queue is not checked all of the time, which means that it does not have an advantage over the local queues. Additionally, each logical processor can have multiple threads, and the stealing occurs between the local queues of the available logical processors. Finally, keep in mind that the Go scheduler is allowed to create more OS threads when needed. OS threads are pretty expensive, however, which means that dealing with OS threads too much might slow down your Go applications.","text_count":926,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What the illustration tells us is that there are two different kinds of queues: a global queue and a local queue attached to each logical processor. Goroutines from the global queue are assigned to the queue of a logical processor in order to be executed. As a result, the Go scheduler needs to check the global queue in order to avoid executing goroutines that are only located at the local queue of each logical processor. However, the global queue is not checked all of the time, which means that it does not have an advantage over the local queues. Additionally, each logical processor can have multiple threads, and the stealing occurs between the local queues of the available logical processors. Finally, keep in mind that the Go scheduler is allowed to create more OS threads when needed. OS threads are pretty expensive, however, which means that dealing with OS threads too much might slow down your Go applications."}]},{"block_type":"element","block":"k6pz2j70","search_text":"Keep in mind that using more goroutines in a program is not a panacea for performance, as more goroutines in addition to the various calls to sync.Add() , sync.Wait() , and sync.Done() might slow down your program due to the extra work that needs to be done by the Go scheduler.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Keep in mind that using more goroutines in a program is not a panacea for performance, as more goroutines in addition to the various calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Add()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Wait()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"might slow down your program due to the extra work that needs to be done by the Go scheduler."}]},{"block_type":"element","block":"k6pz2j71","search_text":"Note The Go scheduler, as most Go components, is always evolving, which means that the people who work on the Go scheduler continually try to improve its performance by making small changes in the way it works. The core principles, however, remain the same. ","text_count":258,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go scheduler, as most Go components, is always evolving, which means that the people who work on the Go scheduler continually try to improve its performance by making small changes in the way it works. The core principles, however, remain the same."}]}]},{"block_type":"element","block":"k6pz2j72","search_text":"Are all these details useful? I think they are! Do you need to know all of these in order to write Go code that uses goroutines? Absolutely not! However, knowing what occurs behind the scenes can definitely help you when strange things start happening, or if you are curious about how the Go scheduler works. It will certainly make you a better developer!","text_count":355,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Are all these details useful? I think they are! Do you need to know all of these in order to write Go code that uses goroutines? Absolutely not! However, knowing what occurs behind the scenes can definitely help you when strange things start happening, or if you are curious about how the Go scheduler works. It will certainly make you a better developer!"}]},{"block_type":"element","block":"k6pz2j73","search_text":"The GOMAXPROCS environment variable","text_count":35,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The GOMAXPROCS environment variable"}]},{"block_type":"element","block":"k6pz2j74","search_text":"The GOMAXPROCS environment variable (and Go function) allows you to limit the number of operating system threads that can execute user-level Go code simultaneously. Starting with Go version 1.5, the default value of GOMAXPROCS should be the number of cores available in your Unix machine.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"environment variable (and Go function) allows you to limit the number of operating system threads that can execute user-level Go code simultaneously. Starting with Go version 1.5, the default value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"should be the number of cores available in your Unix machine."}]},{"block_type":"element","block":"k6pz2j75","search_text":"If you decide to assign a value to GOMAXPROCS that is less than the number of the cores in your Unix machine, you might affect the performance of your program. However, using a GOMAXPROCS value that is larger than the number of the available cores will not necessarily make your program run faster.","text_count":298,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you decide to assign a value to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"that is less than the number of the cores in your Unix machine, you might affect the performance of your program. However, using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"value that is larger than the number of the available cores will not necessarily make your program run faster."}]},{"block_type":"element","block":"k6pz2j76","search_text":"You can programmatically discover the value of the GOMAXPROCS environment variable, that is, the relevant code. It is be found in the following maxprocs.go program:","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can programmatically discover the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"environment variable, that is, the relevant code. It is be found in the following"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"maxprocs.go"}]},{"block_type":"text","content":"program:"}]},{"block_type":"element","block":"k6pz2j77","search_text":"package main import ( \"fmt\" \"runtime\" ) func getGOMAXPROCS() int { return runtime.GOMAXPROCS(0) } func main() { fmt.Printf(\"GOMAXPROCS: %d\\n\", getGOMAXPROCS()) } ","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"runtime\" \n) \n \nfunc getGOMAXPROCS() int { \n    return runtime.GOMAXPROCS(0) \n} \n \nfunc main() { \n    fmt.Printf(\"GOMAXPROCS: %d\\n\", getGOMAXPROCS()) \n}"}]}]},{"block_type":"element","block":"k6pz2j78","search_text":"Executing maxprocs.go on a machine with an Intel i7 processor will produce the following output:","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"maxprocs.go"}]},{"block_type":"text","content":"on a machine with an Intel i7 processor will produce the following output:"}]},{"block_type":"element","block":"k6pz2j79","search_text":"$ go run maxprocs.go GOMAXPROCS: 8","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run maxprocs.go\nGOMAXPROCS: 8"}]}]},{"block_type":"element","block":"k6pz2j7a","search_text":"You can modify the previous output by changing the value of the GOMAXPROCS environment variable prior to the execution of the program, however. The following commands are executed in the bash(1) Unix shell:","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can modify the previous output by changing the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"environment variable prior to the execution of the program, however. The following commands are executed in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bash(1)"}]},{"block_type":"text","content":"Unix shell:"}]},{"block_type":"element","block":"k6pz2j7b","search_text":"$ go version go version go1.9.4 darwin/amd64 $ export GOMAXPROCS=800; go run maxprocs.go GOMAXPROCS: 800 $ export GOMAXPROCS=4; go run maxprocs.go GOMAXPROCS: 4","text_count":160,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go version\ngo version go1.9.4 darwin/amd64\n$ export GOMAXPROCS=800; go run maxprocs.go\nGOMAXPROCS: 800\n$ export GOMAXPROCS=4; go run maxprocs.go\nGOMAXPROCS: 4"}]}]},{"block_type":"element","block":"k6pz2j7c","search_text":"The select keyword","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The select keyword"}]},{"block_type":"element","block":"k6pz2j7d","search_text":"As you will learn in a short while, the select keyword is pretty powerful and it can do many things in a variety of situations. The select statement in Go looks like a switch statement for channels. In practice, this means that select allows a goroutine to wait on multiple communications operations. Therefore, the main benefit that you receive from select is that it gives you the power to work with multiple channels using a single select block. As a consequence, you can have nonblocking operations on channels.","text_count":515,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will learn in a short while, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword is pretty powerful and it can do many things in a variety of situations. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement in Go looks like a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"switch"}]},{"block_type":"text","content":"statement for channels. In practice, this means that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"allows a goroutine to wait on multiple communications operations. Therefore, the main benefit that you receive from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"is that it gives you the power to work with multiple channels using a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"block. As a consequence, you can have nonblocking operations on channels."}]},{"block_type":"element","block":"k6pz2j7e","search_text":"Tip The biggest problem when using multiple channels and the select keyword is deadlocks . This means that you should be extra careful during the design and the development process in order to avoid such deadlocks. ","text_count":215,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The biggest problem when using multiple channels and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword is"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"deadlocks"}]},{"block_type":"text","content":". This means that you should be extra careful during the design and the development process in order to avoid such deadlocks."}]}]},{"block_type":"element","block":"k6pz2j7f","search_text":"The Go code of select.go will clarify the use of the select keyword. This program will be presented in five parts.","text_count":114,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"will clarify the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword. This program will be presented in five parts."}]},{"block_type":"element","block":"k6pz2j7g","search_text":"The first part of select.go is shown in the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j7h","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" \"time\" ) ","text_count":64,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j7i","search_text":"The second code portion from select.go follows next:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j7j","search_text":"func gen(min, max int, createNumber chan int, end chan bool) { for { select { case createNumber <- rand.Intn(max-min) + min: case <-end: close(end) return case <-time.After(4 * time.Second): fmt.Println(\"n\\time.After()!\") } } } ","text_count":228,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func gen(min, max int, createNumber chan int, end chan bool) { \n    for { \n         select { \n         case createNumber &lt;- rand.Intn(max-min) + min: \n         case &lt;-end: \n               close(end) \n               return \n         case &lt;-time.After(4 * time.Second): \n               fmt.Println(\"n\\time.After()!\") \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j7k","search_text":"So, what is really happening in the code of this select block? This particular select statement has three cases. Note that the select statements do not require a default branch. You can consider the third branch of the select statement as a clever default branch. The time.After() function will return after the specified time has passed, and therefore it will unblock the select statement in case all of the other channels are blocked.","text_count":436,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, what is really happening in the code of this"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"block? This particular"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement has three cases. Note that the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statements do not require a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"branch. You can consider the third branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement as a clever"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"branch. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function will return after the specified time has passed, and therefore it will unblock the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement in case all of the other channels are blocked."}]},{"block_type":"element","block":"k6pz2j7l","search_text":"A select statement is not evaluated sequentially, as all of its channels are examined simultaneously. If none of the channels in a select statement is ready, the select statement will block until one of the channels is ready. If multiple channels of a select statement is ready, then the Go runtime will make a random selection over the set of these ready channels. The Go runtime tries to make this random selection between these ready channels as uniformly and as fairly as possible.","text_count":485,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement is not evaluated sequentially, as all of its channels are examined simultaneously. If none of the channels in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement is ready, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement will block until one of the channels is ready. If multiple channels of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement is ready, then the Go runtime will make a random selection over the set of these ready channels. The Go runtime tries to make this random selection between these ready channels as uniformly and as fairly as possible."}]},{"block_type":"element","block":"k6pz2j7m","search_text":"The third part of select.go is as follows:","text_count":42,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j7n","search_text":"func main() { rand.Seed(time.Now().Unix()) createNumber := make(chan int) end := make(chan bool) if len(os.Args) != 2 { fmt.Println(\"Please give me an integer!\") return } ","text_count":171,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    rand.Seed(time.Now().Unix()) \n    createNumber := make(chan int) \n    end := make(chan bool) \n \n    if len(os.Args) != 2 { \n         fmt.Println(\"Please give me an integer!\") \n         return \n    }"}]}]},{"block_type":"element","block":"k6pz2j7o","search_text":"The fourth code portion of the select.go program contains the following Go code:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code portion of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j7p","search_text":"n, _ := strconv.Atoi(os.Args[1]) fmt.Printf(\"Going to create %d random numbers.\\n\", n) go gen(0, 2*n, createNumber, end) for i := 0; i < n; i++ { fmt.Printf(\"%d \", <-createNumber) } ","text_count":182,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"n, _ := strconv.Atoi(os.Args[1]) \n   fmt.Printf(\"Going to create %d random numbers.\\n\", n) \n   go gen(0, 2*n, createNumber, end) \n \n   for i := 0; i &lt; n; i++ { \n         fmt.Printf(\"%d \", &lt;-createNumber) \n   }"}]}]},{"block_type":"element","block":"k6pz2j7q","search_text":"Note The reason for not examining the error value returned by strconv.Atoi() is to save some space. You should never do this in real applications. ","text_count":147,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for not examining the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"strconv.Atoi()"}]},{"block_type":"text","content":"is to save some space. You should never do this in real applications."}]}]},{"block_type":"element","block":"k6pz2j7r","search_text":"The remaining Go code of the select.go program is as follows:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2j7s","search_text":"time.Sleep(5 * time.Second) fmt.Println(\"Exiting...\") end <- true } ","text_count":68,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"time.Sleep(5 * time.Second) \n   fmt.Println(\"Exiting...\") \n   end &lt;- true \n}"}]}]},{"block_type":"element","block":"k6pz2j7t","search_text":"The main purpose of the time.Sleep(5 * time.Second) statement is to give the time.After() function of gen() , enough time to return, and therefore activate the relevant branch of the select statement.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(5 * time.Second)"}]},{"block_type":"text","content":"statement is to give the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gen()"}]},{"block_type":"text","content":", enough time to return, and therefore activate the relevant branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement."}]},{"block_type":"element","block":"k6pz2j7u","search_text":"The last statement of the main() function is what terminates the program by activating the case <-end branch of the select statement in gen() and executing the related Go code.","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last statement of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function is what terminates the program by activating the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"case &lt;-end"}]},{"block_type":"text","content":"branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gen()"}]},{"block_type":"text","content":"and executing the related Go code."}]},{"block_type":"element","block":"k6pz2j7v","search_text":"Executing select.go will generate the following output:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2j7w","search_text":"$ go run select.go 10 Going to create 10 random numbers. 13 17 8 14 19 9 2 0 19 5 time.After()! Exiting...","text_count":106,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run select.go 10\nGoing to create 10 random numbers.\n13 17 8 14 19 9 2 0 19 5\ntime.After()!\nExiting..."}]}]},{"block_type":"element","block":"k6pz2j7x","search_text":"Note The biggest advantage of select is that it can connect, orchestrate, and manage multiple channels. As channels connect goroutines, select connects channels that connect goroutines. Therefore, the select statement is one of the most important, if not the single most important, part of the Go concurrency model. ","text_count":316,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The biggest advantage of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"is that it can connect, orchestrate, and manage multiple channels. As channels connect goroutines,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"connects channels that connect goroutines. Therefore, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement is one of the most important, if not the single most important, part of the Go concurrency model."}]}]},{"block_type":"element","block":"k6pz2j7y","search_text":"Timing out a goroutine","text_count":22,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Timing out a goroutine"}]},{"block_type":"element","block":"k6pz2j7z","search_text":"This section presents two very important techniques that will help you time out goroutines. Put simply, these two techniques will save you from having to wait forever for a goroutine to finish its job, and they will give you full control over the amount of time that you want to wait for a goroutine to end. Both techniques use the capabilities of the handy select keyword combined with the time.After() function that you experienced in the previous section.","text_count":458,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section presents two very important techniques that will help you time out goroutines. Put simply, these two techniques will save you from having to wait forever for a goroutine to finish its job, and they will give you full control over the amount of time that you want to wait for a goroutine to end. Both techniques use the capabilities of the handy"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword combined with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function that you experienced in the previous section."}]},{"block_type":"element","block":"k6pz2j80","search_text":"Timing out a goroutine – take 1","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Timing out a goroutine&nbsp;&ndash; take 1"}]},{"block_type":"element","block":"k6pz2j81","search_text":"The source code of the first technique will be saved in timeOut1.go , and it will be presented in four parts.","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of the first technique will be saved in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2j82","search_text":"The first part of timeOut1.go is shown in the following Go code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j83","search_text":"package main import ( \"fmt\" \"time\" ) ","text_count":37,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j84","search_text":"The second code segment from timeOut1.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j85","search_text":"func main() { c1 := make(chan string) go func() { time.Sleep(time.Second * 3) c1 <- \"c1 OK\" }() ","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    c1 := make(chan string) \n    go func() { \n         time.Sleep(time.Second * 3) \n         c1 &lt;- \"c1 OK\" \n    }()"}]}]},{"block_type":"element","block":"k6pz2j86","search_text":"The time.Sleep() call is used for emulating the time it will normally take for the function to finish its job. In this case, the anonymous function that is executed as a goroutine will take about 3 seconds ( time.Second * 3 ) before writing a message to the c1 channel.","text_count":269,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call is used for emulating the time it will normally take for the function to finish its job. In this case, the anonymous function that is executed as a goroutine will take about 3 seconds ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Second * 3"}]},{"block_type":"text","content":") before writing a message to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c1"}]},{"block_type":"text","content":"channel."}]},{"block_type":"element","block":"k6pz2j87","search_text":"The third code segment from timeOut1.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j88","search_text":"select { case res := <-c1: fmt.Println(res) case <-time.After(time.Second * 1): fmt.Println(\"timeout c1\") } ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"select { \n    case res := &lt;-c1: \n         fmt.Println(res) \n    case &lt;-time.After(time.Second * 1): \n         fmt.Println(\"timeout c1\") \n    }"}]}]},{"block_type":"element","block":"k6pz2j89","search_text":"The purpose of the time.After() function call is to wait for the chosen time. In this case, you are not interested in the actual value returned by time.After() , but in the fact that the time.After() function call has ended, which means that the time has passed. In this case, as the value passed to the time.After() function is smaller than the value used in the time.Sleep() call that was executed as the goroutine in the previous code segment, you will most likely get a time-out message.","text_count":491,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function call is to wait for the chosen time. In this case, you are not interested in the actual value returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":", but in the fact that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function call has ended, which means that the time has passed. In this case, as the value passed to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function is smaller than the value used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call that was executed as the goroutine in the previous code segment, you will most likely get a time-out message."}]},{"block_type":"element","block":"k6pz2j8a","search_text":"The remaining code from timeOut1.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j8b","search_text":"c2 := make(chan string) go func() { time.Sleep(3 * time.Second) c2 <- \"c2 OK\" }() select { case res := <-c2: fmt.Println(res) case <-time.After(4 * time.Second): fmt.Println(\"timeout c2\") } } ","text_count":192,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"c2 := make(chan string) \n    go func() { \n         time.Sleep(3 * time.Second) \n         c2 &lt;- \"c2 OK\" \n    }() \n \n    select { \n    case res := &lt;-c2: \n         fmt.Println(res) \n    case &lt;-time.After(4 * time.Second): \n         fmt.Println(\"timeout c2\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j8c","search_text":"The preceding code both executes a goroutine that will take about 3 seconds to execute because of the time.Sleep() call, and it defines a timeout period of 4 seconds using time.After(4 * time.Second) . If the time.After(4 * time.Second) call returns after you get a value from the c2 channel found in the first case of the select block, then there will not be any time out; otherwise, you will get a time out! However, in this case, the value of the time.After() call provides enough time to the time.Sleep() call to return, so you will most likely not get a time-out message here.","text_count":581,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code both executes a goroutine that will take about 3 seconds to execute because of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call, and it defines a timeout period of 4 seconds using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After(4 * time.Second)"}]},{"block_type":"text","content":". If the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After(4 * time.Second)"}]},{"block_type":"text","content":"call returns after you get a value from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c2"}]},{"block_type":"text","content":"channel found in the first case of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"block, then there will not be any time out; otherwise, you will get a time out! However, in this case, the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"call provides enough time to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"call to return, so you will most likely not get a time-out message here."}]},{"block_type":"element","block":"k6pz2j8d","search_text":"Executing timeOut1.go will generate the following output:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut1.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2j8e","search_text":"$ go run timeOut1.go timeout c1 c2 OK ","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run timeOut1.go\ntimeout c1\nc2 OK"}]}]},{"block_type":"element","block":"k6pz2j8f","search_text":"As expected, the first goroutine did not finish its job, whereas the second goroutine had enough time to finish.","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As expected, the first goroutine did not finish its job, whereas the second goroutine had enough time to finish."}]},{"block_type":"element","block":"k6pz2j8g","search_text":"Timing out a goroutine – take 2","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Timing out a goroutine&nbsp;&ndash; take 2"}]},{"block_type":"element","block":"k6pz2j8h","search_text":"The source code of the second technique will be saved in timeOut2.go , and it will be presented in five parts. This time, the time-out period is provided as a command-line argument to the program.","text_count":196,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of the second technique will be saved in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":", and it will be presented in five parts. This time, the time-out period is provided as a command-line argument to the program."}]},{"block_type":"element","block":"k6pz2j8i","search_text":"The first part of timeOut2.go is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j8j","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" \"sync\" \"time\" ) ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j8k","search_text":"The second code segment of timeOut2.go is shown in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j8l","search_text":"func timeout(w *sync.WaitGroup, t time.Duration) bool { temp := make(chan int) go func() { time.Sleep(5 * time.Second) defer close(temp) w.Wait() }() select { case <-temp: return false case <-time.After(t): return true } } ","text_count":223,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func timeout(w *sync.WaitGroup, t time.Duration) bool { \n    temp := make(chan int) \n    go func() { \n        time.Sleep(5 * time.Second) \n        defer close(temp) \n        w.Wait() \n    }() \n \n    select { \n    case &lt;-temp: \n        return false \n    case &lt;-time.After(t): \n        return true \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j8m","search_text":"In the preceding code, the time duration that will be used in the time.After() call is a parameter of the timeout() function, which means that it can vary. Once again, the select block implements the logic of the timeout. Additionally, the w.Wait() call will make the timeout() function wait for a matching sync.Done() function indefinitely in order to end. When the w.Wait() call returns, the first branch of the select statement will be executed.","text_count":448,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, the time duration that will be used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"call is a parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"function, which means that it can vary. Once again, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"block implements the logic of the timeout. Additionally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Wait()"}]},{"block_type":"text","content":"call will make the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"function wait for a matching"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"function indefinitely in order to end. When the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Wait()"}]},{"block_type":"text","content":"call returns, the first branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement will be executed."}]},{"block_type":"element","block":"k6pz2j8n","search_text":"The third code portion from timeOut2.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j8o","search_text":"func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"Need a time duration!\") return } var w sync.WaitGroup w.Add(1) t, err := strconv.Atoi(arguments[1]) if err != nil { fmt.Println(err) return } ","text_count":215,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) != 2 { \n         fmt.Println(\"Need a time duration!\") \n         return \n    } \n \n    var w sync.WaitGroup \n    w.Add(1) \n \n    t, err := strconv.Atoi(arguments[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    }"}]}]},{"block_type":"element","block":"k6pz2j8p","search_text":"The fourth part of the timeOut2.go program follows next:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"program follows next:"}]},{"block_type":"element","block":"k6pz2j8q","search_text":"duration := time.Duration(int32(t)) * time.Millisecond fmt.Printf(\"Timeout period is %s\\n\", duration) if timeout(&w, duration) { fmt.Println(\"Timed out!\") } else { fmt.Println(\"OK!\") } ","text_count":185,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"duration := time.Duration(int32(t)) * time.Millisecond \n   fmt.Printf(\"Timeout period is %s\\n\", duration) \n \n   if timeout(&amp;w, duration) { \n        fmt.Println(\"Timed out!\") \n   } else { \n        fmt.Println(\"OK!\") \n   }"}]}]},{"block_type":"element","block":"k6pz2j8r","search_text":"The time.Duration() function converts an integer value into a time.Duration variable that you can use afterwards.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Duration()"}]},{"block_type":"text","content":"function converts an integer value into a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Duration"}]},{"block_type":"text","content":"variable that you can use afterwards."}]},{"block_type":"element","block":"k6pz2j8s","search_text":"The remaining Go code from timeOut2.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j8t","search_text":"w.Done() if timeout(&w, duration) { fmt.Println(\"Timed out!\") } else { fmt.Println(\"OK!\") } } ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"w.Done() \n    if timeout(&amp;w, duration) { \n         fmt.Println(\"Timed out!\") \n    } else { \n         fmt.Println(\"OK!\") \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j8u","search_text":"Once the w.Done() call is executed, the previous timeout() function will return. However, the second call to timeout() has no sync.Done() statement to wait for.","text_count":160,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Done()"}]},{"block_type":"text","content":"call is executed, the previous"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"function will return. However, the second call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"has no"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Done()"}]},{"block_type":"text","content":"statement to wait for."}]},{"block_type":"element","block":"k6pz2j8v","search_text":"Executing timeOut2.go will generate the following type of output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2j8w","search_text":"$ go run timeOut2.go 10000 Timeout period is 10s Timed out! OK!","text_count":63,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run timeOut2.go 10000\nTimeout period is 10s\nTimed out!\nOK!"}]}]},{"block_type":"element","block":"k6pz2j8x","search_text":"In this execution of timeOut2.go , the time-out period is longer than the time.Sleep(5 * time.Second) call of the anonymous goroutine. However, without the required call to w.Done() , the anonymous goroutine cannot return and therefore the time.After(t) call will end first, so the timeout() function of the first if statement will return true . In the second if statement, the anonymous function does not have to wait for anything, so the timeout() function will return false because time.Sleep(5 * time.Second) will finish before time.After(t) :","text_count":547,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeOut2.go"}]},{"block_type":"text","content":", the time-out period is longer than the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(5 * time.Second)"}]},{"block_type":"text","content":"call of the anonymous goroutine. However, without the required call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Done()"}]},{"block_type":"text","content":", the anonymous goroutine cannot return and therefore the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After(t)"}]},{"block_type":"text","content":"call will end first, so the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"function of the first"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement will return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":". In the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement, the anonymous function does not have to wait for anything, so the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"function will return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(5 * time.Second)"}]},{"block_type":"text","content":"will finish before"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After(t)"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2j8y","search_text":"$ go run timeOut2.go 100 Timeout period is 100ms Timed out! Timed out! ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run timeOut2.go 100\nTimeout period is 100ms\nTimed out!\nTimed out!"}]}]},{"block_type":"element","block":"k6pz2j8z","search_text":"In the second program execution, however, the time-out period is too short, so both executions of timeout() do not have enough time to finish, therefore both will be timed out.","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the second program execution, however, the time-out period is too short, so both executions of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"timeout()"}]},{"block_type":"text","content":"do not have enough time to finish, therefore both will be timed out."}]},{"block_type":"element","block":"k6pz2j90","search_text":"So, when defining a time-out period, make sure that you choose an appropriate value or your results might not be what you might expect.","text_count":135,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, when defining a time-out period, make sure that you choose an appropriate value or your results might not be what you might expect."}]},{"block_type":"element","block":"k6pz2j91","search_text":"Go channels revisited","text_count":21,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Go channels revisited"}]},{"block_type":"element","block":"k6pz2j92","search_text":"Once the select keyword comes into play, Go channels can be used in several unique ways to do many more things than what you experienced in Chapter 9, Go Concurrency – Goroutines, Channels, and Pipelines . This section will reveal the many uses of Go channels.","text_count":260,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"keyword comes into play, Go channels can be used in several unique ways to do many more things than what you experienced in Chapter 9,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency &ndash; Goroutines, Channels, and Pipelines"}]},{"block_type":"text","content":". This section will reveal the many uses of Go channels."}]},{"block_type":"element","block":"k6pz2j93","search_text":"It helps to remember that the zero value of the channel type is nil , and that if you send a message to a closed channel, the program will panic. However, if you try to read from a closed channel, you will get the zero value of the type of that channel. So, after closing a channel, you can no longer write to it, but you can still read from it.","text_count":345,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It helps to remember that the zero value of the channel type is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":", and that if you send a message to a closed channel, the program will panic. However, if you try to read from a closed channel, you will get the zero value of the type of that channel. So, after closing a channel, you can no longer write to it, but you can still read from it."}]},{"block_type":"element","block":"k6pz2j94","search_text":"In order to be able to close a channel, the channel must not be receive-only. Additionally, a nil channel always blocks, which means that trying to read or write from a nil channel will block. This property of channels can be very useful when you want to disable a branch of a select statement by assigning the nil value to a channel variable.","text_count":343,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to be able to close a channel, the channel must not be receive-only. Additionally, a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"channel always blocks, which means that trying to read or write from a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"channel will block. This property of channels can be very useful when you want to disable a branch of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement by assigning the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"value to a channel variable."}]},{"block_type":"element","block":"k6pz2j95","search_text":"Finally, if you try to close a nil channel, your program will panic. This is best illustrated in the closeNilChannel.go program, which is presented next:","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, if you try to close a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"channel, your program will panic. This is best illustrated in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"closeNilChannel.go"}]},{"block_type":"text","content":"program, which is presented next:"}]},{"block_type":"element","block":"k6pz2j96","search_text":"package main func main() { var c chan string close(c) } ","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nfunc main() { \n    var c chan string \n    close(c) \n}"}]}]},{"block_type":"element","block":"k6pz2j97","search_text":"Executing closeNilChannel.go will generate the following output:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"closeNilChannel.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2j98","search_text":"$ go run closeNilChannel.go panic: close of nil channel goroutine 1 [running]: main.main() /Users/mtsouk/closeNilChannel.go:5 +0x2a exit status 2","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run closeNilChannel.go\npanic: close of nil channel\n    \ngoroutine 1 [running]:\nmain.main()\n    /Users/mtsouk/closeNilChannel.go:5 +0x2a\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2j99","search_text":"Signal channels","text_count":15,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Signal channels"}]},{"block_type":"element","block":"k6pz2j9a","search_text":"A signal channel is one that is used just for signaling. Put simply, you can use a signal channel when you want to inform somebody else about something. Signal channels should not be used for transferring data.","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"signal channel"}]},{"block_type":"text","content":"is one that is used just for signaling. Put simply, you can use a signal channel when you want to inform somebody else about something. Signal channels should not be used for transferring data."}]},{"block_type":"element","block":"k6pz2j9b","search_text":"Note You should not confuse signal channels with Unix signal handling , which was discussed in Chapter 8, Telling a Unix system What to Do , because these two are totally different things. ","text_count":189,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should not confuse signal channels with"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Unix signal handling"}]},{"block_type":"text","content":", which was discussed in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix system What to Do"}]},{"block_type":"text","content":", because these two are totally different things."}]}]},{"block_type":"element","block":"k6pz2j9c","search_text":"You will see a code example that uses signal channels in the Specifying the order of execution for your goroutines section later in this chapter.","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will see a code example that uses signal channels in the&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Specifying the order of execution for your goroutines"}]},{"block_type":"text","content":"&nbsp;section&nbsp;later in this chapter."}]},{"block_type":"element","block":"k6pz2j9d","search_text":"Buffered channels","text_count":17,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Buffered channels"}]},{"block_type":"element","block":"k6pz2j9e","search_text":"The topic of this subsection is buffered channels . These are channels that allow the Go scheduler to put jobs in the queue quickly in order to be able to deal with more requests. Moreover, you can use buffered channels as semaphores in order to limit the throughput of your application.","text_count":287,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The topic of this subsection is"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"buffered channels"}]},{"block_type":"text","content":". These are channels that allow the Go scheduler to put jobs in the queue quickly in order to be able to deal with more requests. Moreover, you can use buffered channels as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"semaphores"}]},{"block_type":"text","content":"in order to limit the throughput of your application."}]},{"block_type":"element","block":"k6pz2j9f","search_text":"The technique presented here works as follows: All incoming requests are forwarded to a channel, which processes them one by one. When the channel is done processing a request, it sends a message to the original caller saying that it is ready to process a new one. So, the capacity of the buffer of the channel restricts the number of simultaneous requests that it can keep.","text_count":374,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique presented here works as follows:"},{"block_type":"element","tag_name":"br","attributes":{},"children":[]},{"block_type":"text","content":"All incoming requests are forwarded to a channel, which processes them one by one. When the channel is done processing a request, it sends a message to the original caller saying that it is ready to process a new one. So, the capacity of the buffer of the channel restricts the number of simultaneous requests that it can keep."}]},{"block_type":"element","block":"k6pz2j9g","search_text":"The technique will be presented with the help of the code found in bufChannel.go , which is broken into four parts.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique will be presented with the help of the code found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":", which is broken into four parts."}]},{"block_type":"element","block":"k6pz2j9h","search_text":"The first part of the code of bufChannel.go is as follows:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j9i","search_text":"package main import ( \"fmt\" ) ","text_count":30,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2j9j","search_text":"The second code segment of bufChannel.go contains the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2j9k","search_text":"func main() { numbers := make(chan int, 5) counter := 10 ","text_count":57,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    numbers := make(chan int, 5) \n    counter := 10"}]}]},{"block_type":"element","block":"k6pz2j9l","search_text":"The definition presented of the numbers channel gives it a place to store up to five integers.","text_count":94,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition presented of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel gives it a place to store up to five integers."}]},{"block_type":"element","block":"k6pz2j9m","search_text":"The third part of the code of bufChannel.go is shown in the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j9n","search_text":"for i := 0; i < counter; i++ { select { case numbers <- i: default: fmt.Println(\"Not enough space for\", i) } } ","text_count":111,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; counter; i++ { \n    select { \n         case numbers &lt;- i: \n         default: \n               fmt.Println(\"Not enough space for\", i) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j9o","search_text":"In the preceding code, we tried to put 10 integers in the numbers channel. However, as the numbers channel has room for only 5 integers, you will not be able to store all 10 integers in it.","text_count":189,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, we tried to put 10 integers in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel. However, as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel has room for only 5 integers, you will not be able to store all 10 integers in it."}]},{"block_type":"element","block":"k6pz2j9p","search_text":"The remaining Go code of bufChannel.go follows next:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2j9q","search_text":"for i := 0; i < counter+5; i++ { select { case num := <-numbers: fmt.Println(num) default: fmt.Println(\"Nothing more to be done!\") break } } } ","text_count":143,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; counter+5; i++ { \n    select { \n         case num := &lt;-numbers: \n               fmt.Println(num) \n         default: \n               fmt.Println(\"Nothing more to be done!\") \n               break \n         } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2j9r","search_text":"In the preceding Go code, we tried to read the contents of the numbers channel using a for loop and a select statement. As long as there is something to read from the numbers channel, the first branch of the select statement will get executed. As long as the numbers channel is empty, the default branch will be executed.","text_count":321,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, we tried to read the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement. As long as there is something to read from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel, the first branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement will get executed. As long as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"numbers"}]},{"block_type":"text","content":"channel is empty, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"default"}]},{"block_type":"text","content":"branch will be executed."}]},{"block_type":"element","block":"k6pz2j9s","search_text":"Executing bufChannel.go will create the following type of output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufChannel.go"}]},{"block_type":"text","content":"will create the following type of output:"}]},{"block_type":"element","block":"k6pz2j9t","search_text":"$ go run bufChannel.go Not enough space for 5 Not enough space for 6 Not enough space for 7 Not enough space for 8 Not enough space for 9 0 1 2 3 4 Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! Nothing more to be done! ","text_count":398,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run bufChannel.go\nNot enough space for 5\nNot enough space for 6\nNot enough space for 7\nNot enough space for 8\nNot enough space for 9\n0\n1\n2\n3\n4\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!\nNothing more to be done!"}]}]},{"block_type":"element","block":"k6pz2j9u","search_text":"Nil channels","text_count":12,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Nil channels"}]},{"block_type":"element","block":"k6pz2j9v","search_text":"In this subsection, you will learn about nil channels . These are a special kind of channel because they will always block. The use of the nil channels is illustrated in nilChannel.go , which will be presented in four code segments.","text_count":232,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"nil channels"}]},{"block_type":"text","content":". These are a special kind of channel because they will always block. The use of the nil channels is illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":", which will be presented in four code segments."}]},{"block_type":"element","block":"k6pz2j9w","search_text":"The first part of nilChannel.go is as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2j9x","search_text":"package main import ( \"fmt\" \"math/rand\" \"time\" ) ","text_count":49,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2j9y","search_text":"The second code portion of nilChannel.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2j9z","search_text":"func add(c chan int) { sum := 0 t := time.NewTimer(time.Second) for { select { case input := <-c: sum = sum + input case <-t.c: c = nil fmt.Println(sum) } } } ","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func add(c chan int) { \n    sum := 0 \n    t := time.NewTimer(time.Second) \n \n    for { \n         select { \n         case input := &lt;-c: \n               sum = sum + input \n         case &lt;-t.c: \n               c = nil \n               fmt.Println(sum) \n         } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ja0","search_text":"The add() function demonstrates how a nil channel is used. The <-t.C statement blocks the C channel of the t timer for the time that is specified in the time.NewTimer() call. Do not confuse the c channel, which is the parameter of the function, with the t.C channel, which belongs to the t timer. When the time expires, the timer sends a value to the t.C channel. This will trigger the execution of the relevant branch of the select statement, which will assign the nil value to the c channel and print the sum variable.","text_count":520,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"add()"}]},{"block_type":"text","content":"function demonstrates how a nil channel is used. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;-t.C"}]},{"block_type":"text","content":"statement blocks the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;of the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t"}]},{"block_type":"text","content":"&nbsp;timer&nbsp;for the time that is specified in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.NewTimer()"}]},{"block_type":"text","content":"call. Do not confuse the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"&nbsp;channel, which is the parameter of the function, with the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t.C"}]},{"block_type":"text","content":"&nbsp;channel, which belongs to the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t"}]},{"block_type":"text","content":"&nbsp;timer. When the time expires, the timer sends a value to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"t.C"}]},{"block_type":"text","content":"channel. This will trigger the execution of the relevant branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement, which will assign the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"&nbsp;value&nbsp;to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;and print the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sum"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2ja1","search_text":"The third code segment of nilChannel.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2ja2","search_text":"func send(c chan int) { for { c <- rand.Intn(10) } } ","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func send(c chan int) { \n    for { \n         c &lt;- rand.Intn(10) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2ja3","search_text":"The purpose of the send() function is to generate random numbers and continue sending them to a channel for as long as the channel is open.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"send()"}]},{"block_type":"text","content":"function is to generate random numbers and continue sending them to a channel for as long as the channel is open."}]},{"block_type":"element","block":"k6pz2ja4","search_text":"The remaining Go code of nilChannel.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2ja5","search_text":"func main() { c := make(chan int) go add(c) go send(c) time.Sleep(3 * time.Second) } ","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    c := make(chan int) \n    go add(c) \n    go send(c) \n \n    time.Sleep(3 * time.Second) \n}"}]}]},{"block_type":"element","block":"k6pz2ja6","search_text":"The time.Sleep() function is used for giving enough time to the two goroutines to operate.","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"function is used for giving enough time to the two goroutines to operate."}]},{"block_type":"element","block":"k6pz2ja7","search_text":"Executing nilChannel.go will generate the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2ja8","search_text":"$ go run nilChannel.go 13167523 $ go run nilChannel.go 12988362","text_count":63,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run nilChannel.go\n13167523\n$ go run nilChannel.go\n12988362"}]}]},{"block_type":"element","block":"k6pz2ja9","search_text":"Since the number of times that the first branch of the select statement in the add() function will be executed is not fixed, you will get different results from executing nilChannel.go .","text_count":186,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Since the number of times that the first branch of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"add()"}]},{"block_type":"text","content":"function will be executed is not fixed, you will get different results from executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nilChannel.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jaa","search_text":"Channel of channels","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Channel of channels"}]},{"block_type":"element","block":"k6pz2jab","search_text":"A channel of channels is a special kind of channel variable that works with channels instead of other types of variables. Nevertheless, you still have to declare a data type for a channel of channels. You can define a channel of channels using the chan keyword two times in a row, as shown in the following statement:","text_count":317,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"channel of channels"}]},{"block_type":"text","content":"is a special kind of channel variable that works with channels instead of other types of variables. Nevertheless, you still have to declare a data type for a channel of channels. You can define a channel of channels using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chan"}]},{"block_type":"text","content":"keyword two times in a row, as shown in the following statement:"}]},{"block_type":"element","block":"k6pz2jac","search_text":"c1 := make(chan chan int)","text_count":25,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"c1 := make(chan chan int)"}]}]},{"block_type":"element","block":"k6pz2jad","search_text":"Note The other types of channels presented in this chapter are far more popular and handy than a channel of channels. ","text_count":118,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The other types of channels presented in this chapter are far more popular and handy than a channel of channels."}]}]},{"block_type":"element","block":"k6pz2jae","search_text":"The use of channels of channels is illustrated using the code found in chSquare.go , which will be presented in four parts.","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The use of channels of channels is illustrated using the code found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":", which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2jaf","search_text":"The first part of chSquare.go is as follows:","text_count":44,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jag","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" \"time\" ) var times int ","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n) \n \nvar times int"}]}]},{"block_type":"element","block":"k6pz2jah","search_text":"The second code portion from chSquare.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jai","search_text":"func f1(cc chan chan int, f chan bool) { c := make(chan int) cc <- c defer close(c) sum := 0 select { case x := <-c: for i := 0; i <= x; i++ { sum = sum + i } c <- sum case <-f: return } } ","text_count":189,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f1(cc chan chan int, f chan bool) { \n    c := make(chan int) \n    cc &lt;- c \n    defer close(c) \n \n    sum := 0 \n    select { \n    case x := &lt;-c: \n         for i := 0; i &lt;= x; i++ { \n               sum = sum + i \n         } \n         c &lt;- sum \n    case &lt;-f: \n         return \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jaj","search_text":"After declaring a regular int channel, you will send that to the channel of channels variable. Then you use a select statement in order to be able to read data from the regular int channel or exit your function using the f signal channel.","text_count":238,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After declaring a regular"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"channel, you will send that to the channel of channels variable. Then you use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement in order to be able to read data from the regular"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"channel or exit your function using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f"}]},{"block_type":"text","content":"signal channel."}]},{"block_type":"element","block":"k6pz2jak","search_text":"Once you read a single value from the c channel, you start a for loop that calculates the sum of all integers from 0 up to the integer value that you just read. Next, you will send the calculated value to the c int channel and you are done.","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once you read a single value from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c"}]},{"block_type":"text","content":"channel, you start a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that calculates the sum of all integers from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"0"}]},{"block_type":"text","content":"up to the integer value that you just read. Next, you will send the calculated value to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"c int"}]},{"block_type":"text","content":"channel and you are done."}]},{"block_type":"element","block":"k6pz2jal","search_text":"The third part of chSquare.go contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jam","search_text":"func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"Need just one integer argument!\") return } times, err := strconv.Atoi(arguments[1]) if err != nil { fmt.Println(err) return } cc := make(chan chan int) ","text_count":225,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) != 2 { \n         fmt.Println(\"Need just one integer argument!\") \n         return \n    } \n \n    times, err := strconv.Atoi(arguments[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n \n    cc := make(chan chan int)"}]}]},{"block_type":"element","block":"k6pz2jan","search_text":"The last statement in the preceding code is where you declare a channel of channels variable named cc , which is the star of the program because everything depends on that variable: the cc variable is passed to the f1() function, and it will be used in the for loop which is coming next.","text_count":287,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last statement in the preceding code is where you declare a channel of channels variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cc"}]},{"block_type":"text","content":", which is the star of the program because everything depends on that variable: the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cc"}]},{"block_type":"text","content":"variable is passed to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"function, and it will be used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop which is coming next."}]},{"block_type":"element","block":"k6pz2jao","search_text":"The remaining Go code of chSquare.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jap","search_text":"for i := 1; i < times+1; i++ { f := make(chan bool) go f1(cc, f) ch := <-cc ch <- i for sum := range ch { fmt.Print(\"Sum(\", i, \")=\", sum) } fmt.Println() time.Sleep(time.Second) close(f) } } ","text_count":191,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 1; i &lt; times+1; i++ { \n    f := make(chan bool) \n    go f1(cc, f) \n    ch := &lt;-cc \n    ch &lt;- i \n    for sum := range ch { \n               fmt.Print(\"Sum(\", i, \")=\", sum) \n         } \n         fmt.Println() \n         time.Sleep(time.Second) \n         close(f) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jaq","search_text":"The f channel is a signal channel used for ending the goroutine when the real work is finished. The ch := <-cc statement allows you to get a regular channel from the channel of channels variable in order to be able to send an int value to it using ch <- i . After this, you start reading from it using a for loop. Although the f1() function is programmed to send a single value back, you can also read multiple values. Note that each value of i is served by a different goroutine.","text_count":480,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f"}]},{"block_type":"text","content":"channel is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"signal channel"}]},{"block_type":"text","content":"used for ending the goroutine when the real work is finished. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ch := &lt;-cc"}]},{"block_type":"text","content":"statement allows you to get a regular channel from the channel of channels variable in order to be able to send an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"value to it using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ch &lt;- i"}]},{"block_type":"text","content":". After this, you start reading from it using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. Although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"function is programmed to send a single value back, you can also read multiple values. Note that each value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"is served by a different goroutine."}]},{"block_type":"element","block":"k6pz2jar","search_text":"The type of a signal channel can be anything you want, including bool , which is used in the preceding code, and struct{} , which will be used in the signal channel in the next section. The main advantage of a struct{} signal channel is that no data can be sent to it, which can save you from bugs and misconceptions.","text_count":317,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The type of a signal channel can be anything you want, including"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bool"}]},{"block_type":"text","content":", which is used in the preceding code, and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct{}"}]},{"block_type":"text","content":", which will be used in the signal channel in the next section. The main advantage of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct{}"}]},{"block_type":"text","content":"signal channel is that no data can be sent to it, which can save you from bugs and misconceptions."}]},{"block_type":"element","block":"k6pz2jas","search_text":"Executing chSquare.go will generate the following type of output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"chSquare.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2jat","search_text":"$ go run chSquare.go 4 Sum(1)=1 Sum(2)=3 Sum(3)=6 Sum(4)=10 $ go run chSquare.go 6 Sum(1)=1 Sum(2)=3 Sum(3)=6 Sum(4)=10 Sum(5)=15 Sum(6)=21","text_count":139,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run chSquare.go 4\nSum(1)=1\nSum(2)=3\nSum(3)=6\nSum(4)=10\n$ go run chSquare.go 6\nSum(1)=1\nSum(2)=3\nSum(3)=6\nSum(4)=10\nSum(5)=15\nSum(6)=21"}]}]},{"block_type":"element","block":"k6pz2jau","search_text":"Specifying the order of execution for your goroutines","text_count":53,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Specifying the order of execution for your goroutines"}]},{"block_type":"element","block":"k6pz2jav","search_text":"Although you should not make any assumptions about the order in which your goroutines will be executed, there are times when you need to be able to control this order. This subsection illustrates such a technique using signal channels .","text_count":236,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although you should not make any assumptions about the order in which your goroutines will be executed, there are times when you need to be able to control this order. This subsection illustrates such a technique using"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"signal channels"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jaw","search_text":"Tip You might ask why choose to execute goroutines in a given order when simple functions could do the same job much more easily. The answer is simple: goroutines are able to operate concurrently and wait for other goroutines to end, whereas functions executed in sequence cannot do that! ","text_count":289,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might ask why choose to execute goroutines in a given order when simple functions could do the same job much more easily. The answer is simple: goroutines are able to operate concurrently and wait for other goroutines to end, whereas functions executed in sequence cannot do that!"}]}]},{"block_type":"element","block":"k6pz2jax","search_text":"The name of the Go program for this topic is defineOrder.go , and it will be presented in five parts.","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go program for this topic is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":", and it will be presented in five parts."}]},{"block_type":"element","block":"k6pz2jay","search_text":"The first part of defineOrder.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jaz","search_text":"package main import ( \"fmt\" \"time\" ) func A(a, b chan struct{}) { <-a fmt.Println(\"A()!\") time.Sleep(time.Second) close(b) } ","text_count":125,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"time\" \n) \n \nfunc A(a, b chan struct{}) { \n    &lt;-a \n    fmt.Println(\"A()!\") \n    time.Sleep(time.Second) \n    close(b) \n}"}]}]},{"block_type":"element","block":"k6pz2jb0","search_text":"The A() function is blocked by the channel stored in the a parameter. Once that channel is unblocked in the main() function, the A() function will start working. Finally, it will close the b channel, which will unblock another function, in this case function B() .","text_count":264,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"function is blocked by the channel stored in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"parameter. Once that channel is unblocked in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"function will start working. Finally, it will close the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"&nbsp;channel, which will unblock another function, in this case function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jb1","search_text":"The second code portion of defineOrder.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jb2","search_text":"func B(a, b chan struct{}) { <-a fmt.Println(\"B()!\") close(b) } ","text_count":64,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func B(a, b chan struct{}) { \n    &lt;-a \n    fmt.Println(\"B()!\") \n    close(b) \n}"}]}]},{"block_type":"element","block":"k6pz2jb3","search_text":"The logic in B() is the same as in the A() function. The function is blocked until the a channel is closed. Then it does its job and closes the b channel. Note that the a and b channels refer to the names of the parameters of the function.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The logic in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B()"}]},{"block_type":"text","content":"is the same as in the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"&nbsp;function. The function is blocked until the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;is closed. Then it does its job and closes the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"&nbsp;channel. Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"&nbsp;channels&nbsp;refer to the names of the parameters of the function."}]},{"block_type":"element","block":"k6pz2jb4","search_text":"The third code segment of defineOrder.go follows next:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jb5","search_text":"func C(a chan struct{}) { <-a fmt.Println(\"C()!\") } ","text_count":52,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func C(a chan struct{}) { \n    &lt;-a \n    fmt.Println(\"C()!\") \n}"}]}]},{"block_type":"element","block":"k6pz2jb6","search_text":"The C() function is blocked and waits for the a channel to close in order to start working.","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C()"}]},{"block_type":"text","content":"&nbsp;function&nbsp;is blocked and waits for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"a"}]},{"block_type":"text","content":"&nbsp;channel&nbsp;to close in order to start working."}]},{"block_type":"element","block":"k6pz2jb7","search_text":"The fourth part of defineOrder.go contains the following code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2jb8","search_text":"func main() { x := make(chan struct{}) y := make(chan struct{}) z := make(chan struct{}) ","text_count":89,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    x := make(chan struct{}) \n    y := make(chan struct{}) \n    z := make(chan struct{})"}]}]},{"block_type":"element","block":"k6pz2jb9","search_text":"These three channels will be the parameters for the three functions.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"These three channels will be the parameters for the three functions."}]},{"block_type":"element","block":"k6pz2jba","search_text":"The last code segment of defineOrder.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jbb","search_text":"go C(z) go A(x, y) go C(z) go B(y, z) go C(z) close(x) time.Sleep(3 * time.Second) } ","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go C(z) \n    go A(x, y) \n    go C(z) \n    go B(y, z) \n    go C(z) \n \n    close(x) \n    time.Sleep(3 * time.Second) \n}"}]}]},{"block_type":"element","block":"k6pz2jbc","search_text":"Executing defineOrder.go will generate the desired output even though the C() function was called multiple times:","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defineOrder.go"}]},{"block_type":"text","content":"will generate the desired output even though the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C()"}]},{"block_type":"text","content":"&nbsp;function&nbsp;was called multiple times:"}]},{"block_type":"element","block":"k6pz2jbd","search_text":"$ go run defineOrder.go A()! B()! C()! C()! C()!","text_count":48,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run defineOrder.go\nA()!\nB()!\nC()!\nC()!\nC()!"}]}]},{"block_type":"element","block":"k6pz2jbe","search_text":"Calling the C() function multiple times as goroutines will work just fine because C() does not close any channels. However, if you call A() or B() more than once, you will most likely get an error message such as the following:","text_count":227,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Calling the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C()"}]},{"block_type":"text","content":"function multiple times as goroutines will work just fine because"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"C()"}]},{"block_type":"text","content":"does not close any channels. However, if you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B()"}]},{"block_type":"text","content":"more than once, you will most likely get an error message such as the following:"}]},{"block_type":"element","block":"k6pz2jbf","search_text":"$ go run defineOrder.go A()! A()! B()! C()! C()! C()! panic: close of closed channel","text_count":84,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run defineOrder.go\nA()!\nA()!\nB()!\nC()!\nC()!\nC()!\npanic: close of closed channel"}]}]},{"block_type":"element","block":"k6pz2jbg","search_text":"goroutine 7 [running]: main.A(0xc420072060, 0xc4200720c0) /Users/mtsouk/Desktop/defineOrder.go:12 +0x9d created by main.main /Users/mtsouk/Desktop/defineOrder.go:33 +0xfa exit status ","text_count":183,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"goroutine 7 [running]:\nmain.A(0xc420072060, 0xc4200720c0)\n      /Users/mtsouk/Desktop/defineOrder.go:12 +0x9d\ncreated by main.main\n      /Users/mtsouk/Desktop/defineOrder.go:33 +0xfa\nexit status"}]}]},{"block_type":"element","block":"k6pz2jbh","search_text":"As you can see from the output, the A() function was called two times. However, as the A() function closes a channel, one of its goroutines will find that channel already closed and generate a panic situation. You will get a similar panic situation if you call B() more than once.","text_count":280,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the output, the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"&nbsp;function&nbsp;was called two times. However, as the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"A()"}]},{"block_type":"text","content":"&nbsp;function&nbsp;closes a channel, one of its goroutines will find that channel already closed and generate a panic situation. You will get a similar panic situation if you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B()"}]},{"block_type":"text","content":"more than once."}]},{"block_type":"element","block":"k6pz2jbi","search_text":"Shared memory and shared variables","text_count":34,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Shared memory and shared variables"}]},{"block_type":"element","block":"k6pz2jbj","search_text":"Shared memory and shared variables are the most common ways for Unix threads to communicate with each other. A Mutex variable, which is an abbreviation for mutual exclusion variable, is mainly used for thread synchronization and for protecting shared data when multiple writes can occur at the same time. A mutex works like a buffered channel of capacity one, which allows at most one goroutine to access a shared variable at any given time. This means that there is no way for two or more goroutines to try to update that variable simultaneously.","text_count":547,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Shared memory"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"shared variables"}]},{"block_type":"text","content":"are the most common ways for Unix threads to communicate with each other. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Mutex"}]},{"block_type":"text","content":"variable, which is an abbreviation for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"mutual exclusion"}]},{"block_type":"text","content":"variable, is mainly used for thread synchronization and for protecting shared data when multiple writes can occur at the same time. A mutex works like a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"buffered channel"}]},{"block_type":"text","content":"of capacity one, which allows at most one goroutine to access a shared variable at any given time. This means that there is no way for two or more goroutines to try to update that variable simultaneously."}]},{"block_type":"element","block":"k6pz2jbk","search_text":"A critical section of a concurrent program is the code that cannot be executed simultaneously by all processes, threads, or, in this case, by all goroutines. It is the code that needs to be protected by mutexes. Therefore, identifying the critical sections of your code will make the whole programming process so much simpler that you should pay attention to this task.","text_count":369,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"critical section"}]},{"block_type":"text","content":"of a concurrent program is the code that cannot be executed simultaneously by all processes, threads, or, in this case, by all goroutines. It is the code that needs to be protected by mutexes. Therefore, identifying the critical sections of your code will make the whole programming process so much simpler that you should pay attention to this task."}]},{"block_type":"element","block":"k6pz2jbl","search_text":"Note A critical section cannot be embedded in another critical section when both critical sections use the same sync.Mutex or sync.RWMutex variable. Put simply avoid, at almost any cost, spreading mutexes across functions because that makes it really hard to see whether you are embedding or not! ","text_count":297,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A critical section cannot be embedded in another critical section when both critical sections use the same"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"variable. Put simply avoid, at almost any cost, spreading mutexes across functions because that makes it really hard to see whether you are embedding or not!"}]}]},{"block_type":"element","block":"k6pz2jbm","search_text":"The next two subsections will illustrate the use of the sync.Mutex and sync.RWMutex types.","text_count":90,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next two subsections will illustrate the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"&nbsp;and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"types."}]},{"block_type":"element","block":"k6pz2jbn","search_text":"The sync.Mutex type","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The sync.Mutex type"}]},{"block_type":"element","block":"k6pz2jbo","search_text":"The sync.Mutex type is the Go implementation of a mutex. Its definition, which can be found in the mutex.go file of the sync directory, is as follows:","text_count":150,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"type is the Go implementation of a mutex. Its definition, which can be found in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"file of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"directory, is as follows:"}]},{"block_type":"element","block":"k6pz2jbp","search_text":"// A Mutex is a mutual exclusion lock. // The zero value for a Mutex is an unlocked mutex. // // A Mutex must not be copied after first use. type Mutex struct { state int32 sema uint32 } ","text_count":187,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// A Mutex is a mutual exclusion lock. \n// The zero value for a Mutex is an unlocked mutex. \n// \n// A Mutex must not be copied after first use. \ntype Mutex struct { \n    state int32 \n    sema  uint32 \n}"}]}]},{"block_type":"element","block":"k6pz2jbq","search_text":"The definition of the sync.Mutex type is nothing extraordinary. All of the interesting work is being done by the sync.Lock() and sync.Unlock() functions that can lock and unlock a sync.Mutex mutex, respectively. Locking a mutex means that nobody else can lock it until it has been released using the sync.Unlock() function.","text_count":323,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"type is nothing extraordinary. All of the interesting work is being done by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Unlock()"}]},{"block_type":"text","content":"functions that can lock and unlock a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex, respectively. Locking a mutex means that nobody else can lock it until it has been released using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Unlock()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2jbr","search_text":"The mutex.go program, which is going to be presented in five parts, illustrates the use of the sync.Mutex type.","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"program, which is going to be presented in five parts, illustrates the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"type."}]},{"block_type":"element","block":"k6pz2jbs","search_text":"The first code segment of mutex.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jbt","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" \"sync\" \"time\" ) var ( m sync.Mutex v1 int ) ","text_count":87,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n    \"time\" \n) \n \nvar ( \n    m  sync.Mutex \n    v1 int \n)"}]}]},{"block_type":"element","block":"k6pz2jbu","search_text":"The second part of mutex.go is shown in the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jbv","search_text":"func change(i int) { m.Lock() time.Sleep(time.Second) v1 = v1 + 1 if v1%10 == 0 { v1 = v1 - 10*i } m.Unlock() } ","text_count":112,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func change(i int) { \n    m.Lock() \n    time.Sleep(time.Second) \n    v1 = v1 + 1 \n    if v1%10 == 0 { \n          v1 = v1 - 10*i \n   } \n    m.Unlock() \n}"}]}]},{"block_type":"element","block":"k6pz2jbw","search_text":"The critical section of this function is the Go code between the m.Lock() and m.Unlock() statements.","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The critical section of this function is the Go code between the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Unlock()"}]},{"block_type":"text","content":"statements."}]},{"block_type":"element","block":"k6pz2jbx","search_text":"The third part of mutex.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jby","search_text":"func read() int { m.Lock() a := v1 m.Unlock() return a } ","text_count":57,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func read() int { \n    m.Lock() \n    a := v1 \n    m.Unlock() \n    return a \n}"}]}]},{"block_type":"element","block":"k6pz2jbz","search_text":"Similarly, the critical section of this function is defined by the m.Lock() and m.Unlock() statements.","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, the critical section of this function is defined by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Unlock()"}]},{"block_type":"text","content":"statements."}]},{"block_type":"element","block":"k6pz2jc0","search_text":"The fourth code segment of mutex.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jc1","search_text":"func main() { if len(os.Args) != 2 { fmt.Println(\"Please give me an integer!\") return } numGR, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } var waitGroup sync.WaitGroup ","text_count":198,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n         fmt.Println(\"Please give me an integer!\") \n         return \n    } \n \n    numGR, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n    var waitGroup sync.WaitGroup"}]}]},{"block_type":"element","block":"k6pz2jc2","search_text":"The last part of mutex.go is shown in the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jc3","search_text":"fmt.Printf(\"%d \", read()) for i := 0; i < numGR; i++ { waitGroup.Add(1) go func(i int) { defer waitGroup.Done() change(i) fmt.Printf(\"-> %d\", read()) }(i) } waitGroup.Wait() fmt.Printf(\"-> %d\\n\", read()) } ","text_count":206,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Printf(\"%d \", read()) \n    for i := 0; i &lt; numGR; i++ { \n         waitGroup.Add(1) \n         go func(i int) { \n               defer waitGroup.Done() \n               change(i) \n               fmt.Printf(\"-&gt; %d\", read()) \n         }(i) \n   } \n \n    waitGroup.Wait() \n    fmt.Printf(\"-&gt; %d\\n\", read()) \n}"}]}]},{"block_type":"element","block":"k6pz2jc4","search_text":"Executing mutex.go will generate the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"mutex.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jc5","search_text":"$ go run mutex.go 21 0 -> 1-> 2-> 3-> 4-> 5-> 6-> 7-> 8-> 9-> -30-> -29-> -28-> -27-> -26-> -25-> -24-> -23-> -22-> -21-> -210-> -209-> -209 $ go run mutex.go 21 0 -> 1-> 2-> 3-> 4-> 5-> 6-> 7-> 8-> 9-> -130-> -129-> -128-> -127-> -126-> -125-> -124-> -123-> -122-> -121-> -220-> -219-> -219 $ go run mutex.go 21 0 -> 1-> 2-> 3-> 4-> 5-> 6-> 7-> 8-> 9-> -100-> -99-> -98-> -97-> -96-> -95-> -94-> -93-> -92-> -91-> -260-> -259-> -259","text_count":433,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run mutex.go 21\n0 -&gt; 1-&gt; 2-&gt; 3-&gt; 4-&gt; 5-&gt; 6-&gt; 7-&gt; 8-&gt; 9-&gt; -30-&gt; -29-&gt; -28-&gt; -27-&gt; -26-&gt; -25-&gt; -24-&gt; -23-&gt; -22-&gt; -21-&gt; -210-&gt; -209-&gt; -209\n$ go run mutex.go 21\n0 -&gt; 1-&gt; 2-&gt; 3-&gt; 4-&gt; 5-&gt; 6-&gt; 7-&gt; 8-&gt; 9-&gt; -130-&gt; -129-&gt; -128-&gt; -127-&gt; -126-&gt; -125-&gt; -124-&gt; -123-&gt; -122-&gt; -121-&gt; -220-&gt; -219-&gt; -219\n$ go run mutex.go 21\n0 -&gt; 1-&gt; 2-&gt; 3-&gt; 4-&gt; 5-&gt; 6-&gt; 7-&gt; 8-&gt; 9-&gt; -100-&gt; -99-&gt; -98-&gt; -97-&gt; -96-&gt; -95-&gt; -94-&gt; -93-&gt; -92-&gt; -91-&gt; -260-&gt; -259-&gt; -259"}]}]},{"block_type":"element","block":"k6pz2jc6","search_text":"If you remove the m.Lock() and m.Unlock() statements from the change() function, the program will generate output similar to the following:","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you remove the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m.Unlock()"}]},{"block_type":"text","content":"statements from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"change()"}]},{"block_type":"text","content":"function, the program will generate output similar to the following:"}]},{"block_type":"element","block":"k6pz2jc7","search_text":"$ go run mutex.go 21 0 -> 1-> 6-> 7-> 5-> -60-> -59-> 9-> 2-> -58-> 3-> -52-> 4-> -57-> 8-> -55-> -90-> -54-> -89-> -53-> -56-> -51-> -89 $ go run mutex.go 21 0 -> 1-> 7-> 8-> 9-> 5-> -99-> 4-> 2-> -97-> -96-> 3-> -98-> -95-> -100-> -93-> -94-> -92-> -91-> -230-> 6-> -229-> -229 $ go run mutex.go 21 0 -> 3-> 7-> 8-> 9-> -120-> -119-> -118-> -117-> 1-> -115-> -114-> -116-> 4-> 6-> -112-> 2-> -111-> 5-> -260-> -113-> -259-> -259","text_count":430,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run mutex.go 21\n0 -&gt; 1-&gt; 6-&gt; 7-&gt; 5-&gt; -60-&gt; -59-&gt; 9-&gt; 2-&gt; -58-&gt; 3-&gt; -52-&gt; 4-&gt; -57-&gt; 8-&gt; -55-&gt; -90-&gt; -54-&gt; -89-&gt; -53-&gt; -56-&gt; -51-&gt; -89\n$ go run mutex.go 21\n0 -&gt; 1-&gt; 7-&gt; 8-&gt; 9-&gt; 5-&gt; -99-&gt; 4-&gt; 2-&gt; -97-&gt; -96-&gt; 3-&gt; -98-&gt; -95-&gt; -100-&gt; -93-&gt; -94-&gt; -92-&gt; -91-&gt; -230-&gt; 6-&gt; -229-&gt; -229\n$ go run mutex.go 21\n0 -&gt; 3-&gt; 7-&gt; 8-&gt; 9-&gt; -120-&gt; -119-&gt; -118-&gt; -117-&gt; 1-&gt; -115-&gt; -114-&gt; -116-&gt; 4-&gt; 6-&gt; -112-&gt; 2-&gt; -111-&gt; 5-&gt; -260-&gt; -113-&gt; -259-&gt; -259"}]}]},{"block_type":"element","block":"k6pz2jc8","search_text":"The reason for such a change in the output is that all goroutines are simultaneously changing the shared variable, which is the main reason that the output appears randomly generated.","text_count":183,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for such a change in the output is that all goroutines are simultaneously changing the shared variable, which is the main reason that the output appears randomly generated."}]},{"block_type":"element","block":"k6pz2jc9","search_text":"What happens if you forget to unlock a mutex?","text_count":45,"tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"What happens if you forget to unlock a mutex?"}]},{"block_type":"element","block":"k6pz2jca","search_text":"In this section, you will see what happens if you forget to unlock sync.Mutex . You will do this using the Go code of forgetMutex.go , which will be presented in two parts.","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see what happens if you forget to unlock&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":". You will do this using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"forgetMutex.go"}]},{"block_type":"text","content":", which will be presented in two parts."}]},{"block_type":"element","block":"k6pz2jcb","search_text":"The first part of forgetMutex.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"forgetMutex.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jcc","search_text":"package main import ( \"fmt\" \"sync\" ) var m sync.Mutex func function() { m.Lock() fmt.Println(\"Locked!\") } ","text_count":106,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"sync\" \n) \n \nvar m sync.Mutex \n \nfunc function() { \n    m.Lock() \n    fmt.Println(\"Locked!\") \n}"}]}]},{"block_type":"element","block":"k6pz2jcd","search_text":"All of the problems in this program are caused because the developer forgot to release the lock on the m sync.Mutex mutex. However, if your program will call function() only once, then everything will look just fine!","text_count":216,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of the problems in this program are caused because the developer forgot to release the lock on the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"m sync.Mutex"}]},{"block_type":"text","content":"mutex. However, if your program will call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"function()"}]},{"block_type":"text","content":"only once, then everything will look just fine!"}]},{"block_type":"element","block":"k6pz2jce","search_text":"The second part of forgetMutex.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"forgetMutex.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jcf","search_text":"func main() { var w sync.WaitGroup go func() { defer w.Done() function() }() w.Add(1) go func() { defer w.Done() function() }() w.Add(1) w.Wait() } ","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var w sync.WaitGroup \n \n    go func() { \n         defer w.Done() \n         function() \n    }() \n    w.Add(1) \n \n    go func() { \n         defer w.Done() \n         function() \n    }() \n    w.Add(1) \n \n    w.Wait() \n}"}]}]},{"block_type":"element","block":"k6pz2jcg","search_text":"There is nothing wrong with the main() function that generates just two goroutines and waits for them to finish.","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is nothing wrong with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function that generates just two goroutines and waits for them to finish."}]},{"block_type":"element","block":"k6pz2jch","search_text":"Executing forgetMutex.go will produce the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"forgetMutex.go"}]},{"block_type":"text","content":"will produce the following output:"}]},{"block_type":"element","block":"k6pz2jci","search_text":"$ go run forgetMutex.go Locked! fatal error: all goroutines are asleep - deadlock! goroutine 1 [semacquire]: sync.runtime_Semacquire(0xc42001209c) /usr/local/Cellar/go/1.9.4/libexec/src/runtime/sema.go:56 +0x39 sync.(*WaitGroup).Wait(0xc420012090) /usr/local/Cellar/go/1.9.4/libexec/src/sync/waitgroup.go:131 +0x72 main.main() /Users/mtsouk/forgetMutex.go:30 +0xb6 goroutine 5 [semacquire]: sync.runtime_SemacquireMutex(0x115c6fc, 0x0) /usr/local/Cellar/go/1.9.4/libexec/src/runtime/sema.go:71 +0x3d sync.(*Mutex).Lock(0x115c6f8) /usr/local/Cellar/go/1.9.4/libexec/src/sync/mutex.go:134 +0xee main.function() /Users/mtsouk/forgetMutex.go:11 +0x2d main.main.func1(0xc420012090) /Users/mtsouk/forgetMutex.go:20 +0x48 created by main.main /Users/mtsouk/forgetMutex.go:18 +0x58 exit status 2","text_count":787,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run forgetMutex.go\nLocked!\nfatal error: all goroutines are asleep - deadlock!\n    \ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc42001209c)\n          /usr/local/Cellar/go/1.9.4/libexec/src/runtime/sema.go:56 +0x39\nsync.(*WaitGroup).Wait(0xc420012090)\n          /usr/local/Cellar/go/1.9.4/libexec/src/sync/waitgroup.go:131 +0x72\nmain.main()\n          /Users/mtsouk/forgetMutex.go:30 +0xb6\n    \ngoroutine 5 [semacquire]:\nsync.runtime_SemacquireMutex(0x115c6fc, 0x0)\n          /usr/local/Cellar/go/1.9.4/libexec/src/runtime/sema.go:71 +0x3d\nsync.(*Mutex).Lock(0x115c6f8)\n          /usr/local/Cellar/go/1.9.4/libexec/src/sync/mutex.go:134 +0xee\nmain.function()\n          /Users/mtsouk/forgetMutex.go:11 +0x2d\nmain.main.func1(0xc420012090)\n          /Users/mtsouk/forgetMutex.go:20 +0x48\ncreated by main.main\n          /Users/mtsouk/forgetMutex.go:18 +0x58\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2jcj","search_text":"So, forgetting to unlock a sync.Mutex mutex will create a panic situation even in the simplest kind of program. The same applies to the sync.RWMutex type of mutex that you will to work with in the next section.","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, forgetting to unlock a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex will create a panic situation even in the simplest kind of program. The same applies to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"type of mutex that you will to work with in the next section."}]},{"block_type":"element","block":"k6pz2jck","search_text":"The sync.RWMutex type","text_count":21,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The sync.RWMutex type"}]},{"block_type":"element","block":"k6pz2jcl","search_text":"The sync.RWMutex type is another kind of mutex-actually, it is an improved version of sync.Mutex , which is defined in the rwmutex.go file of the sync directory as follows:","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"type is another kind of mutex-actually, it is an improved version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":", which is defined in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwmutex.go"}]},{"block_type":"text","content":"file of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"directory as follows:"}]},{"block_type":"element","block":"k6pz2jcm","search_text":"type RWMutex struct { w Mutex // held if there are pending writers writerSem uint32 // semaphore for writers to wait for completing readers readerSem uint32 // semaphore for readers to wait for completing writers readerCount int32 // number of pending readers readerWait int32 // number of departing readers } ","text_count":310,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type RWMutex struct { \n    w           Mutex  // held if there are pending writers \n    writerSem   uint32 // semaphore for writers to wait for completing readers \n    readerSem   uint32 // semaphore for readers to wait for completing writers \n    readerCount int32  // number of pending readers \n    readerWait  int32  // number of departing readers \n}"}]}]},{"block_type":"element","block":"k6pz2jcn","search_text":"In other words, sync.RWMutex is based on sync.Mutex with the necessary additions and improvements.","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In other words,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"is based on"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"with the necessary additions and improvements."}]},{"block_type":"element","block":"k6pz2jco","search_text":"Now let's talk about how sync.RWMutex improves sync.Mutex . Although only one function is allowed to perform write operations using a sync.RWMutex mutex, you can have multiple readers owning a sync.RWMutex mutex. However, there is one thing of which you should be aware: until all of the readers of a sync.RWMutex mutex unlock that mutex, you cannot lock it for writing, which is the small price you have to pay for allowing multiple readers.","text_count":442,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's talk about how"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"improves"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":". Although only one function is allowed to perform write operations using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex, you can have multiple readers owning a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex. However, there is one thing of which you should be aware: until all of the readers of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex unlock that mutex, you cannot lock it for writing, which is the small price you have to pay for allowing multiple readers."}]},{"block_type":"element","block":"k6pz2jcp","search_text":"The functions that can help you work with a sync.RWMutex mutex are RLock() and RUnlock() , which are used for locking and unlocking the mutex, respectively, for reading purposes. The Lock() and Unlock() functions used in a sync.Mutex mutex should still be used when you want to lock and unlock a sync.RWMutex mutex for writing purposes. Thus, an RLock() function call that locks for reading purposes should be paired with an RUnlock() function call. Finally, it should be apparent that you should not make changes to any shared variables inside the RLock() and RUnlock() blocks of code.","text_count":586,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The functions that can help you work with a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RLock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RUnlock()"}]},{"block_type":"text","content":", which are used for locking and unlocking the mutex, respectively,&nbsp;for reading purposes. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unlock()"}]},{"block_type":"text","content":"functions used in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex should still be used when you want to lock and unlock a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex for writing purposes. Thus, an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RLock()"}]},{"block_type":"text","content":"function call that locks for reading purposes should be paired with an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RUnlock()"}]},{"block_type":"text","content":"function call. Finally, it should be apparent that you should not make changes to any shared variables inside the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RLock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RUnlock()"}]},{"block_type":"text","content":"blocks of code."}]},{"block_type":"element","block":"k6pz2jcq","search_text":"The Go code found in rwMutex.go illustrates the use and usefulness of the sync.RWMutex type. The program is presented in six parts, and it contains two slightly different versions of the same function. The first one uses a sync.RWMutex mutex for reading, and the second one uses a sync.Mutex mutex for reading. The performance difference between the two functions will help you understand the benefits of the sync.RWMutex mutex better, when used for reading purposes.","text_count":467,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code found in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"illustrates the use and usefulness of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"type. The program is presented in six parts, and it contains two slightly different versions of the same function. The first one uses a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex for reading, and the second one uses a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex for reading. The performance difference between the two functions will help you understand the benefits of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex better, when used for reading purposes."}]},{"block_type":"element","block":"k6pz2jcr","search_text":"The first part of rwMutex.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jcs","search_text":"package main import ( \"fmt\" \"os\" \"sync\" \"time\" ) var Password = secret{password: \"myPassword\"} type secret struct { RWM sync.RWMutex M sync.Mutex password string } ","text_count":164,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"sync\" \n    \"time\" \n) \n \nvar Password = secret{password: \"myPassword\"} \n \ntype secret struct { \n    RWM      sync.RWMutex \n    M        sync.Mutex \n    password string \n}"}]}]},{"block_type":"element","block":"k6pz2jct","search_text":"The secret structure holds a shared variable, a sync.RWMutex mutex, and a sync.Mutex mutex.","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"secret"}]},{"block_type":"text","content":"structure holds a shared variable, a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex, and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex."}]},{"block_type":"element","block":"k6pz2jcu","search_text":"The second code portion of rwMutex.go is shown in the following code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"is shown in the following code:"}]},{"block_type":"element","block":"k6pz2jcv","search_text":"func Change(c *secret, pass string) { c.RWM.Lock() fmt.Println(\"LChange\") time.Sleep(10 * time.Second)","text_count":102,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Change(c *secret, pass string) { \n    c.RWM.Lock() \n    fmt.Println(\"LChange\") \n    time.Sleep(10 * time.Second)"}]}]},{"block_type":"element","block":"k6pz2jcw","search_text":"c.password = pass c.RWM.Unlock() } ","text_count":35,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"c.password = pass \n    c.RWM.Unlock() \n}"}]}]},{"block_type":"element","block":"k6pz2jcx","search_text":"The Change() function modifies a shared variable, which means that you need to use an exclusive lock, which is the reason for using the Lock() and Unlock() functions. You cannot get away with using exclusive locks when changing things!","text_count":235,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Change()"}]},{"block_type":"text","content":"function modifies a shared variable, which means that you need to use an exclusive lock, which is the reason for using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unlock()"}]},{"block_type":"text","content":"functions. You cannot get away with using exclusive locks when changing things!"}]},{"block_type":"element","block":"k6pz2jcy","search_text":"The third part of rwMutex.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jcz","search_text":"func show(c *secret) string { c.RWM.RLock() fmt.Print(\"show\") time.Sleep(3 * time.Second) defer c.RWM.RUnlock() return c.password } ","text_count":132,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func show(c *secret) string { \n    c.RWM.RLock() \n    fmt.Print(\"show\") \n    time.Sleep(3 * time.Second) \n    defer c.RWM.RUnlock() \n    return c.password \n}"}]}]},{"block_type":"element","block":"k6pz2jd0","search_text":"The show() function uses the RLock() and RUnlock() functions because its critical section is used for reading a shared variable. So, although many goroutines can read the shared variable, no one can change it without using the Lock() and Unlock() functions. However, the Lock() function will be blocked for as long as there is someone reading that shared variable using the mutex.","text_count":380,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"show()"}]},{"block_type":"text","content":"function uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RLock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RUnlock()"}]},{"block_type":"text","content":"functions because its critical section is used for reading a shared variable. So, although many goroutines can read the shared variable, no one can change it without using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Lock()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unlock()"}]},{"block_type":"text","content":"functions. However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Lock()"}]},{"block_type":"text","content":"function will be blocked for as long as there is someone reading that shared variable using the mutex."}]},{"block_type":"element","block":"k6pz2jd1","search_text":"The fourth code segment of rwMutex.go contains the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jd2","search_text":"func showWithLock(c *secret) string { c.M.Lock() fmt.Println(\"showWithLock\") time.Sleep(3 * time.Second) defer c.M.Unlock() return c.password } ","text_count":144,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func showWithLock(c *secret) string { \n    c.M.Lock() \n    fmt.Println(\"showWithLock\") \n    time.Sleep(3 * time.Second) \n    defer c.M.Unlock() \n    return c.password \n}"}]}]},{"block_type":"element","block":"k6pz2jd3","search_text":"The only difference between the code of the showWithLock() function and the code of the show() function is that the showWithLock() function uses an exclusive lock for reading, which means that only one showWithLock() function can read the password field of the secret structure.","text_count":278,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The only difference between the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"showWithLock()"}]},{"block_type":"text","content":"function and the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"show()"}]},{"block_type":"text","content":"function is that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"showWithLock()"}]},{"block_type":"text","content":"function uses an exclusive lock for reading, which means that only one"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"showWithLock()"}]},{"block_type":"text","content":"function can read the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"password"}]},{"block_type":"text","content":"field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"secret"}]},{"block_type":"text","content":"structure."}]},{"block_type":"element","block":"k6pz2jd4","search_text":"The fifth part of rwMutex.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jd5","search_text":"func main() { var showFunction = func(c *secret) string { return \"\" } if len(os.Args) != 2 { fmt.Println(\"Using sync.RWMutex!\") showFunction = show } else { fmt.Println(\"Using sync.Mutex!\") showFunction = showWithLock } var waitGroup sync.WaitGroup fmt.Println(\"Pass:\", showFunction(&Password)) ","text_count":295,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    var showFunction = func(c *secret) string { return \"\" } \n    if len(os.Args) != 2 { \n          fmt.Println(\"Using sync.RWMutex!\") \n          showFunction = show \n    } else { \n          fmt.Println(\"Using sync.Mutex!\") \n         showFunction = showWithLock \n    } \n \n    var waitGroup sync.WaitGroup \n \n    fmt.Println(\"Pass:\", showFunction(&amp;Password))"}]}]},{"block_type":"element","block":"k6pz2jd6","search_text":"The remaining code of rwMutex.go follows next:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jd7","search_text":"for i := 0; i < 15; i++ { waitGroup.Add(1) go func() { defer waitGroup.Done() fmt.Println(\"Go Pass:\", showFunction(&Password)) }() } go func() { waitGroup.Add(1) defer waitGroup.Done() Change(&Password, \"123456\") }() waitGroup.Wait() fmt.Println(\"Pass:\", showFunction(&Password)) } ","text_count":282,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for i := 0; i &lt; 15; i++ { \n    waitGroup.Add(1) \n         go func() { \n               defer waitGroup.Done() \n               fmt.Println(\"Go Pass:\", showFunction(&amp;Password)) \n         }() \n    } \n \n    go func() { \n         waitGroup.Add(1) \n         defer waitGroup.Done() \n         Change(&amp;Password, \"123456\") \n    }() \n \n    waitGroup.Wait() \n    fmt.Println(\"Pass:\", showFunction(&amp;Password)) \n}"}]}]},{"block_type":"element","block":"k6pz2jd8","search_text":"Executing rwMutex.go two times and using the time(1) command-line utility to benchmark the two versions of the program will generate the following type of output:","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rwMutex.go"}]},{"block_type":"text","content":"two times and using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time(1)"}]},{"block_type":"text","content":"command-line utility to benchmark the two versions of the program will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2jd9","search_text":"$ time go run rwMutex.go 10 >/dev/null real 0m51.206s user 0m0.130s sys 0m0.074s $ time go run rwMutex.go >/dev/null real 0m22.191s user 0m0.135s sys 0m0.071s","text_count":158,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ time go run rwMutex.go 10 &gt;/dev/null\n    \nreal  0m51.206s\nuser  0m0.130s\nsys   0m0.074s\n$ time go run rwMutex.go &gt;/dev/null\n    \nreal  0m22.191s\nuser  0m0.135s\nsys   0m0.071s"}]}]},{"block_type":"element","block":"k6pz2jda","search_text":"Note that the > /dev/null at the end of the preceding commands is for omitting the output of the two commands. Thus, the version that uses the sync.RWMutex mutex is much faster than the version that uses sync.Mutex .","text_count":216,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&gt; /dev/null"}]},{"block_type":"text","content":"at the end of the preceding commands is for omitting the output of the two commands. Thus, the version that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.RWMutex"}]},{"block_type":"text","content":"mutex is much faster than the version that uses"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jdb","search_text":"Sharing memory using goroutines","text_count":31,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Sharing memory using goroutines"}]},{"block_type":"element","block":"k6pz2jdc","search_text":"The last subsection of this topic illustrates how you can share data using a dedicated goroutine. Although shared memory is the traditional way that threads use to communicate with each other, Go comes with built-in synchronization features that allow a single goroutine to own a shared piece of data. This means that other goroutines must send messages to this single goroutine that owns the shared data, which prevents the corruption of the data. Such a goroutine is called a monitor goroutine . In Go terminology, this is s haring by communicating instead of communicating by sharing .","text_count":588,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last subsection of this topic illustrates how you can share data using a dedicated goroutine. Although shared memory is the traditional way that threads use to communicate with each other, Go comes with built-in synchronization features that allow a single goroutine to own a shared piece of data. This means that other goroutines must send messages to this single goroutine that owns the shared data, which prevents the corruption of the data. Such a goroutine is called a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"monitor goroutine"}]},{"block_type":"text","content":". In Go terminology, this is s"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"haring by communicating instead of communicating by sharing"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jdd","search_text":"The technique will be illustrated using the monitor.go source file, which will be presented in five parts. The monitor.go program generates random numbers using a monitor goroutine.","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique will be illustrated using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"source file, which will be presented in five parts. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"program generates random numbers using a monitor goroutine."}]},{"block_type":"element","block":"k6pz2jde","search_text":"The first part of monitor.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jdf","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" \"sync\" \"time\" ) var readValue = make(chan int) var writeValue = make(chan int) ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n    \"time\" \n) \n \nvar readValue = make(chan int) \nvar writeValue = make(chan int)"}]}]},{"block_type":"element","block":"k6pz2jdg","search_text":"The readValue channel is used for reading the random numbers, whereas the writeValue channel is used for getting new random numbers.","text_count":132,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readValue"}]},{"block_type":"text","content":"channel is used for reading the random numbers, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeValue"}]},{"block_type":"text","content":"channel is used for getting new random numbers."}]},{"block_type":"element","block":"k6pz2jdh","search_text":"The second code portion of monitor.go is shown in the following code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"is shown in the following code:"}]},{"block_type":"element","block":"k6pz2jdi","search_text":"func set(newValue int) { writeValue <- newValue } func read() int { return <-readValue } ","text_count":89,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func set(newValue int) { \n   writeValue &lt;- newValue \n} \n \nfunc read() int { \n   return &lt;-readValue \n}"}]}]},{"block_type":"element","block":"k6pz2jdj","search_text":"The purpose of the set() function is to set the value of the shared variable, whereas the purpose of the read() function is to read the value of the saved variable.","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"set()"}]},{"block_type":"text","content":"function is to set the value of the shared variable, whereas the purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"read()"}]},{"block_type":"text","content":"function is to read the value of the saved variable."}]},{"block_type":"element","block":"k6pz2jdk","search_text":"The third code segment of the monitor.go program is as follows:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2jdl","search_text":"func monitor() { var value int for { select { case newValue := <-writeValue: value = newValue fmt.Printf(\"%d \", value) case readValue <- value: } } } ","text_count":150,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func monitor() { \n    var value int \n    for { \n         select { \n         case newValue := &lt;-writeValue: \n               value = newValue \n               fmt.Printf(\"%d \", value) \n         case readValue &lt;- value: \n         } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jdm","search_text":"All of the logic of the program can be found in the implementation of the monitor() function. Most specifically, the select statement orchestrates the operation of the entire program. When you have a read request, the read() function attempts to read from the readValue channel, which is controlled by the monitor() function. This returns the current value that is kept in the value variable. On the other hand, when you want to change the stored value, you call set() . This writes to the writeValue channel that is also handled by the select statement. As a result, no one can deal with the value shared variable without using the monitor() function.","text_count":652,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of the logic of the program can be found in the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor()"}]},{"block_type":"text","content":"function. Most specifically, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement orchestrates the operation of the entire program. When you have a read request, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"read()"}]},{"block_type":"text","content":"function attempts to read from the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readValue"}]},{"block_type":"text","content":"channel, which is controlled by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor()"}]},{"block_type":"text","content":"function. This returns the current value that is kept in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"value"}]},{"block_type":"text","content":"variable. On the other hand, when you want to change the stored value, you call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"set()"}]},{"block_type":"text","content":". This writes to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writeValue"}]},{"block_type":"text","content":"channel that is also handled by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement. As a result, no one can deal with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"value"}]},{"block_type":"text","content":"shared variable without using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2jdn","search_text":"The fourth code segment of monitor.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jdo","search_text":"func main() { if len(os.Args) != 2 { fmt.Println(\"Please give an integer!\") return } n, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } fmt.Printf(\"Going to create %d random numbers.\\n\", n) rand.Seed(time.Now().Unix()) go monitor() ","text_count":258,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n         fmt.Println(\"Please give an integer!\") \n         return \n    } \n    n, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n \n    fmt.Printf(\"Going to create %d random numbers.\\n\", n) \n    rand.Seed(time.Now().Unix()) \n    go monitor()"}]}]},{"block_type":"element","block":"k6pz2jdp","search_text":"The last part of monitor.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jdq","search_text":"var w sync.WaitGroup for r := 0; r < n; r++ { w.Add(1) go func() { defer w.Done() set(rand.Intn(10 * n)) }() } w.Wait() fmt.Printf(\"\\nLast value: %d\\n\", read()) } ","text_count":163,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var w sync.WaitGroup \n \n    for r := 0; r &lt; n; r++ { \n         w.Add(1) \n         go func() { \n               defer w.Done() \n               set(rand.Intn(10 * n)) \n         }() \n    } \n    w.Wait() \n    fmt.Printf(\"\\nLast value: %d\\n\", read()) \n}"}]}]},{"block_type":"element","block":"k6pz2jdr","search_text":"Executing monitor.go generates the following output:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"monitor.go"}]},{"block_type":"text","content":"generates the following output:"}]},{"block_type":"element","block":"k6pz2jds","search_text":"$ go run monitor.go 20 Going to create 20 random numbers. 89 88 166 42 149 89 20 84 44 178 184 28 52 121 62 91 31 117 140 106 Last value: 106 $ go run monitor.go 10 Going to create 10 random numbers. 30 16 66 70 65 45 31 57 62 26 Last value: 26 ","text_count":245,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run monitor.go 20\nGoing to create 20 random numbers.\n89 88 166 42 149 89 20 84 44 178 184 28 52 121 62 91 31 117 140 106\nLast value: 106\n$ go run monitor.go 10\nGoing to create 10 random numbers.\n30 16 66 70 65 45 31 57 62 26\nLast value: 26"}]}]},{"block_type":"element","block":"k6pz2jdt","search_text":"Tip Personally, I prefer to use a monitor goroutine instead of the traditional shared memory techniques because the implementation that uses the monitor goroutine is safer and closer to the Go philosophy. ","text_count":205,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Personally, I prefer to use a monitor goroutine instead of the traditional shared memory techniques because the implementation that uses the monitor goroutine is safer and closer to the Go philosophy."}]}]},{"block_type":"element","block":"k6pz2jdu","search_text":"Catching race conditions","text_count":24,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Catching race conditions"}]},{"block_type":"element","block":"k6pz2jdv","search_text":"A data race condition is a situation where two or more running elements such as threads and goroutines try to take control or modify a shared resource or a variable of a program. Strictly speaking, a data race occurs when two or more instructions access the same memory address, where at least one of them performs a write operation.","text_count":333,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"data race condition"}]},{"block_type":"text","content":"is a situation where two or more running elements such as threads and goroutines try to take control or modify a shared resource or a variable of a program. Strictly speaking, a data race occurs when two or more instructions access the same memory address, where at least one of them performs a write operation."}]},{"block_type":"element","block":"k6pz2jdw","search_text":"Using the -race flag when running or building a Go source file will turn on the Go race detector , which will make the compiler create a modified version of a typical executable file. This modified version can record all accesses to shared variables as well as all synchronization events that take place, including calls to sync.Mutex and sync.WaitGroup . After analyzing the relevant events, the race detector prints a report that can help you identify potential problems so that you can correct them.","text_count":502,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-race"}]},{"block_type":"text","content":"flag when running or building a Go source file will turn on the Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"race detector"}]},{"block_type":"text","content":", which will make the compiler create a modified version of a typical executable file. This modified version can record all accesses to shared variables as well as all synchronization events that take place, including calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":". After analyzing the relevant events, the race detector prints a report that can help you identify potential problems so that you can correct them."}]},{"block_type":"element","block":"k6pz2jdx","search_text":"Look at the following Go code, which is saved as raceC.go . This program is presented in three parts.","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the following Go code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":". This program is presented in three parts."}]},{"block_type":"element","block":"k6pz2jdy","search_text":"The first part of raceC.go is as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jdz","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" \"sync\" ) func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"Give me a natural number!\") os.Exit(1) } numGR, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } ","text_count":247,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n) \n \nfunc main() { \n    arguments := os.Args \n    if len(arguments) != 2 { \n         fmt.Println(\"Give me a natural number!\") \n         os.Exit(1) \n    } \n    numGR, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    }"}]}]},{"block_type":"element","block":"k6pz2je0","search_text":"The second part of raceC.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2je1","search_text":"var waitGroup sync.WaitGroup var i int k := make(map[int]int) k[1] = 12 for i = 0; i < numGR; i++ { waitGroup.Add(1) go func() { defer waitGroup.Done() k[i] = i }() } ","text_count":167,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var waitGroup sync.WaitGroup \n    var i int \n \n    k := make(map[int]int) \n    k[1] = 12 \n \n    for i = 0; i &lt; numGR; i++ { \n        waitGroup.Add(1) \n        go func() { \n               defer waitGroup.Done() \n               k[i] = i \n        }() \n    }"}]}]},{"block_type":"element","block":"k6pz2je2","search_text":"The remaining Go code of raceC.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2je3","search_text":"k[2] = 10 waitGroup.Wait() fmt.Printf(\"k = %#v\\n\", k) } ","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"k[2] = 10 \n    waitGroup.Wait() \n    fmt.Printf(\"k = %#v\\n\", k) \n}"}]}]},{"block_type":"element","block":"k6pz2je4","search_text":"As if it were not enough that many goroutines are accessing the k map at the same time, we added another statement that accesses the k map before calling the sync.Wait() function.","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As if it were not enough that many goroutines are accessing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"map at the same time, we added another statement that accesses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"map before calling the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Wait()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2je5","search_text":"If you execute raceC.go , you will get the following output without any warning or error messages:","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":", you will get the following output without any warning or error messages:"}]},{"block_type":"element","block":"k6pz2je6","search_text":"$ go run raceC.go 10 k = map[int]int{7:10, 2:10, 10:10, 1:12} $ go run raceC.go 10 k = map[int]int{2:10, 10:10, 1:12, 8:8, 9:9} $ go run raceC.go 10 k = map[int]int{10:10, 1:12, 6:7, 7:7, 2:10}","text_count":193,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run raceC.go 10\nk = map[int]int{7:10, 2:10, 10:10, 1:12}\n$ go run raceC.go 10\nk = map[int]int{2:10, 10:10, 1:12, 8:8, 9:9}\n$ go run raceC.go 10\nk = map[int]int{10:10, 1:12, 6:7, 7:7, 2:10}"}]}]},{"block_type":"element","block":"k6pz2je7","search_text":"If you execute raceC.go only once, then everything will look normal despite the fact that you do not get what you would expect when printing the contents of the k map. However, executing raceC.go multiple times tells us that there is something wrong here, mainly because each execution generates a different output.","text_count":315,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"only once, then everything will look normal despite the fact that you do not get what you would expect when printing the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"map. However, executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"multiple times tells us that there is something wrong here, mainly because each execution generates a different output."}]},{"block_type":"element","block":"k6pz2je8","search_text":"There are many more things that we can get from raceC.go and its unexpected output, if we decide to use the Go race detector to analyze it:","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are many more things that we can get from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"and its unexpected output, if we decide to use the Go race detector to analyze it:"}]},{"block_type":"element","block":"k6pz2je9","search_text":"$ go run -race raceC.go 10 ================== WARNING: DATA RACE Read at 0x00c42007c008 by goroutine 6: main.main.func1() /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x69 Previous write at 0x00c42007c008 by main goroutine: main.main() /Users/mtsouk/ch/ch10/code/raceC.go:28 +0x27b Goroutine 6 (running) created at: main.main() /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b ================== ================== WARNING: DATA RACE Write at 0x00c420074180 by goroutine 7: runtime.mapassign_fast64() /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:598 +0x0 main.main.func1() /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x90 Previous write at 0x00c420074180 by goroutine 6: runtime.mapassign_fast64() /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:598 +0x0 main.main.func1() /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x90 Goroutine 7 (running) created at: main.main() /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b Goroutine 6 (finished) created at: main.main() /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b ================== k = map[int]int{3:4, 5:5, 9:9, 10:10, 1:1, 2:10, 4:4, 6:6, 7:7, 8:8} Found 2 data race(s) exit status 66 ","text_count":1148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run -race raceC.go 10\n==================\nWARNING: DATA RACE\nRead at 0x00c42007c008 by goroutine 6:\n  main.main.func1()\n      /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x69\n    \nPrevious write at 0x00c42007c008 by main goroutine:\n  main.main()\n      /Users/mtsouk/ch/ch10/code/raceC.go:28 +0x27b\n    \nGoroutine 6 (running) created at:\n  main.main()\n      /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b\n==================\n==================\nWARNING: DATA RACE\nWrite at 0x00c420074180 by goroutine 7:\n  runtime.mapassign_fast64()\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:598 +0x0\n  main.main.func1()\n      /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x90\n    \nPrevious write at 0x00c420074180 by goroutine 6:\n  runtime.mapassign_fast64()\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:598 +0x0\n  main.main.func1()\n      /Users/mtsouk/ch/ch10/code/raceC.go:32 +0x90\n    \nGoroutine 7 (running) created at:\n  main.main()\n      /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b\n    \nGoroutine 6 (finished) created at:\n  main.main()\n      /Users/mtsouk/ch/ch10/code/raceC.go:30 +0x24b\n==================\nk = map[int]int{3:4, 5:5, 9:9, 10:10, 1:1, 2:10, 4:4, 6:6, 7:7, 8:8}\nFound 2 data race(s)\nexit status 66"}]}]},{"block_type":"element","block":"k6pz2jea","search_text":"So, the race detector found two data races. Each one begins with the WARNING: DATA RACE message in its output.","text_count":110,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, the race detector found two data races. Each one begins with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"WARNING: DATA RACE"}]},{"block_type":"text","content":"message in its output."}]},{"block_type":"element","block":"k6pz2jeb","search_text":"The first data race happens inside main.main.func1() , which is called by the for loop that is called by a goroutine. The problem here is signified by the Previous write message. After examining the related code, it is easy to see that the actual problem is that the anonymous function takes no parameters, which means that the value of i that is used in the for loop cannot be deterministically discerned, as it keeps changing due to the for loop, which is a write operation.","text_count":476,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"data race"}]},{"block_type":"text","content":"happens inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.main.func1()"}]},{"block_type":"text","content":", which is called by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that is called by a goroutine. The problem here is signified by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Previous write"}]},{"block_type":"text","content":"message. After examining the related code, it is easy to see that the actual problem is that the anonymous function takes no parameters, which means that the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"i"}]},{"block_type":"text","content":"that is used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop cannot be deterministically discerned, as it keeps changing due to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, which is a write operation."}]},{"block_type":"element","block":"k6pz2jec","search_text":"The message of the second data race is Write at 0x00c420074180 by goroutine 7 . If you read the relevant output, you will see that the data race is related to a write operation, and it is happening on a Go map by at least two goroutines. As the two goroutines have the same name ( main.main.func1() ), it indicates that we are talking about the same goroutine. Two goroutines trying to write the same variable is a data race condition!","text_count":435,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The message of the second data race is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write at 0x00c420074180 by goroutine 7"}]},{"block_type":"text","content":". If you read the relevant output, you will see that the data race is related to a write operation, and it is happening on a Go map by at least two goroutines. As the two goroutines have the same name ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.main.func1()"}]},{"block_type":"text","content":"), it indicates that we are talking about the same goroutine. Two goroutines trying to write the same variable is a data race condition!"}]},{"block_type":"element","block":"k6pz2jed","search_text":"Note The main.main.func1() notation is used by Go in order to name an anonymous function internally. If you had different anonymous functions, their names would have been different as well. ","text_count":190,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.main.func1()"}]},{"block_type":"text","content":"notation is used by Go in order to name an anonymous function internally. If you had different anonymous functions, their names would have been different as well."}]}]},{"block_type":"element","block":"k6pz2jee","search_text":"You might ask yourself, What can I do now in order to correct the problems coming from the two data races?","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You might ask yourself,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What can I do now in order to correct the problems coming from the two data races?"}]}]},{"block_type":"element","block":"k6pz2jef","search_text":"Well, you can rewrite the main() function of raceC.go as follows:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Well, you can rewrite the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2jeg","search_text":"func main() { arguments := os.Args if len(arguments) != 2 { fmt.Println(\"Give me a natural number!\") os.Exit(1) } numGR, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } var waitGroup sync.WaitGroup var i int k := make(map[int]int) k[1] = 12 for i = 0; i < numGR; i++ { waitGroup.Add(1) go func(j int) { defer waitGroup.Done() aMutex.Lock() k[j] = j aMutex.Unlock() }(i) } waitGroup.Wait() k[2] = 10 fmt.Printf(\"k = %#v\\n\", k) } ","text_count":454,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) != 2 { \n         fmt.Println(\"Give me a natural number!\") \n         os.Exit(1) \n    } \n    numGR, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n  \n    var waitGroup sync.WaitGroup \n    var i int \n \n    k := make(map[int]int) \n    k[1] = 12 \n \n    for i = 0; i &lt; numGR; i++ { \n         waitGroup.Add(1) \n         go func(j int) { \n               defer waitGroup.Done() \n               aMutex.Lock() \n               k[j] = j \n               aMutex.Unlock() \n         }(i) \n    } \n \n    waitGroup.Wait() \n    k[2] = 10 \n    fmt.Printf(\"k = %#v\\n\", k) \n}"}]}]},{"block_type":"element","block":"k6pz2jeh","search_text":"The aMutex variable is a global sync.Mutex variable defined outside the main() function that is accessible from everywhere in the program. Although this is not required, having such a global variable can save you from having to pass it to your functions all of the time.","text_count":270,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aMutex"}]},{"block_type":"text","content":"variable is a global"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"variable defined outside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function that is accessible from everywhere in the program. Although this is not required, having such a global variable can save you from having to pass it to your functions all of the time."}]},{"block_type":"element","block":"k6pz2jei","search_text":"Saving the new version of raceC.go as noRaceC.go and executing it will generate the expected output:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Saving the new version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raceC.go"}]},{"block_type":"text","content":"as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"noRaceC.go"}]},{"block_type":"text","content":"and executing it will generate the expected output:"}]},{"block_type":"element","block":"k6pz2jej","search_text":"$ go run noRaceC.go 10 k = map[int]int{1:1, 0:0, 5:5, 3:3, 6:6, 9:9, 2:10, 4:4, 7:7, 8:8}","text_count":89,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run noRaceC.go 10\nk = map[int]int{1:1, 0:0, 5:5, 3:3, 6:6, 9:9, 2:10, 4:4, 7:7, 8:8}"}]}]},{"block_type":"element","block":"k6pz2jek","search_text":"Processing noRaceC.go with the Go race detector will generate the following output:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Processing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"noRaceC.go"}]},{"block_type":"text","content":"with the Go race detector will generate the following output:"}]},{"block_type":"element","block":"k6pz2jel","search_text":"$ go run -race noRaceC.go 10 k = map[int]int{5:5, 7:7, 9:9, 1:1, 0:0, 4:4, 6:6, 8:8, 2:10, 3:3} ","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run -race noRaceC.go 10\nk = map[int]int{5:5, 7:7, 9:9, 1:1, 0:0, 4:4, 6:6, 8:8, 2:10, 3:3}"}]}]},{"block_type":"element","block":"k6pz2jem","search_text":"Note that you need to use a locking mechanism while accessing the k map. If you do not use such a mechanism and just change the implementation of the anonymous function that is executed as a goroutine, you will get the following output from go run noRaceC.go :","text_count":260,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that you need to use a locking mechanism while accessing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"k"}]},{"block_type":"text","content":"map. If you do not use such a mechanism and just change the implementation of the anonymous function that is executed as a goroutine, you will get the following output from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run noRaceC.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jen","search_text":"$ go run noRaceC.go 10 fatal error: concurrent map writes goroutine 10 [running]: runtime.throw(0x10ca0bd, 0x15) /usr/local/Cellar/go/1.9.3/libexec/src/runtime/panic.go:605 +0x95 fp=0xc420024738 sp=0xc420024718 pc=0x10276b5 runtime.mapassign_fast64(0x10ae680, 0xc420074180, 0x5, 0x0) /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:607 +0x3d2 fp=0xc420024798 sp=0xc420024738 pc=0x100b582 main.main.func1(0xc420010090, 0xc420074180, 0x5) /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:35 +0x6b fp=0xc4200247c8 sp=0xc420024798 pc=0x1096f5b runtime.goexit() /usr/local/Cellar/go/1.9.3/libexec/src/runtime/asm_amd64.s:2337 +0x1 fp=0xc4200247d0 sp=0xc4200247c8 pc=0x1050c21 created by main.main /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:32 +0x15a goroutine 1 [semacquire]: sync.runtime_Semacquire(0xc42001009c) /usr/local/Cellar/go/1.9.3/libexec/src/runtime/sema.go:56 +0x39 sync.(*WaitGroup).Wait(0xc420010090) /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:131 +0x72 main.main() /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:40 +0x17a goroutine 12 [runnable]: sync.(*WaitGroup).Done(0xc420010090) /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:99 +0x43 main.main.func1(0xc420010090, 0xc420074180, 0x7) /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:37 +0x79 created by main.main /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:32 +0x15a exit status 2","text_count":1427,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run noRaceC.go 10\nfatal error: concurrent map writes\n    \ngoroutine 10 [running]:\nruntime.throw(0x10ca0bd, 0x15)\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/panic.go:605 +0x95 fp=0xc420024738 sp=0xc420024718 pc=0x10276b5\nruntime.mapassign_fast64(0x10ae680, 0xc420074180, 0x5, 0x0)\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/hashmap_fast.go:607 +0x3d2 fp=0xc420024798 sp=0xc420024738 pc=0x100b582\nmain.main.func1(0xc420010090, 0xc420074180, 0x5)\n      /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:35 +0x6b fp=0xc4200247c8 sp=0xc420024798 pc=0x1096f5b\nruntime.goexit()\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/asm_amd64.s:2337 +0x1 fp=0xc4200247d0 sp=0xc4200247c8 pc=0x1050c21\ncreated by main.main\n      /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:32 +0x15a\n    \ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc42001009c)\n      /usr/local/Cellar/go/1.9.3/libexec/src/runtime/sema.go:56 +0x39\nsync.(*WaitGroup).Wait(0xc420010090)\n      /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:131 +0x72\nmain.main()\n      /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:40 +0x17a\n    \ngoroutine 12 [runnable]:\nsync.(*WaitGroup).Done(0xc420010090)\n      /usr/local/Cellar/go/1.9.3/libexec/src/sync/waitgroup.go:99 +0x43\nmain.main.func1(0xc420010090, 0xc420074180, 0x7)\n     /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:37 +0x79\ncreated by main.main\n      /Users/mtsouk/Desktop/masterGo/ch/ch10/code/noRaceC.go:32 +0x15a\nexit status 2"}]}]},{"block_type":"element","block":"k6pz2jeo","search_text":"The root of the problem is pretty obvious: concurrent map writes .","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The root of the problem is pretty obvious:"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"concurrent map writes"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jep","search_text":"The context package","text_count":19,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The context package"}]},{"block_type":"element","block":"k6pz2jeq","search_text":"The main purpose of the context package is to define the Context type and support cancellation ! Yes, you heard that right; the main purpose of the context package is supporting cancellation because there are times that, for some reason, you want to abandon what you are doing. However, it would be very helpful to be able to include some extra information about your cancelling decisions. The context package allows you to do exactly that!","text_count":440,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package is to define the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"type and support"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"cancellation"}]},{"block_type":"text","content":"! Yes, you heard that right; the main purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package is supporting cancellation because there are times that, for some reason, you want to abandon what you are doing. However, it would be very helpful to be able to include some extra information about your cancelling decisions. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package allows you to do exactly that!"}]},{"block_type":"element","block":"k6pz2jer","search_text":"If you take a look at the source code of the context package, you will realize that its implementation is pretty simple—even the implementation of the Context type is pretty simple, yet the context package is very important.","text_count":224,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you take a look at the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package, you will realize that its implementation is pretty simple&mdash;even the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"type is pretty simple, yet the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package is very important."}]},{"block_type":"element","block":"k6pz2jes","search_text":"Note The context package existed for a while as an external Go package, but it first appeared as a standard Go package in Go version 1.7. So, if you have an older Go version, you will not be able to follow this section without first downloading the context package. ","text_count":266,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package existed for a while as an external Go package, but it first appeared as a standard Go package in Go version 1.7. So, if you have an older Go version, you will not be able to follow this section without first downloading the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package."}]}]},{"block_type":"element","block":"k6pz2jet","search_text":"The Context type is an interface with four methods, named Deadline() , Done() , Err() , and Value() . The good news is that you do not need to implement all of these functions of the Context interface—you just need to modify a Context variable using functions such as context.WithCancel() and context.WithTimeout() .","text_count":316,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"type is an interface with four methods, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Deadline()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Done()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Err()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Value()"}]},{"block_type":"text","content":". The good news is that you do not need to implement all of these functions of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"interface&mdash;you just need to modify a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"variable using functions such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithCancel()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithTimeout()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jeu","search_text":"The following is a simple use of the context package using the Go code of the simpleContext.go file, which will be presented in six parts.","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following is a simple use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package using the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"file, which will be presented in six parts."}]},{"block_type":"element","block":"k6pz2jev","search_text":"The first code segment of simpleContext.go contains the following code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2jew","search_text":"package main import ( \"context\" \"fmt\" \"os\" \"strconv\" \"time\" ) ","text_count":62,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"context\" \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2jex","search_text":"The second part of simpleContext.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jey","search_text":"func f1(t int) { c1 := context.Background() c1, cancel := context.WithCancel(c1) defer cancel() go func() { time.Sleep(4 * time.Second) cancel() }() ","text_count":149,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f1(t int) { \n    c1 := context.Background() \n    c1, cancel := context.WithCancel(c1) \n    defer cancel() \n \n    go func() { \n         time.Sleep(4 * time.Second) \n         cancel() \n    }()"}]}]},{"block_type":"element","block":"k6pz2jez","search_text":"The f1() function requires just one parameter, which is the time delay, because everything else is defined inside the function. Note that the type of the cancel variable is context.CancelFunc .","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"function requires just one parameter, which is the time delay, because everything else is defined inside the function. Note that the type of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cancel"}]},{"block_type":"text","content":"variable is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.CancelFunc"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jf0","search_text":"You need to call the context.Background() function in order to initialize an empty Context parameter. The context.WithCancel() function uses an existing Context and creates a child of it with cancellation. The context.WithCancel() function also creates a Done channel that can be closed, either when the cancel() function is called, as shown in the preceding code, or when the Done channel of the parent context is closed.","text_count":422,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You need to call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.Background()"}]},{"block_type":"text","content":"function in order to initialize an empty"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"parameter. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithCancel()"}]},{"block_type":"text","content":"function uses an existing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"and creates a child of it with cancellation. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithCancel()"}]},{"block_type":"text","content":"function also creates a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Done"}]},{"block_type":"text","content":"channel that can be closed, either when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cancel()"}]},{"block_type":"text","content":"function is called, as shown in the preceding code, or when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Done"}]},{"block_type":"text","content":"channel of the parent context is closed."}]},{"block_type":"element","block":"k6pz2jf1","search_text":"The third code portion of simpleContext.go contains the rest of the code of the f1() function:","text_count":94,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"contains the rest of the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"function:"}]},{"block_type":"element","block":"k6pz2jf2","search_text":"select { case <-c1.Done(): fmt.Println(\"f1():\", c1.Err()) return case r := <-time.After(time.Duration(t) * time.Second): fmt.Println(\"f1():\", r) } return } ","text_count":156,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"select { \ncase &lt;-c1.Done(): \n    fmt.Println(\"f1():\", c1.Err()) \n    return \ncase r := &lt;-time.After(time.Duration(t) * time.Second): \n    fmt.Println(\"f1():\", r) \n    } \n    return \n}"}]}]},{"block_type":"element","block":"k6pz2jf3","search_text":"Here you see the use of the Done() function of a Context variable. When this function is called, you have a cancellation. The return value of Context.Done() is a channel, because otherwise you would have not been able to use it in a select statement.","text_count":250,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you see the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Done()"}]},{"block_type":"text","content":"function of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"variable. When this function is called, you have a cancellation. The return value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context.Done()"}]},{"block_type":"text","content":"is a channel, because otherwise you would have not been able to use it in a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement."}]},{"block_type":"element","block":"k6pz2jf4","search_text":"The fourth part of simpleContext.go contains the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jf5","search_text":"func f2(t int) { c2 := context.Background() c2, cancel := context.WithTimeout(c2, time.Duration(t)*time.Second) defer cancel() go func() { time.Sleep(4 * time.Second) cancel() }() select { case <-c2.Done(): fmt.Println(\"f2():\", c2.Err()) return case r := <-time.After(time.Duration(t) * time.Second): fmt.Println(\"f2():\", r) } return }","text_count":335,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f2(t int) { \n    c2 := context.Background() \n    c2, cancel := context.WithTimeout(c2, time.Duration(t)*time.Second) \n    defer cancel() \n \n    go func() { \n        time.Sleep(4 * time.Second) \n        cancel() \n    }() \n \n    select { \n    case &lt;-c2.Done(): \n        fmt.Println(\"f2():\", c2.Err()) \n        return \n    case r := &lt;-time.After(time.Duration(t) * time.Second): \n        fmt.Println(\"f2():\", r) \n    } \n   return \n}"}]}]},{"block_type":"element","block":"k6pz2jf6","search_text":"This part showcases the use of the context.WithTimeout() function, which requires two parameters: a Context parameter and a time.Duration parameter. When the timeout period expires, the cancel() function is automatically called.","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part showcases the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithTimeout()"}]},{"block_type":"text","content":"function, which requires two parameters: a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"parameter and a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Duration"}]},{"block_type":"text","content":"parameter. When the timeout period expires, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cancel()"}]},{"block_type":"text","content":"function is automatically called."}]},{"block_type":"element","block":"k6pz2jf7","search_text":"The fifth part of simpleContext.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jf8","search_text":"func f3(t int) { c3 := context.Background() deadline := time.Now().Add(time.Duration(2*t) * time.Second) c3, cancel := context.WithDeadline(c3, deadline) defer cancel() go func() { time.Sleep(4 * time.Second) cancel() }() select { case <-c3.Done(): fmt.Println(\"f3():\", c3.Err()) return case r := <-time.After(time.Duration(t) * time.Second): fmt.Println(\"f3():\", r) } return } ","text_count":378,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f3(t int) { \n    c3 := context.Background() \n    deadline := time.Now().Add(time.Duration(2*t) * time.Second) \n    c3, cancel := context.WithDeadline(c3, deadline) \n    defer cancel() \n \n    go func() { \n         time.Sleep(4 * time.Second) \n         cancel() \n    }() \n \n    select { \n    case &lt;-c3.Done(): \n         fmt.Println(\"f3():\", c3.Err()) \n         return \n    case r := &lt;-time.After(time.Duration(t) * time.Second): \n         fmt.Println(\"f3():\", r)\n} \n    return \n}"}]}]},{"block_type":"element","block":"k6pz2jf9","search_text":"The preceding Go code illustrates the use of the context.WithDeadline() function that requires two parameters: a Context variable and a time in the future that signifies the deadline of the operation. When the deadline passes, the cancel() function is automatically called.","text_count":273,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding Go code illustrates the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithDeadline()"}]},{"block_type":"text","content":"function that requires two parameters: a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"variable and a time in the future that signifies the deadline of the operation. When the deadline passes, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cancel()"}]},{"block_type":"text","content":"function is automatically called."}]},{"block_type":"element","block":"k6pz2jfa","search_text":"The remaining Go code of simpleContext.go is as follows:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jfb","search_text":"func main() { if len(os.Args) != 2 { fmt.Println(\"Need a delay!\") return } delay, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } fmt.Println(\"Delay:\", delay) f1(delay) f2(delay) f3(delay) } ","text_count":217,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n         fmt.Println(\"Need a delay!\") \n         return \n    } \n \n    delay, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n    fmt.Println(\"Delay:\", delay) \n \n    f1(delay) \n    f2(delay) \n    f3(delay) \n}"}]}]},{"block_type":"element","block":"k6pz2jfc","search_text":"Executing simpleContext.go will generate the following output:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jfd","search_text":"$ go run simpleContext.go 4 Delay: 4 f1(): 2018-02-13 23:30:00.271587 +0200 EET m=+4.003435078 f2(): 2018-02-13 23:30:04.272678 +0200 EET m=+8.004706996 f3(): 2018-02-13 23:30:08.273738 +0200 EET m=+12.005937567 $ go run simpleContext.go 10 Delay: 10 f1(): context canceled f2(): context canceled f3(): context canceled","text_count":319,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run simpleContext.go 4\nDelay: 4\nf1(): 2018-02-13 23:30:00.271587 +0200 EET m=+4.003435078\nf2(): 2018-02-13 23:30:04.272678 +0200 EET m=+8.004706996\nf3(): 2018-02-13 23:30:08.273738 +0200 EET m=+12.005937567\n$ go run simpleContext.go 10\nDelay: 10\nf1(): context canceled\nf2(): context canceled\nf3(): context canceled"}]}]},{"block_type":"element","block":"k6pz2jfe","search_text":"The long lines of the output are the return values of the time.After() function calls. They denote normal operation of the program. The point here is that the operation of the program is cancelled when there are delays in its execution.","text_count":236,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The long lines of the output are the return values of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.After()"}]},{"block_type":"text","content":"function calls. They denote normal operation of the program. The point here is that the operation of the program is cancelled when there are delays in its execution."}]},{"block_type":"element","block":"k6pz2jff","search_text":"This is as simple as it gets for the use of the context package, as the code presented did not do any serious work with the Context interface. However, the Go code included in the next section will present a more realistic example.","text_count":231,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is as simple as it gets for the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package, as the code presented did not do any serious work with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"interface. However, the Go code included in the next section will present a more realistic example."}]},{"block_type":"element","block":"k6pz2jfg","search_text":"An advanced example of the context package","text_count":42,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"An advanced example of the context package"}]},{"block_type":"element","block":"k6pz2jfh","search_text":"The functionality of the context package will be illustrated much better and in greater depth using the Go code of the useContext.go program, which is presented in five parts.","text_count":175,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package will be illustrated much better and in greater depth using the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"program, which is presented in five parts."}]},{"block_type":"element","block":"k6pz2jfi","search_text":"In this example, you will create an HTTP client that does not want to wait too long for a server response, which is not an unusual scenario. In fact, as almost all HTTP clients support such functionality, you will study another technique for timing out an HTTP request in Chapter 12, The Foundations of Network Programming in Go .","text_count":330,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this example, you will create an HTTP client that does not want to wait too long for a server response, which is not an unusual scenario. In fact, as almost all HTTP clients support such functionality, you will study another technique for timing out an HTTP request in Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Foundations of Network Programming in Go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jfj","search_text":"The useContext.go program requires two command-line arguments: the URL of the server to which it is going to connect and the delay for which it should wait. If the program has only one command-line argument, then the delay would be 5 seconds.","text_count":242,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"program requires two command-line arguments: the URL of the server to which it is going to connect and the delay for which it should wait. If the program has only one command-line argument, then the delay would be 5 seconds."}]},{"block_type":"element","block":"k6pz2jfk","search_text":"The first code segment of useContext.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jfl","search_text":"package main import ( \"context\" \"fmt\" \"io/ioutil\" \"net/http\" \"os\" \"strconv\" \"sync\" \"time\" ) var ( myUrl string delay int = 5 w sync.WaitGroup ) type myData struct { r *http.Response err error } ","text_count":194,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"context\" \n    \"fmt\" \n    \"io/ioutil\" \n    \"net/http\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n    \"time\" \n) \n \nvar ( \n    myUrl string \n    delay int = 5 \n    w     sync.WaitGroup \n) \n \ntype myData struct { \n    r   *http.Response \n    err error \n}"}]}]},{"block_type":"element","block":"k6pz2jfm","search_text":"Both myURL and delay are global variables, so they can be accessed from anything in the code. Additionally, there is a sync.WaitGroup variable named w , which also has a global scope, and the definition of a structure named myData for keeping together the response of the web server, along with an error variable in case there is an error somewhere.","text_count":349,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myURL"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"delay"}]},{"block_type":"text","content":"are global variables, so they can be accessed from anything in the code. Additionally, there is a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.WaitGroup"}]},{"block_type":"text","content":"variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w"}]},{"block_type":"text","content":", which also has a global scope, and the definition of a structure named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myData"}]},{"block_type":"text","content":"for keeping together the response of the web server, along with an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"variable in case there is an error somewhere."}]},{"block_type":"element","block":"k6pz2jfn","search_text":"The second part of useContext.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jfo","search_text":"func connect(c context.Context) error { defer w.Done() data := make(chan myData, 1) tr := &http.Transport{} httpClient := &http.Client{Transport: tr} req, _ := http.NewRequest(\"GET\", myUrl, nil) ","text_count":195,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func connect(c context.Context) error { \n   defer w.Done() \n   data := make(chan myData, 1) \n \n   tr := &amp;http.Transport{} \n   httpClient := &amp;http.Client{Transport: tr} \n \n   req, _ := http.NewRequest(\"GET\", myUrl, nil)"}]}]},{"block_type":"element","block":"k6pz2jfp","search_text":"The preceding Go code deals with the HTTP connection.","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding Go code deals with the HTTP connection."}]},{"block_type":"element","block":"k6pz2jfq","search_text":"Note You will learn more about developing web servers and clients in Go in Chapter 12, The Foundations of Network Programming in Go . ","text_count":134,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about developing web servers and clients in Go in Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Foundations of Network Programming in Go"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2jfr","search_text":"The third code portion of useContext.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jfs","search_text":"go func() { response, err := httpClient.Do(req) if err != nil { fmt.Println(err) data <- myData{nil, err} return } else { pack := myData{response, err} data <- pack } }() ","text_count":171,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go func() { \n    response, err := httpClient.Do(req) \n    if err != nil { \n        fmt.Println(err) \n        data &lt;- myData{nil, err} \n             return \n         } else { \n               pack := myData{response, err} \n               data &lt;- pack \n         } \n    }()"}]}]},{"block_type":"element","block":"k6pz2jft","search_text":"The fourth code segment of useContext.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jfu","search_text":"select { case <-c.Done(): tr.CancelRequest(req) <-data fmt.Println(\"The request was cancelled!\") return c.Err() case ok := <-data: err := ok.err resp := ok.r if err != nil { fmt.Println(\"Error select:\", err) return err } defer resp.Body.Close() realHTTPData, err := ioutil.ReadAll(resp.Body) if err != nil { fmt.Println(\"Error select:\", err) return err } fmt.Printf(\"Server Response: %s\\n\", realHTTPData) } return nil } ","text_count":420,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"select { \n   case &lt;-c.Done(): \n         tr.CancelRequest(req) \n         &lt;-data \n         fmt.Println(\"The request was cancelled!\") \n         return c.Err() \n   case ok := &lt;-data: \n         err := ok.err \n         resp := ok.r \n         if err != nil { \n               fmt.Println(\"Error select:\", err) \n               return err \n         } \n         defer resp.Body.Close() \n \n         realHTTPData, err := ioutil.ReadAll(resp.Body) \n         if err != nil { \n               fmt.Println(\"Error select:\", err) \n               return err \n         } \n         fmt.Printf(\"Server Response: %s\\n\", realHTTPData) \n \n   } \n   return nil \n}"}]}]},{"block_type":"element","block":"k6pz2jfv","search_text":"The remaining code of useContext.go , which is the implementation of the main() function, is as follows:","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":", which is the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, is as follows:"}]},{"block_type":"element","block":"k6pz2jfw","search_text":"func main() { if len(os.Args) == 1 { fmt.Println(\"Need a URL and a delay!\") return } myUrl = os.Args[1] if len(os.Args) == 3 { t, err := strconv.Atoi(os.Args[2]) if err != nil { fmt.Println(err) return } delay = t } fmt.Println(\"Delay:\", delay) c := context.Background() c, cancel := context.WithTimeout(c, time.Duration(delay)*time.Second) defer cancel() fmt.Printf(\"Connecting to %s \\n\", myUrl) w.Add(1) go connect(c) w.Wait() fmt.Println(\"Exiting...\") } ","text_count":457,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n   if len(os.Args) == 1 { \n         fmt.Println(\"Need a URL and a delay!\") \n         return \n   } \n \n    myUrl = os.Args[1] \n    if len(os.Args) == 3 { \n         t, err := strconv.Atoi(os.Args[2]) \n         if err != nil { \n               fmt.Println(err) \n               return \n        } \n        delay = t \n    } \n \n    fmt.Println(\"Delay:\", delay) \n    c := context.Background() \n    c, cancel := context.WithTimeout(c, time.Duration(delay)*time.Second) \n    defer cancel() \n \n    fmt.Printf(\"Connecting to %s \\n\", myUrl) \n    w.Add(1) \n    go connect(c) \n    w.Wait() \n    fmt.Println(\"Exiting...\") \n}"}]}]},{"block_type":"element","block":"k6pz2jfx","search_text":"The timeout period is defined by the context.WithTimeout() method. The connect() function that is executed as a goroutine will either terminate normally or when the cancel() function is executed.","text_count":195,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The timeout period is defined by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithTimeout()"}]},{"block_type":"text","content":"method. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"connect()"}]},{"block_type":"text","content":"function that is executed as a goroutine will either terminate normally or when the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cancel()"}]},{"block_type":"text","content":"function is executed."}]},{"block_type":"element","block":"k6pz2jfy","search_text":"Although it is not necessary to know about the server part of the operation, it is good to see how a Go version of a web server can be slow in a random way; that is, a random number generator decides how slow your web server will be. The name of the source file is slowWWW.go , and its contents are as follows:","text_count":310,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although it is not necessary to know about the server part of the operation, it is good to see how a Go version of a web server can be slow in a random way; that is, a random number generator decides how slow your web server will be. The name of the source file is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":", and its contents are as follows:"}]},{"block_type":"element","block":"k6pz2jfz","search_text":"package main import ( \"fmt\" \"math/rand\" \"net/http\" \"os\" \"time\" ) func random(min, max int) int { return rand.Intn(max-min) + min } func myHandler(w http.ResponseWriter, r *http.Request) { delay := random(0, 15) time.Sleep(time.Duration(delay) * time.Second) fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Fprintf(w, \"Delay: %d\\n\", delay) fmt.Printf(\"Served: %s\\n\", r.Host) } func main() { seed := time.Now().Unix() rand.Seed(seed) PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Using default port number: \", PORT) } else { PORT = \":\" + arguments[1] } http.HandleFunc(\"/\", myHandler) err := http.ListenAndServe(PORT, nil) if err != nil { fmt.Println(err) os.Exit(10) } } ","text_count":699,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"net/http\" \n    \"os\" \n    \"time\" \n) \n \nfunc random(min, max int) int { \n    return rand.Intn(max-min) + min \n} \n \nfunc myHandler(w http.ResponseWriter, r *http.Request) { \n    delay := random(0, 15) \n    time.Sleep(time.Duration(delay) * time.Second) \n \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Fprintf(w, \"Delay: %d\\n\", delay) \n    fmt.Printf(\"Served: %s\\n\", r.Host) \n} \n \nfunc main() { \n    seed := time.Now().Unix() \n    rand.Seed(seed) \n \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Using default port number: \", PORT) \n    } else { \n        PORT = \":\" + arguments[1] \n    } \n \n    http.HandleFunc(\"/\", myHandler) \n    err := http.ListenAndServe(PORT, nil) \n    if err != nil { \n        fmt.Println(err) \n        os.Exit(10) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jg0","search_text":"As you can see, you do not need to use the context package in the slowWWW.go file because it is the job of the web client to decide how much time it can wait for a response!","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, you do not need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":"file because it is the job of the web client to decide how much time it can wait for a response!"}]},{"block_type":"element","block":"k6pz2jg1","search_text":"The code of the myHandler() function is responsible for the slowness of the web server program. The delay can be from 0 seconds to 14 seconds, as introduced by the random(0, 15) function call.","text_count":192,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHandler()"}]},{"block_type":"text","content":"function is responsible for the slowness of the web server program. The delay can be from 0 seconds to 14 seconds, as introduced by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"random(0, 15)"}]},{"block_type":"text","content":"function call."}]},{"block_type":"element","block":"k6pz2jg2","search_text":"If you try to use the slowWWW.go web server using a tool such as wget(1) , you will receive the following output:","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":"web server using a tool such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wget(1)"}]},{"block_type":"text","content":", you will receive the following output:"}]},{"block_type":"element","block":"k6pz2jg3","search_text":"$ wget -qO- http://localhost:8001/ Serving: / Delay: 4 $ wget -qO- http://localhost:8001/ Serving: / Delay: 13","text_count":110,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ wget -qO- http://localhost:8001/\nServing: /\nDelay: 4\n$ wget -qO- http://localhost:8001/\nServing: /\nDelay: 13"}]}]},{"block_type":"element","block":"k6pz2jg4","search_text":"This happens because the default timeout value of wget(1) is larger.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This happens because the default timeout value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wget(1)"}]},{"block_type":"text","content":"is larger."}]},{"block_type":"element","block":"k6pz2jg5","search_text":"Executing useContext.go while slowWWW.go is already running in another Unix shell will create the following output when processed with the handy time(1) utility:","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"while"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":"is already running in another Unix shell will create the following output when processed with the handy"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time(1)"}]},{"block_type":"text","content":"utility:"}]},{"block_type":"element","block":"k6pz2jg6","search_text":"$ time go run useContext.go http://localhost:8001/ 1 Delay: 1 Connecting to http://localhost:8001/ Get http://localhost:8001/: net/http: request canceled The request was cancelled! Exiting... real 0m1.374s user 0m0.304s sys 0m0.117s $ time go run useContext.go http://localhost:8001/ 10 Delay: 10 Connecting to http://localhost:8001/ Get http://localhost:8001/: net/http: request canceled The request was cancelled! Exiting... real 0m10.381s user 0m0.314s sys 0m0.125s $ time go run useContext.go http://localhost:8001/ 15 Delay: 15 Connecting to http://localhost:8001/ Server Response: Serving: / Delay: 13 Exiting... real 0m13.379s user 0m0.309s sys 0m0.118s","text_count":660,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ time go run useContext.go http://localhost:8001/ 1\nDelay: 1\nConnecting to http://localhost:8001/\nGet http://localhost:8001/: net/http: request canceled\nThe request was cancelled!\nExiting...\n    \nreal  0m1.374s\nuser  0m0.304s\nsys   0m0.117s\n$ time go run useContext.go http://localhost:8001/ 10\nDelay: 10\nConnecting to http://localhost:8001/\nGet http://localhost:8001/: net/http: request canceled\nThe request was cancelled!\nExiting...\n    \nreal  0m10.381s\nuser  0m0.314s\nsys   0m0.125s\n$ time go run useContext.go http://localhost:8001/ 15\nDelay: 15\nConnecting to http://localhost:8001/\nServer Response: Serving: /\nDelay: 13\n    \nExiting...\n    \nreal  0m13.379s\nuser  0m0.309s\nsys   0m0.118s"}]}]},{"block_type":"element","block":"k6pz2jg7","search_text":"The output shows that only the third command actually got an answer from the HTTP server—the first two commands timed out!","text_count":122,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output shows that only the third command actually got an answer from the HTTP server&mdash;the first two commands timed out!"}]},{"block_type":"element","block":"k6pz2jg8","search_text":"Worker pools","text_count":12,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Worker pools"}]},{"block_type":"element","block":"k6pz2jg9","search_text":"Generally speaking, a Worker pool is a set of threads that are about to process jobs assigned to them. More or less, the Apache web server works that way: the main process accepts all incoming requests that are forwarded to the worker processes for getting served. Once a worker process has finished its job, it is ready to serve a new client. Nevertheless, there is a central difference here because our worker pool will use goroutines instead of threads. Additionally, threads do not usually die after serving a request because the cost of ending a thread and creating a new one is too high, whereas goroutines do die after finishing their job.","text_count":646,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Generally speaking, a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Worker pool"}]},{"block_type":"text","content":"is a set of threads that are about to process jobs assigned to them. More or less, the Apache web server works that way: the main process accepts all incoming requests that are forwarded to the worker processes for getting served. Once a worker process has finished its job, it is ready to serve a new client. Nevertheless, there is a central difference here because our worker pool will use goroutines instead of threads. Additionally, threads do not usually die after serving a request because the cost of ending a thread and creating a new one is too high, whereas goroutines do die after finishing their job."}]},{"block_type":"element","block":"k6pz2jga","search_text":"As you will see shortly, worker pools in Go are implemented with the help of buffered channels , because they allow you to limit the number of goroutines running at the same time.","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will see shortly, worker pools in Go are implemented with the help of"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"buffered channels"}]},{"block_type":"text","content":", because they allow you to limit the number of goroutines running at the same time."}]},{"block_type":"element","block":"k6pz2jgb","search_text":"The next program, workerPool.go , will be presented in five parts. The program will implement a simple task: it will process integer numbers and print their square values using a single goroutine for serving each request. Despite the deceptive simplicity of workerPool.go , the Go code of the program can be easily used as a template for implementing much more difficult tasks.","text_count":377,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next program,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":", will be presented in five parts. The program will implement a simple task: it will process integer numbers and print their square values using a single goroutine for serving each request. Despite the deceptive simplicity of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":", the Go code of the program can be easily used as a template for implementing much more difficult tasks."}]},{"block_type":"element","block":"k6pz2jgc","search_text":"Tip This is an advanced technique that can help you create server processes in Go that can accept and serve multiple clients using goroutines! ","text_count":143,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is an advanced technique that can help you create server processes in Go that can accept and serve multiple clients using goroutines!"}]}]},{"block_type":"element","block":"k6pz2jgd","search_text":"The first part of workerPool.go follows next:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jge","search_text":"package main import ( \"fmt\" \"os\" \"strconv\" \"sync\" \"time\" ) type Client struct { id int integer int } type Data struct { job Client square int } ","text_count":144,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"strconv\" \n    \"sync\" \n    \"time\" \n) \n \ntype Client struct { \n    id      int \n    integer int \n} \n \ntype Data struct { \n    job    Client \n    square int \n}"}]}]},{"block_type":"element","block":"k6pz2jgf","search_text":"Here you can see a technique that uses the Client structure for assigning a unique id to each request that will process. The Data structure is used for grouping the data of a Client with the actual results generated by the program. Put simply, the Client structure holds the input data of each request, whereas the Data structure holds the results of a request.","text_count":361,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here you can see a technique that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Client"}]},{"block_type":"text","content":"structure for assigning a unique id to each request that will process. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Data"}]},{"block_type":"text","content":"structure is used for grouping the data of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Client"}]},{"block_type":"text","content":"with the actual results generated by the program. Put simply, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Client"}]},{"block_type":"text","content":"structure holds the input data of each request, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Data"}]},{"block_type":"text","content":"structure holds the results of a request."}]},{"block_type":"element","block":"k6pz2jgg","search_text":"The second code portion of workerPool.go is shown in the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jgh","search_text":"var ( size = 10 clients = make(chan Client, size) data = make(chan Data, size) ) func worker(w *sync.WaitGroup) { for c := range clients { square := c.integer * c.integer output := Data{c, square} data <- output time.Sleep(time.Second) } w.Done() } ","text_count":249,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var ( \n    size    = 10 \n    clients = make(chan Client, size) \n    data    = make(chan Data, size) \n) \n \nfunc worker(w *sync.WaitGroup) { \n    for c := range clients { \n        square := c.integer * c.integer \n        output := Data{c, square} \n        data &lt;- output \n        time.Sleep(time.Second) \n    } \n    w.Done() \n}"}]}]},{"block_type":"element","block":"k6pz2jgi","search_text":"The preceding code has two interesting parts. The first part creates three global variables. The clients and data buffered channels are used for getting new client requests and writing the results, respectively. If you want your program to run faster, you can increase the value of the size parameter.","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code has two interesting parts. The first part creates three global variables. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"buffered channels are used for getting new client requests and writing the results, respectively. If you want your program to run faster, you can increase the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size"}]},{"block_type":"text","content":"parameter."}]},{"block_type":"element","block":"k6pz2jgj","search_text":"The second part is the implementation of the worker() function, which reads the clients channel in order to get new requests to serve. Once the processing is complete, the result is written to the data channel. The delay that is introduced using the time.Sleep(time.Second) statement is not necessary, but it gives you a better sense of the way the generated output will be printed.","text_count":382,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part is the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"worker()"}]},{"block_type":"text","content":"function, which reads the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"channel in order to get new requests to serve. Once the processing is complete, the result is written to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"channel. The delay that is introduced using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep(time.Second)"}]},{"block_type":"text","content":"statement is not necessary, but it gives you a better sense of the way the generated output will be printed."}]},{"block_type":"element","block":"k6pz2jgk","search_text":"The third part of workerPool.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jgl","search_text":"func makeWP(n int) { var w sync.WaitGroup for i := 0; i < n; i++ { w.Add(1) go worker(&w) } w.Wait() close(data) } func create(n int) { for i := 0; i < n; i++ { c := Client{i, i} clients <- c } close(clients) } ","text_count":211,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func makeWP(n int) { \n    var w sync.WaitGroup \n    for i := 0; i &lt; n; i++ { \n         w.Add(1) \n         go worker(&amp;w) \n    } \n    w.Wait() \n    close(data) \n} \n \nfunc create(n int) { \n    for i := 0; i &lt; n; i++ { \n        c := Client{i, i} \n        clients &lt;- c \n    } \n    close(clients) \n}"}]}]},{"block_type":"element","block":"k6pz2jgm","search_text":"The preceding code implements two functions, named makeWP() and create() . The purpose of the makeWP() function is to generate the required number of worker() goroutines for processing all requests. Although the w.Add(1) function is called in makeWP() , the w.Done() is called in the worker() function once a worker has finished its job.","text_count":337,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code implements two functions, named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"makeWP()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create()"}]},{"block_type":"text","content":". The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"makeWP()"}]},{"block_type":"text","content":"function is to generate the required number of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"worker()"}]},{"block_type":"text","content":"goroutines for processing all requests. Although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Add(1)"}]},{"block_type":"text","content":"function is called in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"makeWP()"}]},{"block_type":"text","content":", the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"w.Done()"}]},{"block_type":"text","content":"is called in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"worker()"}]},{"block_type":"text","content":"function once a worker has finished its job."}]},{"block_type":"element","block":"k6pz2jgn","search_text":"The purpose of the create() function is to create all requests properly using the Client type and then to write them to the clients channel for processing. Note that the clients channel is read by the worker() function.","text_count":219,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create()"}]},{"block_type":"text","content":"function is to create all requests properly using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Client"}]},{"block_type":"text","content":"type and then to write them to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"channel for processing. Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"channel is read by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"worker()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2jgo","search_text":"The fourth code segment of workerPool.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jgp","search_text":"func main() { fmt.Println(\"Capacity of clients:\", cap(clients)) fmt.Println(\"Capacity of data:\", cap(data)) if len(os.Args) != 3 { fmt.Println(\"Need #jobs and #workers!\") os.Exit(1) } nJobs, err := strconv.Atoi(os.Args[1]) if err != nil { fmt.Println(err) return } nWorkers, err := strconv.Atoi(os.Args[2]) if err != nil { fmt.Println(err) return } ","text_count":349,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fmt.Println(\"Capacity of clients:\", cap(clients)) \n    fmt.Println(\"Capacity of data:\", cap(data)) \n \n    if len(os.Args) != 3 { \n        fmt.Println(\"Need #jobs and #workers!\") \n        os.Exit(1) \n    } \n \n    nJobs, err := strconv.Atoi(os.Args[1]) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    nWorkers, err := strconv.Atoi(os.Args[2]) \n    if err != nil { \n        fmt.Println(err) \n        return \n   }"}]}]},{"block_type":"element","block":"k6pz2jgq","search_text":"In the preceding code, you read your command-line parameters. First, however, you see that you can use the cap() function to find the capacity of a channel.","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you read your command-line parameters. First, however, you see that you can use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cap()"}]},{"block_type":"text","content":"function to find the capacity of a channel."}]},{"block_type":"element","block":"k6pz2jgr","search_text":"If the number of workers is larger than the size of the clients buffered channel, then the number of goroutines that is going to be created will be equal to the size of the clients channel. Similarly, if the number of jobs is larger than the number of workers, the jobs will be served in smaller sets.","text_count":301,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If the number of workers is larger than the size of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"buffered channel, then the number of goroutines that is going to be created will be equal to the size of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"channel. Similarly, if the number of jobs is larger than the number of workers, the jobs will be served in smaller sets."}]},{"block_type":"element","block":"k6pz2jgs","search_text":"The program allows you to define the number of workers and the number of jobs using its command-line arguments. However, in order to change the size of the clients and data channels, you will need to make changes to the source code of the program.","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The program allows you to define the number of workers and the number of jobs using its command-line arguments. However, in order to change the size of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"channels, you will need to make changes to the source code of the program."}]},{"block_type":"element","block":"k6pz2jgt","search_text":"The remaining code of workerPool.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jgu","search_text":"go create(nJobs) finished := make(chan interface{}) go func() { for d := range data { fmt.Printf(\"Client ID: %d\\tint: \", d.job.id) fmt.Printf(\"%dtsquare: %d\\n\", d.job.integer, d.square) } finished <- true }() makeWP(nWorkers) fmt.Printf(\": %v\\n\", <-finished) } ","text_count":261,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"go create(nJobs) \nfinished := make(chan interface{}) \ngo func() { \n    for d := range data { \n        fmt.Printf(\"Client ID: %d\\tint: \", d.job.id) \n        fmt.Printf(\"%dtsquare: %d\\n\", d.job.integer, d.square) \n    } \n         finished &lt;- true \n    }() \n \n    makeWP(nWorkers) \n    fmt.Printf(\": %v\\n\", &lt;-finished) \n}"}]}]},{"block_type":"element","block":"k6pz2jgv","search_text":"First, you will call the create() function for mimicking the client requests that you will have to process. An anonymous goroutine is used for reading the data channel and printing the output to the screen. The finished channel is used for blocking the program until the anonymous goroutine is done reading the data channel. Therefore, the finished channel needs no particular type! Finally, you will call the makeWP() function for actually processing the requests. The <-finished statement in fmt.Printf() blocks, which means that it does not allow the program to end until somebody writes something to the finished channel. That somebody is the anonymous goroutine of the main() function. Additionally, although the anonymous function writes the value true to the finished channel, you can write false to it and have the same result, which is unblocking the main() function. Try it on your own!","text_count":896,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, you will call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"create()"}]},{"block_type":"text","content":"function for mimicking the client requests that you will have to process. An anonymous goroutine is used for reading the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"channel and printing the output to the screen. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"finished"}]},{"block_type":"text","content":"channel is used for blocking the program until the anonymous goroutine is done reading the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"channel. Therefore, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"finished"}]},{"block_type":"text","content":"channel needs no particular type! Finally, you will call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"makeWP()"}]},{"block_type":"text","content":"function for actually processing the requests. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;-finished"}]},{"block_type":"text","content":"statement in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt.Printf()"}]},{"block_type":"text","content":"blocks, which means that it does not allow the program to end until somebody writes something to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"finished"}]},{"block_type":"text","content":"channel. That somebody is the anonymous goroutine of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function. Additionally, although the anonymous function writes the value"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":"to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"finished"}]},{"block_type":"text","content":"channel, you can write&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"false"}]},{"block_type":"text","content":"to it and have the same result, which is unblocking the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function. Try it on your own!"}]},{"block_type":"element","block":"k6pz2jgw","search_text":"Executing workerPool.go will generate the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jgx","search_text":"$ go run workerPool.go 15 5 Capacity of clients: 10 Capacity of data: 10 Client ID: 0 int: 0 square: 0 Client ID: 4 int: 4 square: 16 Client ID: 1 int: 1 square: 1 Client ID: 3 int: 3 square: 9 Client ID: 2 int: 2 square: 4 Client ID: 5 int: 5 square: 25","text_count":254,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run workerPool.go 15 5\nCapacity of clients: 10\nCapacity of data: 10\nClient ID: 0      int: 0      square: 0\nClient ID: 4      int: 4      square: 16\nClient ID: 1      int: 1      square: 1\nClient ID: 3      int: 3      square: 9\nClient ID: 2      int: 2      square: 4\nClient ID: 5      int: 5      square: 25"}]}]},{"block_type":"element","block":"k6pz2jgy","search_text":"Client ID: 6 int: 6 square: 36 Client ID: 7 int: 7 square: 49 Client ID: 8 int: 8 square: 64 Client ID: 9 int: 9 square: 81 Client ID: 10 int: 10 square: 100 Client ID: 11 int: 11 square: 121 Client ID: 12 int: 12 square: 144 Client ID: 13 int: 13 square: 169 Client ID: 14 int: 14 square: 196 : true","text_count":300,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"Client ID: 6      int: 6      square: 36\nClient ID: 7      int: 7      square: 49\nClient ID: 8      int: 8      square: 64\nClient ID: 9      int: 9      square: 81\nClient ID: 10     int: 10     square: 100\nClient ID: 11     int: 11     square: 121\nClient ID: 12     int: 12     square: 144\nClient ID: 13     int: 13     square: 169\nClient ID: 14     int: 14     square: 196\n: true"}]}]},{"block_type":"element","block":"k6pz2jgz","search_text":"When you want to serve each individual request without expecting an answer from it in the main() function, as happened with workerPool.go , you have fewer things to worry about. A simple way both to use goroutines for processing your requests and to get an answer from them in the main() function is using shared memory or a monitor process that will collect the data instead of just printing it on the screen.","text_count":410,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When you want to serve each individual request without expecting an answer from it in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, as happened with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":", you have fewer things to worry about. A simple way both to use goroutines for processing your requests and to get an answer from them in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function is using shared memory or a monitor process that will collect the data instead of just printing it on the screen."}]},{"block_type":"element","block":"k6pz2jh0","search_text":"Finally, the work of the workerPool.go program is much simpler because the worker() function cannot fail. This will not be the case when you have to work over computer networks or with other kinds of resources that can fail.","text_count":224,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the work of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"program is much simpler because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"worker()"}]},{"block_type":"text","content":"function cannot fail. This will not be the case when you have to work over computer networks or with other kinds of resources that can fail."}]},{"block_type":"element","block":"k6pz2jh1","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2jh2","search_text":"The following are very useful resources:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following are very useful resources:"}]},{"block_type":"element","block":"k6pz2jh3","search_text":"Visit the documentation page of the sync package, which can be found at https://golang.org/pkg/sync/ . Visit the documentation page of the context package, which can be found at https://golang.org/pkg/context/ . You can learn more about the implementation of the Go scheduler by visiting https://golang.org/src/runtime/proc.go . You can view the design document of the Go scheduler at https://golang.org/s/go11sched . ","text_count":418,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/sync/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/sync/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/context/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/context/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the implementation of the Go scheduler by visiting&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/runtime/proc.go"},"children":[{"block_type":"text","content":"https://golang.org/src/runtime/proc.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"You can view the design document of the Go scheduler at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/s/go11sched"},"children":[{"block_type":"text","content":"https://golang.org/s/go11sched"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2jh4","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2jh5","search_text":"Try to implement a concurrent version of wc(1) that uses a buffered channel. Next, try to implement a concurrent version of wc(1) that uses shared memory. Finally, try to implement a concurrent version of wc(1) that uses a monitor goroutine. Modify the Go code of workerPool.go in order to save the results in a file. Use a mutex and a critical section while dealing with the file, or a monitor goroutine that will keep writing your data on the disk. What will happen to the workerPool.go program when the value of the size global variable becomes 1 ? Why? Modify the Go code of workerPool.go in order to implement the functionality of the wc(1) command-line utility. Modify the Go code of workerPool.go so that the size of the clients and data buffered channels can be defined as command-line arguments. Try to write a concurrent version of the find(1) command-line utility that uses a monitor goroutine. Modify the code of simpleContext.go so that the anonymous function used in all f1() , f2() , and f3() functions becomes a separate function. What is the main challenge of this code change? Modify the Go code of simpleContext.go so that all the f1() , f2() , and f3() functions use an externally created Context variable instead of defining their own. Modify the Go code of useContext.go in order to use either context.WithDeadline() or context.WithCancel() instead of context.WithTimeout() . Finally, try to implement a concurrent version of the find(1) command-line utility using a sync.Mutex mutex. ","text_count":1507,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to implement a concurrent version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"that uses a buffered channel."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Next, try to implement a concurrent version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"that uses shared memory."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Finally, try to implement a concurrent version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"that uses a monitor goroutine."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"in order to save the results in a file. Use a mutex and a critical section while dealing with the file, or a monitor goroutine that will keep writing your data on the disk."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"What will happen to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"program when the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"size"}]},{"block_type":"text","content":"global variable becomes"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":"? Why?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"in order to implement the functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wc(1)"}]},{"block_type":"text","content":"command-line utility."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"workerPool.go"}]},{"block_type":"text","content":"so that the size of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clients"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"data"}]},{"block_type":"text","content":"buffered channels can be defined as command-line arguments."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to write a concurrent version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"find(1)"}]},{"block_type":"text","content":"command-line utility that uses a monitor goroutine."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"so that the anonymous function used in all"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f3()"}]},{"block_type":"text","content":"functions becomes a separate function. What is the main challenge of this code change?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"simpleContext.go"}]},{"block_type":"text","content":"so that all the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f3()"}]},{"block_type":"text","content":"functions use an externally created"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Context"}]},{"block_type":"text","content":"variable instead of defining their own."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"in order to use either"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithDeadline()"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithCancel()"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context.WithTimeout()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Finally, try to implement a concurrent version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"find(1)"}]},{"block_type":"text","content":"command-line utility using a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":"mutex."}]}]},{"block_type":"element","block":"k6pz2jh6","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2jh7","search_text":"This chapter addressed many important topics related to goroutines. Mainly, however, it clarified the power of the select statement. Additionally, it demonstrated the use of the context standard Go package.","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter addressed many important topics related to goroutines. Mainly, however, it clarified the power of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement. Additionally, it demonstrated the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2jh8","search_text":"Due to the capabilities of the select statement, channels are the preferred Go way for interconnecting the components of a Go program.","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Due to the capabilities of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement, channels are the preferred Go way for interconnecting the components of a Go program."}]},{"block_type":"element","block":"k6pz2jh9","search_text":"There are many rules in concurrent programming; however, the most important rule is that you should avoid sharing things unless you have a pretty good reason to do so. Shared data is the root of all nasty bugs in concurrent programming.","text_count":236,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are many rules in concurrent programming; however, the most important rule is that you should avoid sharing things unless you have a pretty good reason to do so. Shared data is the root of all nasty bugs in concurrent programming."}]},{"block_type":"element","block":"k6pz2jha","search_text":"What you must remember from this chapter is that although shared memory used to be the only way for exchanging data over the threads of the same process, Go offers better ways for goroutines to communicate with each other. So think in Go terms before deciding to use shared memory in your Go code. Nonetheless, if you really have to use shared memory, you might want to use a monitor goroutine instead.","text_count":402,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What you must remember from this chapter is that although shared memory used to be the only way for exchanging data over the threads of the same process, Go offers better ways for goroutines to communicate with each other. So think in Go terms before deciding to use shared memory in your Go code. Nonetheless, if you really have to use shared memory, you might want to use a monitor goroutine instead."}]},{"block_type":"element","block":"k6pz2jhb","search_text":"The primary subjects of the next chapter will be code testing, code optimization, and code profiling with Go. Apart from these topics, you will learn about benchmarking Go code, cross compilation, and finding unreachable Go code.","text_count":229,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The primary subjects of the next chapter will be code testing, code optimization, and code profiling with Go. Apart from these topics, you will learn about benchmarking Go code, cross compilation, and finding unreachable Go code."}]},{"block_type":"element","block":"k6pz2jhc","search_text":"At the end of the next chapter, you will also learn how to document your Go code and how to generate HTML output using the godoc utility.","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"At the end of the next chapter, you will also learn how to document your Go code and how to generate HTML output using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility."}]}]},{"title":"Code Testing, Optimization, and Profiling","author":"Mihalis Tsoukalos","block":"k6pz24q6","number":11,"contents":[{"block_type":"element","block":"k6pz2jhd","search_text":"The previous chapter discussed concurrency in Go and how the select statement allows you to use channels as glue for controlling goroutines and allowing goroutines to communicate.","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The previous chapter discussed concurrency in Go and how the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"select"}]},{"block_type":"text","content":"statement allows you to use channels as glue for controlling goroutines and allowing goroutines to communicate."}]},{"block_type":"element","block":"k6pz2jhe","search_text":"The Go topics in this chapter are just moderately advanced, yet they are very practical and important, especially when you are interested in improving the performance of your Go programs and discovering bugs quickly. This chapter primarily addresses code optimization, code testing, code documentation, and code profiling.","text_count":322,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go topics in this chapter are just moderately advanced, yet they are very practical and important, especially when you are interested in improving the performance of your Go programs and discovering bugs quickly. This chapter primarily addresses code optimization, code testing, code documentation, and code profiling."}]},{"block_type":"element","block":"k6pz2jhf","search_text":"Code optimization is a process where one or more developers try to make certain parts of a program run faster, more efficient, or use fewer resources. Put simply, code optimization is about eliminating the bottlenecks of a program.","text_count":231,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Code optimization"}]},{"block_type":"text","content":"is a process where one or more developers try to make certain parts of a program run faster, more efficient, or use fewer resources. Put simply, code optimization is about eliminating the bottlenecks of a program."}]},{"block_type":"element","block":"k6pz2jhg","search_text":"Code testing is about making sure that your code does what you want it to do. In this chapter, you will experience the Go way of testing code. The best time to write code to test your program is during the development phase, as this can help reveal bugs in your code as early as possible.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Code testing"}]},{"block_type":"text","content":"is about making sure that your code does what you want it to do. In this chapter, you will experience the Go way of testing code. The best time to write code to test your program is during the development phase, as this can help reveal bugs in your code as early as possible."}]},{"block_type":"element","block":"k6pz2jhh","search_text":"Code profiling relates to measuring certain aspects of a program in order to get a detailed understanding of the way the code works. The results of code profiling may help you decide which parts of your code need to change.","text_count":223,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Code profiling"}]},{"block_type":"text","content":"relates to measuring certain aspects of a program in order to get a detailed understanding of the way the code works. The results of code profiling may help you decide which parts of your code need to change."}]},{"block_type":"element","block":"k6pz2jhi","search_text":"I hope that you already recognize the importance of documenting your code in order to describe the decisions you made in developing the implementation of your program. In this chapter, you will see how Go can help you generate documentation for the modules that you implement.","text_count":276,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"I hope that you already recognize the importance of documenting your code in order to describe the decisions you made in developing the implementation of your program. In this chapter, you will see how Go can help you generate documentation for the modules that you implement."}]},{"block_type":"element","block":"k6pz2jhj","search_text":"Note Documentation is so important that some developers write the documentation first and the code afterwards! ","text_count":111,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Documentation is so important that some developers write the documentation first and the code afterwards!"}]}]},{"block_type":"element","block":"k6pz2jhk","search_text":"In this chapter of Mastering Go , you will learn the following topics:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2jhl","search_text":"Profiling Go code The go tool pprof utility Using the web interface of the Go profiler Testing Go code The go test command The go tool trace utility Benchmarking Go code Cross-compilation Generating documentation for your Go code Creating example functions Finding unreachable Go code in your programs ","text_count":302,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Profiling Go code"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"utility"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the web interface of the Go profiler"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Testing Go code"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Benchmarking Go code"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Cross-compilation"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Generating documentation for your Go code"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Creating example functions"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Finding unreachable Go code in your programs"}]}]},{"block_type":"element","block":"k6pz2jhm","search_text":"The Go version used in this chapter","text_count":35,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The Go version used in this chapter"}]},{"block_type":"element","block":"k6pz2jhn","search_text":"Note that in this chapter, we will be using the latest Go version on a macOS machine. At the time of writing, this is Go version 1.10:","text_count":134,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that in this chapter, we will be using the latest Go version on a macOS machine. At the time of writing, this is Go version 1.10:"}]},{"block_type":"element","block":"k6pz2jho","search_text":"$ date Fri Mar 9 23:17:49 EET 2018 $ go version go version go1.10 darwin/amd64 ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ date\nFri Mar 9 23:17:49 EET 2018\n$ go version\ngo version go1.10 darwin/amd64"}]}]},{"block_type":"element","block":"k6pz2jhp","search_text":"The reason I mention this is that you will need at least Go version 1.10 in order to be able to use the web interface of the Go code profiler. However, the rest of the presented commands and code will work just fine with earlier Go versions.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason I mention this is that you will need at least Go version 1.10 in order to be able to use the web interface of the Go code profiler. However, the rest of the presented commands and code will work just fine with earlier Go versions."}]},{"block_type":"element","block":"k6pz2jhq","search_text":"Comparing Go version 1.10 with Go version 1.9","text_count":45,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Comparing Go version 1.10 with Go version 1.9"}]},{"block_type":"element","block":"k6pz2jhr","search_text":"This section will list the most important differences between Go version 1.9 and Go version 1.10, just to give you an idea of the pace of Go changes.","text_count":149,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will list the most important differences between Go version 1.9 and Go version 1.10, just to give you an idea of the pace of Go changes."}]},{"block_type":"element","block":"k6pz2jhs","search_text":"Some of the changes in Go version 1.10 are as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Some of the changes in Go version 1.10 are as follows:"}]},{"block_type":"element","block":"k6pz2jht","search_text":"There is a change in the way that the GOROOT and GOTMPDIR environment variables are defined. The go test command caches test results, which means that it might run a little faster. The go doc tool now includes output about functions that return slices of a type or a pointer to a type when you tell go doc to display data about that type. The runtime/pprof package that you will see later in this chapter now includes symbol information about the blocking and mutex profiles. The go fix tool replaces the import statements of golang.org/x/net/context with just context . The go tool proff includes a web interface. Although this is a major change, it has nothing to do with the Go programming language itself and therefore does not break any existing Go code. You will see that web interface in action later in this chapter. Go version 1.10 includes minor changes to some packages of the standard Go library, including archive/tar and archive/zip , debug/macho , hash , html/template , math/big , net/url , os , time , unicode , and net/smtp . ","text_count":1044,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is a change in the way that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOROOT"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOTMPDIR"}]},{"block_type":"text","content":"environment variables are defined."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command caches test results, which means that it might run a little faster."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go doc"}]},{"block_type":"text","content":"tool now includes output about functions that return slices of a type or a pointer to a type when you tell"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go doc"}]},{"block_type":"text","content":"to display data about that type."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"package that you will see later in this chapter now includes symbol information about the blocking and mutex profiles."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go fix"}]},{"block_type":"text","content":"tool replaces the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"statements of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"golang.org/x/net/context"}]},{"block_type":"text","content":"with just"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool proff"}]},{"block_type":"text","content":"includes a web interface. Although this is a major change, it has nothing to do with the Go programming language itself and therefore does not break any existing Go code. You will see that web interface in action later in this chapter."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go version 1.10 includes minor changes to some packages of the standard Go library, including"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"archive/tar"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"archive/zip"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"debug/macho"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"hash"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"math/big"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/url"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"unicode"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/smtp"}]},{"block_type":"text","content":"."}]}]}]},{"block_type":"element","block":"k6pz2jhu","search_text":"As you must realize, the Go programming language progresses without breaking things. This might look insignificant at first, but it is a very important feature of Go which guarantees that the existing Go code will continue to compile without changes while Go evolves. A side effect of this is that this book will be relevant for many years!","text_count":340,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you must realize, the Go programming language progresses without breaking things. This might look insignificant at first, but it is a very important feature of Go which guarantees that the existing Go code will continue to compile without changes while Go evolves. A side effect of this is that this book will be relevant for many years!"}]},{"block_type":"element","block":"k6pz2jhv","search_text":"Installing a beta or RC version of Go","text_count":37,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Installing a beta or RC version of Go"}]},{"block_type":"element","block":"k6pz2jhw","search_text":"If you are eager to try the latest version of Go, even if it means that you will need to install a beta or a Release Candidate ( RC ) version of Go, there is a way!","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are eager to try the latest version of Go, even if it means that you will need to install a beta or a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Release Candidate"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"RC"}]},{"block_type":"text","content":") version of Go, there is a way!"}]},{"block_type":"element","block":"k6pz2jhx","search_text":"Note Despite their name, Release Candidate versions of Go are pretty stable. Just do not install a RC version on a production Unix machine without having a very good reason to do so! ","text_count":183,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Despite their name, Release Candidate versions of Go are pretty stable. Just do not install a RC version on a production Unix machine without having a very good reason to do so!"}]}]},{"block_type":"element","block":"k6pz2jhy","search_text":"If you have a version of Go that is older than 1.10 and you want to try Go version 1.10 RC1, you can do that as follows:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you have a version of Go that is older than 1.10 and you want to try Go version 1.10 RC1, you can do that as follows:"}]},{"block_type":"element","block":"k6pz2jhz","search_text":"$ go get golang.org/x/build/version/go1.10rc1 ","text_count":46,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go get golang.org/x/build/version/go1.10rc1"}]}]},{"block_type":"element","block":"k6pz2ji0","search_text":"You should expect to execute an analogous command if you want to install a different version of Go. On a macOS High Sierra system that runs release 10.13.3, the new Go binary will be installed inside ~/go/bin :","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should expect to execute an analogous command if you want to install a different version of Go. On a macOS High Sierra system that runs release 10.13.3, the new Go binary will be installed inside"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"~/go/bin"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ji1","search_text":"$ cd ~/go/bin $ ls -l -rwxr-xr-x 1 mtsouk staff 6051164 Jan 30 19:04 go1.10rc1 ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cd ~/go/bin\n$ ls -l\n-rwxr-xr-x 1 mtsouk staff 6051164 Jan 30 19:04 go1.10rc1"}]}]},{"block_type":"element","block":"k6pz2ji2","search_text":"If you try to execute go1.10rc1 , you will get the following output:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go1.10rc1"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2ji3","search_text":"$ ./go1.10rc1 go1.10rc1: not downloaded. Run 'go1.10rc1 download' to install to /Users/mtsouk/sdk/go1.10rc1 ","text_count":108,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ./go1.10rc1\ngo1.10rc1: not downloaded. Run 'go1.10rc1 download' to install to /Users/mtsouk/sdk/go1.10rc1"}]}]},{"block_type":"element","block":"k6pz2ji4","search_text":"Next you will have to execute the remaining files of Go version 1.10 RC1 as follows:","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Next you will have to execute the remaining files of Go version 1.10 RC1 as follows:"}]},{"block_type":"element","block":"k6pz2ji5","search_text":"$ ./go1.10rc1 download $ ls -l ~/sdk/go1.10rc1/ total 248016 -rw-r--r-- 1 mtsouk staff 47028 Jan 25 19:30 AUTHORS -rw-r--r-- 1 mtsouk staff 1576 Jan 25 19:30 CONTRIBUTING.md -rw-r--r-- 1 mtsouk staff 61940 Jan 25 19:30 CONTRIBUTORS -rw-r--r-- 1 mtsouk staff 1479 Jan 25 19:30 LICENSE -rw-r--r-- 1 mtsouk staff 1303 Jan 25 19:30 PATENTS -rw-r--r-- 1 mtsouk staff 1601 Jan 25 19:30 README.md -rw-r--r-- 1 mtsouk staff 9 Jan 25 19:30 VERSION drwxr-xr-x 16 mtsouk staff 512 Jan 30 19:07 api drwxr-xr-x 5 mtsouk staff 160 Jan 30 19:07 bin drwxr-xr-x 4 mtsouk staff 128 Jan 30 19:07 blog drwxr-xr-x 48 mtsouk staff 1536 Jan 30 19:07 doc -rw-r--r-- 1 mtsouk staff 5686 Jan 25 19:30 favicon.ico -rw-r--r-- 1 mtsouk staff 117832137 Jan 30 19:07 go1.10rc1.darwin-amd64.tar.gz drwxr-xr-x 3 mtsouk staff 96 Jan 30 19:07 lib drwxr-xr-x 16 mtsouk staff 512 Jan 30 19:07 misc drwxr-xr-x 8 mtsouk staff 256 Jan 30 19:07 pkg -rw-r--r-- 1 mtsouk staff 26 Jan 25 19:30 robots.txt drwxr-xr-x 68 mtsouk staff 2176 Jan 30 19:07 src drwxr-xr-x 295 mtsouk staff 9440 Jan 30 19:07 test","text_count":1060,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ./go1.10rc1 download\n$ ls -l ~/sdk/go1.10rc1/\ntotal 248016\n-rw-r--r-- 1 mtsouk staff 47028 Jan 25 19:30 AUTHORS\n-rw-r--r-- 1 mtsouk staff 1576 Jan 25 19:30 CONTRIBUTING.md\n-rw-r--r-- 1 mtsouk staff 61940 Jan 25 19:30 CONTRIBUTORS\n-rw-r--r-- 1 mtsouk staff 1479 Jan 25 19:30 LICENSE\n-rw-r--r-- 1 mtsouk staff 1303 Jan 25 19:30 PATENTS\n-rw-r--r-- 1 mtsouk staff 1601 Jan 25 19:30 README.md\n-rw-r--r-- 1 mtsouk staff 9 Jan 25 19:30 VERSION\ndrwxr-xr-x 16 mtsouk staff 512 Jan 30 19:07 api\ndrwxr-xr-x 5 mtsouk staff 160 Jan 30 19:07 bin\ndrwxr-xr-x 4 mtsouk staff 128 Jan 30 19:07 blog\ndrwxr-xr-x 48 mtsouk staff 1536 Jan 30 19:07 doc\n-rw-r--r-- 1 mtsouk staff 5686 Jan 25 19:30 favicon.ico\n-rw-r--r-- 1 mtsouk staff 117832137 Jan 30 19:07 go1.10rc1.darwin-amd64.tar.gz\ndrwxr-xr-x 3 mtsouk staff 96 Jan 30 19:07 lib\ndrwxr-xr-x 16 mtsouk staff 512 Jan 30 19:07 misc\ndrwxr-xr-x 8 mtsouk staff 256 Jan 30 19:07 pkg\n-rw-r--r-- 1 mtsouk staff 26 Jan 25 19:30 robots.txt\ndrwxr-xr-x 68 mtsouk staff 2176 Jan 30 19:07 src\ndrwxr-xr-x 295 mtsouk staff 9440 Jan 30 19:07 test"}]}]},{"block_type":"element","block":"k6pz2ji6","search_text":"You can now use Go version 1.10 RC1 as go1.10rc1 :","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can now use Go version 1.10 RC1 as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go1.10rc1"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2ji7","search_text":"$ ~/go/bin/go1.10rc1 version go version go1.10rc1 darwin/amd64 ","text_count":63,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ~/go/bin/go1.10rc1 version\ngo version go1.10rc1 darwin/amd64"}]}]},{"block_type":"element","block":"k6pz2ji8","search_text":"About optimization","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About optimization"}]},{"block_type":"element","block":"k6pz2ji9","search_text":"Code optimization is both an art and a science! This means that there is no deterministic way to help you optimize your Go code, or any other code in any programming language, and that you should use your brain and try many things if you want to make your code run faster.","text_count":272,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Code optimization"}]},{"block_type":"text","content":"is both an art and a science! This means that there is no deterministic way to help you optimize your Go code, or any other code in any programming language, and that you should use your brain and try many things if you want to make your code run faster."}]},{"block_type":"element","block":"k6pz2jia","search_text":"Tip You should make sure that you are optimizing code that does not contain any bugs , because there is no point in optimizing a bug. If you have any bugs in your program, you should debug it first! ","text_count":199,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should make sure that you are optimizing code that does not contain any"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"bugs"}]},{"block_type":"text","content":", because there is no point in optimizing a bug. If you have any bugs in your program, you should debug it first!"}]}]},{"block_type":"element","block":"k6pz2jib","search_text":"If you are really into code optimization, you might want to read Compilers: Principles, Techniques and Tools by Alfred V. Aho , Monica S. Lam , Ravi Sethi and Jeffrey D. Ullman , Pearson Education Limited , 2014 , which focuses on compiler construction. Additionally, all volumes in The Art of Computer Programming series by Donald Knuth , Addison-Wesley Professional , 1998 , are a great resource for all aspects of programming.","text_count":429,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you are really into code optimization, you might want to read"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Compilers: Principles, Techniques and Tools"}]},{"block_type":"text","content":"by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Alfred V. Aho"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Monica S. Lam"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Ravi Sethi"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Jeffrey D. Ullman"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Pearson Education Limited"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"2014"}]},{"block_type":"text","content":", which focuses on compiler construction. Additionally, all volumes in"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Art of Computer Programming"}]},{"block_type":"text","content":"series by"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Donald Knuth"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Addison-Wesley Professional"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"1998"}]},{"block_type":"text","content":", are a great resource for all aspects of programming."}]},{"block_type":"element","block":"k6pz2jic","search_text":"Always remember what Donald Knuth said about optimization:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Always remember what"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Donald Knuth"}]},{"block_type":"text","content":"said about optimization:"}]},{"block_type":"element","block":"k6pz2jid","search_text":"The real problem is that programmers have spent far too much time worrying about efficiency in the wrong places and at the wrong times; premature optimization is the root of all evil (or at least most of it) in programming. ","text_count":224,"tag_name":"blockquote","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The real problem is that programmers have spent far too much time worrying about efficiency in the wrong places and at the wrong times; premature optimization is the root of all evil (or at least most of it) in programming."}]}]},{"block_type":"element","block":"k6pz2jie","search_text":"Optimizing Go code","text_count":18,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Optimizing Go code"}]},{"block_type":"element","block":"k6pz2jif","search_text":"Code optimization is the process where you try to discover the parts of your code that have a big influence on the performance of the entire program in order to make them run faster or use fewer resources.","text_count":205,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Code optimization"}]},{"block_type":"text","content":"is the process where you try to discover the parts of your code that have a big influence on the performance of the entire program in order to make them run faster or use fewer resources."}]},{"block_type":"element","block":"k6pz2jig","search_text":"The benchmarking section that appears later in this chapter will greatly help you understand what is going on with your code behind the scenes and which parameters of your program have the greatest impact on the performance of your program.","text_count":240,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The benchmarking section that appears later in this chapter will greatly help you understand what is going on with your code behind the scenes and which parameters of your program have the greatest impact on the performance of your program."}]},{"block_type":"element","block":"k6pz2jih","search_text":"However, do not underestimate common sense. Put simply, if one of your functions is executed ten-thousand times more than the rest of the functions of a program, try to optimize that function first.","text_count":198,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"However, do not underestimate common sense. Put simply, if one of your functions is executed ten-thousand times more than the rest of the functions of a program, try to optimize that function first."}]},{"block_type":"element","block":"k6pz2jii","search_text":"Tip The general advice for optimization is that you must optimize bug-free code only. This means that you must optimize working code only. Therefore, you should first try to write correct code even if that code is slow. Finally, the single most frequent mistake that programmers make is trying to optimize the first version of their code, which is the root of most bugs! ","text_count":371,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The general advice for optimization is that you must optimize bug-free code only. This means that you must optimize working code only. Therefore, you should first try to write correct code even if that code is slow. Finally, the single most frequent mistake that programmers make is trying to optimize the first version of their code, which is the root of most bugs!"}]}]},{"block_type":"element","block":"k6pz2jij","search_text":"Again, code optimization is both an art and a science, which means that it is a pretty difficult task. The next section about profiling Go code will definitely help you with code optimization because the main purpose of profiling is to find the bottlenecks in your code in order to optimize the right and most important parts of your program.","text_count":342,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Again, code optimization is both an art and a science, which means that it is a pretty difficult task. The next section about profiling Go code will definitely help you with code optimization because the main purpose of profiling is to find the bottlenecks in your code in order to optimize the right and most important parts of your program."}]},{"block_type":"element","block":"k6pz2jik","search_text":"Profiling Go code","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Profiling Go code"}]},{"block_type":"element","block":"k6pz2jil","search_text":"Profiling is a process of dynamic program analysis that measures various values related to program execution in order to give you a better understanding on the behavior of your program. In this section, you will learn how to profile Go code in order to understand your code better and improve its performance. Sometimes, code profiling can even reveal bugs!","text_count":357,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Profiling"}]},{"block_type":"text","content":"is a process of dynamic program analysis that measures various values related to program execution in order to give you a better understanding on the behavior of your program. In this section, you will learn how to profile Go code in order to understand your code better and improve its performance. Sometimes, code profiling can even reveal bugs!"}]},{"block_type":"element","block":"k6pz2jim","search_text":"First, we will use the command-line interface of the Go profiler. Next, we will use the brand new web interface of the Go profiler!","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, we will use the command-line interface of the Go profiler. Next, we will use the brand new web interface of the Go profiler!"}]},{"block_type":"element","block":"k6pz2jin","search_text":"The single most important thing to remember is that if you want to profile Go code, you will need to import the runtime/pprof standard Go package, either directly or indirectly. You can find the help page of the pprof tool by executing the go tool pprof -help command, which will generate lots of output.","text_count":304,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The single most important thing to remember is that if you want to profile Go code, you will need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"standard Go package, either directly or indirectly. You can find the help page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pprof"}]},{"block_type":"text","content":"tool by executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof -help"}]},{"block_type":"text","content":"command, which will generate lots of output."}]},{"block_type":"element","block":"k6pz2jio","search_text":"The net/http/pprof standard Go package","text_count":38,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The net/http/pprof standard Go package"}]},{"block_type":"element","block":"k6pz2jip","search_text":"Although Go comes with the low-level runtime/pprof standard Go package, there is also a high-level net/http/pprof package that should be used when you want to profile a web application written in Go. As this chapter will not talk about creating HTTP servers in Go, you will learn more about the net/http/pprof package in Chapter 12, The Foundations of Network Programming in Go .","text_count":379,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although Go comes with the low-level"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"standard Go package, there is also a high-level"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package that should be used when you want to profile a web application written in Go. As this chapter will not talk about creating HTTP servers in Go, you will learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package in Chapter 12,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Foundations of Network Programming in Go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jiq","search_text":"A simple profiling example","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A simple profiling example"}]},{"block_type":"element","block":"k6pz2jir","search_text":"Go supports two kinds of profiling: CPU profiling and memory profiling . It is not recommended that you profile an application for both kinds at the same time, because these two different kinds of profiling do not work well with each other. The profileMe.go application is an exception, however, because it is used for illustrating the two techniques.","text_count":351,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go supports two kinds of profiling:"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"CPU profiling"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"memory profiling"}]},{"block_type":"text","content":". It is not recommended that you profile an application for both kinds at the same time, because these two different kinds of profiling do not work well with each other. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"application is an exception, however, because it is used for illustrating the two techniques."}]},{"block_type":"element","block":"k6pz2jis","search_text":"The Go code to be profiled is saved as profileMe.go , and it will be presented in five parts. The first part of profileMe.go is shown in the following Go code:","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code to be profiled is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":", and it will be presented in five parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jit","search_text":"package main import ( \"fmt\" \"math\" \"os\" \"runtime\" \"runtime/pprof\" \"time\" ) func fibo1(n int) int64 { if n == 0 || n == 1 { return int64(n) } time.Sleep(time.Millisecond) return int64(fibo2(n-1)) + int64(fibo2(n-2)) } ","text_count":217,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"math\" \n    \"os\" \n    \"runtime\" \n    \"runtime/pprof\" \n    \"time\" \n) \nfunc fibo1(n int) int64 { \n    if n == 0 || n == 1 { \n          return int64(n) \n    } \n    time.Sleep(time.Millisecond) \n    return int64(fibo2(n-1)) + int64(fibo2(n-2)) \n}"}]}]},{"block_type":"element","block":"k6pz2jiu","search_text":"Notice that it is compulsory to import the runtime/pprof package directly or indirectly for your program to create profiling data. The reason for calling time.Sleep() in the fibo1() function is to slow it down a bit. You will learn why, near the end of this section.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that it is compulsory to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"package directly or indirectly for your program to create profiling data. The reason for calling"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1()"}]},{"block_type":"text","content":"function is to slow it down a bit. You will learn why, near the end of this section."}]},{"block_type":"element","block":"k6pz2jiv","search_text":"The second code segment of profileMe.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jiw","search_text":"func fibo2(n int) int { fn := make(map[int]int) for i := 0; i <= n; i++ { var f int if i <= 2 { f = 1 } else { f = fn[i-1] + fn[i-2] } fn[i] = f } time.Sleep(50 * time.Millisecond) return fn[n] } ","text_count":196,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func fibo2(n int) int { \n    fn := make(map[int]int) \n    for i := 0; i &lt;= n; i++ { \n        var f int \n        if i &lt;= 2 { \n            f = 1 \n        } else { \n            f = fn[i-1] + fn[i-2] \n        } \n        fn[i] = f \n    } \n    time.Sleep(50 * time.Millisecond) \n    return fn[n] \n}"}]}]},{"block_type":"element","block":"k6pz2jix","search_text":"The preceding code contains the implementation of another Go function that uses a different algorithm for calculating the numbers of the Fibonacci sequence.","text_count":156,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code contains the implementation of another Go function that uses a different algorithm for calculating the numbers of the Fibonacci sequence."}]},{"block_type":"element","block":"k6pz2jiy","search_text":"The third part of profileMe.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jiz","search_text":"func N1(n int) bool { k := math.Floor(float64(n/2 + 1)) for i := 2; i < int(k); i++ { if (n % i) == 0 { return false } } return true } func N2(n int) bool { for i := 2; i < n; i++ { if (n % i) == 0 { return false } } return true } ","text_count":231,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func N1(n int) bool { \n    k := math.Floor(float64(n/2 + 1)) \n    for i := 2; i &lt; int(k); i++ { \n         if (n % i) == 0 { \n               return false \n         } \n    } \n    return true \n} \nfunc N2(n int) bool { \n    for i := 2; i &lt; n; i++ { \n        if (n % i) == 0 { \n            return false \n        } \n    } \n    return true \n}"}]}]},{"block_type":"element","block":"k6pz2jj0","search_text":"Both the N1() and N2() functions are used for finding out whether a given integer is a prime number or not. The first function is optimized because its for loop iterates over approximately half the numbers used in the for loop of N2() . As both functions are relatively slow, there is no need for a call to time.Sleep() here.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"N1()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"N2()"}]},{"block_type":"text","content":"functions are used for finding out whether a given integer is a prime number or not. The first function is optimized because its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop iterates over approximately half the numbers used in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"N2()"}]},{"block_type":"text","content":". As both functions are relatively slow, there is no need for a call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"here."}]},{"block_type":"element","block":"k6pz2jj1","search_text":"The fourth code segment of profileMe.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jj2","search_text":"func main() { cpuFile, err := os.Create(\"/tmp/cpuProfile.out\") if err != nil { fmt.Println(err) return } pprof.StartCPUProfile(cpuFile) defer pprof.StopCPUProfile() total := 0 for i := 2; i < 100000; i++ { n := N1(i) if n { total = total + 1 } } fmt.Println(\"Total primes:\", total) total = 0 for i := 2; i < 100000; i++ { n := N2(i) if n { total = total + 1 } } fmt.Println(\"Total primes:\", total) for i := 1; i < 90; i++ { n := fibo1(i) fmt.Print(n, \" \") } fmt.Println() for i := 1; i < 90; i++ { n := fibo2(i) fmt.Print(n, \" \") } fmt.Println() runtime.GC() ","text_count":559,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    cpuFile, err := os.Create(\"/tmp/cpuProfile.out\") \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n    pprof.StartCPUProfile(cpuFile) \n    defer pprof.StopCPUProfile() \n    total := 0 \n    for i := 2; i &lt; 100000; i++ { \n        n := N1(i) \n        if n { \n            total = total + 1 \n        } \n    } \n    fmt.Println(\"Total primes:\", total) \n    total = 0 \n    for i := 2; i &lt; 100000; i++ { \n        n := N2(i) \n        if n { \n            total = total + 1 \n        } \n    } \n    fmt.Println(\"Total primes:\", total) \n    for i := 1; i &lt; 90; i++ { \n        n := fibo1(i) \n        fmt.Print(n, \" \") \n    } \n    fmt.Println() \n    for i := 1; i &lt; 90; i++ { \n        n := fibo2(i) \n        fmt.Print(n, \" \") \n    } \n    fmt.Println() \n    runtime.GC()"}]}]},{"block_type":"element","block":"k6pz2jj3","search_text":"The call to os.Create() is used to have a file to which to write the profiling data. The pprof.StartCPUProfile() call begins the CPU profiling of the program, and the call to pprof.StopCPUProfile() stops it.","text_count":207,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Create()"}]},{"block_type":"text","content":"is used to have a file to which to write the profiling data. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pprof.StartCPUProfile()"}]},{"block_type":"text","content":"call begins the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"CPU profiling"}]},{"block_type":"text","content":"of the program, and the call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pprof.StopCPUProfile()"}]},{"block_type":"text","content":"stops it."}]},{"block_type":"element","block":"k6pz2jj4","search_text":"The last part of profileMe.go follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jj5","search_text":"// Memory profiling! memory, err := os.Create(\"/tmp/memoryProfile.out\") if err != nil { fmt.Println(err) return } defer memory.Close() for i := 0; i < 10; i++ { s := make([]byte, 50000000) if s == nil { fmt.Println(\"Operation failed!\") } time.Sleep(50 * time.Millisecond) } err = pprof.WriteHeapProfile(memory) if err != nil { fmt.Println(err) return } } ","text_count":355,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// Memory profiling! \n   memory, err := os.Create(\"/tmp/memoryProfile.out\") \n   if err != nil { \n         fmt.Println(err) \n         return \n   } \n   defer memory.Close() \n   for i := 0; i &lt; 10; i++ { \n         s := make([]byte, 50000000) \n         if s == nil { \n               fmt.Println(\"Operation failed!\") \n         } \n         time.Sleep(50 * time.Millisecond) \n   } \n   err = pprof.WriteHeapProfile(memory) \n   if err != nil { \n         fmt.Println(err) \n         return \n   } \n}"}]}]},{"block_type":"element","block":"k6pz2jj6","search_text":"In the last part, you can see how the memory profiling technique works. It is pretty similar to CPU profiling, and once again you will need a file for writing out the profiling data.","text_count":182,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the last part, you can see how the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"memory profiling"}]},{"block_type":"text","content":"technique works. It is pretty similar to CPU profiling, and once again you will need a file for writing out the profiling data."}]},{"block_type":"element","block":"k6pz2jj7","search_text":"Executing profileMe.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jj8","search_text":"$ go run profileMe.go Total primes: 9592 Total primes: 9592 1 2 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025 20365011074 32951280099 53316291173 86267571272 139583862445 225851433717 365435296162 591286729879 956722026041 1548008755920 2504730781961 4052739537881 6557470319842 10610209857723 17167680177565 27777890035288 44945570212853 72723460248141 117669030460994 190392490709135 308061521170129 498454011879264 806515533049393 1304969544928657 2111485077978050 3416454622906707 5527939700884757 8944394323791464 14472334024676221 23416728348467685 37889062373143906 61305790721611591 99194853094755497 160500643816367088 259695496911122585 420196140727489673 679891637638612258 1100087778366101931 1779979416004714189 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025 20365011074 32951280099 53316291173 86267571272 139583862445 225851433717 365435296162 591286729879 956722026041 1548008755920 2504730781961 4052739537881 6557470319842 10610209857723 17167680177565 27777890035288 44945570212853 72723460248141 117669030460994 190392490709135 308061521170129 498454011879264 806515533049393 1304969544928657 2111485077978050 3416454622906707 5527939700884757 8944394323791464 14472334024676221 23416728348467685 37889062373143906 61305790721611591 99194853094755497 160500643816367088 259695496911122585 420196140727489673 679891637638612258 1100087778366101931 1779979416004714189 ","text_count":1940,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run profileMe.go\nTotal primes: 9592\nTotal primes: 9592\n1 2 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 \n17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 \n3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 \n165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 \n4807526976 7778742049 12586269025 20365011074 32951280099 53316291173 \n86267571272 139583862445 225851433717 365435296162 591286729879 956722026041 \n1548008755920 2504730781961 4052739537881 6557470319842 10610209857723 \n17167680177565 27777890035288 44945570212853 72723460248141 117669030460994 \n190392490709135 308061521170129 498454011879264 806515533049393 1304969544928657 \n2111485077978050 3416454622906707 5527939700884757 8944394323791464 \n14472334024676221 23416728348467685 37889062373143906 61305790721611591 \n99194853094755497 160500643816367088 259695496911122585 420196140727489673 \n679891637638612258 1100087778366101931 1779979416004714189\n1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 \n28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 \n5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 \n433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 \n12586269025 20365011074 32951280099 53316291173 86267571272 139583862445 \n225851433717 365435296162 591286729879 956722026041 1548008755920 2504730781961 \n4052739537881 6557470319842 10610209857723 17167680177565 27777890035288\n 44945570212853 72723460248141 117669030460994 190392490709135 308061521170129 \n498454011879264 806515533049393 1304969544928657 2111485077978050 3416454622906707 \n5527939700884757 8944394323791464 14472334024676221 23416728348467685 \n37889062373143906 61305790721611591 99194853094755497 160500643816367088 \n259695496911122585 420196140727489673 679891637638612258 1100087778366101931 \n1779979416004714189"}]}]},{"block_type":"element","block":"k6pz2jj9","search_text":"Apart from the output, the program will also collect the profiling data in two files:","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from the output, the program will also collect the profiling data in two files:"}]},{"block_type":"element","block":"k6pz2jja","search_text":"$ cd /tmp $ ls -l *Profile* -rw-r--r-- 1 mtsouk wheel 1965 Mar 8 16:53 cpuProfile.out -rw-r--r-- 1 mtsouk wheel 484 Mar 8 16:53 memoryProfile.out","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ cd /tmp\n$ ls -l *Profile*\n-rw-r--r-- 1 mtsouk wheel 1965 Mar 8 16:53 cpuProfile.out\n-rw-r--r-- 1 mtsouk wheel 484 Mar 8 16:53 memoryProfile.out"}]}]},{"block_type":"element","block":"k6pz2jjb","search_text":"It is only after collecting the profiling data that you can start to inspect it. Thus, you can now start the command-line profiler to examine the CPU data as follows:","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is only after collecting the profiling data that you can start to inspect it. Thus, you can now start the command-line profiler to examine the CPU data as follows:"}]},{"block_type":"element","block":"k6pz2jjc","search_text":"$ go tool pprof /tmp/cpuProfile.out Main binary filename not available. Type: cpu Time: Mar 8, 2018 at 4:53pm (EET) Duration: 19.12s, Total samples = 4.18s (21.86%) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) ","text_count":243,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof /tmp/cpuProfile.out\nMain binary filename not available.\nType: cpu\nTime: Mar 8, 2018 at 4:53pm (EET)\nDuration: 19.12s, Total samples = 4.18s (21.86%)\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jjd","search_text":"Typing help while in the profiler shell will generate the following output:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Typing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"help"}]},{"block_type":"text","content":"while in the profiler shell will generate the following output:"}]},{"block_type":"element","block":"k6pz2jje","search_text":"(pprof) help Commands: callgrind Outputs a graph in callgrind format comments Output all profile comments disasm Output assembly listings annotated with samples dot Outputs a graph in DOT format eog Visualize graph through eog evince Visualize graph through evince gif Outputs a graph image in GIF format gv Visualize graph through gv kcachegrind Visualize report in KCachegrind list Output annotated source for functions matching regexp pdf Outputs a graph in PDF format peek Output callers/callees of functions matching regexp png Outputs a graph image in PNG format proto Outputs the profile in compressed protobuf format ps Outputs a graph in PS format raw Outputs a text representation of the raw profile svg Outputs a graph in SVG format tags Outputs all tags in the profile text Outputs top entries in text form top Outputs top entries in text form topproto Outputs top entries in compressed protobuf format traces Outputs all profile samples in text form tree Outputs a text rendering of call graph web Visualize graph through web browser weblist Display annotated source in a web browser o/options List options and their current values quit/exit/^D Exit pprof Options: call_tree Create a context-sensitive call tree compact_labels Show minimal headers divide_by Ratio to divide all samples before visualization drop_negative Ignore negative differences edgefraction Hide edges below <f>*total focus Restricts to samples going through a node matching regexp hide Skips nodes matching regexp ignore Skips paths going through any nodes matching regexp mean Average sample value over first value (count) nodecount Max number of nodes to show nodefraction Hide nodes below <f>*total normalize Scales profile based on the base profile. output Output filename for file-based outputs positive_percentages Ignore negative samples when computing percentages prune_from Drops any functions below the matched frame. relative_percentages Show percentages relative to focused subgraph sample_index Sample value to report (0-based index or name) show Only show nodes matching regexp source_path Search path for source files tagfocus Restricts to samples with tags in range or matched by regexp taghide Skip tags matching this regexp tagignore Discard samples with tags in range or matched by regexp tagshow Only consider tags matching this regexp trim Honor nodefraction/edgefraction/nodecount defaults unit Measurement units to display Option groups (only set one per group): cumulative cum Sort entries based on cumulative weight flat Sort entries based on own weight granularity addresses Aggregate at the function level. addressnoinlines Aggregate at the function level, including functions' addresses in the output. files Aggregate at the file level. functions Aggregate at the function level. lines Aggregate at the source code line level. noinlines Aggregate at the function level. : Clear focus/ignore/hide/tagfocus/tagignore type \"help <cmd|option>\" for more information (pprof) ","text_count":2982,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"(pprof) help\nCommands:\ncallgrind Outputs a graph in callgrind format\ncomments Output all profile comments\ndisasm Output assembly listings annotated with samples\ndot Outputs a graph in DOT format\neog Visualize graph through eog\nevince Visualize graph through evince\ngif Outputs a graph image in GIF format\ngv Visualize graph through gv\nkcachegrind Visualize report in KCachegrind\nlist Output annotated source for functions matching regexp\npdf Outputs a graph in PDF format\npeek Output callers/callees of functions matching regexp\npng Outputs a graph image in PNG format\nproto Outputs the profile in compressed protobuf format\nps Outputs a graph in PS format\nraw Outputs a text representation of the raw profile\nsvg Outputs a graph in SVG format\ntags Outputs all tags in the profile\ntext Outputs top entries in text form\ntop Outputs top entries in text form\ntopproto Outputs top entries in compressed protobuf format\ntraces Outputs all profile samples in text form\ntree Outputs a text rendering of call graph\nweb Visualize graph through web browser\nweblist Display annotated source in a web browser\no/options List options and their current values\nquit/exit/^D Exit pprof\nOptions:\ncall_tree Create a context-sensitive call tree\ncompact_labels Show minimal headers\ndivide_by Ratio to divide all samples before visualization\ndrop_negative Ignore negative differences\nedgefraction Hide edges below &lt;f&gt;*total\nfocus Restricts to samples going through a node matching regexp\nhide Skips nodes matching regexp\nignore Skips paths going through any nodes matching regexp\nmean Average sample value over first value (count)\nnodecount Max number of nodes to show\nnodefraction Hide nodes below &lt;f&gt;*total\nnormalize Scales profile based on the base profile.\noutput Output filename for file-based outputs\npositive_percentages Ignore negative samples when computing percentages\nprune_from Drops any functions below the matched frame.\nrelative_percentages Show percentages relative to focused subgraph\nsample_index Sample value to report (0-based index or name)\nshow Only show nodes matching regexp\nsource_path Search path for source files\ntagfocus Restricts to samples with tags in range or matched by regexp\ntaghide Skip tags matching this regexp\ntagignore Discard samples with tags in range or matched by regexp\ntagshow Only consider tags matching this regexp\ntrim Honor nodefraction/edgefraction/nodecount defaults\nunit Measurement units to display\nOption groups (only set one per group):\ncumulative\ncum Sort entries based on cumulative weight\nflat Sort entries based on own weight\ngranularity\naddresses Aggregate at the function level.\naddressnoinlines Aggregate at the function level, including functions' addresses in the output.\nfiles Aggregate at the file level.\nfunctions Aggregate at the function level.\nlines Aggregate at the source code line level.\nnoinlines Aggregate at the function level.\n: Clear focus/ignore/hide/tagfocus/tagignore\ntype \"help &lt;cmd|option&gt;\" for more information\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jjf","search_text":"Tip Do find the time to try out all of the commands of the go tool pprof utility and familiarize yourself with them. ","text_count":117,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Do find the time to try out all of the commands of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"utility and familiarize yourself with them."}]}]},{"block_type":"element","block":"k6pz2jjg","search_text":"The top command returns the top 10 entries in text form:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"top"}]},{"block_type":"text","content":"command returns the top 10 entries in text form:"}]},{"block_type":"element","block":"k6pz2jjh","search_text":"(pprof) top Showing nodes accounting for 4120ms, 98.56% of 4180ms total Dropped 26 nodes (cum <= 20.90ms) Showing top 10 nodes out of 21 flat flat% sum% cum cum% 1950ms 46.65% 46.65% 1950ms 46.65% main.N2 1170ms 27.99% 74.64% 1170ms 27.99% runtime.usleep 910ms 21.77% 96.41% 910ms 21.77% main.N1 90ms 2.15% 98.56% 90ms 2.15% runtime.mach_semaphore_signal 0 0% 98.56% 2890ms 69.14% main.main 0 0% 98.56% 80ms 1.91% runtime.goready 0 0% 98.56% 80ms 1.91% runtime.goready.func1 0 0% 98.56% 80ms 1.91% runtime.goroutineReady 0 0% 98.56% 90ms 2.15% runtime.mach_semrelease 0 0% 98.56% 2890ms 69.14% runtime.main","text_count":606,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"(pprof) top\nShowing nodes accounting for 4120ms, 98.56% of 4180ms total\nDropped 26 nodes (cum &lt;= 20.90ms)\nShowing top 10 nodes out of 21\nflat flat% sum% cum cum%\n1950ms 46.65% 46.65% 1950ms 46.65% main.N2\n1170ms 27.99% 74.64% 1170ms 27.99% runtime.usleep\n910ms 21.77% 96.41% 910ms 21.77% main.N1\n90ms 2.15% 98.56% 90ms 2.15% runtime.mach_semaphore_signal\n0 0% 98.56% 2890ms 69.14% main.main\n0 0% 98.56% 80ms 1.91% runtime.goready\n0 0% 98.56% 80ms 1.91% runtime.goready.func1\n0 0% 98.56% 80ms 1.91% runtime.goroutineReady\n0 0% 98.56% 90ms 2.15% runtime.mach_semrelease\n0 0% 98.56% 2890ms 69.14% runtime.main"}]}]},{"block_type":"element","block":"k6pz2jji","search_text":"As the first line of the output states, the functions presented are responsible for 98.56% of the total execution time of the program. The main.N2 function in particular is responsible for the 46.65% of the execution time of the program.","text_count":237,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the first line of the output states, the functions presented are responsible for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"98.56%"}]},{"block_type":"text","content":"of the total execution time of the program. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.N2"}]},{"block_type":"text","content":"function in particular is responsible for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"46.65%"}]},{"block_type":"text","content":"of the execution time of the program."}]},{"block_type":"element","block":"k6pz2jjj","search_text":"The top10 --cum command returns the cumulative time for each function:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"top10 --cum"}]},{"block_type":"text","content":"command returns the cumulative time for each function:"}]},{"block_type":"element","block":"k6pz2jjk","search_text":"(pprof) top10 --cum Showing nodes accounting for 4030ms, 96.41% of 4180ms total Dropped 26 nodes (cum <= 20.90ms) Showing top 10 nodes out of 21 flat flat% sum% cum cum% 0 0% 0% 2890ms 69.14% main.main 0 0% 0% 2890ms 69.14% runtime.main 1950ms 46.65% 46.65% 1950ms 46.65% main.N2 0 0% 46.65% 1180ms 28.23% runtime.mstart 0 0% 46.65% 1180ms 28.23% runtime.mstart1 0 0% 46.65% 1180ms 28.23% runtime.sysmon 1170ms 27.99% 74.64% 1170ms 27.99% runtime.usleep 910ms 21.77% 96.41% 910ms 21.77% main.N1 0 0% 96.41% 130ms 3.11% runtime.systemstack 0 0% 96.41% 110ms 2.63% runtime.timerproc","text_count":580,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"(pprof) top10 --cum\nShowing nodes accounting for 4030ms, 96.41% of 4180ms total\nDropped 26 nodes (cum &lt;= 20.90ms)\nShowing top 10 nodes out of 21\nflat flat% sum% cum cum%\n0 0% 0% 2890ms 69.14% main.main\n0 0% 0% 2890ms 69.14% runtime.main\n1950ms 46.65% 46.65% 1950ms 46.65% main.N2\n0 0% 46.65% 1180ms 28.23% runtime.mstart\n0 0% 46.65% 1180ms 28.23% runtime.mstart1\n0 0% 46.65% 1180ms 28.23% runtime.sysmon\n1170ms 27.99% 74.64% 1170ms 27.99% runtime.usleep\n910ms 21.77% 96.41% 910ms 21.77% main.N1\n0 0% 96.41% 130ms 3.11% runtime.systemstack\n0 0% 96.41% 110ms 2.63% runtime.timerproc"}]}]},{"block_type":"element","block":"k6pz2jjl","search_text":"What if you want to find out what is happening with a particular function? You can use the list command followed by the function name, combined with the package name, and you'll get more detailed information about the performance of that function:","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What if you want to find out what is happening with a particular function? You can use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"list"}]},{"block_type":"text","content":"command followed by the function name, combined with the package name, and you'll get more detailed information about the performance of that function:"}]},{"block_type":"element","block":"k6pz2jjm","search_text":"(pprof) list main.N1 Total: 4.18s ROUTINE ======= main.N1 in /Users/mtsouk/ch11/code/profileMe.go 910ms 910ms (flat, cum) 21.77% of Total . . 32: return fn[n] . . 33:} . . 34: . . 35:func N1(n int) bool { . . 36: k := math.Floor(float64(n/2 + 1)) 60ms 60ms 37: for i := 2; i < int(k); i++ { 850ms 850ms 38: if (n % i) == 0 { . . 39: return false . . 40: } . . 41: } . . 42: return true . . 43:} (pprof)","text_count":402,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"(pprof) list main.N1\nTotal: 4.18s\nROUTINE ======= main.N1 in /Users/mtsouk/ch11/code/profileMe.go\n910ms 910ms (flat, cum) 21.77% of Total\n. . 32:     return fn[n]\n. . 33:}\n. . 34:\n. . 35:func N1(n int) bool {\n. . 36:     k := math.Floor(float64(n/2 + 1))\n60ms 60ms 37:     for i := 2; i &lt; int(k); i++ {\n850ms 850ms 38:         if (n % i) == 0 {\n. . 39:                 return false\n. . 40:           }\n. . 41:     }\n. . 42:     return true\n. . 43:}\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jjn","search_text":"The output shows that the for loop of main.N1 is responsible for almost all of the execution time of the entire function. Specifically, the if (n % i) == 0 statement is responsible for 850ms out of 910ms of the execution time of the entire function.","text_count":249,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output shows that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main.N1"}]},{"block_type":"text","content":"is responsible for almost all of the execution time of the entire function. Specifically, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if (n % i) == 0"}]},{"block_type":"text","content":"statement is responsible for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"850ms"}]},{"block_type":"text","content":"out of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"910ms"}]},{"block_type":"text","content":"of the execution time of the entire function."}]},{"block_type":"element","block":"k6pz2jjo","search_text":"You can also create a PDF output of the profiling data from the shell of the Go profiler, using the pdf command:","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can also create a PDF output of the profiling data from the shell of the Go profiler, using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pdf"}]},{"block_type":"text","content":"command:"}]},{"block_type":"element","block":"k6pz2jjp","search_text":"(pprof) pdf Generating report in profile001.pdf","text_count":47,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"(pprof) pdf\nGenerating report in profile001.pdf"}]}]},{"block_type":"element","block":"k6pz2jjq","search_text":"Note that you will need Graphviz in order to generate a PDF file that can be viewed using your favorite PDF reader.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that you will need"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Graphviz"}]},{"block_type":"text","content":"in order to generate a PDF file that can be viewed using your favorite PDF reader."}]},{"block_type":"element","block":"k6pz2jjr","search_text":"Finally, a warning: if your program executes too quickly, then the profiler will not have enough time to get its required samples and you might see the Total samples = 0 output when you load the data file. In that case, you will not be able to get any useful information from the profiling process. This is the reason for using the time.Sleep() function in some of the functions of profileMe.go :","text_count":396,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, a warning: if your program executes too quickly, then the profiler will not have enough time to get its required samples and you might see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Total samples = 0"}]},{"block_type":"text","content":"output when you load the data file. In that case, you will not be able to get any useful information from the profiling process. This is the reason for using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time.Sleep()"}]},{"block_type":"text","content":"function in some of the functions of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jjs","search_text":"$ go tool pprof /tmp/cpuProfile.out Type: cpu Time: Mar 7, 2018 at 10:25pm (EET) Duration: 202.29ms, Total samples = 0","text_count":118,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof /tmp/cpuProfile.out\nType: cpu\nTime: Mar 7, 2018 at 10:25pm (EET)\nDuration: 202.29ms, Total samples = 0"}]}]},{"block_type":"element","block":"k6pz2jjt","search_text":"Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof)","text_count":77,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"Entering interactive mode (type \"help\" for commands, \"o\" for options)\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jju","search_text":"A convenient external package for profiling","text_count":43,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A convenient external package for profiling"}]},{"block_type":"element","block":"k6pz2jjv","search_text":"In this subsection, you will see the use of an external Go package that sets up the profiling environment much more conveniently than when using the runtime/pprof standard Go package. This point is illustrated in betterProfile.go , which will be presented in three parts.","text_count":271,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will see the use of an external Go package that sets up the profiling environment much more conveniently than when using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"standard Go package. This point is illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"betterProfile.go"}]},{"block_type":"text","content":", which will be presented in three parts."}]},{"block_type":"element","block":"k6pz2jjw","search_text":"The first part of betterProfile.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"betterProfile.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jjx","search_text":"package main import ( \"fmt\" \"github.com/pkg/profile\" ) var VARIABLE int func N1(n int) bool { for i := 2; i < n; i++ { if (n % i) == 0 { return false } } return true } ","text_count":168,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"github.com/pkg/profile\" \n) \nvar VARIABLE int \nfunc N1(n int) bool { \n    for i := 2; i &lt; n; i++ { \n        if (n % i) == 0 { \n               return false \n        } \n    } \n    return true \n}"}]}]},{"block_type":"element","block":"k6pz2jjy","search_text":"In the preceding code, you can see the use of an external Go package that can be found at, github.com/pkg/profile . You can download it with the help of the go get command, as follows:","text_count":184,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see the use of an external Go package that can be found at,&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://github.com/pkg/profile","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"github.com/pkg/profile"}]},{"block_type":"text","content":". You can download it with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go get"}]},{"block_type":"text","content":"command, as follows:"}]},{"block_type":"element","block":"k6pz2jjz","search_text":"$ go get github.com/pkg/profile","text_count":31,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go get github.com/pkg/profile"}]}]},{"block_type":"element","block":"k6pz2jk0","search_text":"The second code segment of betterProfile.go contains the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"betterProfile.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jk1","search_text":"func Multiply(a, b int) int { if a == 1 { return b } if a == 0 || b == 0 { return 0 } if a < 0 { return -Multiply(-a, b) } return b + Multiply(a-1, b) } func main() { defer profile.Start(profile.ProfilePath(\"/tmp\")).Stop() ","text_count":223,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Multiply(a, b int) int { \n    if a == 1 { \n        return b \n    } \n    if a == 0 || b == 0 { \n        return 0 \n    } \n    if a &lt; 0 { \n        return -Multiply(-a, b) \n    } \n    return b + Multiply(a-1, b) \n} \nfunc main() { \n    defer profile.Start(profile.ProfilePath(\"/tmp\")).Stop()"}]}]},{"block_type":"element","block":"k6pz2jk2","search_text":"The github.com/pkg/profile package by Dave Cheney requires that you insert just a single statement in order to enable CPU profiling in your Go application. If you want to enable memory profiling , you should insert the following statement instead:","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://github.com/pkg/profile","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"github.com/pkg/profile"}]},{"block_type":"text","content":"package by Dave Cheney requires that you insert just a single statement in order to enable"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"CPU profiling"}]},{"block_type":"text","content":"in your Go application. If you want to enable"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"memory profiling"}]},{"block_type":"text","content":", you should insert the following statement instead:"}]},{"block_type":"element","block":"k6pz2jk3","search_text":"defer profile.Start(profile.MemProfile).Stop() ","text_count":47,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"defer profile.Start(profile.MemProfile).Stop()"}]}]},{"block_type":"element","block":"k6pz2jk4","search_text":"The remaining Go code of the program is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of the program is as follows:"}]},{"block_type":"element","block":"k6pz2jk5","search_text":"total := 0 for i := 2; i < 200000; i++ { n := N1(i) if n { total++ } } fmt.Println(\"Total: \", total) total = 0 for i := 0; i < 5000; i++ { for j := 0; j < 400; j++ { k := Multiply(i, j) VARIABLE = k total++ } } fmt.Println(\"Total: \", total) } ","text_count":243,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"total := 0 \nfor i := 2; i &lt; 200000; i++ { \n    n := N1(i) \n    if n { \n        total++ \n        } \n    } \n    fmt.Println(\"Total: \", total) \n    total = 0 \n    for i := 0; i &lt; 5000; i++ { \n        for j := 0; j &lt; 400; j++ { \n            k := Multiply(i, j) \n            VARIABLE = k \n            total++ \n        } \n    } \n    fmt.Println(\"Total: \", total) \n}"}]}]},{"block_type":"element","block":"k6pz2jk6","search_text":"Executing betterProfile.go generates the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"betterProfile.go"}]},{"block_type":"text","content":"generates the following output:"}]},{"block_type":"element","block":"k6pz2jk7","search_text":"$ go run betterProfile.go 2018/03/08 17:01:28 profile: cpu profiling enabled, /tmp/cpu.pprof Total: 17984 Total: 2000000 2018/03/08 17:01:56 profile: cpu profiling disabled, /tmp/cpu.pprof","text_count":188,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run betterProfile.go\n2018/03/08 17:01:28 profile: cpu profiling enabled, /tmp/cpu.pprof\nTotal: 17984\nTotal: 2000000\n2018/03/08 17:01:56 profile: cpu profiling disabled, /tmp/cpu.pprof"}]}]},{"block_type":"element","block":"k6pz2jk8","search_text":"Note The github.com/pkg/profile package will help you with the data capturing portion; the processing part is the same as before! ","text_count":130,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://github.com/pkg/profile"},"children":[{"block_type":"text","content":"github.com/pkg/profile"}]},{"block_type":"text","content":"package will help you with the data capturing portion; the processing part is the same as before!"}]}]},{"block_type":"element","block":"k6pz2jk9","search_text":"$ go tool pprof /tmp/cpu.pprof Main binary filename not available. Type: cpu Time: Mar 8, 2018 at 5:01pm (EET) Duration: 27.51s, Total samples = 23.62s (85.87%) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof)","text_count":238,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof /tmp/cpu.pprof\nMain binary filename not available.\nType: cpu\nTime: Mar 8, 2018 at 5:01pm (EET)\nDuration: 27.51s, Total samples = 23.62s (85.87%)\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jka","search_text":"The web interface of the Go profiler","text_count":36,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The web interface of the Go profiler"}]},{"block_type":"element","block":"k6pz2jkb","search_text":"The good news is that with Go version 1.10, the go tool pprof command comes with a web user interface!","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good news is that with Go version 1.10, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"command comes with a web user interface!"}]},{"block_type":"element","block":"k6pz2jkc","search_text":"Note For the web user interface feature to work, you will need to have Graphviz installed and your web browser must support JavaScript. If you want to play it safe, use either Chrome or Firefox . ","text_count":196,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the web user interface feature to work, you will need to have"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Graphviz"}]},{"block_type":"text","content":"installed and your web browser must support JavaScript. If you want to play it safe, use either"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Chrome"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Firefox"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2jkd","search_text":"You can start the interactive Go profiler as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can start the interactive Go profiler as follows:"}]},{"block_type":"element","block":"k6pz2jke","search_text":"$ go tool pprof -http=[host]:[port] aProfile","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof -http=[host]:[port] aProfile"}]}]},{"block_type":"element","block":"k6pz2jkf","search_text":"A profiling example that uses the web interface","text_count":47,"tag_name":"h1","attributes":{},"children":[{"block_type":"text","content":"A profiling example that uses the web interface"}]},{"block_type":"element","block":"k6pz2jkg","search_text":"We will use the data captured from the execution of profileMe.go to study the web interface of the Go profiler as there is no need for creating a specific code example for doing this. As you learned in the previous subsection, you will first need to execute the following command:","text_count":280,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We will use the data captured from the execution of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"to study the web interface of the Go profiler as there is no need for creating a specific code example for doing this. As you learned in the previous subsection, you will first need to execute the following command:"}]},{"block_type":"element","block":"k6pz2jkh","search_text":"$ go tool pprof -http=localhost:8080 /tmp/cpuProfile.out Main binary filename not available.","text_count":92,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof -http=localhost:8080 /tmp/cpuProfile.out\nMain binary filename not available."}]}]},{"block_type":"element","block":"k6pz2jki","search_text":"The following figure shows the initial screen of the web user interface of the Go profiler after executing the preceding command:","text_count":129,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following figure shows the initial screen of the web user interface of the Go profiler after executing the preceding command:"}]},{"block_type":"element","block":"k6pz2jkj","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000008.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jkk","search_text":"The web interface of the Go profiler in action","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The web interface of the Go profiler in action"}]},{"block_type":"element","block":"k6pz2jkl","search_text":"Similarly, the following figure shows the http://localhost:8080/source URL of the Go profiler, which displays analytical information for each function of the program:","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, the following figure shows the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/source"}]},{"block_type":"text","content":"URL of the Go profiler, which displays analytical information for each function of the program:"}]},{"block_type":"element","block":"k6pz2jkm","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000006.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jkn","search_text":"Using the /source URL of the Go profiler","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using the /source URL of the Go profiler"}]},{"block_type":"element","block":"k6pz2jko","search_text":"Tip As I cannot possibly show every single page of the Go profiler web interface, you should begin to familiarize yourself with it on your own, as it is a great tool for examining the operation of your programs. ","text_count":212,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As I cannot possibly show every single page of the Go profiler web interface, you should begin to familiarize yourself with it on your own, as it is a great tool for examining the operation of your programs."}]}]},{"block_type":"element","block":"k6pz2jkp","search_text":"A quick introduction to Graphviz","text_count":32,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A quick introduction to Graphviz"}]},{"block_type":"element","block":"k6pz2jkq","search_text":"Graphviz is a very handy compilation of utilities and a computer language that allows you to draw complex graphs. Strictly speaking, Graphviz is a collection of tools for manipulating both directed and undirected graph structures and generating graph layouts. Graphviz has its own language, named DOT , which is simple, elegant, and powerful. The good thing about Graphviz is that you can write its code using a simple plain text editor. A wonderful side effect of this feature is that you can easily develop scripts that generate Graphviz code! Also, most programming languages, including Python , Ruby , C++ , and Perl , provide their own interface for creating Graphviz files using native code.","text_count":697,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Graphviz"}]},{"block_type":"text","content":"is a very handy compilation of utilities and a computer language that allows you to draw complex graphs. Strictly speaking, Graphviz is a collection of tools for manipulating both directed and undirected"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"graph"}]},{"block_type":"text","content":"structures and generating graph layouts. Graphviz has its own language, named"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"DOT"}]},{"block_type":"text","content":", which is simple, elegant, and powerful. The good thing about Graphviz is that you can write its code using a simple plain text editor. A wonderful side effect of this feature is that you can easily develop scripts that generate Graphviz code! Also, most programming languages, including"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Python"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Ruby"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"C++"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Perl"}]},{"block_type":"text","content":", provide their own interface for creating Graphviz files using native code."}]},{"block_type":"element","block":"k6pz2jkr","search_text":"Note You need not know all of these things about Graphviz in order to use the web interface of the Go profiler. It is just useful to know how Graphviz works and what its code looks like. ","text_count":187,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You need not know all of these things about Graphviz in order to use the web interface of the Go profiler. It is just useful to know how Graphviz works and what its code looks like."}]}]},{"block_type":"element","block":"k6pz2jks","search_text":"The following Graphviz code, which is saved as graph.dot , briefly illustrates the way that Graphviz works and the look of the Graphviz language:","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following Graphviz code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"graph.dot"}]},{"block_type":"text","content":", briefly illustrates the way that Graphviz works and the look of the Graphviz language:"}]},{"block_type":"element","block":"k6pz2jkt","search_text":"digraph G { graph [dpi = 300, bgcolor = \"gray\"]; rankdir = LR; node [shape=record, width=.2, height=.2, color=\"white\" ]; node0 [label = \"<p0> |<p1>|<p2>|<p3>|<p4>| | \", height = 3]; node[ width=2 ]; node1 [label = \"{<e> r0 | 123 | <p> }\", color=\"gray\" ]; node2 [label = \"{<e> r10 | 13 | <p> }\" ]; node3 [label = \"{<e> r11 | 23 | <p> }\" ]; node4 [label = \"{<e> r12 | 326 | <p> }\" ]; node5 [label = \"{<e> r13 | 1f3 | <p> }\" ]; node6 [label = \"{<e> r20 | 143 | <p> }\" ]; node7 [label = \"{<e> r40 | b23 | <p> }\" ]; node0:p0 -> node1:e [dir=both color=\"red:blue\"]; node0:p1 -> node2:e [dir=back arrowhead=diamond]; node2:p -> node3:e; node3:p -> node4:e [dir=both arrowtail=box color=\"red\"]; node4:p -> node5:e [dir=forward]; node0:p2 -> node6:e [dir=none color=\"orange\"]; node0:p4 -> node7:e; }","text_count":790,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"digraph G \n{ \n    graph [dpi = 300, bgcolor = \"gray\"]; \n    rankdir = LR; \n    node [shape=record, width=.2, height=.2, color=\"white\" ]; \n    \n    node0 [label = \"&lt;p0&gt; |&lt;p1&gt;|&lt;p2&gt;|&lt;p3&gt;|&lt;p4&gt;| | \", height = 3]; \n    node[ width=2 ]; \n    node1 [label = \"{&lt;e&gt; r0 | 123 | &lt;p&gt; }\", color=\"gray\" ]; \n    node2 [label = \"{&lt;e&gt; r10 | 13 | &lt;p&gt; }\" ]; \n    node3 [label = \"{&lt;e&gt; r11 | 23 | &lt;p&gt; }\" ]; \n    node4 [label = \"{&lt;e&gt; r12 | 326 | &lt;p&gt; }\" ]; \n    node5 [label = \"{&lt;e&gt; r13 | 1f3 | &lt;p&gt; }\" ]; \n    node6 [label = \"{&lt;e&gt; r20 | 143 | &lt;p&gt; }\" ]; \n    node7 [label = \"{&lt;e&gt; r40 | b23 | &lt;p&gt; }\" ]; \n    \n    node0:p0 -&gt; node1:e [dir=both color=\"red:blue\"]; \n    node0:p1 -&gt; node2:e [dir=back arrowhead=diamond]; \n    node2:p -&gt; node3:e; \n    node3:p -&gt; node4:e [dir=both arrowtail=box color=\"red\"]; \n    node4:p -&gt; node5:e [dir=forward]; \n    node0:p2 -&gt; node6:e [dir=none color=\"orange\"]; \n    node0:p4 -&gt; node7:e; \n}"}]}]},{"block_type":"element","block":"k6pz2jku","search_text":"The color attribute changes the color of a node, whereas the shape attribute changes the shape of a node. Additionally, the dir attribute, which can be applied to edges, defines whether an edge is going to have two arrows, one, or none. Furthermore, the style of the arrowhead can be specified using the arrowhead and arrowtail attributes.","text_count":339,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"color"}]},{"block_type":"text","content":"attribute changes the color of a node, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"shape"}]},{"block_type":"text","content":"attribute changes the shape of a node. Additionally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"dir"}]},{"block_type":"text","content":"attribute, which can be applied to edges, defines whether an edge is going to have two arrows, one, or none. Furthermore, the style of the arrowhead can be specified using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arrowhead"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"arrowtail"}]},{"block_type":"text","content":"attributes."}]},{"block_type":"element","block":"k6pz2jkv","search_text":"Compiling the preceding code using one of the Graphviz command-line tools in order to create a PNG image requires the execution of the following command in your favorite Unix shell:","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Compiling the preceding code using one of the Graphviz command-line tools in order to create a PNG image requires the execution of the following command in your favorite Unix shell:"}]},{"block_type":"element","block":"k6pz2jkw","search_text":"$ dot -T png graph.dot -o graph.png $ ls -l graph.png -rw-r--r--@ 1 mtsouk staff 94155 Mar 1 07:30 graph.png ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ dot -T png graph.dot -o graph.png\n$ ls -l graph.png\n-rw-r--r--@ 1 mtsouk staff 94155 Mar 1 07:30 graph.png"}]}]},{"block_type":"element","block":"k6pz2jkx","search_text":"The following diagram shows the graphics file generated from the execution of the preceding command:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following diagram shows the graphics file generated from the execution of the preceding command:"}]},{"block_type":"element","block":"k6pz2jky","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000001.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jkz","search_text":"Using Graphviz to create graphs","text_count":31,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using Graphviz to create graphs"}]},{"block_type":"element","block":"k6pz2jl0","search_text":"Thus, if you want to visualize any kind of structure, you should definitely consider using Graphviz and its tools, especially if you want to automate things with your own scripts.","text_count":179,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Thus, if you want to visualize any kind of structure, you should definitely consider using Graphviz and its tools, especially if you want to automate things with your own scripts."}]},{"block_type":"element","block":"k6pz2jl1","search_text":"The go tool trace utility","text_count":25,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The go tool trace utility"}]},{"block_type":"element","block":"k6pz2jl2","search_text":"The go tool trace utility is a tool for viewing trace files that can be generated with any one of the following three ways:","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility is a tool for viewing trace files that can be generated with any one of the following three ways:"}]},{"block_type":"element","block":"k6pz2jl3","search_text":"Using the runtime/trace package Using the net/http/pprof package Executing the go test -trace command ","text_count":102,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/trace"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test -trace"}]},{"block_type":"text","content":"command"}]}]},{"block_type":"element","block":"k6pz2jl4","search_text":"This section will use the first technique only. The output of the following command will greatly help you understand what the Go execution tracer does:","text_count":151,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will use the first technique only. The output of the following command will greatly help you understand what the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go execution tracer"}]},{"block_type":"text","content":"does:"}]},{"block_type":"element","block":"k6pz2jl5","search_text":"$ go doc runtime/trace package trace // import \"runtime/trace\" Go execution tracer. The tracer captures a wide range of execution events like goroutine creation/blocking/unblocking, syscall enter/exit/block,GC-related events, changes of heap size, processor start/stop, etc and writes them to an io.Writer in a compact form. A precise nanosecond-precision timestamp and a stack trace is captured for most events. A trace can be analyzed later with 'go tool trace' command. func Start(w io.Writer) error func Stop()","text_count":514,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go doc runtime/trace\npackage trace // import \"runtime/trace\"\nGo execution tracer. The tracer captures a wide range of execution events like goroutine creation/blocking/unblocking, syscall enter/exit/block,GC-related events, changes of heap size, processor start/stop, etc and writes them to an io.Writer in a compact form. A precise nanosecond-precision timestamp and a stack trace is captured for most events. A trace can be analyzed later with 'go tool trace' command.\nfunc Start(w io.Writer) error\nfunc Stop()"}]}]},{"block_type":"element","block":"k6pz2jl6","search_text":"In Chapter 2, Understanding Go Internals , we talked about the Go garbage collector and presented a Go utility gColl.go , which allowed us to see some of the variables of the Go garbage collector. In this section, we will gather even more information about the operation of gColl.go , using the go tool trace utility.","text_count":317,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In Chapter 2,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Understanding Go Internals"}]},{"block_type":"text","content":", we talked about the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Go garbage collector"}]},{"block_type":"text","content":"and presented a Go utility"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":", which allowed us to see some of the variables of the Go garbage collector. In this section, we will gather even more information about the operation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":", using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2jl7","search_text":"First, let's examine the modified version of the gColl.go program, which tells Go to collect performance data. It is saved as goGC.go , and it will be presented in three parts.","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"First, let's examine the modified version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gColl.go"}]},{"block_type":"text","content":"program, which tells Go to collect performance data. It is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goGC.go"}]},{"block_type":"text","content":", and it will be presented in three parts."}]},{"block_type":"element","block":"k6pz2jl8","search_text":"The first part of goGC.go is as follows:","text_count":40,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goGC.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jl9","search_text":"package main import ( \"fmt\" \"os\" \"runtime\" \"runtime/trace\" \"time\" ) func printStats(mem runtime.MemStats) { runtime.ReadMemStats(&mem) fmt.Println(\"mem.Alloc:\", mem.Alloc) fmt.Println(\"mem.TotalAlloc:\", mem.TotalAlloc) fmt.Println(\"mem.HeapAlloc:\", mem.HeapAlloc) fmt.Println(\"mem.NumGC:\", mem.NumGC) fmt.Println(\"-----\") } ","text_count":324,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"os\" \n    \"runtime\" \n    \"runtime/trace\" \n    \"time\" \n) \nfunc printStats(mem runtime.MemStats) { \n    runtime.ReadMemStats(&amp;mem) \n    fmt.Println(\"mem.Alloc:\", mem.Alloc) \n    fmt.Println(\"mem.TotalAlloc:\", mem.TotalAlloc) \n    fmt.Println(\"mem.HeapAlloc:\", mem.HeapAlloc) \n    fmt.Println(\"mem.NumGC:\", mem.NumGC) \n    fmt.Println(\"-----\") \n}"}]}]},{"block_type":"element","block":"k6pz2jla","search_text":"As you already know, you first need to import the runtime/trace standard Go package in order to collect data for the go tool trace utility.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you already know, you first need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/trace"}]},{"block_type":"text","content":"standard Go package in order to collect data for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2jlb","search_text":"The second code segment of goGC.go is shown in the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goGC.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jlc","search_text":"func main() { f, err := os.Create(\"/tmp/traceFile.out\") if err != nil { panic(err) } defer f.Close() err = trace.Start(f) if err != nil { fmt.Println(err) return } defer trace.Stop() ","text_count":183,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    f, err := os.Create(\"/tmp/traceFile.out\") \n    if err != nil { \n        panic(err) \n    } \n    defer f.Close() \n    err = trace.Start(f) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    defer trace.Stop()"}]}]},{"block_type":"element","block":"k6pz2jld","search_text":"This part is all about acquiring data for the go tool trace utility, and it has nothing to do with the functionality of the actual program. First, you will create a new file that will hold the tracing data for the go tool trace utility. Then you can start the tracing process, using trace.Start() . When you are done, you will call the trace.Stop() function. The defer call to this function means that you want to terminate tracing when your program ends.","text_count":455,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This part is all about acquiring data for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility, and it has nothing to do with the functionality of the actual program. First, you will create a new file that will hold the tracing data for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility. Then you can start the tracing process, using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"trace.Start()"}]},{"block_type":"text","content":". When you are done, you will call the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"trace.Stop()"}]},{"block_type":"text","content":"function. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"defer"}]},{"block_type":"text","content":"call to this function means that you want to terminate tracing when your program ends."}]},{"block_type":"element","block":"k6pz2jle","search_text":"Tip Using the go tool trace utility is a process with two phases that requires extra Go code. First you collect the data, and then you display and process it. ","text_count":159,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility is a process with two phases that requires extra Go code. First you collect the data, and then you display and process it."}]}]},{"block_type":"element","block":"k6pz2jlf","search_text":"The remaining Go code is as follows:","text_count":36,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code is as follows:"}]},{"block_type":"element","block":"k6pz2jlg","search_text":"var mem runtime.MemStats printStats(mem) for i := 0; i < 3; i++ { s := make([]byte, 50000000) if s == nil { fmt.Println(\"Operation failed!\") } } printStats(mem) for i := 0; i < 5; i++ { s := make([]byte, 100000000) if s == nil { fmt.Println(\"Operation failed!\") } time.Sleep(time.Millisecond)","text_count":292,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"var mem runtime.MemStats \n    printStats(mem) \n    for i := 0; i &lt; 3; i++ { \n        s := make([]byte, 50000000) \n        if s == nil { \n            fmt.Println(\"Operation failed!\") \n        } \n    } \n    printStats(mem) \n    for i := 0; i &lt; 5; i++ { \n        s := make([]byte, 100000000) \n        if s == nil { \n            fmt.Println(\"Operation failed!\") \n        } \n        time.Sleep(time.Millisecond)"}]}]},{"block_type":"element","block":"k6pz2jlh","search_text":"} printStats(mem) }","text_count":19,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} \n    printStats(mem) \n}"}]}]},{"block_type":"element","block":"k6pz2jli","search_text":"Executing goGC.go produces the following output as well as a new file named /tmp/traceFile.out with the tracing information:","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"goGC.go"}]},{"block_type":"text","content":"produces the following output as well as a new file named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/tmp/traceFile.out"}]},{"block_type":"text","content":"with the tracing information:"}]},{"block_type":"element","block":"k6pz2jlj","search_text":"$ go run goGC.go mem.Alloc: 107264 mem.TotalAlloc: 107264 mem.HeapAlloc: 107264 mem.NumGC: 0 ----- mem.Alloc: 50117672 mem.TotalAlloc: 150129416 mem.HeapAlloc: 50117672 mem.NumGC: 3 ----- mem.Alloc: 117320 mem.TotalAlloc: 650174208 mem.HeapAlloc: 117320 mem.NumGC: 8 ----- $ cd /tmp $ ls -l traceFile.out -rw-r--r-- 1 mtsouk wheel 8275 Mar 7 08:37 traceFile.out $ file /tmp/traceFile.out /tmp/traceFile.out: data ","text_count":413,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run goGC.go\nmem.Alloc: 107264\nmem.TotalAlloc: 107264\nmem.HeapAlloc: 107264\nmem.NumGC: 0\n-----\nmem.Alloc: 50117672\nmem.TotalAlloc: 150129416\nmem.HeapAlloc: 50117672\nmem.NumGC: 3\n-----\nmem.Alloc: 117320\nmem.TotalAlloc: 650174208\nmem.HeapAlloc: 117320\nmem.NumGC: 8\n-----\n$ cd /tmp\n$ ls -l traceFile.out\n-rw-r--r-- 1 mtsouk wheel 8275 Mar 7 08:37 traceFile.out\n$ file /tmp/traceFile.out\n/tmp/traceFile.out: data"}]}]},{"block_type":"element","block":"k6pz2jlk","search_text":"The go tool trace utility uses a web interface that starts automatically when you execute the following command:","text_count":112,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility uses a web interface that starts automatically when you execute the following command:"}]},{"block_type":"element","block":"k6pz2jll","search_text":"$ go tool trace /tmp/traceFile.out 2018/03/07 08:34:36 Parsing trace... 2018/03/07 08:34:36 Serializing trace... 2018/03/07 08:34:36 Splitting trace... 2018/03/07 08:34:36 Opening browser. Trace viewer is listening on http://127.0.0.1:61428","text_count":240,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool trace /tmp/traceFile.out\n2018/03/07 08:34:36 Parsing trace...\n2018/03/07 08:34:36 Serializing trace...\n2018/03/07 08:34:36 Splitting trace...\n2018/03/07 08:34:36 Opening browser. Trace viewer is listening on http://127.0.0.1:61428"}]}]},{"block_type":"element","block":"k6pz2jlm","search_text":"","text_count":0,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"&nbsp;"}]},{"block_type":"element","block":"k6pz2jln","search_text":"The following screenshot shows the initial image of the web interface of the go tool trace utility when examining the /tmp/traceFile.out trace file:","text_count":148,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows the initial image of the web interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility when examining the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/tmp/traceFile.out"}]},{"block_type":"text","content":"trace file:"}]},{"block_type":"element","block":"k6pz2jlo","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000032.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jlp","search_text":"The initial screen of the web interface of the go trace tool","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The initial screen of the web interface of the go trace tool"}]},{"block_type":"element","block":"k6pz2jlq","search_text":"You should now select the View trace link. This will take you to the next figure, which shows you another view of the web interface of the go tool trace utility that uses the data from /tmp/traceFile.out :","text_count":205,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should now select the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"View trace"}]},{"block_type":"text","content":"link. This will take you to the next figure, which shows you another view of the web interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"utility that uses the data from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/tmp/traceFile.out"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jlr","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000031.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jls","search_text":"Examining the operation of the Go Garbage Collector using the go tool trace","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Examining the operation of the Go Garbage Collector using the go tool trace"}]},{"block_type":"element","block":"k6pz2jlt","search_text":"In the preceding figure, you can see that the Go GC runs on its own goroutine, but it does not run all of the time. Additionally, you can see the number of goroutines used by the program. You can learn more about this by selecting certain parts of the interactive view. As we are interested in the operation of the GC, a useful piece of information that is displayed is how often and for how much long the Go GC runs.","text_count":417,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding figure, you can see that the Go GC runs on its own goroutine, but it does not run all of the time. Additionally, you can see the number of goroutines used by the program. You can learn more about this by selecting certain parts of the interactive view. As we are interested in the operation of the GC, a useful piece of information that is displayed is how often and for how much long the Go GC runs."}]},{"block_type":"element","block":"k6pz2jlu","search_text":"Note that although go tool trace is a very handy and powerful utility, it cannot solve every kind of performance problem. There are times where go tool pprof is more appropriate, especially when you want to reveal where your program spends most of its time by individual function.","text_count":280,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that although"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"is a very handy and powerful utility, it cannot solve every kind of performance problem. There are times where"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"is more appropriate, especially when you want to reveal where your program spends most of its time by individual function."}]},{"block_type":"element","block":"k6pz2jlv","search_text":"Testing Go code","text_count":15,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Testing Go code"}]},{"block_type":"element","block":"k6pz2jlw","search_text":"Software testing is a very large subject, and it cannot be covered in a single section of a chapter in a book. So, this brief section will try to present as much practical information as possible.","text_count":196,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Software testing is a very large subject, and it cannot be covered in a single section of a chapter in a book. So, this brief section will try to present as much practical information as possible."}]},{"block_type":"element","block":"k6pz2jlx","search_text":"Go allows you to write tests for your Go code in order to detect bugs. Strictly speaking, this section is about automated testing , which involves writing extra code to verify whether the real code; that is, the production code, works as expected or not. Thus, the result of a test function is either PASS or FAIL . You will see how this works shortly.","text_count":352,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go allows you to write tests for your Go code in order to detect bugs. Strictly speaking, this section is about automated"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":", which involves writing extra code to verify whether the real code; that is, the production code, works as expected or not. Thus, the result of a test function is either"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PASS"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FAIL"}]},{"block_type":"text","content":". You will see how this works shortly."}]},{"block_type":"element","block":"k6pz2jly","search_text":"Although the Go approach to testing might look simple at first, especially if you compare it with the testing practices of other programming languages, it is very efficient and effective because it does not require too much of the developer's time.","text_count":248,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the Go approach to testing might look simple at first, especially if you compare it with the testing practices of other programming languages, it is very efficient and effective because it does not require too much of the developer's time."}]},{"block_type":"element","block":"k6pz2jlz","search_text":"Go follows certain conventions regarding testing. First of all, testing functions should be included in Go source files that end with _test.go . So, if you have a package named aGoPackage.go , then your tests should be placed in a file named aGoPackage_test.go . A test function begins with Test , and it checks the correctness of the behavior of a function of the production package.","text_count":384,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go follows certain conventions regarding testing. First of all, testing functions should be included in Go source files that end with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_test.go"}]},{"block_type":"text","content":". So, if you have a package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aGoPackage.go"}]},{"block_type":"text","content":", then your tests should be placed in a file named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"aGoPackage_test.go"}]},{"block_type":"text","content":". A test function begins with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Test"}]},{"block_type":"text","content":", and it checks the correctness of the behavior of a function of the production package."}]},{"block_type":"element","block":"k6pz2jm0","search_text":"Finally, you will need to import the testing standard Go package for the go test subcommand to work correctly. As you will soon see, this import requirement also applies to two additional cases.","text_count":194,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, you will need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":"standard Go package for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"subcommand to work correctly. As you will soon see, this import requirement also applies to two additional cases."}]},{"block_type":"element","block":"k6pz2jm1","search_text":"Once the testing code is correct, the go test subcommand does all the dirty work for you, which includes scanning all the *_test.go files for special functions, generating a temporary main package properly, calling these special functions, getting the results, and generating the final output.","text_count":293,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once the testing code is correct, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"subcommand does all the dirty work for you, which includes scanning all the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"*_test.go"}]},{"block_type":"text","content":"files for special functions, generating a temporary"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package properly, calling these special functions, getting the results, and generating the final output."}]},{"block_type":"element","block":"k6pz2jm2","search_text":"Tip Always put the testing code in a different source file. There is no need to create a huge source file that is hard to read and maintain. ","text_count":141,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Always put the testing code in a different source file. There is no need to create a huge source file that is hard to read and maintain."}]}]},{"block_type":"element","block":"k6pz2jm3","search_text":"Writing tests for existing Go code","text_count":34,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Writing tests for existing Go code"}]},{"block_type":"element","block":"k6pz2jm4","search_text":"In this section, you will learn how to write tests for an existing Go application that includes two functions: one for calculating the numbers of the Fibonacci sequence and one for finding out the length of a string. The main reason for using these two functions that implement such relatively trivial tasks is simplicity. The tricky point here is that each function will have two different implementations: one that works fine and another one that has some issues.","text_count":465,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to write tests for an existing Go application that includes two functions: one for calculating the numbers of the Fibonacci sequence and one for finding out the length of a string. The main reason for using these two functions that implement such relatively trivial tasks is simplicity. The tricky point here is that each function will have two different implementations: one that works fine and another one that has some issues."}]},{"block_type":"element","block":"k6pz2jm5","search_text":"The Go package in this example is named testMe , and it is saved as testMe.go . The code of this package will be presented in three parts.","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go package in this example is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe"}]},{"block_type":"text","content":", and it is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe.go"}]},{"block_type":"text","content":". The code of this package will be presented in three parts."}]},{"block_type":"element","block":"k6pz2jm6","search_text":"The first part of testMe.go has the following Go code:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe.go"}]},{"block_type":"text","content":"has the following Go code:"}]},{"block_type":"element","block":"k6pz2jm7","search_text":"package testMe func f1(n int) int { if n == 0 { return 0 } if n == 1 { return 1 } return f1(n-1) + f1(n-2) } ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package testMe \nfunc f1(n int) int { \n    if n == 0 { \n        return 0 \n    } \n    if n == 1 { \n        return 1 \n    } \n    return f1(n-1) + f1(n-2) \n}"}]}]},{"block_type":"element","block":"k6pz2jm8","search_text":"In the preceding code, you can see the definition of a function named f1() that calculates natural numbers of the Fibonacci sequence.","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see the definition of a function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"that calculates natural numbers of the Fibonacci sequence."}]},{"block_type":"element","block":"k6pz2jm9","search_text":"The second part of testMe.go is shown in the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jma","search_text":"func f2(n int) int { if n == 0 { return 0 } if n == 1 { return 2 } return f2(n-1) + f2(n-2) } ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f2(n int) int { \n    if n == 0 { \n        return 0 \n    }\n    if n == 1 { \n        return 2 \n    } \n    return f2(n-1) + f2(n-2) \n}"}]}]},{"block_type":"element","block":"k6pz2jmb","search_text":"In this code, you can see the implementation of another function that calculates the numbers of the Fibonacci sequence named f2() . However, this function contains a bug because it does not return 1 when the value of n is 1 , which destroys the entire functionality of the function.","text_count":282,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this code, you can see the implementation of another function that calculates the numbers of the Fibonacci sequence named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":". However, this function contains a bug because it does not return"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":"when the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1"}]},{"block_type":"text","content":", which destroys the entire functionality of the function."}]},{"block_type":"element","block":"k6pz2jmc","search_text":"The remaining code of testMe.go is shown in the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jmd","search_text":"func s1(s string) int { if s == \"\" { return 0 } n := 1 for range s { n++ } return n } func s2(s string) int { return len(s) } ","text_count":126,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func s1(s string) int { \n    if s == \"\" { \n        return 0 \n    } \n    n := 1 \n    for range s { \n        n++ \n    } \n    return n \n}\n \nfunc s2(s string) int { \n    return len(s) \n}"}]}]},{"block_type":"element","block":"k6pz2jme","search_text":"In this part, we implement two functions named s1() and s2() , which work on strings. Both of these functions find the length of a string. However, the implementation of s1() is wrong because the initial value of n is 1 instead of 0.","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, we implement two functions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2()"}]},{"block_type":"text","content":", which work on strings. Both of these functions find the length of a string. However, the implementation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1()"}]},{"block_type":"text","content":"is wrong because the initial value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"n"}]},{"block_type":"text","content":"is 1 instead of 0."}]},{"block_type":"element","block":"k6pz2jmf","search_text":"It is now time to start thinking about tests and test cases. First of all, you should create a testMe_test.go file that will be used for storing your testing functions. Next, it is important to realize that you do not need to make any code changes to testMe.go . Finally, remember that you should try to write as many tests as required to cover all potential inputs and outputs.","text_count":378,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is now time to start thinking about tests and test cases. First of all, you should create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe_test.go"}]},{"block_type":"text","content":"file that will be used for storing your testing functions. Next, it is important to realize that you do not need to make any code changes to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe.go"}]},{"block_type":"text","content":". Finally, remember that you should try to write as many tests as required to cover all potential inputs and outputs."}]},{"block_type":"element","block":"k6pz2jmg","search_text":"The first part of testMe_test.go is shown in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe_test.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jmh","search_text":"package testMe import \"testing\" func TestS1(t *testing.T) { if s1(\"123456789\") != 9 { t.Error(`s1(\"123456789\") != 9`) } if s1(\"\") != 0 { t.Error(`s1(\"\") != 0`) } }","text_count":163,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package testMe \nimport \"testing\" \nfunc TestS1(t *testing.T) { \n    if s1(\"123456789\") != 9 { \n        t.Error(`s1(\"123456789\") != 9`) \n    } \n    if s1(\"\") != 0 { \n        t.Error(`s1(\"\") != 0`) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jmi","search_text":"The preceding function performs two tests on the s1() function: one using \"123456789\" as input and another one using \"\" as input.","text_count":129,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding function performs two tests on the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s1()"}]},{"block_type":"text","content":"function: one using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"123456789\""}]},{"block_type":"text","content":"as input and another one using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"\"\""}]},{"block_type":"text","content":"as input."}]},{"block_type":"element","block":"k6pz2jmj","search_text":"The second part of testMe_test.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jmk","search_text":"func TestS2(t *testing.T) { if s2(\"123456789\") != 9 { t.Error(`s2(\"123456789\") != 9`) } if s2(\"\") != 0 { t.Error(`s2(\"\") != 0`) } } ","text_count":132,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func TestS2(t *testing.T) { \n    if s2(\"123456789\") != 9 { \n        t.Error(`s2(\"123456789\") != 9`) \n    } \n    if s2(\"\") != 0 { \n        t.Error(`s2(\"\") != 0`) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jml","search_text":"The preceding testing code performs the same two tests on the s2() function.","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding testing code performs the same two tests on the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"s2()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2jmm","search_text":"The remaining code of testMe_test.go comes next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testMe_test.go"}]},{"block_type":"text","content":"comes next:"}]},{"block_type":"element","block":"k6pz2jmn","search_text":"func TestF1(t *testing.T) { if f1(0) != 0 { t.Error(`f1(0) != 0`) } if f1(1) != 1 { t.Error(`f1(1) != 1`) } if f1(2) != 1 { t.Error(`f1(2) != 1`) } if f1(10) != 55 { t.Error(`f1(10) != 55`) } } func TestF2(t *testing.T) { if f2(0) != 0 { t.Error(`f2(0) != 0`) } if f2(1) != 1 { t.Error(`f2(1) != 1`) } if f2(2) != 1 { t.Error(`f2(2) != 1`) } if f2(10) != 55 { t.Error(`f2(10) != 55`) } }","text_count":387,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func TestF1(t *testing.T) { \n    if f1(0) != 0 { \n        t.Error(`f1(0) != 0`) \n    } \n    if f1(1) != 1 { \n        t.Error(`f1(1) != 1`) \n    } \n    if f1(2) != 1 { \n        t.Error(`f1(2) != 1`) \n    } \n    if f1(10) != 55 { \n        t.Error(`f1(10) != 55`) \n    } \n}\n \nfunc TestF2(t *testing.T) { \n    if f2(0) != 0 { \n        t.Error(`f2(0) != 0`) \n    } \n    if f2(1) != 1 { \n        t.Error(`f2(1) != 1`) \n    } \n   if f2(2) != 1 { \n        t.Error(`f2(2) != 1`) \n    } \n    if f2(10) != 55 { \n        t.Error(`f2(10) != 55`) \n   } \n}"}]}]},{"block_type":"element","block":"k6pz2jmo","search_text":"The previous code tests the operation of the f1() and the f2() functions.","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The previous code tests the operation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"functions."}]},{"block_type":"element","block":"k6pz2jmp","search_text":"Executing the tests will generate the following output:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the tests will generate the following output:"}]},{"block_type":"element","block":"k6pz2jmq","search_text":"$ go test testMe.go testMe_test.go -v === RUN TestS1 --- FAIL: TestS1 (0.00s) testMe_test.go:7: s1(\"123456789\") != 9 === RUN TestS2 --- PASS: TestS2 (0.00s) === RUN TestF1 --- PASS: TestF1 (0.00s) === RUN TestF2 --- FAIL: TestF2 (0.00s) testMe_test.go:50: f2(1) != 1 testMe_test.go:54: f2(2) != 1 testMe_test.go:58: f2(10) != 55 FAIL FAIL command-line-arguments 0.005s","text_count":368,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test testMe.go testMe_test.go -v\n=== RUN TestS1\n--- FAIL: TestS1 (0.00s)\n    testMe_test.go:7: s1(\"123456789\") != 9\n=== RUN TestS2\n--- PASS: TestS2 (0.00s)\n=== RUN TestF1\n--- PASS: TestF1 (0.00s)\n=== RUN TestF2\n--- FAIL: TestF2 (0.00s)\n    testMe_test.go:50: f2(1) != 1\n    testMe_test.go:54: f2(2) != 1\n    testMe_test.go:58: f2(10) != 55\nFAIL\nFAIL  command-line-arguments  0.005s"}]}]},{"block_type":"element","block":"k6pz2jmr","search_text":"If you do not include the -v parameter, which produces richer output, you will get the following output:","text_count":104,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you do not include the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-v"}]},{"block_type":"text","content":"parameter, which produces richer output, you will get the following output:"}]},{"block_type":"element","block":"k6pz2jms","search_text":"$ go test testMe.go testMe_test.go --- FAIL: TestS1 (0.00s) testMe_test.go:7: s1(\"123456789\") != 9 --- FAIL: TestF2 (0.00s) testMe_test.go:50: f2(1) != 1 testMe_test.go:54: f2(2) != 1 testMe_test.go:58: f2(10) != 55 FAIL FAIL command-line-arguments 0.005s ","text_count":256,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test testMe.go testMe_test.go\n--- FAIL: TestS1 (0.00s)\n    testMe_test.go:7: s1(\"123456789\") != 9\n--- FAIL: TestF2 (0.00s)\n    testMe_test.go:50: f2(1) != 1\n    testMe_test.go:54: f2(2) != 1\n    testMe_test.go:58: f2(10) != 55\nFAIL\nFAIL  command-line-arguments  0.005s"}]}]},{"block_type":"element","block":"k6pz2jmt","search_text":"Should you wish to execute certain tests, you should use to -run command-line option that accepts a regular expression and executes all tests that have a function name which matches the given regular expression:","text_count":211,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Should you wish to execute certain tests, you should use to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-run"}]},{"block_type":"text","content":"command-line option that accepts a regular expression and executes all tests that have a function name which matches the given regular expression:"}]},{"block_type":"element","block":"k6pz2jmu","search_text":"$ go test testMe.go testMe_test.go -run='F2' -v === RUN TestF2 --- FAIL: TestF2 (0.00s) testMe_test.go:50: f2(1) != 1 testMe_test.go:54: f2(2) != 1 testMe_test.go:58: f2(10) != 55 FAIL FAIL command-line-arguments 0.005s $ go test testMe.go testMe_test.go -run='F1' ok command-line-arguments (cached)","text_count":299,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test testMe.go testMe_test.go -run='F2' -v\n=== RUN TestF2\n--- FAIL: TestF2 (0.00s)\n    testMe_test.go:50: f2(1) != 1\n    testMe_test.go:54: f2(2) != 1\n    testMe_test.go:58: f2(10) != 55\nFAIL\nFAIL  command-line-arguments  0.005s\n$ go test testMe.go testMe_test.go -run='F1'\nok    command-line-arguments  (cached)"}]}]},{"block_type":"element","block":"k6pz2jmv","search_text":"The last command verifies that the go test command used caching.","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last command verifies that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command used caching."}]},{"block_type":"element","block":"k6pz2jmw","search_text":"Note Software testing can only show the presence of one or more bugs, not the absence of bugs! This means that you can never be absolutely sure that your code has no bugs. ","text_count":172,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Software testing can only show the presence of one or more bugs, not the absence of bugs! This means that you can never be absolutely sure that your code has no bugs."}]}]},{"block_type":"element","block":"k6pz2jmx","search_text":"Benchmarking Go code","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Benchmarking Go code"}]},{"block_type":"element","block":"k6pz2jmy","search_text":"Benchmarking can give you information about the performance of a function or a program in order to understand better how much faster or slower a function is compared to another function, or compared to the rest of the application. Using that information, you can easily reveal the part of the Go code that needs to be rewritten in order to improve its performance.","text_count":364,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Benchmarking can give you information about the performance of a function or a program in order to understand better how much faster or slower a function is compared to another function, or compared to the rest of the application. Using that information, you can easily reveal the part of the Go code that needs to be rewritten in order to improve its performance."}]},{"block_type":"element","block":"k6pz2jmz","search_text":"Tip Never benchmark your Go code on a busy Unix machine that is currently being used for other, more important purposes unless you have a very good reason to do so. ","text_count":165,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Never benchmark your Go code on a busy Unix machine that is currently being used for other, more important purposes unless you have a very good reason to do so."}]}]},{"block_type":"element","block":"k6pz2jn0","search_text":"Go follows certain conventions regarding benchmarking. The most important convention is that the name of a benchmark function must begin with Benchmark .","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go follows certain conventions regarding benchmarking. The most important convention is that the name of a benchmark function must begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jn1","search_text":"Once again, the go test subcommand is responsible for benchmarking a program. As a result, you still need to import the testing standard Go package and include benchmarking functions in Go files that end with _test.go .","text_count":219,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"subcommand is responsible for benchmarking a program. As a result, you still need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":"standard Go package and include benchmarking functions in Go files that end with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_test.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jn2","search_text":"A simple benchmarking example","text_count":29,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"A simple benchmarking example"}]},{"block_type":"element","block":"k6pz2jn3","search_text":"In this section, I will show you a basic benchmarking example that will measure the performance of three algorithms that generate numbers belonging to the Fibonacci sequence . The good news is that such algorithms require lots of mathematical calculations, which make them perfect candidates for benchmarking.","text_count":309,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, I will show you a basic benchmarking example that will measure the performance of three algorithms that generate numbers belonging to the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Fibonacci sequence"}]},{"block_type":"text","content":". The good news is that such algorithms require lots of mathematical calculations, which make them perfect candidates for benchmarking."}]},{"block_type":"element","block":"k6pz2jn4","search_text":"For the purposes of this section, I will create a new main package, which will be saved as benchmarkMe.go and presented in three parts.","text_count":135,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the purposes of this section, I will create a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package, which will be saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"and presented in three parts."}]},{"block_type":"element","block":"k6pz2jn5","search_text":"The first part of benchmarkMe.go is as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jn6","search_text":"package main import ( \"fmt\" ) func fibo1(n int) int { if n == 0 { return 0 } else if n == 1 { return 1 } else { return fibo1(n-1) + fibo1(n-2) } } ","text_count":147,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n) \n\nfunc fibo1(n int) int { \n    if n == 0 { \n        return 0 \n    } else if n == 1 { \n        return 1 \n    } else { \n        return fibo1(n-1) + fibo1(n-2) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jn7","search_text":"The preceding code contains the implementation of the fibo1() function that uses recursion in order to calculate the numbers of the Fibonacci sequence. Although the algorithm works fine, this is a relatively simple and somehow slow approach.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code contains the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1()"}]},{"block_type":"text","content":"function that uses recursion in order to calculate the numbers of the Fibonacci sequence. Although the algorithm works fine, this is a relatively simple and somehow slow approach."}]},{"block_type":"element","block":"k6pz2jn8","search_text":"The second code segment of benchmarkMe.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jn9","search_text":"func fibo2(n int) int { if n == 0 || n == 1 { return n } return fibo2(n-1) + fibo2(n-2) } ","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func fibo2(n int) int { \n    if n == 0 || n == 1 { \n        return n \n    } \n    return fibo2(n-1) + fibo2(n-2) \n}"}]}]},{"block_type":"element","block":"k6pz2jna","search_text":"In this part, you see the implementation of the fibo2() function that is almost identical to the fibo1() function that you saw earlier. However, it will be interesting to see whether a small code change—a single if statement as opposed to an if else if block—has any impact to the performance of the function.","text_count":309,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo2()"}]},{"block_type":"text","content":"function that is almost identical to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1()"}]},{"block_type":"text","content":"function that you saw earlier. However, it will be interesting to see whether a small code change&mdash;a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement as opposed to an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if else if"}]},{"block_type":"text","content":"block&mdash;has any impact to the performance of the function."}]},{"block_type":"element","block":"k6pz2jnb","search_text":"The third code portion of benchmarkMe.go contains yet another implementation of a function that calculates numbers that belong to the Fibonacci sequence:","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"contains yet another implementation of a function that calculates numbers that belong to the Fibonacci sequence:"}]},{"block_type":"element","block":"k6pz2jnc","search_text":"func fibo3(n int) int { fn := make(map[int]int) for i := 0; i <= n; i++ { var f int if i <= 2 { f = 1 } else { f = fn[i-1] + fn[i-2] } fn[i] = f } return fn[n] } ","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func fibo3(n int) int { \n    fn := make(map[int]int) \n    for i := 0; i &lt;= n; i++ { \n        var f int \n        if i &lt;= 2 { \n            f = 1 \n        } else { \n            f = fn[i-1] + fn[i-2] \n        } \n        fn[i] = f \n    } \n    return fn[n] \n}"}]}]},{"block_type":"element","block":"k6pz2jnd","search_text":"The fibo3() function presented here uses a totally new approach that requires a Go map and has a for loop. It remains to be seen whether this approach is indeed faster than the other two implementations. The algorithm presented in fibo3() will be also used in Chapter 13, Network Programming – Building Servers and Clients, where it will be explained in greater detail. As you will see in a while, choosing an efficient algorithm can save you from a lot of trouble!","text_count":465,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo3()"}]},{"block_type":"text","content":"function presented here uses a totally new approach that requires a Go"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"map"}]},{"block_type":"text","content":"and has a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. It remains to be seen whether this approach is indeed faster than the other two implementations. The algorithm presented in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo3()"}]},{"block_type":"text","content":"will be also used in Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming &ndash; Building Servers and Clients,"}]},{"block_type":"text","content":"&nbsp;where it will be explained in greater detail. As you will see in a while, choosing an efficient algorithm can save you from a lot of trouble!"}]},{"block_type":"element","block":"k6pz2jne","search_text":"The remaining code of benchmarkMe.go follows next:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jnf","search_text":"func main() { fmt.Println(fibo1(40)) fmt.Println(fibo2(40)) fmt.Println(fibo3(40)) } ","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fmt.Println(fibo1(40)) \n    fmt.Println(fibo2(40)) \n    fmt.Println(fibo3(40)) \n}"}]}]},{"block_type":"element","block":"k6pz2jng","search_text":"Executing benchmarkMe.go will generate the following output:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jnh","search_text":"$ go run benchmarkMe.go 102334155 102334155 102334155","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run benchmarkMe.go\n102334155\n102334155\n102334155"}]}]},{"block_type":"element","block":"k6pz2jni","search_text":"The good news is that all three implementations returned the same number. Now it is time to add some benchmarks to benchmarkMe.go in order to understand the efficiency of the each one of the three algorithms.","text_count":208,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good news is that all three implementations returned the same number. Now it is time to add some benchmarks to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"in order to understand the efficiency of the each one of the three algorithms."}]},{"block_type":"element","block":"k6pz2jnj","search_text":"As the Go rules require, the version of benchmarkMe.go containing the benchmark functions will be saved as benchmarkMe_test.go . This program is presented in five parts.","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the Go rules require, the version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":"containing the benchmark functions will be saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":". This program is presented in five parts."}]},{"block_type":"element","block":"k6pz2jnk","search_text":"The first code segment of benchmarkMe_test.go contains the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jnl","search_text":"package main import ( \"testing\" ) var result int func benchmarkfibo1(b *testing.B, n int) { var r int for i := 0; i < b.N; i++ { r = fibo1(n) } result = r } ","text_count":157,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"testing\" \n) \n\nvar result int \nfunc benchmarkfibo1(b *testing.B, n int) { \n    var r int \n    for i := 0; i &lt; b.N; i++ { \n        r = fibo1(n) \n    } \n    result = r \n}"}]}]},{"block_type":"element","block":"k6pz2jnm","search_text":"In the preceding code, you can see the implementation of a function with a name that begins with the benchmark string instead of the Benchmark string. As a result, this function will not run automatically because it begins with a lowercase b instead of an uppercase B .","text_count":269,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see the implementation of a function with a name that begins with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmark"}]},{"block_type":"text","content":"string instead of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark"}]},{"block_type":"text","content":"string. As a result, this function will not run automatically because it begins with a lowercase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"instead of an uppercase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jnn","search_text":"The reason for storing the result of fibo1(n) in a variable named r and using another global variable named result afterwards is tricky. This technique is used for preventing the compiler from performing any optimizations that will exclude the function that you want to measure because its result are never used! The same technique will be applied in functions benchmarkfibo2() and benchmarkfibo3() , which will be presented next.","text_count":430,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for storing the result of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1(n)"}]},{"block_type":"text","content":"in a variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"and using another global variable named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"result"}]},{"block_type":"text","content":"afterwards is tricky. This technique is used for preventing the compiler from performing any optimizations that will exclude the function that you want to measure because its result are never used! The same technique will be applied in functions"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkfibo2()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkfibo3()"}]},{"block_type":"text","content":", which will be presented next."}]},{"block_type":"element","block":"k6pz2jno","search_text":"The second part of benchmarkMe_test.go is shown in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jnp","search_text":"func benchmarkfibo2(b *testing.B, n int) { var r int for i := 0; i < b.N; i++ { r = fibo2(n) } result = r } func benchmarkfibo3(b *testing.B, n int) { var r int for i := 0; i < b.N; i++ { r = fibo3(n) } result = r } ","text_count":216,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func benchmarkfibo2(b *testing.B, n int) { \n    var r int \n    for i := 0; i &lt; b.N; i++ { \n        r = fibo2(n) \n    } \n    result = r\n} \n\nfunc benchmarkfibo3(b *testing.B, n int) { \n    var r int \n    for i := 0; i &lt; b.N; i++ { \n        r = fibo3(n) \n    } \n    result = r \n}"}]}]},{"block_type":"element","block":"k6pz2jnq","search_text":"The preceding code defines two more benchmark functions that will not run automatically because they begin with a lowercase b instead of an uppercase B .","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code defines two more benchmark functions that will not run automatically because they begin with a lowercase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"instead of an uppercase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"B"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jnr","search_text":"Now I will tell you a big secret: even if these three functions were named BenchmarkFibo1() , BenchmarkFibo2() , and BenchmarkFibo3() , they would not have been invoked automatically by the go test command because their signature is not func(*testing.B) . So, the reason for naming them with a lowercase b is this! However, there is nothing that prevents you from invoking them from other benchmark functions afterwards, as you will see shortly.","text_count":445,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now I will tell you a big secret: even if these three functions were named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkFibo1()"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkFibo2()"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkFibo3()"}]},{"block_type":"text","content":", they would not have been invoked automatically by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command because their signature is not"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"func(*testing.B)"}]},{"block_type":"text","content":". So, the reason for naming them with a lowercase"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b"}]},{"block_type":"text","content":"is this! However, there is nothing that prevents you from invoking them from other benchmark functions afterwards, as you will see shortly."}]},{"block_type":"element","block":"k6pz2jns","search_text":"The third part of benchmarkMe_test.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jnt","search_text":"func Benchmark30fibo1(b *testing.B) { benchmarkfibo1(b, 30) } ","text_count":62,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Benchmark30fibo1(b *testing.B) { \n    benchmarkfibo1(b, 30) \n}"}]}]},{"block_type":"element","block":"k6pz2jnu","search_text":"This is a correct benchmark function with the correct name and the correct signature, which means that it will get executed by go tool .","text_count":136,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is a correct benchmark function with the correct name and the correct signature, which means that it will get executed by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jnv","search_text":"Note that although Benchmark30fibo1() is a valid benchmark function name, BenchmarkfiboIII() is not because there is no uppercase letter or a number after the Benchmark string. This is very important because a benchmark function with an incorrect name will not get executed automatically.","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that although"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark30fibo1()"}]},{"block_type":"text","content":"is a valid benchmark function name,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkfiboIII()"}]},{"block_type":"text","content":"is not because there is no uppercase letter or a number after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark"}]},{"block_type":"text","content":"string. This is very important because a benchmark function with an incorrect name will not get executed automatically."}]},{"block_type":"element","block":"k6pz2jnw","search_text":"The fourth code segment of benchmarkMe_test.go contains the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jnx","search_text":"func Benchmark30fibo2(b *testing.B) { benchmarkfibo2(b, 30) } func Benchmark30fibo3(b *testing.B) { benchmarkfibo3(b, 30) } ","text_count":124,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Benchmark30fibo2(b *testing.B) { \n    benchmarkfibo2(b, 30) \n} \n\nfunc Benchmark30fibo3(b *testing.B) { \n    benchmarkfibo3(b, 30) \n}"}]}]},{"block_type":"element","block":"k6pz2jny","search_text":"Both the Benchmark30fibo2() and Benchmark30fibo3() benchmark functions are similar to Benchmark30fibo1() .","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Both the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark30fibo2()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark30fibo3()"}]},{"block_type":"text","content":"benchmark functions are similar to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark30fibo1()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jnz","search_text":"The last part of benchmarkMe_test.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jo0","search_text":"func Benchmark50fibo1(b *testing.B) { benchmarkfibo1(b, 50) } func Benchmark50fibo2(b *testing.B) { benchmarkfibo2(b, 50) } func Benchmark50fibo3(b *testing.B) { benchmarkfibo3(b, 50) } ","text_count":186,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Benchmark50fibo1(b *testing.B) { \n    benchmarkfibo1(b, 50) \n} \n\nfunc Benchmark50fibo2(b *testing.B) { \n    benchmarkfibo2(b, 50) \n} \n\nfunc Benchmark50fibo3(b *testing.B) { \n    benchmarkfibo3(b, 50) \n}"}]}]},{"block_type":"element","block":"k6pz2jo1","search_text":"In this part, you see three additional benchmark functions that calculate the 50th number in the Fibonacci sequence.","text_count":116,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you see three additional benchmark functions that calculate the 50th number in the Fibonacci sequence."}]},{"block_type":"element","block":"k6pz2jo2","search_text":"Tip Remember that each benchmark is executed for at least 1 second by default. If the benchmark function returns in a time that is less than 1 second, the value of b.N is increased and the function is run again. The first time the value of b.N is 1, then it becomes 2, 5, 10, 20, 50, and so on. This happens because the faster the function, the more times you need to run it to get accurate results. ","text_count":400,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Remember that each benchmark is executed for at least 1 second by default. If the benchmark function returns in a time that is less than 1 second, the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b.N"}]},{"block_type":"text","content":"is increased and the function is run again. The first time the value of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b.N"}]},{"block_type":"text","content":"is 1, then it becomes 2, 5, 10, 20, 50, and so on. This happens because the faster the function, the more times you need to run it to get accurate results."}]}]},{"block_type":"element","block":"k6pz2jo3","search_text":"Executing benchmarkMe_test.go will generate the following output:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe_test.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jo4","search_text":"$ go test -bench=. benchmarkMe.go benchmarkMe_test.go goos: darwin goarch: amd64 Benchmark30fibo1-8 300 4494213 ns/op Benchmark30fibo2-8 300 4463607 ns/op Benchmark30fibo3-8 500000 2829 ns/op Benchmark50fibo1-8 1 67272089954 ns/op Benchmark50fibo2-8 1 67300080137 ns/op Benchmark50fibo3-8 300000 4138 ns/op PASS ok command-line-arguments 145.827s","text_count":346,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test -bench=. benchmarkMe.go benchmarkMe_test.go\ngoos: darwin\ngoarch: amd64\nBenchmark30fibo1-8       300   4494213 ns/op\nBenchmark30fibo2-8       300   4463607 ns/op\nBenchmark30fibo3-8       500000      2829 ns/op\nBenchmark50fibo1-8       1    67272089954 ns/op\nBenchmark50fibo2-8       1    67300080137 ns/op\nBenchmark50fibo3-8       300000      4138 ns/op\nPASS\nok    command-line-arguments  145.827s"}]}]},{"block_type":"element","block":"k6pz2jo5","search_text":"There are two important points here: first, the value of the -bench parameter specifies the benchmark functions that will be executed. The . value used is a regular expression that matches all valid benchmark functions. The second point is that if you omit the -bench parameter, no benchmark function will be executed!","text_count":318,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are two important points here: first, the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-bench"}]},{"block_type":"text","content":"parameter specifies the benchmark functions that will be executed. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"."}]},{"block_type":"text","content":"value used is a regular expression that matches all valid benchmark functions. The second point is that if you omit the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-bench"}]},{"block_type":"text","content":"parameter, no benchmark function will be executed!"}]},{"block_type":"element","block":"k6pz2jo6","search_text":"So, what does this output tell us? First of all, -8 at the end of each benchmark function ( Benchmark10fibo1-8 ) signifies the number of goroutines used during its execution, which is essentially the value of the GOMAXPROCS environment variable. You will recall that we talked about the GOMAXPROCS environment variable back in Chapter 10, Go Concurrency – Advanced Topics . Similarly, you can see the values of GOOS and GOARCH , which show the operating system and the architecture of your machine.","text_count":498,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, what does this output tell us? First of all,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-8"}]},{"block_type":"text","content":"at the end of each benchmark function ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark10fibo1-8"}]},{"block_type":"text","content":") signifies the number of goroutines used during its execution, which is essentially the value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"environment variable. You will recall that we talked about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOMAXPROCS"}]},{"block_type":"text","content":"environment variable back in Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Go Concurrency&nbsp;&ndash; Advanced Topics"}]},{"block_type":"text","content":". Similarly, you can see the values of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":", which show the operating system and the architecture of your machine."}]},{"block_type":"element","block":"k6pz2jo7","search_text":"The second column in the output displays the number of times that the relevant function was executed. Faster functions are executed more times than slower functions. As an example, function Benchmark30fibo3() was executed 500,000 times, while function Benchmark50fibo2() was executed only once! The third column in the output shows the average time of each run.","text_count":361,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second column in the output displays the number of times that the relevant function was executed. Faster functions are executed more times than slower functions. As an example, function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark30fibo3()"}]},{"block_type":"text","content":"was executed 500,000 times, while function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark50fibo2()"}]},{"block_type":"text","content":"was executed only once! The third column in the output shows the average time of each run."}]},{"block_type":"element","block":"k6pz2jo8","search_text":"As you can see, the fibo1() and fibo2() functions are really slow compared to the fibo3() function. Should you wish to include memory allocation statistics in the output, you can execute the following command:","text_count":209,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo2()"}]},{"block_type":"text","content":"&nbsp;functions&nbsp;are really slow compared to the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo3()"}]},{"block_type":"text","content":"&nbsp;function. Should you wish to include memory allocation statistics in the output, you can execute the following command:"}]},{"block_type":"element","block":"k6pz2jo9","search_text":"$ go test -benchmem -bench=. benchmarkMe.go benchmarkMe_test.go goos: darwin goarch: amd64 Benchmark30fibo1-8 300 4413791 ns/op 0 B/op 0 allocs/op Benchmark30fibo2-8 300 4430097 ns/op 0 B/op 0 allocs/op Benchmark30fibo3-8 500000 2774 ns/op 2236 B/op 6 allocs/op Benchmark50fibo1-8 1 71534648696 ns/op 0 B/op 0 allocs/op Benchmark50fibo2-8 1 72551120174 ns/op 0 B/op 0 allocs/op Benchmark50fibo3-8 300000 4612 ns/op 2481 B/op 10 allocs/op PASS ok command-line-arguments 150.500s","text_count":477,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test -benchmem -bench=. benchmarkMe.go benchmarkMe_test.go\ngoos: darwin\ngoarch: amd64\nBenchmark30fibo1-8 300   4413791 ns/op     0 B/op      0 allocs/op\nBenchmark30fibo2-8 300   4430097 ns/op     0 B/op      0 allocs/op\nBenchmark30fibo3-8 500000      2774 ns/op  2236 B/op   6 allocs/op\nBenchmark50fibo1-8 1    71534648696 ns/op  0 B/op      0 allocs/op\nBenchmark50fibo2-8 1    72551120174 ns/op  0 B/op      0 allocs/op\nBenchmark50fibo3-8 300000      4612 ns/op  2481 B/op   10 allocs/op\nPASS\nok    command-line-arguments  150.500s"}]}]},{"block_type":"element","block":"k6pz2joa","search_text":"The preceding output is similar to the one without the -benchmem command-line parameter, but it includes two more columns in its output. The fourth column shows the amount of memory that was allocated on average in each execution of the benchmark function. The fifth column shows the number of allocations used for allocating the memory value of the fourth column. So, Benchmark50fibo3() allocated 2481 bytes in 10 allocations on average.","text_count":438,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding output is similar to the one without the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-benchmem"}]},{"block_type":"text","content":"command-line parameter, but it includes two more columns in its output. The fourth column shows the amount of memory that was allocated on average in each execution of the benchmark function. The fifth column shows the number of allocations used for allocating the memory value of the fourth column. So,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark50fibo3()"}]},{"block_type":"text","content":"allocated 2481 bytes in 10 allocations on average."}]},{"block_type":"element","block":"k6pz2job","search_text":"As you can understand, functions fibo1() and fibo2() do not need any special kind of memory apart from the expected one, because neither of them is using any kind of data structure, which is not the case with fibo3() which uses a map variable; hence the larger than zero values in both the fourth and fifth columns of the output of Benchmark10fibo3-8 .","text_count":352,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can understand, functions"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo1()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo2()"}]},{"block_type":"text","content":"do not need any special kind of memory apart from the expected one, because neither of them is using any kind of data structure, which is not the case with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fibo3()"}]},{"block_type":"text","content":"which uses a map variable; hence the larger than zero values in both the fourth and fifth columns of the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Benchmark10fibo3-8"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2joc","search_text":"A wrong benchmark function","text_count":26,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A wrong benchmark function"}]},{"block_type":"element","block":"k6pz2jod","search_text":"Look at the Go code of the following benchmark function:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Look at the Go code of the following benchmark function:"}]},{"block_type":"element","block":"k6pz2joe","search_text":"func BenchmarkFiboI(b *testing.B) { for i := 0; i < b.N; i++ { _ = fibo1(i) } } ","text_count":80,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func BenchmarkFiboI(b *testing.B) { \n    for i := 0; i &lt; b.N; i++ { \n        _ = fibo1(i) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jof","search_text":"The BenchmarkFibo() function has a valid name and the correct signature. The bad news, however, is that this benchmark function is wrong, and you will not get any output from it after executing the go test command!","text_count":214,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkFibo()"}]},{"block_type":"text","content":"function has a valid name and the correct signature. The bad news, however, is that this benchmark function is wrong, and you will not get any output from it after executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command!"}]},{"block_type":"element","block":"k6pz2jog","search_text":"The reason for this is that as the b.N value grows according to the way described in a previous section, the run time of the benchmark function will also increase because of the for loop. This fact prevents BenchmarkFiboI() from converging to a stable number, which prevents the function from completing and therefore returning.","text_count":328,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for this is that as the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"b.N"}]},{"block_type":"text","content":"value grows according to the way described in a previous section, the run time of the benchmark function will also increase because of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop. This fact prevents"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BenchmarkFiboI()"}]},{"block_type":"text","content":"from converging to a stable number, which prevents the function from completing and therefore returning."}]},{"block_type":"element","block":"k6pz2joh","search_text":"For analogous reasons, the next benchmark function is also wrongly implemented:","text_count":79,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For analogous reasons, the next benchmark function is also wrongly implemented:"}]},{"block_type":"element","block":"k6pz2joi","search_text":"func BenchmarkfiboII(b *testing.B) { for i := 0; i < b.N; i++ { _ = fibo2(b.N) } }","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func BenchmarkfiboII(b *testing.B) { \n    for i := 0; i &lt; b.N; i++ { \n        _ = fibo2(b.N) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2joj","search_text":"Conversely, there is nothing wrong with the implementation of the following two benchmark functions:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Conversely, there is nothing wrong with the implementation of the following two benchmark functions:"}]},{"block_type":"element","block":"k6pz2jok","search_text":"func BenchmarkFiboIV(b *testing.B) { for i := 0; i < b.N; i++ { _ = fibo3(10) } } func BenchmarkFiboIII(b *testing.B) { _ = fibo3(b.N) } ","text_count":137,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func BenchmarkFiboIV(b *testing.B) { \n    for i := 0; i &lt; b.N; i++ { \n        _ = fibo3(10) \n    } \n}\n \nfunc BenchmarkFiboIII(b *testing.B) { \n    _ = fibo3(b.N) \n}"}]}]},{"block_type":"element","block":"k6pz2jol","search_text":"Benchmarking buffered writing","text_count":29,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Benchmarking buffered writing"}]},{"block_type":"element","block":"k6pz2jom","search_text":"In this section, we will explore how the size of the write buffer affects the performance of the entire writing operation using the Go code of writingBU.go , which will be presented in five parts.","text_count":196,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, we will explore how the size of the write buffer affects the performance of the entire writing operation using the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":", which will be presented in five parts."}]},{"block_type":"element","block":"k6pz2jon","search_text":"The writingBU.go program generates dummy files with randomly generated data. The variables of the program are the size of the buffer and the size of the output file.","text_count":165,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"program generates dummy files with randomly generated data. The variables of the program are the size of the buffer and the size of the output file."}]},{"block_type":"element","block":"k6pz2joo","search_text":"The first part of writingBU.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jop","search_text":"package main import ( \"fmt\" \"math/rand\" \"os\" \"strconv\" ) var BUFFERSIZE int var FILESIZE int func random(min, max int) int { return rand.Intn(max-min) + min } ","text_count":159,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"os\" \n    \"strconv\" \n) \n\nvar BUFFERSIZE int \nvar FILESIZE int\n \nfunc random(min, max int) int { \n    return rand.Intn(max-min) + min \n}"}]}]},{"block_type":"element","block":"k6pz2joq","search_text":"The second code portion of writingBU.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jor","search_text":"func createBuffer(buf *[]byte, count int) { *buf = make([]byte, count) if count == 0 { return } for i := 0; i < count; i++ { intByte := byte(random(0, 100)) if len(*buf) > count { return } *buf = append(*buf, intByte) } } ","text_count":222,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func createBuffer(buf *[]byte, count int) { \n    *buf = make([]byte, count) \n    if count == 0 { \n        return \n    } \n    for i := 0; i &lt; count; i++ { \n        intByte := byte(random(0, 100)) \n        if len(*buf) &gt; count { \n               return \n        } \n        *buf = append(*buf, intByte) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jos","search_text":"The third part of writingBU.go is shown in the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jot","search_text":"func Create(dst string, b, f int) error { _, err := os.Stat(dst) if err == nil { return fmt.Errorf(\"File %s already exists.\", dst) } destination, err := os.Create(dst) if err != nil { return err } defer destination.Close() if err != nil { panic(err) } buf := make([]byte, 0) for { createBuffer(&buf, b) buf = buf[:b] if _, err := destination.Write(buf); err != nil { return err } if f < 0 { break } f = f - len(buf) } return err } ","text_count":431,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Create(dst string, b, f int) error { \n    _, err := os.Stat(dst) \n    if err == nil { \n        return fmt.Errorf(\"File %s already exists.\", dst) \n    } \n    destination, err := os.Create(dst) \n    if err != nil { \n        return err \n    } \n    defer destination.Close() \n    if err != nil { \n        panic(err) \n    } \n    buf := make([]byte, 0) \n    for { \n        createBuffer(&amp;buf, b) \n        buf = buf[:b] \n        if _, err := destination.Write(buf); err != nil { \n             return err \n        } \n        if f &lt; 0 { \n             break \n        } \n        f = f - len(buf) \n    } \n    return err \n}"}]}]},{"block_type":"element","block":"k6pz2jou","search_text":"The Create() function does all of the work in the program, and it is the function that needs to be benchmarked.","text_count":111,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Create()"}]},{"block_type":"text","content":"function does all of the work in the program, and it is the function that needs to be benchmarked."}]},{"block_type":"element","block":"k6pz2jov","search_text":"Note that if the buffer size and the file size were not part of the signature of the Create() function, you would a have problem writing a benchmark function for Create() because you would be required to use the BUFFERSIZE and FILESIZE global variables which are both initialized in the main() function of writingBU.go .","text_count":320,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that if the buffer size and the file size were not part of the signature of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Create()"}]},{"block_type":"text","content":"function, you would a have problem writing a benchmark function for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Create()"}]},{"block_type":"text","content":"because you would be required to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BUFFERSIZE"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FILESIZE"}]},{"block_type":"text","content":"global variables which are both initialized in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jow","search_text":"This would be difficult to do in the writingBU_test.go file. This means that in order to create a benchmark for a function, you should also think about it when you are writing your code.","text_count":186,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This would be difficult to do in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"file. This means that in order to create a benchmark for a function, you should also think about it when you are writing your code."}]},{"block_type":"element","block":"k6pz2jox","search_text":"The fourth code segment of writingBU.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2joy","search_text":"func main() { if len(os.Args) != 3 { fmt.Println(\"Need BUFFERSIZE FILESIZE!\") return } output := \"/tmp/randomFile\" BUFFERSIZE, _ = strconv.Atoi(os.Args[1]) FILESIZE, _ = strconv.Atoi(os.Args[2]) err := Create(output, BUFFERSIZE, FILESIZE) if err != nil { fmt.Println(err) } ","text_count":274,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 3 { \n        fmt.Println(\"Need BUFFERSIZE FILESIZE!\") \n        return \n    } \n    output := \"/tmp/randomFile\" \n    BUFFERSIZE, _ = strconv.Atoi(os.Args[1]) \n    FILESIZE, _ = strconv.Atoi(os.Args[2]) \n    err := Create(output, BUFFERSIZE, FILESIZE) \n    if err != nil { \n        fmt.Println(err) \n   }"}]}]},{"block_type":"element","block":"k6pz2joz","search_text":"The remaining Go code of writingBU.go follows next:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jp0","search_text":"err = os.Remove(output) if err != nil { fmt.Println(err) } } ","text_count":61,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err = os.Remove(output) \n    if err != nil { \n         fmt.Println(err) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jp1","search_text":"Although the os.Remove() call that deletes the temporary file is inside of the main() function, which is not called by the benchmark functions, it is easy to call os.Remove() from the benchmark functions, so there is no problem here.","text_count":233,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Remove()"}]},{"block_type":"text","content":"call that deletes the temporary file is inside of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function, which is not called by the benchmark functions, it is easy to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Remove()"}]},{"block_type":"text","content":"from the benchmark functions, so there is no problem here."}]},{"block_type":"element","block":"k6pz2jp2","search_text":"Executing writingBU.go twice on a macOS High Sierra machine with a SSD hard disk using the time(1) utility to check the speed of the program generates the following output:","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"twice on a macOS High Sierra machine with a SSD hard disk using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time(1)"}]},{"block_type":"text","content":"utility to check the speed of the program generates the following output:"}]},{"block_type":"element","block":"k6pz2jp3","search_text":"$ time go run writingBU.go 1 100000 real 0m1.193s user 0m0.349s sys 0m0.809s $ time go run writingBU.go 10 100000 real 0m0.283s user 0m0.195s sys 0m0.228s","text_count":154,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ time go run writingBU.go 1 100000\nreal  0m1.193s\nuser  0m0.349s\nsys   0m0.809s\n$ time go run writingBU.go 10 100000\nreal  0m0.283s\nuser  0m0.195s\nsys   0m0.228s"}]}]},{"block_type":"element","block":"k6pz2jp4","search_text":"So, although it is obvious that the size of the write buffer plays a key role in the performance of the program, we need to be much more specific and accurate. Therefore, we will write benchmark functions that will be stored in writingBU_test.go .","text_count":247,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, although it is obvious that the size of the write buffer plays a key role in the performance of the program, we need to be much more specific and accurate. Therefore, we will write benchmark functions that will be stored in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jp5","search_text":"The first part of writingBU_test.go is shown in the following Go code:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jp6","search_text":"package main import ( \"fmt\" \"os\" \"testing\" ) var ERR error func benchmarkCreate(b *testing.B, buffer, filesize int) { var err error for i := 0; i < b.N; i++ { err = Create(\"/tmp/random\", buffer, filesize) } ERR = err err = os.Remove(\"/tmp/random\") if err != nil { fmt.Println(err) } } ","text_count":285,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"os\" \n    \"testing\" \n) \nvar ERR error\n \nfunc benchmarkCreate(b *testing.B, buffer, filesize int) { \n    var err error \n    for i := 0; i &lt; b.N; i++ { \n        err = Create(\"/tmp/random\", buffer, filesize) \n    } \n    ERR = err \n    err = os.Remove(\"/tmp/random\") \n    if err != nil { \n        fmt.Println(err) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jp7","search_text":"As you will recall, this is not a valid benchmark function.","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you will recall, this is not a valid benchmark function."}]},{"block_type":"element","block":"k6pz2jp8","search_text":"The second code segment of writingBU_test.go is as follows:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jp9","search_text":"func Benchmark1Create(b *testing.B) { benchmarkCreate(b, 1, 1000000) } func Benchmark2Create(b *testing.B) { benchmarkCreate(b, 2, 1000000) } ","text_count":142,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Benchmark1Create(b *testing.B) { \n    benchmarkCreate(b, 1, 1000000) \n}\n \nfunc Benchmark2Create(b *testing.B) { \n    benchmarkCreate(b, 2, 1000000) \n}"}]}]},{"block_type":"element","block":"k6pz2jpa","search_text":"The remaining code of writingBU_test.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jpb","search_text":"func Benchmark4Create(b *testing.B) { benchmarkCreate(b, 4, 1000000) } func Benchmark10Create(b *testing.B) { benchmarkCreate(b, 10, 1000000) } func Benchmark1000Create(b *testing.B) { benchmarkCreate(b, 1000, 1000000) }","text_count":220,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Benchmark4Create(b *testing.B) { \n    benchmarkCreate(b, 4, 1000000) \n}\n \nfunc Benchmark10Create(b *testing.B) { \n    benchmarkCreate(b, 10, 1000000) \n}\n \nfunc Benchmark1000Create(b *testing.B) { \n    benchmarkCreate(b, 1000, 1000000) \n}"}]}]},{"block_type":"element","block":"k6pz2jpc","search_text":"Here we created five benchmark functions that will check the performance of the benchmarkCreate() function, which checks the performance of the Create() function for various write buffer sizes.","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here we created five benchmark functions that will check the performance of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkCreate()"}]},{"block_type":"text","content":"function, which checks the performance of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Create()"}]},{"block_type":"text","content":"function for various write buffer sizes."}]},{"block_type":"element","block":"k6pz2jpd","search_text":"Executing go test on both writingBU.go and writingBU_test.go files will generate the following output:","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"on both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"writingBU_test.go"}]},{"block_type":"text","content":"files will generate the following output:"}]},{"block_type":"element","block":"k6pz2jpe","search_text":"$ go test -bench=. writingBU.go writingBU_test.go goos: darwin goarch: amd64 Benchmark1Create-8 1 6231302525 ns/op Benchmark2Create-8 1 2956333326 ns/op Benchmark4Create-8 1 1498240817 ns/op Benchmark10Create-8 100000 10644 ns/op Benchmark1000Create-8 300000 4653 ns/op PASS ok command-line-arguments 23.774s","text_count":308,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test -bench=. writingBU.go writingBU_test.go\ngoos: darwin\ngoarch: amd64\nBenchmark1Create-8       1    6231302525 ns/op\nBenchmark2Create-8       1    2956333326 ns/op\nBenchmark4Create-8       1    1498240817 ns/op\nBenchmark10Create-8      100000      10644 ns/op\nBenchmark1000Create-8    300000      4653 ns/op\nPASS\nok    command-line-arguments  23.774s"}]}]},{"block_type":"element","block":"k6pz2jpf","search_text":"The following output also checks the memory allocations of the benchmark functions:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following output also checks the memory allocations of the benchmark functions:"}]},{"block_type":"element","block":"k6pz2jpg","search_text":"$ go test -bench=. writingBU.go writingBU_test.go -benchmem goos: darwin goarch: amd64 Benchmark1Create-8 1 6209493161 ns/op 16000840 B/op 2000017 allocs/op Benchmark2Create-8 1 3177139645 ns/op 8000584 B/op 1000013 allocs/op Benchmark4Create 1 1632772604 ns/op 4000424 B/op 500011 allocs/op Benchmark10Create-8 100000 11238 ns/op 336 B/op 7 allocs/op Benchmark1000Create-8 200000 5122 ns/op 303 B/op 5 allocs/op PASS ok command-line-arguments 24.031s","text_count":451,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test -bench=. writingBU.go writingBU_test.go -benchmem\ngoos: darwin\ngoarch: amd64\nBenchmark1Create-8 1    6209493161 ns/op  16000840 B/op      2000017 allocs/op\nBenchmark2Create-8 1    3177139645 ns/op   8000584 B/op      1000013 allocs/op\nBenchmark4Create 1      1632772604 ns/op   4000424 B/op      500011 allocs/op\nBenchmark10Create-8 100000    11238 ns/op  336 B/op    7 allocs/op\nBenchmark1000Create-8 200000 5122 ns/op    303 B/op    5 allocs/op\nPASS\nok    command-line-arguments  24.031s"}]}]},{"block_type":"element","block":"k6pz2jph","search_text":"It is now time to interpret the output of the two go test commands.","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is now time to interpret the output of the two"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"commands."}]},{"block_type":"element","block":"k6pz2jpi","search_text":"It is extremely obvious that using a write buffer with a size of 1 byte is totally inefficient and slows everything down. Additionally, such a buffer size requires too many memory operations, which slows down the program even more!","text_count":231,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is extremely obvious that using a write buffer with a size of 1 byte is totally inefficient and slows everything down. Additionally, such a buffer size requires too many memory operations, which slows down the program even more!"}]},{"block_type":"element","block":"k6pz2jpj","search_text":"Using a write buffer with 2 bytes makes the entire program twice as fast, which is a good thing. However, it is still very slow. The same applies to a write buffer with a size of 4 bytes.","text_count":187,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using a write buffer with 2 bytes makes the entire program twice as fast, which is a good thing. However, it is still very slow. The same applies to a write buffer with a size of 4 bytes."}]},{"block_type":"element","block":"k6pz2jpk","search_text":"Where things get faster is when we decide to use a write buffer with a size of 10 bytes. Finally, the results show that using a write buffer with a size of 1,000 bytes does not make things 100 faster than when using a buffer size of 10 bytes, which means that the sweet spot between speed and write buffer size is between these two values.","text_count":339,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Where things get faster is when we decide to use a write buffer with a size of 10 bytes. Finally, the results show that using a write buffer with a size of 1,000 bytes does not make things 100 faster than when using a buffer size of 10 bytes, which means that the sweet spot between speed and write buffer size is between these two values."}]},{"block_type":"element","block":"k6pz2jpl","search_text":"Finding unreachable Go code","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Finding unreachable Go code"}]},{"block_type":"element","block":"k6pz2jpm","search_text":"Go code that cannot be executed is a logical error, and therefore it is pretty difficult to be revealed by developers or a normal execution of the Go compiler. Put simply, there is nothing wrong with unreachable code apart from the fact that there is no way for this code to get executed!","text_count":288,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go code that cannot be executed is a logical error, and therefore it is pretty difficult to be revealed by developers or a normal execution of the Go compiler. Put simply, there is nothing wrong with unreachable code apart from the fact that there is no way for this code to get executed!"}]},{"block_type":"element","block":"k6pz2jpn","search_text":"Take a look at the following Go code, which is saved as cannotReach.go :","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Take a look at the following Go code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cannotReach.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jpo","search_text":"package main import ( \"fmt\" ) func f1() int { fmt.Println(\"Entering f1()\") return -10 fmt.Println(\"Exiting f1()\") return -1 } func f2() int { if true { return 10 } fmt.Println(\"Exiting f2()\") return 0 } func main() { fmt.Println(f1()) fmt.Println(\"Exiting program...\") } ","text_count":271,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n)\n \nfunc f1() int { \n    fmt.Println(\"Entering f1()\") \n    return -10 \n    fmt.Println(\"Exiting f1()\") \n    return -1 \n}\n \nfunc f2() int { \n    if true { \n        return 10 \n    } \n    fmt.Println(\"Exiting f2()\") \n    return 0 \n}\n \nfunc main() { \n    fmt.Println(f1()) \n    fmt.Println(\"Exiting program...\") \n}"}]}]},{"block_type":"element","block":"k6pz2jpp","search_text":"There is nothing syntactically incorrect with the Go code of cannotReach.go . As a result, you can execute cannotReach.go without getting any error messages from the compiler:","text_count":175,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There is nothing syntactically incorrect with the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cannotReach.go"}]},{"block_type":"text","content":". As a result, you can execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cannotReach.go"}]},{"block_type":"text","content":"without getting any error messages from the compiler:"}]},{"block_type":"element","block":"k6pz2jpq","search_text":"$ go run cannotReach.go Entering f1() -1 Exiting program...","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run cannotReach.go\nEntering f1()\n-1\nExiting program..."}]}]},{"block_type":"element","block":"k6pz2jpr","search_text":"Note that the f2() is never used in the program. However, it is easy to guess that the following Go code of f2() never gets executed because the condition in the preceding if statement is always true :","text_count":201,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"is never used in the program. However, it is easy to guess that the following Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"never gets executed because the condition in the preceding"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"&nbsp;statement is always"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"true"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jps","search_text":"fmt.Println(\"Exiting f2()\") return 0 ","text_count":37,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Exiting f2()\") \nreturn 0"}]}]},{"block_type":"element","block":"k6pz2jpt","search_text":"So, what can you do about it? You can execute go tool vet as follows:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, what can you do about it? You can execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool vet"}]},{"block_type":"text","content":"as follows:"}]},{"block_type":"element","block":"k6pz2jpu","search_text":"$ go tool vet cannotReach.go cannotReach.go:10: unreachable code ","text_count":65,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool vet cannotReach.go\ncannotReach.go:10: unreachable code"}]}]},{"block_type":"element","block":"k6pz2jpv","search_text":"The output tells us that there is unreachable code at line 10 of the program. Now let's remove the return -10 statement from function f1() and rerun go tool vet :","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output tells us that there is unreachable code at line 10 of the program. Now let's remove the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"return -10"}]},{"block_type":"text","content":"statement from function"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f1()"}]},{"block_type":"text","content":"and rerun"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool vet"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jpw","search_text":"$ go tool vet cannotReach.go","text_count":28,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool vet cannotReach.go"}]}]},{"block_type":"element","block":"k6pz2jpx","search_text":"Here there are no new error messages despite the fact the there is still unreachable code in the f2() function. This means that go tool vet cannot catch every possible type of logical error.","text_count":190,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Here there are no new error messages despite the fact the there is still unreachable code in the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f2()"}]},{"block_type":"text","content":"&nbsp;function. This means that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool vet"}]},{"block_type":"text","content":"cannot catch every possible type of logical error."}]},{"block_type":"element","block":"k6pz2jpy","search_text":"Cross-compilation","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Cross-compilation"}]},{"block_type":"element","block":"k6pz2jpz","search_text":"Cross-compilation is the process of generating a binary executable file for a different architecture than the one on which you are working.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Cross-compilation"}]},{"block_type":"text","content":"is the process of generating a binary executable file for a different architecture than the one on which you are working."}]},{"block_type":"element","block":"k6pz2jq0","search_text":"The main benefit that you receive from cross-compilation is that you do not need a second or a third machine for creating executable files for different architectures. This means that you basically need just a single machine for your development. Fortunately, Go has built-in support for cross-compilation!","text_count":306,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main benefit that you receive from cross-compilation is that you do not need a second or a third machine for creating executable files for different architectures. This means that you basically need just a single machine for your development. Fortunately, Go has built-in support for cross-compilation!"}]},{"block_type":"element","block":"k6pz2jq1","search_text":"For the purpose of this section, we will use the Go code of xCompile.go for illustrating the cross-compilation process. The Go code of xCompile.go is as follows:","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the purpose of this section, we will use the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xCompile.go"}]},{"block_type":"text","content":"for illustrating the cross-compilation process. The Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xCompile.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jq2","search_text":"package main import ( \"fmt\" \"runtime\" ) func main() { fmt.Print(\"You are using \", runtime.Compiler, \" \") fmt.Println(\"on a\", runtime.GOARCH, \"machine\") fmt.Println(\"with Go version\", runtime.Version()) } ","text_count":204,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \nimport ( \n    \"fmt\" \n    \"runtime\" \n) \n\nfunc main() { \n    fmt.Print(\"You are using \", runtime.Compiler, \" \") \n    fmt.Println(\"on a\", runtime.GOARCH, \"machine\") \n    fmt.Println(\"with Go version\", runtime.Version()) \n}"}]}]},{"block_type":"element","block":"k6pz2jq3","search_text":"Running xCompile.go on a macOS High Sierra machine generates the following output:","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xCompile.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine generates the following output:"}]},{"block_type":"element","block":"k6pz2jq4","search_text":"$ go run xCompile.go You are using gc on a amd64 machine with Go version go1.10 ","text_count":80,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run xCompile.go\nYou are using gc on a amd64 machine\nwith Go version go1.10"}]}]},{"block_type":"element","block":"k6pz2jq5","search_text":"In order to cross compile a Go source file, you will need to set the GOOS and GOARCH environment variables to the target operating system and architecture, respectively, which is not as difficult as it sounds.","text_count":209,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to cross compile a Go source file, you will need to set the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"environment variables to the target operating system and architecture, respectively, which is not as difficult as it sounds."}]},{"block_type":"element","block":"k6pz2jq6","search_text":"So, the cross-compilation process goes like this:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, the cross-compilation process goes like this:"}]},{"block_type":"element","block":"k6pz2jq7","search_text":"$ env GOOS=linux GOARCH=arm go build xCompile.go $ file xCompile xCompile: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), statically linked, with debug_info, not stripped $ ./xCompile -bash: ./xCompile: cannot execute binary file","text_count":238,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ env GOOS=linux GOARCH=arm go build xCompile.go\n$ file xCompile\nxCompile: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), statically linked, with debug_info, not stripped\n$ ./xCompile\n-bash: ./xCompile: cannot execute binary file"}]}]},{"block_type":"element","block":"k6pz2jq8","search_text":"The first command generates a binary file that works on Linux machines which use the ARM architecture, while the output of file(1) verifies that the generated binary file is indeed for a different architecture.","text_count":210,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first command generates a binary file that works on Linux machines which use the ARM architecture, while the output of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"file(1)"}]},{"block_type":"text","content":"verifies that the generated binary file is indeed for a different architecture."}]},{"block_type":"element","block":"k6pz2jq9","search_text":"As the Debian Linux machine that will be used for this example has an Intel processor, we will have to execute the go build command once more using the correct GOARCH value:","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the Debian Linux machine that will be used for this example has an Intel processor, we will have to execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go build"}]},{"block_type":"text","content":"command once more using the correct"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"value:"}]},{"block_type":"element","block":"k6pz2jqa","search_text":"$ env GOOS=linux GOARCH=386 go build xCompile.go $ file xCompile xCompile: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, with debug_info, not stripped","text_count":181,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ env GOOS=linux GOARCH=386 go build xCompile.go\n$ file xCompile\nxCompile: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, with debug_info, not stripped"}]}]},{"block_type":"element","block":"k6pz2jqb","search_text":"Executing the generated binary executable file on a Linux machine will produce the following expected output:","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the generated binary executable file on a Linux machine will produce the following expected output:"}]},{"block_type":"element","block":"k6pz2jqc","search_text":"$ ./xCompile You are using gc on a 386 machine with Go version go1.10 $ go version go version go1.3.3 linux/amd64 $ go run xCompile.go You are using gc on a amd64 machine with Go version go1.3.3","text_count":194,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ./xCompile\nYou are using gc on a 386 machine\nwith Go version go1.10\n$ go version\ngo version go1.3.3 linux/amd64\n$ go run xCompile.go\nYou are using gc on a amd64 machine\nwith Go version go1.3.3"}]}]},{"block_type":"element","block":"k6pz2jqd","search_text":"One thing to notice here is that the cross-compiled binary file of xCompile.go prints the Go version of the machine used for compiling it. The second thing to notice is that the architecture of the Linux machine is actually amd64 instead of 386 , which was used in the cross-compilation process.","text_count":295,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"One thing to notice here is that the cross-compiled binary file of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"xCompile.go"}]},{"block_type":"text","content":"prints the Go version of the machine used for compiling it. The second thing to notice is that the architecture of the Linux machine is actually"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"amd64"}]},{"block_type":"text","content":"instead of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"386"}]},{"block_type":"text","content":", which was used in the cross-compilation process."}]},{"block_type":"element","block":"k6pz2jqe","search_text":"Tip You can find the list of the available values for the GOOS and GOARCH environment variables at https://golang.org/doc/install/source . Keep in mind, however, that not all the GOOS and GOARCH pairs are valid. ","text_count":212,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the list of the available values for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"environment variables at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/doc/install/source","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/doc/install/source"}]},{"block_type":"text","content":". Keep in mind, however, that not all the&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOOS"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GOARCH"}]},{"block_type":"text","content":"pairs are valid."}]}]},{"block_type":"element","block":"k6pz2jqf","search_text":"Creating example functions","text_count":26,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Creating example functions"}]},{"block_type":"element","block":"k6pz2jqg","search_text":"Part of the documentation process is generating example code that showcases the use of some or all of the functions and types of a package.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Part of the documentation process is generating example code that showcases the use of some or all of the functions and types of a package."}]},{"block_type":"element","block":"k6pz2jqh","search_text":"Example functions have many benefits including the fact that they are executable tests which are executed by go test ! Therefore, if an example function contains an // Output: line, the go test tool will check whether the calculated output matches the values found after the // Output: line.","text_count":291,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Example functions have many benefits including the fact that they are executable tests which are executed by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"! Therefore, if an example function contains an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"// Output:"}]},{"block_type":"text","content":"line, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"tool will check whether the calculated output matches the values found after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"// Output:"}]},{"block_type":"text","content":"line."}]},{"block_type":"element","block":"k6pz2jqi","search_text":"Additionally, examples are really useful when seen in the documentation of the package, which is the subject of the next section. Finally, example functions that are presented on the Go documentation server ( https://golang.org/pkg/io/#example_Copy ) allow the reader of the documentation to experiment with the example code. The Go playground at https://play.golang.org/ also supports this functionality.","text_count":405,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, examples are really useful when seen in the documentation of the package, which is the subject of the next section. Finally, example functions that are presented on the Go documentation server ("},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/io/#example_Copy","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/io/#example_Copy"}]},{"block_type":"text","content":") allow the reader of the documentation to experiment with the example code. The Go playground at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://play.golang.org/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://play.golang.org/"}]},{"block_type":"text","content":"also supports this functionality."}]},{"block_type":"element","block":"k6pz2jqj","search_text":"As the go test subcommand is responsible for the examples of a program, you will need to import the testing standard Go package and include example functions in Go files that end with _test.go . Moreover, the name of each example function must begin with Example . Lastly, example functions take no input parameters and return no results!","text_count":338,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"subcommand is responsible for the examples of a program, you will need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":"standard Go package and include example functions in Go files that end with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_test.go"}]},{"block_type":"text","content":". Moreover, the name of each example function must begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Example"}]},{"block_type":"text","content":". Lastly,"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"example functions"}]},{"block_type":"text","content":"take no input parameters and return no results!"}]},{"block_type":"element","block":"k6pz2jqk","search_text":"Now let's create some example functions for the following package, which is saved as ex.go :","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Now let's create some example functions for the following package, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jql","search_text":"package ex func F1(n int) int { if n == 0 { return 0 } if n == 1 || n == 2 { return 1 } return F1(n-1) + F1(n-2) } func S1(s string) int { return len(s) } ","text_count":155,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package ex \nfunc F1(n int) int { \n    if n == 0 { \n        return 0 \n    } \n    if n == 1 || n == 2 { \n        return 1 \n    } \n    return F1(n-1) + F1(n-2) \n}\n \nfunc S1(s string) int { \n    return len(s) \n}"}]}]},{"block_type":"element","block":"k6pz2jqm","search_text":"The ex.go source file contains the implementation of two functions named F1() and S1() . Note that ex.go does not need to import the fmt package.","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex.go"}]},{"block_type":"text","content":"source file contains the implementation of two functions named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"F1()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"S1()"}]},{"block_type":"text","content":". Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex.go"}]},{"block_type":"text","content":"does not need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fmt"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2jqn","search_text":"As you know, the example functions will be included in the ex_test.go file, which will be presented in three parts.","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you know, the example functions will be included in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex_test.go"}]},{"block_type":"text","content":"file, which will be presented in three parts."}]},{"block_type":"element","block":"k6pz2jqo","search_text":"The first part of ex_test.go is as follows:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jqp","search_text":"package ex import ( \"fmt\" ) ","text_count":28,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package ex \nimport ( \n    \"fmt\" \n)"}]}]},{"block_type":"element","block":"k6pz2jqq","search_text":"The second code portion of ex_test.go is shown in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex_test.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jqr","search_text":"func ExampleF1() { fmt.Println(F1(10)) fmt.Println(F1(2)) // Output: // 55 // 1 } ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func ExampleF1() { \n    fmt.Println(F1(10)) \n    fmt.Println(F1(2)) \n    // Output: \n    // 55 \n    // 1 \n}"}]}]},{"block_type":"element","block":"k6pz2jqs","search_text":"The remaining Go code of ex_test.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex_test.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jqt","search_text":"func ExampleS1() { fmt.Println(S1(\"123456789\")) fmt.Println(S1(\"\")) // Output: // 8 // 0 } ","text_count":91,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func ExampleS1() { \n    fmt.Println(S1(\"123456789\")) \n    fmt.Println(S1(\"\")) \n    // Output: \n    // 8 \n    // 0 \n}"}]}]},{"block_type":"element","block":"k6pz2jqu","search_text":"Executing the go test command on the ex.go package will generate the following output:","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command on the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ex.go"}]},{"block_type":"text","content":"package will generate the following output:"}]},{"block_type":"element","block":"k6pz2jqv","search_text":"$ go test ex.go ex_test.go -v === RUN ExampleF1 --- PASS: ExampleF1 (0.00s) === RUN ExampleS1 --- FAIL: ExampleS1 (0.00s) got: 9 0 want: 8 0 FAIL FAIL command-line-arguments 0.006s","text_count":180,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test ex.go ex_test.go -v\n=== RUN ExampleF1\n--- PASS: ExampleF1 (0.00s)\n=== RUN ExampleS1\n--- FAIL: ExampleS1 (0.00s)\ngot:\n9\n0\nwant:\n8\n0\nFAIL\nFAIL  command-line-arguments  0.006s"}]}]},{"block_type":"element","block":"k6pz2jqw","search_text":"You will observe that the preceding output tells us that there is something wrong with the S1() function based on the data after the // Output: comment.","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will observe that the preceding output tells us that there is something wrong with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"S1()"}]},{"block_type":"text","content":"function based on the data after the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"// Output:"}]},{"block_type":"text","content":"comment."}]},{"block_type":"element","block":"k6pz2jqx","search_text":"Generating documentation","text_count":24,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Generating documentation"}]},{"block_type":"element","block":"k6pz2jqy","search_text":"Go offers the godoc tool, which allows you to view the documentation of your packages—provided that you have included some extra information in your files.","text_count":155,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go offers the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"tool, which allows you to view the documentation of your packages&mdash;provided that you have included some extra information in your files."}]},{"block_type":"element","block":"k6pz2jqz","search_text":"Tip My general advice is that you should try to document everything, but leave out obvious things. Put simply, do not say, Here I create a new int variable . It would be better to state the use of that int variable! Nevertheless, really good code does not usually need documentation! ","text_count":284,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"My general advice is that you should try to document everything, but leave out obvious things. Put simply, do not say,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Here I create a new"}]},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"variable"}]},{"block_type":"text","content":". It would be better to state the use of that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"int"}]},{"block_type":"text","content":"variable! Nevertheless, really good code does not usually need documentation!"}]}]},{"block_type":"element","block":"k6pz2jr0","search_text":"The rule about writing documentation in Go is pretty simple and straightforward. In order to document something, you have to put one or more regular comment lines that start with // just before its declaration. This convention can be used for documenting functions, variables, constants, or even packages!","text_count":305,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The rule about writing documentation in Go is pretty simple and straightforward. In order to document something, you have to put one or more regular comment lines that start with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"//"}]},{"block_type":"text","content":"just before its declaration. This convention can be used for documenting functions, variables, constants, or even packages!"}]},{"block_type":"element","block":"k6pz2jr1","search_text":"Additionally, you'll notice that the first line of the documentation of a package of any size will appear in the package list of godoc , as it happens in https://golang.org/pkg/ . This means that it should be pretty descriptive and complete.","text_count":241,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you'll notice that the first line of the documentation of a package of any size will appear in the package list of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":", as it happens in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/"}]},{"block_type":"text","content":". This means that it should be pretty descriptive and complete."}]},{"block_type":"element","block":"k6pz2jr2","search_text":"Keep in mind that comments which begin with BUG(something) will appear in the Bugs section of the documentation of a package, even if they do not precede a declaration. If you are looking for such an example, you can visit the source code and the documentation page of the bytes package, which can be found at https://golang.org/src/bytes/bytes.go and https://golang.org/pkg/bytes/ , respectively.","text_count":397,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Keep in mind that comments which begin with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"BUG(something)"}]},{"block_type":"text","content":"will appear in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Bugs"}]},{"block_type":"text","content":"section of the documentation of a package, even if they do not precede a declaration. If you are looking for such an example, you can visit the source code and the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bytes"}]},{"block_type":"text","content":"package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/bytes/bytes.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/bytes/bytes.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/bytes/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/bytes/"}]},{"block_type":"text","content":", respectively."}]},{"block_type":"element","block":"k6pz2jr3","search_text":"Lastly, all comments that are not related to a top-level declaration are omitted from the output that is generated by the godoc utility.","text_count":136,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Lastly, all comments that are not related to a top-level declaration are omitted from the output that is generated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2jr4","search_text":"Take a look at the following Go code, which is saved as documentMe.go :","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Take a look at the following Go code, which is saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jr5","search_text":"// This package is for showcasing the documentation capabilities of Go // It is a naive package! package documentMe // Pie is a global variable // This is a silly comment! const Pie = 3.1415912 // The S1() function finds the length of a string // It iterates over the string using range func S1(s string) int { if s == \"\" { return 0 } n := 0 for range s { n++ } return n } // The F1() function returns the double value of its input integer // A better function name would have been Double()! func F1(n int) int { return 2 * n } ","text_count":528,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"// This package is for showcasing the documentation capabilities of Go \n// It is a naive package! \npackage documentMe\n \n// Pie is a global variable \n// This is a silly comment! \nconst Pie = 3.1415912\n \n// The S1() function finds the length of a string \n// It iterates over the string using range \nfunc S1(s string) int { \n    if s == \"\" { \n         return 0 \n    } \n    n := 0 \n    for range s { \n         n++ \n    } \n    return n \n}\n \n// The F1() function returns the double value of its input integer \n// A better function name would have been Double()! \nfunc F1(n int) int { \n    return 2 * n \n}"}]}]},{"block_type":"element","block":"k6pz2jr6","search_text":"As discussed in the previous section, we will need to create a documentMe_test.go file in order to develop example functions for it. The contents of documentMe_test.go will follow next:","text_count":185,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As discussed in the previous section, we will need to create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe_test.go"}]},{"block_type":"text","content":"file in order to develop example functions for it. The contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe_test.go"}]},{"block_type":"text","content":"will follow next:"}]},{"block_type":"element","block":"k6pz2jr7","search_text":"package documentMe import ( \"fmt\" ) func ExampleS1() { fmt.Println(S1(\"123456789\")) fmt.Println(S1(\"\")) // Output: // 9 // 0 } func ExampleF1() { fmt.Println(F1(10)) fmt.Println(F1(2)) // Output: // 1 // 55 } ","text_count":209,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package documentMe \nimport ( \n    \"fmt\" \n) \nfunc ExampleS1() { \n    fmt.Println(S1(\"123456789\")) \n    fmt.Println(S1(\"\")) \n    // Output: \n    // 9 \n    // 0 \n}\n \nfunc ExampleF1() { \n    fmt.Println(F1(10)) \n    fmt.Println(F1(2)) \n    // Output: \n    // 1 \n    // 55 \n}"}]}]},{"block_type":"element","block":"k6pz2jr8","search_text":"In order to be able to see the documentation of documentMe.go , you will need to install the package on your local machine as you learned back in Chapter 6, What You Might Not Know About Go Packages . This will require the execution of the following commands from your favorite Unix shell:","text_count":289,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In order to be able to see the documentation of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":", you will need to install the package on your local machine as you learned back in Chapter 6,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"What You Might Not Know About Go Packages"}]},{"block_type":"text","content":". This will require the execution of the following commands from your favorite Unix shell:"}]},{"block_type":"element","block":"k6pz2jr9","search_text":"$ mkdir ~/go/src/documentMe $ cp documentMe* ~/go/src/documentMe/ $ ls -l ~/go/src/documentMe/ total 16 -rw-r--r--@ 1 mtsouk staff 542 Mar 6 21:11 documentMe.go -rw-r--r--@ 1 mtsouk staff 223 Mar 6 21:11 documentMe_test.go $ go install documentMe $ cd ~/go/pkg/darwin_amd64 $ ls -l documentMe.a -rw-r--r-- 1 mtsouk staff 1626 Mar 6 21:11 documentMe.a ","text_count":351,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir ~/go/src/documentMe\n$ cp documentMe* ~/go/src/documentMe/\n$ ls -l ~/go/src/documentMe/\ntotal 16\n-rw-r--r--@ 1 mtsouk staff 542 Mar 6 21:11 documentMe.go\n-rw-r--r--@ 1 mtsouk staff 223 Mar 6 21:11 documentMe_test.go\n$ go install documentMe\n$ cd ~/go/pkg/darwin_amd64\n$ ls -l documentMe.a\n-rw-r--r-- 1 mtsouk staff 1626 Mar 6 21:11 documentMe.a"}]}]},{"block_type":"element","block":"k6pz2jra","search_text":"Next, you should execute the godoc utility as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Next, you should execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility as follows:"}]},{"block_type":"element","block":"k6pz2jrb","search_text":"$ godoc -http=\":8080\"","text_count":21,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc -http=\":8080\""}]}]},{"block_type":"element","block":"k6pz2jrc","search_text":"Note that you can use you any port number you want, provided that the port is not already in use by another process. If that is the case, you will see an error message similar to the following:","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that you can use you any port number you want, provided that the port is not already in use by another process. If that is the case, you will see an error message similar to the following:"}]},{"block_type":"element","block":"k6pz2jrd","search_text":"$ godoc -http=\":22\" 2018/03/06 21:03:05 ListenAndServe :22: listen tcp :22: bind: permission denied","text_count":99,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ godoc -http=\":22\"\n2018/03/06 21:03:05 ListenAndServe :22: listen tcp :22: bind: permission denied"}]}]},{"block_type":"element","block":"k6pz2jre","search_text":"After taking care of that, you will be able to browse the HTML documentation created using your favorite web browser. The URL that will take you to the documentation is http://localhost:8080/pkg/ .","text_count":197,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After taking care of that, you will be able to browse the HTML documentation created using your favorite web browser. The URL that will take you to the documentation is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/pkg/"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jrf","search_text":"The following screenshot shows the root directory of the godoc server that we just started. There you can see the documentMe package that you created in documentMe.go among the other Go packages:","text_count":195,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows the root directory of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"server that we just started. There you can see the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe"}]},{"block_type":"text","content":"package that you created in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":"among the other Go packages:"}]},{"block_type":"element","block":"k6pz2jrg","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000023.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jrh","search_text":"The root directory of the godoc server","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The root directory of the godoc server"}]},{"block_type":"element","block":"k6pz2jri","search_text":"The following screenshot shows the root directory of the documentation of the documentMe package implemented in the documentMe.go source file:","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows the root directory of the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe"}]},{"block_type":"text","content":"package implemented in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":"source file:"}]},{"block_type":"element","block":"k6pz2jrj","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000029.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jrk","search_text":"The root page of the documentMe.go file","text_count":39,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The root page of the documentMe.go file"}]},{"block_type":"element","block":"k6pz2jrl","search_text":"Similarly, the following screenshot shows the documentation of the S1() function of the documentMe.go package in greater detail, which also includes the example code. The example code is not dynamic in this case, but you can see the code and its output:","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Similarly, the following screenshot shows the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"S1()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":"package in greater detail, which also includes the example code. The example code is not dynamic in this case, but you can see the code and its output:"}]},{"block_type":"element","block":"k6pz2jrm","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000027.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jrn","search_text":"The documentation page and the example of the S1() function","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The documentation page and the example of the S1() function"}]},{"block_type":"element","block":"k6pz2jro","search_text":"Executing the go test command will generate the following output, which might reveal potential problems and bugs in our code:","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command will generate the following output, which might reveal potential problems and bugs in our code:"}]},{"block_type":"element","block":"k6pz2jrp","search_text":"$ go test -v documentMe* === RUN ExampleS1 --- PASS: ExampleS1 (0.00s) === RUN ExampleF1 --- FAIL: ExampleF1 (0.00s) got: 20 4 want: 1 55 FAIL FAIL command-line-arguments 0.005s ","text_count":178,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test -v documentMe*\n=== RUN ExampleS1\n--- PASS: ExampleS1 (0.00s)\n=== RUN ExampleF1\n--- FAIL: ExampleF1 (0.00s)\ngot:\n20\n4\nwant:\n1\n55\nFAIL\nFAIL  command-line-arguments  0.005s"}]}]},{"block_type":"element","block":"k6pz2jrq","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2jrr","search_text":"Visit the following web links:","text_count":30,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the following web links:"}]},{"block_type":"element","block":"k6pz2jrs","search_text":"Visit the website of Graphviz at http://graphviz.org Visit the documentation page of the testing package, which can be found at https://golang.org/pkg/testing/ You can learn more about the godoc utility by visiting its documentation page at https://godoc.org/golang.org/x/tools/cmd/godoc Visit the documentation page of the runtime/pprof standard Go package that can be found at https://golang.org/pkg/runtime/pprof/ You can view the Go code of the net/http/pprof package by visiting https://golang.org/src/net/http/pprof/pprof.go You can find the documentation page of the net/http/pprof package at https://golang.org/pkg/net/http/pprof/ For the complete list of changes between Go version 1.10 and Go version 1.9, you should visit https://golang.org/doc/go1.10 You can learn more about the pprof tool by visiting its development page at https://github.com/google/pprof Watch the Advanced Testing with Go video presented in GopherCon 2017 by Mitchell Hashimoto at https://www.youtube.com/watch?v=8hQG7QlcLBk You can find the source code of the testing package at https://golang.org/src/testing/testing.go You can learn more about the profile package by visiting its web page at https://github.com/pkg/profile You can learn more about the go fix tool by visiting its web page at https://golang.org/cmd/fix/ ","text_count":1307,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the website of Graphviz at"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://graphviz.org","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"http://graphviz.org"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":"package, which can be found at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/testing/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/testing/"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"godoc"}]},{"block_type":"text","content":"utility by visiting its documentation page at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://godoc.org/golang.org/x/tools/cmd/godoc","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://godoc.org/golang.org/x/tools/cmd/godoc"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"standard Go package that can be found at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/runtime/pprof/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/runtime/pprof/"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can view the Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package by visiting"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/net/http/pprof/pprof.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/net/http/pprof/pprof.go"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/http/pprof/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/http/pprof/"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the complete list of changes between Go version 1.10 and Go version 1.9, you should visit"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/doc/go1.10","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/doc/go1.10"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"pprof"}]},{"block_type":"text","content":"tool by visiting its development page at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/google/pprof","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/google/pprof"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Watch the Advanced Testing with Go video presented in GopherCon 2017 by Mitchell Hashimoto at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.youtube.com/watch?v=8hQG7QlcLBk","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://www.youtube.com/watch?v=8hQG7QlcLBk"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testing"}]},{"block_type":"text","content":"package at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/testing/testing.go","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/src/testing/testing.go"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profile"}]},{"block_type":"text","content":"package by visiting its web page at"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/pkg/profile","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://github.com/pkg/profile"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can learn more about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go fix"}]},{"block_type":"text","content":"tool by visiting its web page at"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/cmd/fix/","target":"_blank","rel":"noopener"},"children":[{"block_type":"text","content":"https://golang.org/cmd/fix/"}]}]}]}]},{"block_type":"element","block":"k6pz2jrt","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2jru","search_text":"Write testing functions for the byWord.go program that we developed in Chapter 8, Telling a Unix System What to Do . Write benchmark functions for the readSize.go program that we developed in Chapter 8, Telling a Unix System What to Do . Try to fix the problems in the Go code of documentMe.go and documentMe_test.go . Use the text interface of the go tool pprof utility to examine the memoryProfile.out file generated by profileMe.go . Next, use the web interface of the go tool pprof utility to examine the memoryProfile.out file generated by profileMe.go . ","text_count":560,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Write testing functions for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"byWord.go"}]},{"block_type":"text","content":"program that we developed in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Write benchmark functions for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"readSize.go"}]},{"block_type":"text","content":"program that we developed in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Try to fix the problems in the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"documentMe_test.go"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Use the text interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"utility to examine the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"memoryProfile.out"}]},{"block_type":"text","content":"file generated by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Next, use the web interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"utility to examine the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"memoryProfile.out"}]},{"block_type":"text","content":"file generated by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"profileMe.go"}]},{"block_type":"text","content":"."}]}]}]},{"block_type":"element","block":"k6pz2jrv","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2jrw","search_text":"In this chapter, we talked about code testing, code optimization, and code profiling. Toward the end of the chapter, you learned how to find unreachable code and how to cross-compile Go code. The go test command is used for testing and benchmarking Go code, as well as for offering extra documentation with the use of example functions.","text_count":336,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter, we talked about code testing, code optimization, and code profiling. Toward the end of the chapter, you learned how to find unreachable code and how to cross-compile Go code. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go test"}]},{"block_type":"text","content":"command is used for testing and benchmarking Go code, as well as for offering extra documentation with the use of example functions."}]},{"block_type":"element","block":"k6pz2jrx","search_text":"Although the discussion of the Go profiler and go tool trace is far from complete, you should understand that with topics such as profiling and code tracing, nothing can replace experimenting and trying new techniques on your own!","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the discussion of the Go profiler and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool trace"}]},{"block_type":"text","content":"is far from complete, you should understand that with topics such as profiling and code tracing, nothing can replace experimenting and trying new techniques on your own!"}]},{"block_type":"element","block":"k6pz2jry","search_text":"In the next chapter, we will start talking about network programming in Go, which involves programming applications that work over TCP/IP computer networks, which also includes the internet. Some of the subjects in the next chapter are the net/http package, creating web clients and web servers in Go, the http.Response and http.Request structures, profiling HTTP servers, and timing out network connections.","text_count":408,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the next chapter, we will start talking about network programming in Go, which involves programming applications that work over TCP/IP computer networks, which also includes the internet. Some of the subjects in the next chapter are the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"package, creating web clients and web servers in Go, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"structures, profiling HTTP servers, and timing out network connections."}]},{"block_type":"element","block":"k6pz2jrz","search_text":"Additionally, the next chapter will discuss the IPv4 and IPv6 protocols as well as the Wireshark and tshark tools, which are used for capturing and analyzing network traffic.","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, the next chapter will discuss the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IPv4"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IPv6"}]},{"block_type":"text","content":"protocols as well as the Wireshark and tshark tools, which are used for capturing and analyzing network traffic."}]}]},{"title":"The Foundations of Network Programming in Go","author":"Mihalis Tsoukalos","block":"k6pz24rs","number":12,"contents":[{"block_type":"element","block":"k6pz2js0","search_text":"In the previous chapter, we discussed benchmarking Go code using benchmark functions, testing in Go, example functions, cross-compilation and profiling Go code, as well as generating documentation in Go.","text_count":203,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the previous chapter, we discussed benchmarking Go code using benchmark functions, testing in Go, example functions, cross-compilation&nbsp;and profiling Go code, as well as generating documentation in Go."}]},{"block_type":"element","block":"k6pz2js1","search_text":"This chapter is all about network programming, which means that you will learn how to create web applications that work over computer networks and the internet. However, you will have to wait for the next chapter to learn how to develop TCP and UDP applications.","text_count":262,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter is all about network programming, which means that you will learn how to create web applications that work over computer networks and the internet. However, you will have to wait for the next chapter to learn how to develop TCP and UDP applications."}]},{"block_type":"element","block":"k6pz2js2","search_text":"Note that in order to follow this chapter and the next one successfully, you'll need to know some basic information about HTTP, networking, and how networks work.","text_count":162,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that in order to follow this chapter and the next one successfully, you'll need to know some basic information about HTTP, networking, and how networks work."}]},{"block_type":"element","block":"k6pz2js3","search_text":"In this chapter of Mastering Go , you will learn the following topics:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2js4","search_text":"What TCP/IP is and why it is important The IPv4 and IPv6 protocols The netcat command-line utility Performing DNS lookups in Go The net/http package The http.Response , http.Request , and http.Transport structures Creating web servers in Go Programming web clients in Go Creating websites in Go The http.NewServeMux type Wireshark and tshark Timing out HTTP connections that take too long to finish either on the server or client end ","text_count":434,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"What TCP/IP is and why it is important"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The IPv4 and IPv6 protocols"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"netcat"}]},{"block_type":"text","content":"command-line utility"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Performing"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"DNS"}]},{"block_type":"text","content":"lookups in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structures"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Creating web servers in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Programming web clients in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Creating websites in Go"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":"type"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Wireshark"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tshark"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Timing out HTTP connections that take too long to finish either on the server or client end"}]}]},{"block_type":"element","block":"k6pz2js5","search_text":"Feel free to skip some of the low-level information presented in this chapter—you can always revisit it at another time.","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Feel free to skip some of the low-level information presented in this chapter&mdash;you can always revisit it at another time."}]},{"block_type":"element","block":"k6pz2js6","search_text":"About net/http, net, and http.RoundTripper","text_count":42,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About net/http, net, and http.RoundTripper"}]},{"block_type":"element","block":"k6pz2js7","search_text":"The star of this chapter will be the net/http package, which offers functions that allow you to develop powerful web servers and web clients. The http.Get() and http.Get() methods can be used for making HTTP and HTTPS requests, whereas the http.ListenAndServe() function can be used for creating web servers by specifying the IP address and the TCP port to which the server will listen, as well as the functions that will handle incoming requests.","text_count":447,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The star of this chapter will be the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"package, which offers functions that allow you to develop powerful web servers and web clients. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"methods can be used for making HTTP and HTTPS requests, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.ListenAndServe()"}]},{"block_type":"text","content":"function can be used for creating web servers by specifying the IP address and the TCP port to which the server will listen, as well as the functions that will handle incoming requests."}]},{"block_type":"element","block":"k6pz2js8","search_text":"Apart from net/http , we will use the net package in some of the programs presented in this chapter. The functionality of the net package, however, is going to be explained in greater detail in Chapter 13, Network Programming – Building Servers and Clients .","text_count":258,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Apart from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":", we will use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package in some of the programs presented in this chapter. The functionality of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package, however, is going to be explained in greater detail in Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming&nbsp;&ndash; Building Servers and Clients"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2js9","search_text":"Finally, if you know that http.RoundTripper is an interface that is used for making sure that a Go element is capable of executing an HTTP transaction, it can be handy. Put simply, this means that a Go element can get http.Response for given http.Request . You will learn about http.Response and http.Request in a while.","text_count":320,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, if you know that&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.RoundTripper"}]},{"block_type":"text","content":"is an"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"interface"}]},{"block_type":"text","content":"that is used for making sure that a Go element is capable of executing an HTTP transaction, it can be handy. Put simply, this means that a Go element can get&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"for given"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":". You will learn about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"in a while."}]},{"block_type":"element","block":"k6pz2jsa","search_text":"The http.Response type","text_count":22,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The http.Response type"}]},{"block_type":"element","block":"k6pz2jsb","search_text":"The definition of the http.Response structure, which can be found in the https://golang.org/src/net/http/response.go file, is as follows:","text_count":137,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"structure, which can be found in the"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/net/http/response.go"},"children":[{"block_type":"text","content":"https://golang.org/src/net/http/response.go"}]},{"block_type":"text","content":"file, is as follows:"}]},{"block_type":"element","block":"k6pz2jsc","search_text":"type Response struct { Status string // e.g. \"200 OK\" StatusCode int // e.g. 200 Proto string // e.g. \"HTTP/1.0\" ProtoMajor int // e.g. 1 ProtoMinor int // e.g. 0 Header Header Body io.ReadCloser ContentLength int64 TransferEncoding []string Close bool Uncompressed bool Trailer Header","text_count":285,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Response struct { \n    Status     string // e.g. \"200 OK\" \n    StatusCode int    // e.g. 200 \n    Proto      string // e.g. \"HTTP/1.0\" \n    ProtoMajor int    // e.g. 1 \n    ProtoMinor int    // e.g. 0 \n    Header Header \n    Body io.ReadCloser \n    ContentLength int64 \n    TransferEncoding []string \n    Close bool \n    Uncompressed bool \n    Trailer Header"}]}]},{"block_type":"element","block":"k6pz2jsd","search_text":"Request *Request TLS *tls.ConnectionState } ","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"Request *Request \n    TLS *tls.ConnectionState \n}"}]}]},{"block_type":"element","block":"k6pz2jse","search_text":"The goal of this pretty complex http.Response type is to represent the response of an HTTP request. The source file contains more information about the purpose of each field of the structure, which is the case with most struct types found in the standard Go library.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The goal of this pretty complex"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"type is to represent the response of an HTTP request. The source file contains more information about the purpose of each field of the structure, which is the case with most"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"struct"}]},{"block_type":"text","content":"types found in the standard Go library."}]},{"block_type":"element","block":"k6pz2jsf","search_text":"The http.Request type","text_count":21,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The http.Request type"}]},{"block_type":"element","block":"k6pz2jsg","search_text":"The purpose of the http.Request type is to represent an HTTP request as received by a server, or as it is about to be sent to a server by an HTTP client.","text_count":153,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"type is to represent an HTTP request as received by a server, or as it is about to be sent to a server by an HTTP client."}]},{"block_type":"element","block":"k6pz2jsh","search_text":"The http.Request structure type as defined in https://golang.org/src/net/http/request.go is as follows:","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"structure type as defined in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/net/http/request.go"},"children":[{"block_type":"text","content":"https://golang.org/src/net/http/request.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jsi","search_text":"type Request struct { Method string URL *url.URL Proto string // \"HTTP/1.0\" ProtoMajor int // 1 ProtoMinor int // 0 Header Header Body io.ReadCloser GetBody func() (io.ReadCloser, error) ContentLength int64 TransferEncoding []string Close bool Host string Form url.Values PostForm url.Values MultipartForm *multipart.Form Trailer Header RemoteAddr string RequestURI string TLS *tls.ConnectionState Cancel <-chan struct{} Response *Response ctx context.Context } ","text_count":462,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Request struct { \n    Method string \n    URL *url.URL \n    Proto      string // \"HTTP/1.0\" \n    ProtoMajor int    // 1 \n    ProtoMinor int    // 0 \n    Header Header \n    Body io.ReadCloser \n    GetBody func() (io.ReadCloser, error) \n    ContentLength int64 \n    TransferEncoding []string \n    Close bool \n    Host string \n    Form url.Values \n    PostForm url.Values \n    MultipartForm *multipart.Form \n    Trailer Header \n    RemoteAddr string \n    RequestURI string \n    TLS *tls.ConnectionState \n    Cancel &lt;-chan struct{} \n    Response *Response \n    ctx context.Context \n}"}]}]},{"block_type":"element","block":"k6pz2jsj","search_text":"The http.Transport type","text_count":23,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The http.Transport type"}]},{"block_type":"element","block":"k6pz2jsk","search_text":"The definition of the http.Transport structure, which can be found in https://golang.org/src/net/http/transport.go , is as follows:","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The definition of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structure, which can be found in"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/net/http/transport.go"},"children":[{"block_type":"text","content":"https://golang.org/src/net/http/transport.go"}]},{"block_type":"text","content":", is as follows:"}]},{"block_type":"element","block":"k6pz2jsl","search_text":"type Transport struct { idleMu sync.Mutex wantIdle bool idleConn map[connectMethodKey][]*persistConn idleConnCh map[connectMethodKey]chan *persistConn idleLRU connLRU reqMu sync.Mutex reqCanceler map[*Request]func(error) altMu sync.Mutex altProto atomic.Value Proxy func(*Request) (*url.URL, error) DialContext func(ctx context.Context, network, addr string) (net.Conn, error) Dial func(network, addr string) (net.Conn, error) DialTLS func(network, addr string) (net.Conn, error) TLSClientConfig *tls.Config TLSHandshakeTimeout time.Duration DisableKeepAlives bool DisableCompression bool MaxIdleConns int MaxIdleConnsPerHost int IdleConnTimeout time.Duration ResponseHeaderTimeout time.Duration ExpectContinueTimeout time.Duration TLSNextProto map[string]func(authority string, c *tls.Conn) RoundTripper ProxyConnectHeader Header MaxResponseHeaderBytes int64 nextProtoOnce sync.Once h2transport *http2Transport } ","text_count":914,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Transport struct { \n    idleMu     sync.Mutex \n    wantIdle   bool  \n    idleConn   map[connectMethodKey][]*persistConn  \n    idleConnCh map[connectMethodKey]chan *persistConn \n    idleLRU    connLRU \n    reqMu      sync.Mutex \n    reqCanceler map[*Request]func(error) \n    altMu    sync.Mutex \n    altProto atomic.Value \n    Proxy func(*Request) (*url.URL, error) \n    DialContext func(ctx context.Context, network, addr string) (net.Conn, error) \n    Dial func(network, addr string) (net.Conn, error) \n    DialTLS func(network, addr string) (net.Conn, error) \n    TLSClientConfig *tls.Config \n    TLSHandshakeTimeout time.Duration \n    DisableKeepAlives bool \n    DisableCompression bool \n    MaxIdleConns int \n    MaxIdleConnsPerHost int \n    IdleConnTimeout time.Duration \n    ResponseHeaderTimeout time.Duration \n    ExpectContinueTimeout time.Duration \n    TLSNextProto map[string]func(authority string, c *tls.Conn) RoundTripper \n    ProxyConnectHeader Header \n    MaxResponseHeaderBytes int64 \n    nextProtoOnce sync.Once \n    h2transport   *http2Transport \n}"}]}]},{"block_type":"element","block":"k6pz2jsm","search_text":"As you can see, the http.Transport structure is pretty complex and contains a very large number of fields. The good news is that you will not need to use the http.Transport structure in all of your programs and that you are not required to deal with all of its fields each time that you use it.","text_count":294,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structure is pretty complex and contains a very large number of fields. The good news is that you will not need to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structure in all of your programs and that you are not required to deal with all of its fields each time that you use it."}]},{"block_type":"element","block":"k6pz2jsn","search_text":"The http.Transport structure implements the http.RoundTripper interface and supports HTTP, HTTPS, and HTTP proxies. Note that http.Transport is pretty low level, whereas the http.Client structure that is also used in this chapter implements a high-level HTTP client.","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structure implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.RoundTripper"}]},{"block_type":"text","content":"interface and supports HTTP, HTTPS, and HTTP proxies. Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"is pretty low level, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"structure that is also used in this chapter implements a high-level HTTP client."}]},{"block_type":"element","block":"k6pz2jso","search_text":"About TCP/IP","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"About TCP/IP"}]},{"block_type":"element","block":"k6pz2jsp","search_text":"TCP/IP is a family of protocols that help the internet operate. Its name came from its two most well-known protocols— TCP and IP .","text_count":130,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"TCP/IP"}]},{"block_type":"text","content":"is a family of protocols that help the internet operate. Its name came from its two most well-known protocols&mdash;"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"TCP"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IP"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jsq","search_text":"TCP stands for Transmission Control Protocol . TCP software transmits data between machines using segments, which are also called TCP packets . The main characteristic of TCP is that it is a reliable protocol, which means that it makes sure that a packet was delivered without needing any extra code from the programmer. If there is no proof of a packet delivery, TCP resends that particular packet. Among other things, a TCP packet can be used for establishing connections, transferring data, sending acknowledgements, and closing connections.","text_count":544,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"TCP"}]},{"block_type":"text","content":"stands for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Transmission Control Protocol"}]},{"block_type":"text","content":". TCP software transmits data between machines using segments, which are also called TCP"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"packets"}]},{"block_type":"text","content":". The main characteristic of TCP is that it is a reliable protocol, which means that it makes sure that a packet was delivered without needing any extra code from the programmer. If there is no proof of a packet delivery, TCP resends that particular packet. Among other things, a TCP packet can be used for establishing connections, transferring data, sending acknowledgements, and closing connections."}]},{"block_type":"element","block":"k6pz2jsr","search_text":"When a TCP connection is established between two machines, a full duplex virtual circuit, similar to the telephone call, is created between those two machines. The two machines constantly communicate to make sure that data are sent and received correctly. If the connection fails for some reason, the two machines try to find the problem and report to the relevant application.","text_count":377,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When a TCP connection is established between two machines, a full duplex virtual circuit, similar to the telephone call, is created between those two machines. The two machines constantly communicate to make sure that data are sent and received correctly. If the connection fails for some reason, the two machines try to find the problem and report to the relevant application."}]},{"block_type":"element","block":"k6pz2jss","search_text":"IP stands for Internet Protocol . The main characteristic of IP is that it is not a reliable protocol by nature. IP encapsulates the data that travels over a TCP/IP network because it is responsible for delivering packets from the source host to the destination host according to the IP addresses. IP has to find an addressing method to send the packet to its destination effectively. Although there are dedicated devices called routers that perform IP routing, every TCP/IP device has to perform some basic routing.","text_count":516,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IP"}]},{"block_type":"text","content":"stands for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Internet Protocol"}]},{"block_type":"text","content":". The main characteristic of IP is that it is not a reliable protocol by nature. IP encapsulates the data that travels over a TCP/IP network because it is responsible for delivering packets from the source host to the destination host according to the IP addresses. IP has to find an addressing method to send the packet to its destination effectively. Although there are dedicated devices called routers that perform IP routing, every TCP/IP device has to perform some basic routing."}]},{"block_type":"element","block":"k6pz2jst","search_text":"The UDP ( User Datagram Protocol ) protocol is based on IP, which means that it is also unreliable. Generally speaking, the UDP protocol is simpler than the TCP protocol mainly because UDP is not reliable by design. As a result, UDP messages can be lost, duplicated, or arrive out of order. Furthermore, packets can arrive faster than the recipient can process them. So, UDP is used when speed is more important than reliability.","text_count":429,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"UDP"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"User Datagram Protocol"}]},{"block_type":"text","content":") protocol is based on IP, which means that it is also unreliable. Generally speaking, the UDP protocol is simpler than the TCP protocol mainly because UDP is not reliable by design. As a result, UDP messages can be lost, duplicated, or arrive out of order. Furthermore, packets can arrive faster than the recipient can process them. So, UDP is used when speed is more important than reliability."}]},{"block_type":"element","block":"k6pz2jsu","search_text":"About IPv4 and IPv6","text_count":19,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"About IPv4 and IPv6"}]},{"block_type":"element","block":"k6pz2jsv","search_text":"The first version of the IP protocol is now called IPv4 in order to differentiate it from the latest version of the IP protocol, which is called IPv6 .","text_count":151,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first version of the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IP protocol"}]},{"block_type":"text","content":"is now called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IPv4"}]},{"block_type":"text","content":"in order to differentiate it from the latest version of the IP protocol, which is called"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"IPv6"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jsw","search_text":"The main problem with IPv4 is that it is at the verge of running out of IP addresses, which is the main reason for creating the IPv6 protocol. This happens because an IPv4 address is represented using 32 bits only, which allows a total number of 2 32 (4,294,967,296) different IP addresses. On the other hand, IPv6 uses 128 bits for defining each one of its addresses.","text_count":368,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main problem with IPv4 is that it is at the verge of running out of IP addresses, which is the main reason for creating the IPv6 protocol. This happens because an IPv4 address is represented using 32 bits only, which allows a total number of 2"},{"block_type":"element","tag_name":"sup","attributes":{},"children":[{"block_type":"text","content":"32"}]},{"block_type":"text","content":"(4,294,967,296) different IP addresses. On the other hand, IPv6 uses 128 bits for defining each one of its addresses."}]},{"block_type":"element","block":"k6pz2jsx","search_text":"The format of an IPv4 address is 10.20.32.245 (four parts separated by dots), while the format of an IPv6 address is 3fce:1706:4523:3:150:f8ff:fe21:56cf (eight parts separated by colons).","text_count":187,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The format of an IPv4 address is 10.20.32.245 (four parts separated by dots), while the format of an IPv6 address is 3fce:1706:4523:3:150:f8ff:fe21:56cf (eight parts separated by colons)."}]},{"block_type":"element","block":"k6pz2jsy","search_text":"The nc(1) command-line utility","text_count":30,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The nc(1) command-line utility"}]},{"block_type":"element","block":"k6pz2jsz","search_text":"The nc(1) utility, which is also called netcat(1) , comes in very handy when you want to test TCP/IP servers and clients. This section will present some of its more common uses.","text_count":177,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"utility, which is also called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":", comes in very handy when you want to test TCP/IP servers and clients. This section will present some of its more common uses."}]},{"block_type":"element","block":"k6pz2jt0","search_text":"You can use nc(1) as a client for a TCP service that runs on a machine with the 10.10.1.123 IP address and listens to the port number 1234 , as follows:","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"as a client for a TCP service that runs on a machine with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"10.10.1.123"}]},{"block_type":"text","content":"IP address and listens to the port number"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1234"}]},{"block_type":"text","content":", as follows:"}]},{"block_type":"element","block":"k6pz2jt1","search_text":"$ nc 10.10.1.123 1234","text_count":21,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc 10.10.1.123 1234"}]}]},{"block_type":"element","block":"k6pz2jt2","search_text":"By default, nc(1) uses the TCP protocol. However, if you execute nc(1) with the -u flag, then nc(1) will use the UDP protocol.","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"By default,&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"uses the TCP protocol. However, if you execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-u"}]},{"block_type":"text","content":"flag, then"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"will use the UDP protocol."}]},{"block_type":"element","block":"k6pz2jt3","search_text":"The -l option tells netcat(1) to act as a server, which means that netcat(1) will start listening for connections at the given port number.","text_count":139,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-l"}]},{"block_type":"text","content":"option tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"to act as a server, which means that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"will start listening for connections at the given port number."}]},{"block_type":"element","block":"k6pz2jt4","search_text":"Finally, the -v and -vv options tell netcat(1) to generate verbose output, which can come in handy when you want to troubleshoot network connections.","text_count":149,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-v"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-vv"}]},{"block_type":"text","content":"options tell"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"to generate verbose output, which can come in handy when you want to troubleshoot network connections."}]},{"block_type":"element","block":"k6pz2jt5","search_text":"Although netcat(1) can help you test HTTP applications, it will become niftier in Chapter 13, Network Programming – Building Servers and Clients, when we will develop TCP and UDP clients and servers. As a result, the netcat(1) utility will be used only once in this chapter.","text_count":274,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"can help you test HTTP applications, it will become niftier in Chapter 13,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Network Programming&nbsp;&ndash; Building Servers and Clients,"}]},{"block_type":"text","content":"&nbsp;when we will develop TCP and UDP clients and servers. As a result, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"utility will be used only once in this chapter."}]},{"block_type":"element","block":"k6pz2jt6","search_text":"Reading the configuration of network interfaces","text_count":47,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Reading the configuration of network interfaces"}]},{"block_type":"element","block":"k6pz2jt7","search_text":"There are four core elements in a network configuration: the IP address of the interface, the network mask of the interface, the DNS servers of the machine, and the default gateway or default router of the machine. However, there is a problem here: you cannot find every piece of information using native and portable Go code. This means that there is no portable way to discover the DNS configuration and the default gateway information of a Unix machine.","text_count":456,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"There are four core elements in a network configuration: the IP address of the interface, the network mask of the interface, the DNS servers of the machine, and the default gateway or default router of the machine. However, there is a problem here: you cannot find every piece of information using native and portable Go code. This means that there is no portable way to discover the DNS configuration and the default gateway information of a Unix machine."}]},{"block_type":"element","block":"k6pz2jt8","search_text":"As a result, in this section, you will learn how to read the configuration of the network interfaces of a Unix machine with Go. For this purpose, I will present two portable utilities that allow you to find out information about your network interfaces.","text_count":253,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As a result, in this section, you will learn how to read the configuration of the network interfaces of a Unix machine with Go. For this purpose, I will present two portable utilities that allow you to find out information about your network interfaces."}]},{"block_type":"element","block":"k6pz2jt9","search_text":"The source code of the first utility, netConfig.go , is presented in three parts.","text_count":81,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The source code of the first utility,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":", is presented in three parts."}]},{"block_type":"element","block":"k6pz2jta","search_text":"The first part of netConfig.go is shown in the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jtb","search_text":"package main import ( \"fmt\" \"net\" ) func main() { interfaces, err := net.Interfaces() if err != nil { fmt.Println(err) return } ","text_count":128,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n) \n \nfunc main() { \n    interfaces, err := net.Interfaces() \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2jtc","search_text":"The net.Interfaces() function returns all of the interfaces of the current machine as a slice with elements of the net.Interface type. This slice will be used shortly to acquire the desired information.","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Interfaces()"}]},{"block_type":"text","content":"function returns all of the interfaces of the current machine as a slice with elements of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Interface"}]},{"block_type":"text","content":"type. This slice will be used shortly to acquire the desired information."}]},{"block_type":"element","block":"k6pz2jtd","search_text":"The second code portion of netConfig.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jte","search_text":"for _, i := range interfaces { fmt.Printf(\"Interface: %v\\n\", i.Name) byName, err := net.InterfaceByName(i.Name) if err != nil { fmt.Println(err) } ","text_count":147,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, i := range interfaces { \n    fmt.Printf(\"Interface: %v\\n\", i.Name) \n        byName, err := net.InterfaceByName(i.Name) \n        if err != nil { \n            fmt.Println(err) \n        }"}]}]},{"block_type":"element","block":"k6pz2jtf","search_text":"In the preceding code, you visit each element of the slice with the net.Interface elements to retrieve the desired information.","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you visit each element of the slice with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Interface"}]},{"block_type":"text","content":"elements to retrieve the desired information."}]},{"block_type":"element","block":"k6pz2jtg","search_text":"The remaining Go code of netConfig.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jth","search_text":"addresses, err := byName.Addrs() for k, v := range addresses { fmt.Printf(\"Interface Address #%v: %v\\n\", k, v.String()) } fmt.Println() } } ","text_count":140,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"addresses, err := byName.Addrs() \n        for k, v := range addresses { \n            fmt.Printf(\"Interface Address #%v: %v\\n\", k, v.String()) \n        } \n        fmt.Println() \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jti","search_text":"Executing netConfig.go on a macOS High Sierra machine with Go version 1.10 generates the following output:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine with Go version 1.10 generates the following output:"}]},{"block_type":"element","block":"k6pz2jtj","search_text":"$ go run netConfig.go Interface: lo0 Interface Address #0: 127.0.0.1/8 Interface Address #1: ::1/128 Interface Address #2: fe80::1/64 Interface: gif0 Interface: stf0 Interface: XHC20 Interface: en0 Interface Address #0: fe80::18fa:901a:ea9:eb5f/64 Interface Address #1: 192.168.1.200/24 Interface Address #2: 2a02:587:3006:b800:1cb8:bf1b:b154:4d0c/64 Interface Address #3: 2a02:587:3006:b800:d84a:f0c:c932:35d1/64 Interface: en1 Interface: p2p0 Interface: awdl0 Interface: en2 Interface: en3 Interface: bridge0 Interface: utun0 Interface Address #0: fe80::2514:c3a3:ca83:e1c6/64 Interface: utun1 Interface Address #0: fe80::4e0b:a9a6:9abe:81a4/64 Interface: en5 Interface Address #0: fe80::1cb4:a29e:97bc:6fb5/64 Interface Address #1: 169.254.72.59/16 ","text_count":752,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run netConfig.go\nInterface: lo0\nInterface Address #0: 127.0.0.1/8\nInterface Address #1: ::1/128\nInterface Address #2: fe80::1/64\n    \nInterface: gif0\n    \nInterface: stf0\n    \nInterface: XHC20\n    \nInterface: en0\nInterface Address #0: fe80::18fa:901a:ea9:eb5f/64\nInterface Address #1: 192.168.1.200/24\nInterface Address #2: 2a02:587:3006:b800:1cb8:bf1b:b154:4d0c/64\nInterface Address #3: 2a02:587:3006:b800:d84a:f0c:c932:35d1/64\n    \nInterface: en1\n    \nInterface: p2p0\n    \nInterface: awdl0\n    \nInterface: en2\n    \nInterface: en3\n    \nInterface: bridge0\n    \nInterface: utun0\nInterface Address #0: fe80::2514:c3a3:ca83:e1c6/64\n    \nInterface: utun1\nInterface Address #0: fe80::4e0b:a9a6:9abe:81a4/64\n    \nInterface: en5\nInterface Address #0: fe80::1cb4:a29e:97bc:6fb5/64\nInterface Address #1: 169.254.72.59/16"}]}]},{"block_type":"element","block":"k6pz2jtk","search_text":"As you can see, the netConfig.go utility returns rather large output because today's computers tend to have lots of network interfaces and because the program supports both the IPv4 and IPv6 protocols.","text_count":201,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"utility returns rather large output because today's computers tend to have lots of network interfaces and because the program supports both the IPv4 and IPv6 protocols."}]},{"block_type":"element","block":"k6pz2jtl","search_text":"Executing netConfig.go on a Debian Linux machine with Go version 1.7.4 will generate the following output:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netConfig.go"}]},{"block_type":"text","content":"on a Debian Linux machine with Go version 1.7.4 will generate the following output:"}]},{"block_type":"element","block":"k6pz2jtm","search_text":"$ go run netConfig.go Interface: lo Interface Address #0: 127.0.0.1/8 Interface Address #1: ::1/128 Interface: dummy0 Interface: eth0 Interface Address #0: 10.74.193.253/24 Interface Address #1: 2a01:7e00::f03c:91ff:fe69:1381/64 Interface Address #2: fe80::f03c:91ff:fe69:1381/64 Interface: teql0 Interface: tunl0 Interface: gre0 Interface: gretap0 Interface: erspan0 Interface: ip_vti0 Interface: ip6_vti0 Interface: sit0 Interface: ip6tnl0 Interface: ip6gre0 ","text_count":461,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run netConfig.go\nInterface: lo\nInterface Address #0: 127.0.0.1/8\nInterface Address #1: ::1/128\n    \nInterface: dummy0\n    \nInterface: eth0\nInterface Address #0: 10.74.193.253/24\nInterface Address #1: 2a01:7e00::f03c:91ff:fe69:1381/64\nInterface Address #2: fe80::f03c:91ff:fe69:1381/64\n    \nInterface: teql0\n    \nInterface: tunl0\n    \nInterface: gre0\n    \nInterface: gretap0\n    \nInterface: erspan0\n    \nInterface: ip_vti0\n    \nInterface: ip6_vti0\n    \nInterface: sit0\n    \nInterface: ip6tnl0\n    \nInterface: ip6gre0"}]}]},{"block_type":"element","block":"k6pz2jtn","search_text":"Note that the main reason why a network interface may not have a network address is that it is down, which essentially means that it is not currently configured.","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the main reason why a network interface may not have a network address is that it is down, which essentially means that it is not currently configured."}]},{"block_type":"element","block":"k6pz2jto","search_text":"Note Not all of the listed interfaces have a real hardware network device attached to them. The more representative example is the lo0 interface, which is the loopback device. The loopback device is a special, virtual network interface that is used by your computer in order to communicate with itself. ","text_count":303,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Not all of the listed interfaces have a real hardware network device attached to them. The more representative example is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lo0"}]},{"block_type":"text","content":"interface, which is the loopback device. The"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"loopback device"}]},{"block_type":"text","content":"is a special, virtual network interface that is used by your computer in order to communicate with itself."}]}]},{"block_type":"element","block":"k6pz2jtp","search_text":"The Go code for the next utility, netCapabilities.go , is also presented in three parts. The purpose of the netCapabilities.go utility is to reveal the capabilities of each network interface found on your Unix system.","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The Go code for the next utility,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":", is also presented in three parts. The purpose of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"utility is to reveal the capabilities of each network interface found on your Unix system."}]},{"block_type":"element","block":"k6pz2jtq","search_text":"The netCapabilities.go utility uses the fields of the net.Interface structure, which is defined as follows:","text_count":107,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"utility uses the fields of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Interface"}]},{"block_type":"text","content":"structure, which is defined as follows:"}]},{"block_type":"element","block":"k6pz2jtr","search_text":"type Interface struct { Index int MTU int Name string HardwareAddr HardwareAddr Flags Flags } ","text_count":94,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type Interface struct { \n    Index        int \n    MTU          int \n    Name         string \n    HardwareAddr HardwareAddr \n    Flags        Flags \n}"}]}]},{"block_type":"element","block":"k6pz2jts","search_text":"The first part from the Go code of netCapabilities.go follows next:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part from the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jtt","search_text":"package main import ( \"fmt\" \"net\" ) ","text_count":36,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n)"}]}]},{"block_type":"element","block":"k6pz2jtu","search_text":"The second code portion of netCapabilities.go contains the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jtv","search_text":"func main() { interfaces, err := net.Interfaces() if err != nil { fmt.Print(err) return } ","text_count":90,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    interfaces, err := net.Interfaces() \n \n    if err != nil { \n         fmt.Print(err) \n         return \n    }"}]}]},{"block_type":"element","block":"k6pz2jtw","search_text":"The last part of netCapabilities.go comes in the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"comes in the following Go code:"}]},{"block_type":"element","block":"k6pz2jtx","search_text":"for _, i := range interfaces { fmt.Printf(\"Name: %v\\n\", i.Name) fmt.Println(\"Interface Flags:\", i.Flags.String()) fmt.Println(\"Interface MTU:\", i.MTU) fmt.Println(\"Interface Hardware Address:\", i.HardwareAddr) fmt.Println() } }","text_count":227,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for _, i := range interfaces { \n        fmt.Printf(\"Name: %v\\n\", i.Name) \n        fmt.Println(\"Interface Flags:\", i.Flags.String()) \n        fmt.Println(\"Interface MTU:\", i.MTU) \n        fmt.Println(\"Interface Hardware Address:\", i.HardwareAddr) \n        fmt.Println() \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jty","search_text":"Running netCapabilities.go on a macOS High Sierra machine will generate the following output:","text_count":93,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine will generate the following output:"}]},{"block_type":"element","block":"k6pz2jtz","search_text":"$ go run netCapabilities.go Name: lo0 Interface Flags: up|loopback|multicast Interface MTU: 16384 Interface Hardware Address: Name: gif0 Interface Flags: pointtopoint|multicast Interface MTU: 1280 Interface Hardware Address: Name: stf0 Interface Flags: 0 Interface MTU: 1280 Interface Hardware Address: Name: XHC20 Interface Flags: 0 Interface MTU: 0 Interface Hardware Address: Name: en0 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: 98:5a:eb:d7:84:cd Name: en1 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: d0:03:4b:cf:84:d3 Name: p2p0 Interface Flags: broadcast|multicast Interface MTU: 2304 Interface Hardware Address: 02:03:4b:cf:84:d3 Name: awdl0 Interface Flags: broadcast|multicast Interface MTU: 1484 Interface Hardware Address: 02:ac:d4:3b:d9:29 Name: en2 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: 0a:00:00:a5:32:b0 Name: en3 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: 0a:00:00:a5:32:b1 Name: bridge0 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: 0a:00:00:a5:32:b0 Name: utun0 Interface Flags: up|pointtopoint|multicast Interface MTU: 2000 Interface Hardware Address: Name: utun1 Interface Flags: up|pointtopoint|multicast Interface MTU: 1380 Interface Hardware Address: Name: en5 Interface Flags: up|broadcast|multicast Interface MTU: 1500 Interface Hardware Address: 6e:72:e7:1b:cd:5f ","text_count":1514,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run netCapabilities.go\nName: lo0\nInterface Flags: up|loopback|multicast\nInterface MTU: 16384\nInterface Hardware Address:\n    \nName: gif0\nInterface Flags: pointtopoint|multicast\nInterface MTU: 1280\nInterface Hardware Address:\n    \nName: stf0\nInterface Flags: 0\nInterface MTU: 1280\nInterface Hardware Address:\n    \nName: XHC20\nInterface Flags: 0\nInterface MTU: 0\nInterface Hardware Address:\n    \nName: en0\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: 98:5a:eb:d7:84:cd\n    \nName: en1\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: d0:03:4b:cf:84:d3\n    \nName: p2p0\nInterface Flags: broadcast|multicast\nInterface MTU: 2304\nInterface Hardware Address: 02:03:4b:cf:84:d3\n    \nName: awdl0\nInterface Flags: broadcast|multicast\nInterface MTU: 1484\nInterface Hardware Address: 02:ac:d4:3b:d9:29\n    \nName: en2\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: 0a:00:00:a5:32:b0\n    \nName: en3\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: 0a:00:00:a5:32:b1\n    \nName: bridge0\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: 0a:00:00:a5:32:b0\n    \nName: utun0\nInterface Flags: up|pointtopoint|multicast\nInterface MTU: 2000\nInterface Hardware Address:\n    \nName: utun1\nInterface Flags: up|pointtopoint|multicast\nInterface MTU: 1380\nInterface Hardware Address:\n    \nName: en5\nInterface Flags: up|broadcast|multicast\nInterface MTU: 1500\nInterface Hardware Address: 6e:72:e7:1b:cd:5f"}]}]},{"block_type":"element","block":"k6pz2ju0","search_text":"Executing netCapabilities.go on a Debian Linux machine will generate similar output.","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netCapabilities.go"}]},{"block_type":"text","content":"on a Debian Linux machine will generate similar output."}]},{"block_type":"element","block":"k6pz2ju1","search_text":"Finally, if you are really interested in finding out the default gateway of the machine, you can execute the netstat -nr command either externally or using exec.Command() , taking its output using a pipe or exec.CombinedOutput() , and processing it as text using Go. This solution, however, is neither elegant nor perfect.","text_count":322,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, if you are really interested in finding out the default gateway of the machine, you can execute the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netstat -nr"}]},{"block_type":"text","content":"command either externally or using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"exec.Command()"}]},{"block_type":"text","content":", taking its output using a pipe or"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"exec.CombinedOutput()"}]},{"block_type":"text","content":", and processing it as text using Go. This solution, however, is neither elegant nor perfect."}]},{"block_type":"element","block":"k6pz2ju2","search_text":"Performing DNS lookups","text_count":22,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Performing DNS lookups"}]},{"block_type":"element","block":"k6pz2ju3","search_text":"DNS stands for Domain Name System , which relates to the way an IP address is translated into a name such as packt.com and vice versa. The logic behind the DNS.go utility, which will be developed in this section, is pretty simple: if the given command-line argument is a valid IP address, the program will process it as an IP address; otherwise, it will assume that it is dealing with a hostname that needs to be translated into one or more IP addresses.","text_count":454,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"DNS stands for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Domain Name System"}]},{"block_type":"text","content":", which relates to the way an IP address is translated into a name such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"packt.com"}]},{"block_type":"text","content":"and vice versa. The logic behind the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DNS.go"}]},{"block_type":"text","content":"utility, which will be developed in this section, is pretty simple: if the given command-line argument is a valid IP address, the program will process it as an IP address; otherwise, it will assume that it is dealing with a hostname that needs to be translated into one or more IP addresses."}]},{"block_type":"element","block":"k6pz2ju4","search_text":"The code for the DNS.go utility will be presented in three parts. The first part of the program contains the following Go code:","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DNS.go"}]},{"block_type":"text","content":"utility will be presented in three parts. The first part of the program contains the following Go code:"}]},{"block_type":"element","block":"k6pz2ju5","search_text":"package main import ( \"fmt\" \"net\" \"os\" ) func lookIP(address string) ([]string, error) { hosts, err := net.LookupAddr(address) if err != nil { return nil, err } return hosts, nil } func lookHostname(hostname string) ([]string, error) { IPs, err := net.LookupHost(hostname) if err != nil { return nil, err } return IPs, nil } ","text_count":325,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n    \"os\" \n) \n \nfunc lookIP(address string) ([]string, error) { \n    hosts, err := net.LookupAddr(address) \n    if err != nil { \n        return nil, err \n    } \n    return hosts, nil \n} \n \nfunc lookHostname(hostname string) ([]string, error) { \n    IPs, err := net.LookupHost(hostname) \n    if err != nil { \n        return nil, err \n    } \n    return IPs, nil \n}"}]}]},{"block_type":"element","block":"k6pz2ju6","search_text":"The lookIP() function gets an IP address as input and returns the list of names that match that IP address with the help of the net.LookupAddr() function.","text_count":154,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookIP()"}]},{"block_type":"text","content":"function gets an IP address as input and returns the list of names that match that IP address with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.LookupAddr()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2ju7","search_text":"On the other hand, the lookHostname() function gets a host name as input and returns a list with the associated IP addresses using the net.LookupHost() function.","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the other hand, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lookHostname()"}]},{"block_type":"text","content":"function gets a host name as input and returns a list with the associated IP addresses using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.LookupHost()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2ju8","search_text":"The second part of DNS.go is the following Go code:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DNS.go"}]},{"block_type":"text","content":"is the following Go code:"}]},{"block_type":"element","block":"k6pz2ju9","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide an argument!\") return } input := arguments[1] IPaddress := net.ParseIP(input) ","text_count":166,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide an argument!\") \n        return \n    } \n \n    input := arguments[1] \n    IPaddress := net.ParseIP(input)"}]}]},{"block_type":"element","block":"k6pz2jua","search_text":"The net.ParseIP() function parses a string as an IPv4 or an IPv6 address. If the IP address is not valid, net.ParseIP() returns nil .","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ParseIP()"}]},{"block_type":"text","content":"function parses a string as an IPv4 or an IPv6 address. If the IP address is not valid,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ParseIP()"}]},{"block_type":"text","content":"returns"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jub","search_text":"The remaining Go code of the DNS.go utility follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DNS.go"}]},{"block_type":"text","content":"utility follows next:"}]},{"block_type":"element","block":"k6pz2juc","search_text":"if IPaddress == nil { IPs, err := lookHostname(input) if err == nil { for _, singleIP := range IPs { fmt.Println(singleIP) } } } else { hosts, err := lookIP(input) if err == nil { for _, hostname := range hosts { fmt.Println(hostname) } } } } ","text_count":243,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if IPaddress == nil { \n        IPs, err := lookHostname(input) \n        if err == nil { \n            for _, singleIP := range IPs { \n                fmt.Println(singleIP) \n            } \n        } \n    } else { \n        hosts, err := lookIP(input) \n        if err == nil { \n            for _, hostname := range hosts { \n                     fmt.Println(hostname) \n            } \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jud","search_text":"Executing DNS.go with various kinds of input will generate the following output:","text_count":80,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DNS.go"}]},{"block_type":"text","content":"with various kinds of input will generate the following output:"}]},{"block_type":"element","block":"k6pz2jue","search_text":"$ go run DNS.go 127.0.0.1 localhost $ go run DNS.go 192.168.1.1 cisco $ go run DNS.go packtpub.com 83.166.169.231 $ go run DNS.go google.com 2a00:1450:4001:816::200e 216.58.210.14 $ go run DNS.go www.google.com 2a00:1450:4001:816::2004 216.58.214.36 $ go run DNS.go cnn.com 2a04:4e42::323 2a04:4e42:600::323 2a04:4e42:400::323 2a04:4e42:200::323 151.101.193.67 151.101.1.67 151.101.129.67 151.101.65.67 ","text_count":403,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run DNS.go 127.0.0.1\nlocalhost\n$ go run DNS.go 192.168.1.1\ncisco\n$ go run DNS.go packtpub.com\n83.166.169.231\n$ go run DNS.go google.com\n2a00:1450:4001:816::200e\n216.58.210.14\n$ go run DNS.go www.google.com\n2a00:1450:4001:816::2004\n216.58.214.36\n$ go run DNS.go cnn.com\n2a04:4e42::323\n2a04:4e42:600::323\n2a04:4e42:400::323\n2a04:4e42:200::323\n151.101.193.67\n151.101.1.67\n151.101.129.67\n151.101.65.67"}]}]},{"block_type":"element","block":"k6pz2juf","search_text":"Note that the output of the go run DNS.go 192.168.1.1 command is taken from my /etc/hosts file, because the cisco hostname is an alias for the 192.168.1.1 IP address in my /etc/hosts file.","text_count":188,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go run DNS.go 192.168.1.1"}]},{"block_type":"text","content":"command is taken from my"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/hosts"}]},{"block_type":"text","content":"file, because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cisco"}]},{"block_type":"text","content":"hostname is an alias for the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"192.168.1.1"}]},{"block_type":"text","content":"IP address in my"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/etc/hosts"}]},{"block_type":"text","content":"file."}]},{"block_type":"element","block":"k6pz2jug","search_text":"The output of the last command shows that sometimes a single hostname ( cnn.com ) might have multiple public IP addresses. Pay special attention to the word public here, because although www.google.com has multiple IP addresses, it uses just a single public IP address ( 216.58.214.36 ).","text_count":287,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the last command shows that sometimes a single hostname ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"cnn.com"}]},{"block_type":"text","content":") might have multiple public IP addresses. Pay special attention to the word"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"public"}]},{"block_type":"text","content":"here, because although"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.google.com"}]},{"block_type":"text","content":"has multiple IP addresses, it uses just a single public IP address ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"216.58.214.36"}]},{"block_type":"text","content":")."}]},{"block_type":"element","block":"k6pz2juh","search_text":"Getting the NS records of a domain","text_count":34,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Getting the NS records of a domain"}]},{"block_type":"element","block":"k6pz2jui","search_text":"A very popular DNS request has to do with finding out the name servers of a domain, which are stored in the NS records of that domain. This functionality is will be illustrated in the code of NSrecords.go .","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"A very popular DNS request has to do with finding out the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"name servers"}]},{"block_type":"text","content":"of a domain, which are stored in the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"NS records"}]},{"block_type":"text","content":"of that domain. This functionality is will be illustrated in the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2juj","search_text":"The code of NSrecords.go will be presented in two parts. The first part of NSrecords.go follows next:","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"will be presented in two parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2juk","search_text":"package main import ( \"fmt\" \"net\" \"os\" ) func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Need a domain name!\") return } ","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n    \"os\" \n) \n \nfunc main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Need a domain name!\") \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2jul","search_text":"In this part, you check whether you have at least one command-line argument in order to have something with which you can work.","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, you check whether you have at least one command-line argument in order to have something with which you can work."}]},{"block_type":"element","block":"k6pz2jum","search_text":"The remaining Go code of NSrecords.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jun","search_text":"domain := arguments[1] NSs, err := net.LookupNS(domain) if err != nil { fmt.Println(err) return } for _, NS := range NSs { fmt.Println(NS.Host) } } ","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"domain := arguments[1] \n    NSs, err := net.LookupNS(domain) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    for _, NS := range NSs { \n        fmt.Println(NS.Host) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2juo","search_text":"All the work is done by the net.LookupNS() function, which returns the NS records of a domain as a slice variable of the net.NS type. This is the reason for printing the Host field of each net.NS element of the slice.","text_count":217,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All the work is done by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.LookupNS()"}]},{"block_type":"text","content":"function, which returns the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"NS records"}]},{"block_type":"text","content":"of a domain as a slice variable of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.NS"}]},{"block_type":"text","content":"type. This is the reason for printing the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Host"}]},{"block_type":"text","content":"field of each"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.NS"}]},{"block_type":"text","content":"element of the slice."}]},{"block_type":"element","block":"k6pz2jup","search_text":"Executing NSrecords.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2juq","search_text":"$ go run NSrecords.go mtsoukalos.eu ns5.linode.com. ns4.linode.com. ns1.linode.com. ns2.linode.com. ns3.linode.com. $ go run NSrecords.go www.mtsoukalos.eu lookup www.mtsoukalos.eu on 8.8.8.8:53: no such host ","text_count":209,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run NSrecords.go mtsoukalos.eu\nns5.linode.com.\nns4.linode.com.\nns1.linode.com.\nns2.linode.com.\nns3.linode.com.\n$ go run NSrecords.go www.mtsoukalos.eu\nlookup www.mtsoukalos.eu on 8.8.8.8:53: no such host"}]}]},{"block_type":"element","block":"k6pz2jur","search_text":"You can verify the correctness of the preceding output with the help of the host(1) utility:","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can verify the correctness of the preceding output with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"host(1)"}]},{"block_type":"text","content":"utility:"}]},{"block_type":"element","block":"k6pz2jus","search_text":"$ host -t ns www.mtsoukalos.eu www.mtsoukalos.eu has no NS record $ host -t ns mtsoukalos.eu mtsoukalos.eu name server ns3.linode.com. mtsoukalos.eu name server ns1.linode.com. mtsoukalos.eu name server ns4.linode.com. mtsoukalos.eu name server ns2.linode.com. mtsoukalos.eu name server ns5.linode.com.","text_count":302,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ host -t ns www.mtsoukalos.eu\nwww.mtsoukalos.eu has no NS record\n$ host -t ns mtsoukalos.eu\nmtsoukalos.eu name server ns3.linode.com.\nmtsoukalos.eu name server ns1.linode.com.\nmtsoukalos.eu name server ns4.linode.com.\nmtsoukalos.eu name server ns2.linode.com.\nmtsoukalos.eu name server ns5.linode.com."}]}]},{"block_type":"element","block":"k6pz2jut","search_text":"Getting the MX records of a domain","text_count":34,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Getting the MX records of a domain"}]},{"block_type":"element","block":"k6pz2juu","search_text":"Another very popular DNS request has to do with getting the MX records of a domain. The MX records specify the mail servers of a domain. The code of the MXrecords.go utility will perform this task with Go.","text_count":205,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Another very popular DNS request has to do with getting the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"MX records"}]},{"block_type":"text","content":"of a domain. The MX records specify the mail servers of a domain. The code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"utility will perform this task with Go."}]},{"block_type":"element","block":"k6pz2juv","search_text":"The first part of the MXrecords.go utility is shown in the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"utility is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2juw","search_text":"package main import ( \"fmt\" \"net\" \"os\" ) func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Need a domain name!\") return } ","text_count":145,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n    \"os\" \n) \n \nfunc main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Need a domain name!\") \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2jux","search_text":"The second part of MXrecords.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2juy","search_text":"domain := arguments[1] MXs, err := net.LookupMX(domain) if err != nil { fmt.Println(err) return } for _, MX := range MXs { fmt.Println(MX.Host) } } ","text_count":148,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"domain := arguments[1] \n    MXs, err := net.LookupMX(domain) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    for _, MX := range MXs { \n        fmt.Println(MX.Host) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2juz","search_text":"The code of MXrecords.go works in a similar way to the code of NXrecords.go presented in the previous section. The only difference is that you use the net.LookupMX() function instead of the net.LookupNS() function.","text_count":214,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"works in a similar way to the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NXrecords.go"}]},{"block_type":"text","content":"presented in the previous section. The only difference is that you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.LookupMX()"}]},{"block_type":"text","content":"function instead of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.LookupNS()"}]},{"block_type":"text","content":"function."}]},{"block_type":"element","block":"k6pz2jv0","search_text":"Executing MXrecords.go will generate the following output:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jv1","search_text":"$ go run MXrecords.go golang.com aspmx.l.google.com. alt3.aspmx.l.google.com. alt1.aspmx.l.google.com. alt2.aspmx.l.google.com. $ go run MXrecords.go www.mtsoukalos.eu lookup www.mtsoukalos.eu on 8.8.8.8:53: no such host ","text_count":221,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run MXrecords.go golang.com\naspmx.l.google.com.\nalt3.aspmx.l.google.com.\nalt1.aspmx.l.google.com.\nalt2.aspmx.l.google.com.\n$ go run MXrecords.go www.mtsoukalos.eu\nlookup www.mtsoukalos.eu on 8.8.8.8:53: no such host"}]}]},{"block_type":"element","block":"k6pz2jv2","search_text":"Once again, you can verify the validity of the preceding output with the help of the host(1) utility:","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once again, you can verify the validity of the preceding output with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"host(1)"}]},{"block_type":"text","content":"utility:"}]},{"block_type":"element","block":"k6pz2jv3","search_text":"$ host -t mx golang.com golang.com mail is handled by 2 alt3.aspmx.l.google.com. golang.com mail is handled by 1 aspmx.l.google.com. golang.com mail is handled by 2 alt1.aspmx.l.google.com. golang.com mail is handled by 2 alt2.aspmx.l.google.com. $ host -t mx www.mtsoukalos.eu www.mtsoukalos.eu has no MX record ","text_count":313,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ host -t mx golang.com\ngolang.com mail is handled by 2 alt3.aspmx.l.google.com.\ngolang.com mail is handled by 1 aspmx.l.google.com.\ngolang.com mail is handled by 2 alt1.aspmx.l.google.com.\ngolang.com mail is handled by 2 alt2.aspmx.l.google.com.\n$ host -t mx www.mtsoukalos.eu\nwww.mtsoukalos.eu has no MX record"}]}]},{"block_type":"element","block":"k6pz2jv4","search_text":"Creating a web server in Go","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Creating a web server in Go"}]},{"block_type":"element","block":"k6pz2jv5","search_text":"Go allows you to create a web server on your own, using some of the functions of its standard library. The first time that you saw a web server application programmed in Go in this book was back in Chapter 10, Go Concurrency – Advanced Topics, when we talked about the context package.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go allows you to create a web server on your own,&nbsp;using some of the functions of its standard library. The first time that you saw a web server application programmed in Go in this book was back in Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency&nbsp;&ndash;&nbsp;Advanced Topics,"}]},{"block_type":"text","content":"&nbsp;when we talked about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2jv6","search_text":"Tip Although a web server programmed in Go can do many things efficiently and securely, if what you really need is a powerful web server that will support modules, multiple websites, and virtual hosts, then you would be better off using a web server such as Apache or Nginx . ","text_count":276,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although a web server programmed in Go can do many things efficiently and securely, if what you really need is a powerful web server that will support modules, multiple websites, and virtual hosts, then you would be better off using a web server such as"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Apache"}]},{"block_type":"text","content":"or"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Nginx"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2jv7","search_text":"The name of the Go program for this example will be www.go , and it will be presented in five parts. The first part of www.go contains the expected import statements:","text_count":166,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the Go program for this example will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":", and it will be presented in five parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"contains the expected"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"import"}]},{"block_type":"text","content":"statements:"}]},{"block_type":"element","block":"k6pz2jv8","search_text":"package main import ( \"fmt\" \"net/http\" \"os\" \"time\" ) ","text_count":53,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"os\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2jv9","search_text":"The time package is not necessary for a web server to operate. However, it is needed in this case because the server will send the time and the date to its clients.","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time"}]},{"block_type":"text","content":"package is not necessary for a web server to operate. However, it is needed in this case because the server will send the time and the date to its clients."}]},{"block_type":"element","block":"k6pz2jva","search_text":"The second code segment of www.go is shown in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jvb","search_text":"func myHandler(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served: %s\\n\", r.Host) } ","text_count":138,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func myHandler(w http.ResponseWriter, r *http.Request) { \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2jvc","search_text":"This is the implementation of the first handler function of the program. A handler function serves one or more URLs depending on the configuration used.","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is the implementation of the first handler function of the program. A"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"handler function"}]},{"block_type":"text","content":"serves one or more URLs depending on the configuration used."}]},{"block_type":"element","block":"k6pz2jvd","search_text":"The third part from www.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jve","search_text":"func timeHandler(w http.ResponseWriter, r *http.Request) { t := time.Now().Format(time.RFC1123) Body := \"The current time is:\" fmt.Fprintf(w, \"<h1 align=\\\"center\\\">%s</h1>\", Body) fmt.Fprintf(w, \"<h2 align=\\\"center\\\">%s</h2>\\n\", t) fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served time for: %s\\n\", r.Host) } ","text_count":322,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func timeHandler(w http.ResponseWriter, r *http.Request) { \n    t := time.Now().Format(time.RFC1123) \n    Body := \"The current time is:\" \n    fmt.Fprintf(w, \"&lt;h1 align=\\\"center\\\"&gt;%s&lt;/h1&gt;\", Body) \n    fmt.Fprintf(w, \"&lt;h2 align=\\\"center\\\"&gt;%s&lt;/h2&gt;\\n\", t) \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served time for: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2jvf","search_text":"In the preceding Go code, you can see the implementation of the second handler function of the program. This function generates dynamic content.","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you can see the implementation of the second handler function of the program. This function generates dynamic content."}]},{"block_type":"element","block":"k6pz2jvg","search_text":"The fourth section of code of our web server deals with the command-line arguments and the definition of the supported URLs:","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth section of code of our web server deals with the command-line arguments and the definition of the supported URLs:"}]},{"block_type":"element","block":"k6pz2jvh","search_text":"func main() { PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Using default port number: \", PORT) } else { PORT = \":\" + arguments[1] } http.HandleFunc(\"/time\", timeHandler) http.HandleFunc(\"/\", myHandler) ","text_count":232,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Using default port number: \", PORT) \n    } else { \n         PORT = \":\" + arguments[1] \n    } \n \n    http.HandleFunc(\"/time\", timeHandler) \n    http.HandleFunc(\"/\", myHandler)"}]}]},{"block_type":"element","block":"k6pz2jvi","search_text":"The http.HandleFunc() function associates a URL with a handler function.","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.HandleFunc()"}]},{"block_type":"text","content":"function associates a URL with a handler function."}]},{"block_type":"element","block":"k6pz2jvj","search_text":"The last part of the www.go program is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"program is as follows:"}]},{"block_type":"element","block":"k6pz2jvk","search_text":"err := http.ListenAndServe(PORT, nil) if err != nil { fmt.Println(err) return } } ","text_count":82,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err := http.ListenAndServe(PORT, nil) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jvl","search_text":"You should start the web server with the help of the http.ListenAndServe() function using the desired port number.","text_count":114,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should start the web server with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.ListenAndServe()"}]},{"block_type":"text","content":"function using the desired port number."}]},{"block_type":"element","block":"k6pz2jvm","search_text":"Executing www.go and connecting to its web server will generate the following output:","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"and connecting to its web server will generate the following output:"}]},{"block_type":"element","block":"k6pz2jvn","search_text":"$ go run www.go Using default port number: :8001 Served: localhost:8001 Served: localhost:8001 Served time for: localhost:8001 Served: localhost:8001 Served time for: localhost:8001 Served: localhost:8001 Served time for: localhost:8001 Served: localhost:8001 Served: localhost:8001 Served: localhost:8001 ","text_count":306,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run www.go\nUsing default port number:  :8001\nServed: localhost:8001\nServed: localhost:8001\nServed time for: localhost:8001\nServed: localhost:8001\nServed time for: localhost:8001\nServed: localhost:8001\nServed time for: localhost:8001\nServed: localhost:8001\nServed: localhost:8001\nServed: localhost:8001"}]}]},{"block_type":"element","block":"k6pz2jvo","search_text":"Although the output of the program provides some handy material, I think that you would prefer to see the real output of the program using your favorite web browser. The following screenshot shows the output of the myHandler() function of our web server as displayed in Google Chrome :","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the output of the program provides some handy material, I think that you would prefer to see the real output of the program using your favorite web browser. The following screenshot&nbsp;shows the output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHandler()"}]},{"block_type":"text","content":"function of our web server as displayed in"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Google Chrome"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2jvp","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000026.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jvq","search_text":"The home page of the www.go web server","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The home page of the www.go web server"}]},{"block_type":"element","block":"k6pz2jvr","search_text":"The following screenshot shows that www.go can generate dynamic pages as well. In this case, it is a web page registered in /time , which displays the current time and date:","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows that"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.go"},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]}]},{"block_type":"text","content":"can generate dynamic pages as well. In this case, it is a web page registered in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/time"}]},{"block_type":"text","content":", which displays the current time and date:"}]},{"block_type":"element","block":"k6pz2jvs","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000025.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jvt","search_text":"Getting the current time and date from the www.go web server","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Getting the current time and date from the www.go web server"}]},{"block_type":"element","block":"k6pz2jvu","search_text":"What is really interesting here is that all URLs apart from /time are served by the myHandler() function because its first argument, which is / , matches every URL that is not matched by another handler!","text_count":203,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What is really interesting here is that all URLs apart from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/time"}]},{"block_type":"text","content":"are served by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"myHandler()"}]},{"block_type":"text","content":"function because its first argument, which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/"}]},{"block_type":"text","content":", matches every URL that is not matched by another handler!"}]},{"block_type":"element","block":"k6pz2jvv","search_text":"Profiling an HTTP server","text_count":24,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Profiling an HTTP server"}]},{"block_type":"element","block":"k6pz2jvw","search_text":"As you learned in Chapter 11, Code Testing, Optimization, and Profiling , there is a standard Go package named net/http/pprof that should be used when you want to profile a Go application with its own HTTP server. Therefore, importing net/http/pprof will install various handlers under the /debug/pprof/ URL. You will see more of this in a short while. For now, it is enough that you remember that the net/http/pprof package should be used for profiling web applications with an HTTP server, whereas the runtime/pprof standard Go package should be used for profiling all other kinds of applications.","text_count":599,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you learned in Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization, and Profiling"}]},{"block_type":"text","content":", there is a standard Go package named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"that should be used when you want to profile a Go application with its own HTTP server. Therefore, importing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"will install various handlers under the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/debug/pprof/"}]},{"block_type":"text","content":"URL. You will see more of this in a short while. For now, it is enough that you remember that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package should be used for profiling web applications with an HTTP server, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"runtime/pprof"}]},{"block_type":"text","content":"standard Go package should be used for profiling all other kinds of applications."}]},{"block_type":"element","block":"k6pz2jvx","search_text":"Note that if your profiler works using the http://localhost:8080 address, you will get support for the following web links:","text_count":123,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that if your profiler works using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080"}]},{"block_type":"text","content":"address, you will get support for the following web links:"}]},{"block_type":"element","block":"k6pz2jvy","search_text":"http://localhost:8080/debug/pprof/goroutine http://localhost:8080/debug/pprof/heap http://localhost:8080/debug/pprof/threadcreate http://localhost:8080/debug/pprof/block http://localhost:8080/debug/pprof/mutex http://localhost:8080/debug/pprof/profile http://localhost:8080/debug/pprof/trace?seconds=5 ","text_count":302,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/goroutine"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/heap"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/threadcreate"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/block"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/mutex"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/profile"}]}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:8080/debug/pprof/trace?seconds=5"}]}]}]}]},{"block_type":"element","block":"k6pz2jvz","search_text":"The next program to be presented will use www.go as its starting point and add the necessary Go code to allow you to profile it. The name of the new program is wwwProfile.go , and it will be presented in four parts.","text_count":215,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next program to be presented will use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"as its starting point and add the necessary Go code to allow you to profile it. The name of the new program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2jw0","search_text":"Note that wwwProfile.go will use an http.NewServeMux variable for registering the supported paths of the program. The main reason for doing so is that the use of http.NewServeMux requires defining the HTTP endpoints manually. Also note that you are allowed to define a subset of the supported HTTP endpoints. If you decide not to use http.NewServeMux , then the HTTP endpoints are registered automatically, which also means that you will have to import the net/http/pprof package using the _ character in front of it.","text_count":517,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"will use an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":"variable for registering the supported paths of the program. The main reason for doing so is that the use of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":"requires defining the HTTP endpoints manually. Also note that you are allowed to define a subset of the supported HTTP endpoints. If you decide not to use"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":", then the HTTP endpoints are registered automatically, which also means that you will have to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"_"}]},{"block_type":"text","content":"character in front of it."}]},{"block_type":"element","block":"k6pz2jw1","search_text":"The first part of wwwProfile.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jw2","search_text":"package main import ( \"fmt\" \"net/http\" \"net/http/pprof\" \"os\" \"time\" ) func myHandler(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served: %s\\n\", r.Host) } func timeHandler(w http.ResponseWriter, r *http.Request) { t := time.Now().Format(time.RFC1123) Body := \"The current time is:\" fmt.Fprintf(w, \"<h1 align=\\\"center\\\">%s</h1>\", Body) fmt.Fprintf(w, \"<h2 align=\\\"center\\\">%s</h2>\\n\", t) fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served time for: %s\\n\", r.Host) } ","text_count":530,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"net/http/pprof\" \n    \"os\" \n    \"time\" \n) \n \nfunc myHandler(w http.ResponseWriter, r *http.Request) { \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served: %s\\n\", r.Host) \n} \n \nfunc timeHandler(w http.ResponseWriter, r *http.Request) { \n    t := time.Now().Format(time.RFC1123) \n    Body := \"The current time is:\" \n    fmt.Fprintf(w, \"&lt;h1 align=\\\"center\\\"&gt;%s&lt;/h1&gt;\", Body) \n    fmt.Fprintf(w, \"&lt;h2 align=\\\"center\\\"&gt;%s&lt;/h2&gt;\\n\", t) \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served time for: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2jw3","search_text":"The implementations of these two handler functions are exactly the same as before.","text_count":82,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The implementations of these two handler functions are exactly the same as before."}]},{"block_type":"element","block":"k6pz2jw4","search_text":"The second code segment from wwwProfile.go is as follows:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jw5","search_text":"func main() { PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Using default port number: \", PORT) } else { PORT = \":\" + arguments[1] fmt.Println(\"Using port number: \", PORT) } r := http.NewServeMux() r.HandleFunc(\"/time\", timeHandler) r.HandleFunc(\"/\", myHandler) ","text_count":291,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Using default port number: \", PORT) \n    } else { \n        PORT = \":\" + arguments[1] \n        fmt.Println(\"Using port number: \", PORT) \n    } \n \n    r := http.NewServeMux() \n    r.HandleFunc(\"/time\", timeHandler) \n    r.HandleFunc(\"/\", myHandler)"}]}]},{"block_type":"element","block":"k6pz2jw6","search_text":"In the preceding Go code, you define the URLs that will be supported by your web server using http.NewServeMux() and HandleFunc() .","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you define the URLs that will be supported by your web server using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"HandleFunc()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jw7","search_text":"The third code portion from wwwProfile.go is shown in the following Go code:","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jw8","search_text":"r.HandleFunc(\"/debug/pprof/\", pprof.Index) r.HandleFunc(\"/debug/pprof/cmdline\", pprof.Cmdline) r.HandleFunc(\"/debug/pprof/profile\", pprof.Profile) r.HandleFunc(\"/debug/pprof/symbol\", pprof.Symbol) r.HandleFunc(\"/debug/pprof/trace\", pprof.Trace) ","text_count":245,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"r.HandleFunc(\"/debug/pprof/\", pprof.Index) \n    r.HandleFunc(\"/debug/pprof/cmdline\", pprof.Cmdline) \n    r.HandleFunc(\"/debug/pprof/profile\", pprof.Profile) \n    r.HandleFunc(\"/debug/pprof/symbol\", pprof.Symbol) \n    r.HandleFunc(\"/debug/pprof/trace\", pprof.Trace)"}]}]},{"block_type":"element","block":"k6pz2jw9","search_text":"The preceding Go code defines the HTTP endpoints related to profiling. Without them, you will not be able to profile your web application.","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding Go code defines the HTTP endpoints related to profiling. Without them, you will not be able to profile your web application."}]},{"block_type":"element","block":"k6pz2jwa","search_text":"The remaining Go code is as follows:","text_count":36,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code is as follows:"}]},{"block_type":"element","block":"k6pz2jwb","search_text":"err := http.ListenAndServe(PORT, r) if err != nil { fmt.Println(err) return } } ","text_count":80,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err := http.ListenAndServe(PORT, r) \n    if err != nil { \n         fmt.Println(err) \n         return \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jwc","search_text":"This code begins the Go web server, and this allows it to serve connections from HTTP clients. You'll notice that the second parameter to http.ListenAndServe() is no longer nil .","text_count":178,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This code begins the Go web server, and this allows it to serve connections from HTTP clients. You'll notice that the second parameter to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.ListenAndServe()"}]},{"block_type":"text","content":"is no longer"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nil"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jwd","search_text":"As you can see, wwwProfile.go does not define the /debug/pprof/goroutine HTTP endpoint, which makes perfect sense as wwwProfile.go does not use any goroutines!","text_count":159,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"does not define the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"/debug/pprof/goroutine"}]},{"block_type":"text","content":"HTTP endpoint, which makes perfect sense as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"does not use any goroutines!"}]},{"block_type":"element","block":"k6pz2jwe","search_text":"Executing wwwProfile.go will generate the following output:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jwf","search_text":"$ go run wwwProfile.go 1234 Using port number: :1234 Served time for: localhost:1234 ","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run wwwProfile.go 1234\nUsing port number:  :1234\nServed time for: localhost:1234"}]}]},{"block_type":"element","block":"k6pz2jwg","search_text":"Using the Go profiler to get data is a pretty simple task that requires the execution of the next command, which will take you to the shell of the Go profiler automatically:","text_count":173,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using the Go profiler to get data is a pretty simple task that requires the execution of the next command, which will take you to the shell of the Go profiler automatically:"}]},{"block_type":"element","block":"k6pz2jwh","search_text":"$ go tool pprof http://localhost:1234/debug/pprof/profile Fetching profile over HTTP from http://localhost:1234/debug/pprof/profile Saved profile in /Users/mtsouk/pprof/pprof.samples.cpu.003.pb.gz Type: cpu Time: Mar 27, 2018 at 10:04pm (EEST) Duration: 30s, Total samples = 21.04s (70.13%) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) top Showing nodes accounting for 19.94s, 94.77% of 21.04s total Dropped 159 nodes (cum <= 0.11s) Showing top 10 nodes out of 75 flat flat% sum% cum cum% 13.73s 65.26% 65.26% 13.73s 65.26% syscall.Syscall 1.58s 7.51% 72.77% 1.58s 7.51% runtime.kevent 1.36s 6.46% 79.23% 1.36s 6.46% runtime.mach_semaphore_signal 1.02s 4.85% 84.08% 1.02s 4.85% runtime.usleep 0.80s 3.80% 87.88% 0.80s 3.80% runtime.mach_semaphore_wait 0.53s 2.52% 90.40% 2.11s 10.03% runtime.netpoll 0.44s 2.09% 92.49% 0.44s 2.09% internal/poll.convertErr 0.26s 1.24% 93.73% 0.26s 1.24% net.(*TCPConn).Read","text_count":939,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go tool pprof http://localhost:1234/debug/pprof/profile\nFetching profile over HTTP from http://localhost:1234/debug/pprof/profile\nSaved profile in /Users/mtsouk/pprof/pprof.samples.cpu.003.pb.gz\nType: cpu\nTime: Mar 27, 2018 at 10:04pm (EEST)\nDuration: 30s, Total samples = 21.04s (70.13%)\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\n(pprof) top\nShowing nodes accounting for 19.94s, 94.77% of 21.04s total\nDropped 159 nodes (cum &lt;= 0.11s)\nShowing top 10 nodes out of 75\n    flat  flat%   sum%        cum   cum%\n    13.73s 65.26% 65.26%     13.73s 65.26%  syscall.Syscall\n    1.58s  7.51% 72.77%      1.58s  7.51%  runtime.kevent\n    1.36s  6.46% 79.23%      1.36s  6.46%  runtime.mach_semaphore_signal\n    1.02s  4.85% 84.08%      1.02s  4.85%  runtime.usleep\n    0.80s  3.80% 87.88%      0.80s  3.80%  runtime.mach_semaphore_wait\n    0.53s  2.52% 90.40%      2.11s 10.03%  runtime.netpoll\n    0.44s  2.09% 92.49%      0.44s  2.09%  internal/poll.convertErr\n    0.26s  1.24% 93.73%      0.26s  1.24%  net.(*TCPConn).Read"}]}]},{"block_type":"element","block":"k6pz2jwi","search_text":"0.18s 0.86% 94.58% 0.18s 0.86% runtime.freedefer 0.04s 0.19% 94.77% 1.05s 4.99% runtime.runqsteal (pprof) ","text_count":106,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"0.18s  0.86% 94.58%      0.18s  0.86%  runtime.freedefer\n    0.04s  0.19% 94.77%      1.05s  4.99%  runtime.runqsteal\n(pprof)"}]}]},{"block_type":"element","block":"k6pz2jwj","search_text":"You can now use the profiling data and analyze it using go tool pprof , as you learned in Chapter 11, Code Testing, Optimization, and Profiling .","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can now use the profiling data and analyze it using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":", as you learned in Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization, and Profiling"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2jwk","search_text":"Note You can visit http://HOSTNAME:PORTNUMBER/debug/pprof/ and see the profiling results from there. When the value of HOSTNAME is localhost and that of PORTNUMBER is 1234 , you should visit http://localhost:1234/debug/pprof/ . ","text_count":228,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can visit"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://HOSTNAME:PORTNUMBER/debug/pprof/"}]},{"block_type":"text","content":"and see the profiling results from there. When the value of&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"HOSTNAME"}]},{"block_type":"text","content":"&nbsp;is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"localhost"}]},{"block_type":"text","content":"and that of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PORTNUMBER"}]},{"block_type":"text","content":"&nbsp;is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"1234"}]},{"block_type":"text","content":", you should visit"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http://localhost:1234/debug/pprof/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","block":"k6pz2jwl","search_text":"Should you wish to test the performance of your web server application, you can use the ab(1) utility, which is more widely known as the Apache HTTP server benchmarking tool , in order to create some traffic and benchmark wwwProfile.go . This will also allow go tool pprof to collect more accurate data, as follows:","text_count":315,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Should you wish to test the performance of your web server application, you can use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ab(1)"}]},{"block_type":"text","content":"utility, which is more widely known as the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Apache HTTP server benchmarking tool"}]},{"block_type":"text","content":", in order to create some traffic and benchmark"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"wwwProfile.go"}]},{"block_type":"text","content":". This will also allow"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go tool pprof"}]},{"block_type":"text","content":"to collect more accurate data, as follows:"}]},{"block_type":"element","block":"k6pz2jwm","search_text":"$ ab -k -c 10 -n 100000 \"http://127.0.0.1:1234/time\" This is ApacheBench, Version 2.3 <$Revision: 1807734 $> Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 127.0.0.1 (be patient) Completed 10000 requests Completed 20000 requests Completed 30000 requests Completed 40000 requests Completed 50000 requests Completed 60000 requests Completed 70000 requests Completed 80000 requests Completed 90000 requests Completed 100000 requests Finished 100000 requests Server Software: Server Hostname: 127.0.0.1 Server Port: 1234 Document Path: /time Document Length: 114 bytes Concurrency Level: 10 Time taken for tests: 2.114 seconds Complete requests: 100000 Failed requests: 0 Keep-Alive requests: 100000 Total transferred: 25500000 bytes HTML transferred: 11400000 bytes Requests per second: 47295.75 [#/sec] (mean) Time per request: 0.211 [ms] (mean) Time per request: 0.021 [ms] (mean, across all concurrent requests) Transfer rate: 11777.75 [Kbytes/sec] received Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.0 0 0 Processing: 0 0 0.7 0 13 Waiting: 0 0 0.7 0 13 Total: 0 0 0.7 0 13 Percentage of the requests served within a certain time (ms) 50% 0 66% 0 75% 0 80% 0 90% 0 95% 0 98% 0 99% 0 100% 13 (longest request) ","text_count":1336,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ab -k -c 10 -n 100000 \"http://127.0.0.1:1234/time\"\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n    \nBenchmarking 127.0.0.1 (be patient)\nCompleted 10000 requests\nCompleted 20000 requests\nCompleted 30000 requests\nCompleted 40000 requests\nCompleted 50000 requests\nCompleted 60000 requests\nCompleted 70000 requests\nCompleted 80000 requests\nCompleted 90000 requests\nCompleted 100000 requests\nFinished 100000 requests\n    \n    \nServer Software:\nServer Hostname:        127.0.0.1\nServer Port:            1234\n    \nDocument Path:          /time\nDocument Length:        114 bytes\n    \nConcurrency Level:      10\nTime taken for tests:   2.114 seconds\nComplete requests:      100000\nFailed requests:        0\nKeep-Alive requests:    100000\nTotal transferred:      25500000 bytes\nHTML transferred:       11400000 bytes\nRequests per second:    47295.75 [#/sec] (mean)\nTime per request:       0.211 [ms] (mean)\nTime per request:       0.021 [ms] (mean, across all concurrent requests)\nTransfer rate:          11777.75 [Kbytes/sec] received\n    \nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    0   0.0      0       0\nProcessing:     0    0   0.7      0      13\nWaiting:        0    0   0.7      0      13\nTotal:          0    0   0.7      0      13\n    \nPercentage of the requests served within a certain time (ms)\n50%      0\n66%      0\n75%      0\n80%      0\n90%      0\n95%      0\n98%      0\n99%      0\n100%     13 (longest request)"}]}]},{"block_type":"element","block":"k6pz2jwn","search_text":"Note Can you use the net/http/pprof package for profiling command-line applications? Yes! However, the net/http/pprof package is particularly useful when you want to profile a running web application and capture live data, which is the main reason for presenting it in this chapter. ","text_count":283,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Can you use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package for profiling command-line applications? Yes! However, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package is particularly useful when you want to profile a running web application and capture live data, which is the main reason for presenting it in this chapter."}]}]},{"block_type":"element","block":"k6pz2jwo","search_text":"Creating a website in Go","text_count":24,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Creating a website in Go"}]},{"block_type":"element","block":"k6pz2jwp","search_text":"Do you remember the keyValue.go application from Chapter 4, The Uses of Composite Types, and kvSaveLoad.go from Chapter 8, Telling a Unix System What to Do ? In this section, you will learn how to create a web interface for them, using the capabilities of the standard Go library. The name of the new Go source code file is kvWeb.go , and it will be presented in six parts.","text_count":373,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Do you remember the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"application from Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types,&nbsp;"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"from Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"? In this section, you will learn how to create a web interface for them, using the capabilities of the standard Go library. The name of the new Go source code file is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":", and it will be presented in six parts."}]},{"block_type":"element","block":"k6pz2jwq","search_text":"The first difference between the Go code of kvWeb.go and www.go , developed earlier in this chapter, is that kvWeb.go uses the http.NewServeMux type for dealing with HTTP requests because it is much more versatile for nontrivial web applications.","text_count":246,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first difference between the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":", developed earlier in this chapter, is that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewServeMux"}]},{"block_type":"text","content":"type for dealing with HTTP requests because it is much more versatile for nontrivial web applications."}]},{"block_type":"element","block":"k6pz2jwr","search_text":"The first part of kvWeb.go is as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jws","search_text":"package main import ( \"encoding/gob\" \"fmt\" \"html/template\" \"net/http\" \"os\" ) type myElement struct { Name string Surname string Id string } var DATA = make(map[string]myElement) var DATAFILE = \"/tmp/dataFile.gob\" ","text_count":213,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"encoding/gob\" \n    \"fmt\" \n    \"html/template\" \n    \"net/http\" \n    \"os\" \n) \n \ntype myElement struct { \n    Name    string \n    Surname string \n    Id      string \n} \n \nvar DATA = make(map[string]myElement) \nvar DATAFILE = \"/tmp/dataFile.gob\""}]}]},{"block_type":"element","block":"k6pz2jwt","search_text":"You have already seen this code in kvSaveLoad.go in Chapter 8, Telling a Unix System What to Do.","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You have already seen this code in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do."}]}]},{"block_type":"element","block":"k6pz2jwu","search_text":"The second part of kvWeb.go is shown in the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2jwv","search_text":"func save() error { fmt.Println(\"Saving\", DATAFILE) err := os.Remove(DATAFILE) if err != nil { fmt.Println(err) } saveTo, err := os.Create(DATAFILE) if err != nil { fmt.Println(\"Cannot create\", DATAFILE) return err } defer saveTo.Close() encoder := gob.NewEncoder(saveTo) err = encoder.Encode(DATA) if err != nil { fmt.Println(\"Cannot save to\", DATAFILE) return err } return nil } func load() error { fmt.Println(\"Loading\", DATAFILE) loadFrom, err := os.Open(DATAFILE) defer loadFrom.Close() if err != nil { fmt.Println(\"Empty key/value store!\") return err } decoder := gob.NewDecoder(loadFrom) decoder.Decode(&DATA) return nil } func ADD(k string, n myElement) bool { if k == \"\" { return false } if LOOKUP(k) == nil { DATA[k] = n return true } return false } func DELETE(k string) bool { if LOOKUP(k) != nil { delete(DATA, k) return true } return false } func LOOKUP(k string) *myElement { _, ok := DATA[k] if ok { n := DATA[k] return &n } else { return nil } } func CHANGE(k string, n myElement) bool { DATA[k] = n return true } func PRINT() { for k, d := range DATA {","text_count":1070,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func save() error { \n    fmt.Println(\"Saving\", DATAFILE) \n    err := os.Remove(DATAFILE) \n    if err != nil { \n        fmt.Println(err) \n    } \n \n    saveTo, err := os.Create(DATAFILE) \n    if err != nil { \n        fmt.Println(\"Cannot create\", DATAFILE) \n        return err \n    } \n    defer saveTo.Close() \n \n    encoder := gob.NewEncoder(saveTo) \n    err = encoder.Encode(DATA) \n    if err != nil { \n        fmt.Println(\"Cannot save to\", DATAFILE) \n        return err \n    } \n    return nil \n} \n \nfunc load() error { \n    fmt.Println(\"Loading\", DATAFILE) \n    loadFrom, err := os.Open(DATAFILE) \n    defer loadFrom.Close() \n    if err != nil { \n        fmt.Println(\"Empty key/value store!\") \n        return err \n    } \n \n    decoder := gob.NewDecoder(loadFrom) \n    decoder.Decode(&amp;DATA) \n    return nil \n} \n \nfunc ADD(k string, n myElement) bool { \n    if k == \"\" { \n        return false \n   } \n \n   if LOOKUP(k) == nil { \n       DATA[k] = n \n       return true \n    } \n    return false \n} \n \nfunc DELETE(k string) bool { \n    if LOOKUP(k) != nil { \n        delete(DATA, k) \n        return true \n    } \n    return false \n} \n \nfunc LOOKUP(k string) *myElement { \n    _, ok := DATA[k] \n    if ok { \n        n := DATA[k] \n        return &amp;n \n    } else { \n        return nil \n    } \n} \n \nfunc CHANGE(k string, n myElement) bool { \n    DATA[k] = n \n    return true \n} \n \nfunc PRINT() { \n    for k, d := range DATA {"}]}]},{"block_type":"element","block":"k6pz2jww","search_text":"fmt.Printf(\"key: %s value: %v\\n\", k, d) } } ","text_count":44,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Printf(\"key: %s value: %v\\n\", k, d) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jwx","search_text":"You should also be familiar with the preceding Go code, as it first appeared in kvSaveLoad.go in Chapter 8, Telling a Unix System What to Do.","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You should also be familiar with the preceding Go code, as it first appeared in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do."}]}]},{"block_type":"element","block":"k6pz2jwy","search_text":"The third code portion of kvWeb.go follows next:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jwz","search_text":"func homePage(w http.ResponseWriter, r *http.Request) { fmt.Println(\"Serving\", r.Host, \"for\", r.URL.Path) myT := template.Must(template.ParseGlob(\"home.gohtml\")) myT.ExecuteTemplate(w, \"home.gohtml\", nil) } func listAll(w http.ResponseWriter, r *http.Request) { fmt.Println(\"Listing the contents of the KV store!\") fmt.Fprintf(w, \"<a href=\\\"/\\\" style=\\\"margin-right: 20px;\\\">Home sweet home!</a>\") fmt.Fprintf(w, \"<a href=\\\"/list\\\" style=\\\"margin-right: 20px;\\\">List all elements!</a>\") fmt.Fprintf(w, \"<a href\\=\"/change\\\" style=\\\"margin-right: 20px;\\\">Change an element!</a>\") fmt.Fprintf(w, \"<a href\\=\"/insert\\\" style=\\\"margin-right: 20px;\\\">Insert new element!</a>\") fmt.Fprintf(w, \"<h1>The contents of the KV store are:</h1>\") fmt.Fprintf(w, \"<ul>\") for k, v := range DATA { fmt.Fprintf(w, \"<li>\") fmt.Fprintf(w, \"<strong>%s</strong> with value: %v\\n\", k, v) fmt.Fprintf(w, \"</li>\") } fmt.Fprintf(w, \"</ul>\") } ","text_count":915,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func homePage(w http.ResponseWriter, r *http.Request) { \n    fmt.Println(\"Serving\", r.Host, \"for\", r.URL.Path) \n    myT := template.Must(template.ParseGlob(\"home.gohtml\")) \n    myT.ExecuteTemplate(w, \"home.gohtml\", nil) \n} \n \nfunc listAll(w http.ResponseWriter, r *http.Request) { \n    fmt.Println(\"Listing the contents of the KV store!\") \n \n    fmt.Fprintf(w, \"&lt;a href=\\\"/\\\" style=\\\"margin-right: 20px;\\\"&gt;Home sweet home!&lt;/a&gt;\") \n    fmt.Fprintf(w, \"&lt;a href=\\\"/list\\\" style=\\\"margin-right: 20px;\\\"&gt;List all elements!&lt;/a&gt;\") \n    fmt.Fprintf(w, \"&lt;a href\\=\"/change\\\" style=\\\"margin-right: 20px;\\\"&gt;Change an element!&lt;/a&gt;\") \n    fmt.Fprintf(w, \"&lt;a href\\=\"/insert\\\" style=\\\"margin-right: 20px;\\\"&gt;Insert new element!&lt;/a&gt;\") \n \n    fmt.Fprintf(w, \"&lt;h1&gt;The contents of the KV store are:&lt;/h1&gt;\") \n    fmt.Fprintf(w, \"&lt;ul&gt;\") \n    for k, v := range DATA { \n        fmt.Fprintf(w, \"&lt;li&gt;\") \n        fmt.Fprintf(w, \"&lt;strong&gt;%s&lt;/strong&gt; with value: %v\\n\", k, v) \n        fmt.Fprintf(w, \"&lt;/li&gt;\") \n    } \n \n    fmt.Fprintf(w, \"&lt;/ul&gt;\") \n}"}]}]},{"block_type":"element","block":"k6pz2jx0","search_text":"The listAll() function does not use any Go templates for generating its dynamic output. Instead, its output is generated on the fly, using Go. You may consider this an exception, as web applications usually work better with HTML templates and the html/template standard Go package.","text_count":281,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"listAll()"}]},{"block_type":"text","content":"function does not use any Go templates for generating its dynamic output. Instead, its output is generated on the fly, using Go. You may consider this an exception, as web applications usually work better with HTML templates and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"html/template"}]},{"block_type":"text","content":"standard Go package."}]},{"block_type":"element","block":"k6pz2jx1","search_text":"The fourth part of kvWeb.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jx2","search_text":"func changeElement(w http.ResponseWriter, r *http.Request) { fmt.Println(\"Changing an element of the KV store!\") tmpl := template.Must(template.ParseFiles(\"update.gohtml\")) if r.Method != http.MethodPost { tmpl.Execute(w, nil) return } key := r.FormValue(\"key\") n := myElement{ Name: r.FormValue(\"name\"), Surname: r.FormValue(\"surname\"), Id: r.FormValue(\"id\"), } if !CHANGE(key, n) { fmt.Println(\"Update operation failed!\") } else { err := save() if err != nil { fmt.Println(err) return } tmpl.Execute(w, struct{ Success bool }{true}) } } ","text_count":539,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func changeElement(w http.ResponseWriter, r *http.Request) { \n    fmt.Println(\"Changing an element of the KV store!\") \n    tmpl := template.Must(template.ParseFiles(\"update.gohtml\")) \n    if r.Method != http.MethodPost { \n        tmpl.Execute(w, nil) \n        return \n    } \n \n    key := r.FormValue(\"key\") \n    n := myElement{        \n        Name:    r.FormValue(\"name\"),\n        Surname: r.FormValue(\"surname\"),\n        Id:      r.FormValue(\"id\"),\n    } \n \n    if !CHANGE(key, n) { \n        fmt.Println(\"Update operation failed!\") \n    } else { \n        err := save() \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n        tmpl.Execute(w, struct{ Success bool }{true}) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jx3","search_text":"In the preceding Go code, you can see how to read the values from the fields of an HTML form with the help of the FormValue() function. The template.Must() function is a helper function which makes sure that the template file provided contains no errors.","text_count":254,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, you can see how to read the values from the fields of an HTML form with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"FormValue()"}]},{"block_type":"text","content":"function. The&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"template.Must()"}]},{"block_type":"text","content":"&nbsp;function is a helper function which makes sure that the template file provided contains no errors."}]},{"block_type":"element","block":"k6pz2jx4","search_text":"The fifth code segment of kvWeb.go is contained in the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"is contained in the following Go code:"}]},{"block_type":"element","block":"k6pz2jx5","search_text":"func insertElement(w http.ResponseWriter, r *http.Request) { fmt.Println(\"Inserting an element to the KV store!\") tmpl := template.Must(template.ParseFiles(\"insert.gohtml\")) if r.Method != http.MethodPost { tmpl.Execute(w, nil) return } key := r.FormValue(\"key\") n := myElement{ Name: r.FormValue(\"name\"), Surname: r.FormValue(\"surname\"), Id: r.FormValue(\"id\"), } if !ADD(key, n) { fmt.Println(\"Add operation failed!\") } else { err := save() if err != nil { fmt.Println(err) return } tmpl.Execute(w, struct{ Success bool }{true}) } } ","text_count":534,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func insertElement(w http.ResponseWriter, r *http.Request) { \n    fmt.Println(\"Inserting an element to the KV store!\") \n    tmpl := template.Must(template.ParseFiles(\"insert.gohtml\")) \n    if r.Method != http.MethodPost { \n        tmpl.Execute(w, nil) \n        return \n   } \n \n   key := r.FormValue(\"key\") \n   n := myElement{ \n       Name:    r.FormValue(\"name\"), \n       Surname: r.FormValue(\"surname\"), \n       Id:      r.FormValue(\"id\"), \n   } \n \n    if !ADD(key, n) { \n        fmt.Println(\"Add operation failed!\") \n    } else { \n        err := save() \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n        tmpl.Execute(w, struct{ Success bool }{true}) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jx6","search_text":"The remaining Go code is as follows:","text_count":36,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code is as follows:"}]},{"block_type":"element","block":"k6pz2jx7","search_text":"func main() { err := load() if err != nil { fmt.Println(err) } PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Using default port number: \", PORT) } else { PORT = \":\" + arguments[1] } http.HandleFunc(\"/\", homePage) http.HandleFunc(\"/change\", changeElement) http.HandleFunc(\"/list\", listAll) http.HandleFunc(\"/insert\", insertElement) err = http.ListenAndServe(PORT, nil) if err != nil { fmt.Println(err) } } ","text_count":434,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    err := load() \n    if err != nil { \n        fmt.Println(err) \n    } \n \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Using default port number: \", PORT) \n    } else { \n        PORT = \":\" + arguments[1] \n    } \n \n    http.HandleFunc(\"/\", homePage) \n    http.HandleFunc(\"/change\", changeElement) \n    http.HandleFunc(\"/list\", listAll) \n    http.HandleFunc(\"/insert\", insertElement) \n    err = http.ListenAndServe(PORT, nil) \n    if err != nil { \n        fmt.Println(err) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jx8","search_text":"The main() function of kvWeb.go is much simpler than the main() function of kvSaveLoad.go from Chapter 8, Telling a Unix System What to Do, because these two program have a totally different design.","text_count":198,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"is much simpler than the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main()"}]},{"block_type":"text","content":"function of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"from Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do,"}]},{"block_type":"text","content":"&nbsp;because these two program have a totally different design."}]},{"block_type":"element","block":"k6pz2jx9","search_text":"It is now time to look at the gohtml files used for this project starting with home.gohtml , which is as follows:","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"It is now time to look at the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gohtml"}]},{"block_type":"text","content":"files used for this project starting with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"home.gohtml"}]},{"block_type":"text","content":", which is as follows:"}]},{"block_type":"element","block":"k6pz2jxa","search_text":"<!doctype html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>A Key Value Store!</title> </head> <body> <a href=\"/\" style=\"margin-right: 20px;\">Home sweet home!</a> <a href=\"/list\" style=\"margin-right: 20px;\">List all elements!</a> <a href=\"/change\" style=\"margin-right: 20px;\">Change an element!</a> <a href=\"/insert\" style=\"margin-right: 20px;\">Insert new element!</a> <h2>Welcome to the Go KV store!</h2> </body> </html> ","text_count":432,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;!doctype html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n    &lt;meta charset=\"UTF-8\"&gt; \n    &lt;title&gt;A Key Value Store!&lt;/title&gt; \n&lt;/head&gt; \n&lt;body&gt; \n \n&lt;a href=\"/\" style=\"margin-right: 20px;\"&gt;Home sweet home!&lt;/a&gt; \n&lt;a href=\"/list\" style=\"margin-right: 20px;\"&gt;List all elements!&lt;/a&gt; \n&lt;a href=\"/change\" style=\"margin-right: 20px;\"&gt;Change an element!&lt;/a&gt; \n&lt;a href=\"/insert\" style=\"margin-right: 20px;\"&gt;Insert new element!&lt;/a&gt; \n \n&lt;h2&gt;Welcome to the Go KV store!&lt;/h2&gt; \n \n&lt;/body&gt; \n&lt;/html&gt;"}]}]},{"block_type":"element","block":"k6pz2jxb","search_text":"The home.gohtml file is static, which means that its contents do not change. However, the remaining gohtml files display information dynamically.","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"home.gohtml"}]},{"block_type":"text","content":"file is static, which means that its contents do not change. However, the remaining"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"gohtml"}]},{"block_type":"text","content":"files display information dynamically."}]},{"block_type":"element","block":"k6pz2jxc","search_text":"The contents of update.gohtml are as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"update.gohtml"}]},{"block_type":"text","content":"are as follows:"}]},{"block_type":"element","block":"k6pz2jxd","search_text":"<!doctype html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>A Key Value Store!</title> </head> <body> <a href=\"/\" style=\"margin-right: 20px;\">Home sweet home!</a> <a href=\"/list\" style=\"margin-right: 20px;\">List all elements!</a> <a href=\"/change\" style=\"margin-right: 20px;\">Change an element!</a> <a href=\"/insert\" style=\"margin-right: 20px;\">Insert new element!</a> {{if .Success}} <h1>Element updated!</h1>{{else}} <h1>Please fill in the fields:</h1> <form method=\"POST\"> <label>Key:</label><br /> <input type=\"text\" name=\"key\"><br /> <label>Name:</label><br /> <input type=\"text\" name=\"name\"><br /> <label>Surname:</label><br /> <input type=\"text\" name=\"surname\"><br /> <label>Id:</label><br /> <input type=\"text\" name=\"id\"><br /> <input type=\"submit\"> </form> {{end}} </body> </html> ","text_count":800,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;!doctype html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n    &lt;meta charset=\"UTF-8\"&gt; \n    &lt;title&gt;A Key Value Store!&lt;/title&gt; \n&lt;/head&gt; \n&lt;body&gt; \n \n&lt;a href=\"/\" style=\"margin-right: 20px;\"&gt;Home sweet home!&lt;/a&gt; \n&lt;a href=\"/list\" style=\"margin-right: 20px;\"&gt;List all elements!&lt;/a&gt; \n&lt;a href=\"/change\" style=\"margin-right: 20px;\"&gt;Change an element!&lt;/a&gt; \n&lt;a href=\"/insert\" style=\"margin-right: 20px;\"&gt;Insert new element!&lt;/a&gt; \n \n{{if .Success}}   &lt;h1&gt;Element updated!&lt;/h1&gt;{{else}}\n&lt;h1&gt;Please fill in the fields:&lt;/h1&gt;\n    &lt;form method=\"POST\"&gt; \n        &lt;label&gt;Key:&lt;/label&gt;&lt;br /&gt; \n        &lt;input type=\"text\" name=\"key\"&gt;&lt;br /&gt; \n        &lt;label&gt;Name:&lt;/label&gt;&lt;br /&gt; \n        &lt;input type=\"text\" name=\"name\"&gt;&lt;br /&gt; \n        &lt;label&gt;Surname:&lt;/label&gt;&lt;br /&gt; \n        &lt;input type=\"text\" name=\"surname\"&gt;&lt;br /&gt; \n        &lt;label&gt;Id:&lt;/label&gt;&lt;br /&gt; \n        &lt;input type=\"text\" name=\"id\"&gt;&lt;br /&gt; \n        &lt;input type=\"submit\"&gt; \n    &lt;/form&gt; \n{{end}} \n \n&lt;/body&gt; \n&lt;/html&gt;"}]}]},{"block_type":"element","block":"k6pz2jxe","search_text":"The preceding is mainly HTML code. Its most interesting part is the if statement that specifies whether you should see the form or the Element updated! message.","text_count":160,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding is mainly HTML code. Its most interesting part is the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"if"}]},{"block_type":"text","content":"statement that specifies whether you should see the form or the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Element updated!"}]},{"block_type":"text","content":"message."}]},{"block_type":"element","block":"k6pz2jxf","search_text":"Finally, the contents of insert.gohtml are as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the contents of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"insert.gohtml"}]},{"block_type":"text","content":"are as follows:"}]},{"block_type":"element","block":"k6pz2jxg","search_text":"<!doctype html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>A Key Value Store!</title> </head> <body> <a href=\"/\" style=\"margin-right: 20px;\">Home sweet home!</a> <a href=\"/list\" style=\"margin-right: 20px;\">List all elements!</a> <a href=\"/change\" style=\"margin-right: 20px;\">Change an element!</a> <a href=\"/insert\" style=\"margin-right: 20px;\">Insert new element!</a> {{if .Success}} <h1>Element inserted!</h1> {{else}} <h1>Please fill in the fields:</h1> <form method=\"POST\"> <label>Key:</label><br /> <input type=\"text\" name=\"key\"><br /> <label>Name:</label><br /> <input type=\"text\" name=\"name\"><br /> <label>Surname:</label><br /> <input type=\"text\" name=\"surname\"><br /> <label>Id:</label><br /> <input type=\"text\" name=\"id\"><br /> <input type=\"submit\"> </form> {{end}} </body> </html> ","text_count":802,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&lt;!doctype html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n    &lt;meta charset=\"UTF-8\"&gt; \n    &lt;title&gt;A Key Value Store!&lt;/title&gt; \n&lt;/head&gt; \n&lt;body&gt; \n \n&lt;a href=\"/\" style=\"margin-right: 20px;\"&gt;Home sweet home!&lt;/a&gt; \n&lt;a href=\"/list\" style=\"margin-right: 20px;\"&gt;List all elements!&lt;/a&gt; \n&lt;a href=\"/change\" style=\"margin-right: 20px;\"&gt;Change an element!&lt;/a&gt; \n&lt;a href=\"/insert\" style=\"margin-right: 20px;\"&gt;Insert new element!&lt;/a&gt; \n \n{{if .Success}} \n    &lt;h1&gt;Element inserted!&lt;/h1&gt; \n{{else}} \n    &lt;h1&gt;Please fill in the fields:&lt;/h1&gt;\n    &lt;form method=\"POST\"&gt; \n         &lt;label&gt;Key:&lt;/label&gt;&lt;br /&gt; \n         &lt;input type=\"text\" name=\"key\"&gt;&lt;br /&gt; \n         &lt;label&gt;Name:&lt;/label&gt;&lt;br /&gt; \n         &lt;input type=\"text\" name=\"name\"&gt;&lt;br /&gt; \n         &lt;label&gt;Surname:&lt;/label&gt;&lt;br /&gt; \n         &lt;input type=\"text\" name=\"surname\"&gt;&lt;br /&gt; \n         &lt;label&gt;Id:&lt;/label&gt;&lt;br /&gt; \n         &lt;input type=\"text\" name=\"id\"&gt;&lt;br /&gt; \n         &lt;input type=\"submit\"&gt; \n    &lt;/form&gt; \n{{end}} \n \n&lt;/body&gt; \n&lt;/html&gt;"}]}]},{"block_type":"element","block":"k6pz2jxh","search_text":"As you can see, insert.gohtml and update.gohtml are identical apart from the text in the <title> tag!","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"insert.gohtml"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"update.gohtml"}]},{"block_type":"text","content":"are identical apart from the text in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"&lt;title&gt;"}]},{"block_type":"text","content":"tag!"}]},{"block_type":"element","block":"k6pz2jxi","search_text":"Executing kvWeb.go will generate the following output on a Unix shell:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"will generate the following output on a Unix shell:"}]},{"block_type":"element","block":"k6pz2jxj","search_text":"$ go run kvWeb.go Loading /tmp/dataFile.gob Using default port number: :8001 Serving localhost:8001 for / Serving localhost:8001 for /favicon.ico Listing the contents of the KV store! Serving localhost:8001 for /favicon.ico Inserting an element to the KV store! Serving localhost:8001 for /favicon.ico Inserting an element to the KV store! Add operation failed! Serving localhost:8001 for /favicon.ico Inserting an element to the KV store! Serving localhost:8001 for /favicon.ico Inserting an element to the KV store! Saving /tmp/dataFile.gob Serving localhost:8001 for /favicon.ico Inserting an element to the KV store! Serving localhost:8001 for /favicon.ico Changing an element of the KV store! Serving localhost:8001 for /favicon.ico ","text_count":738,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run kvWeb.go\nLoading /tmp/dataFile.gob\nUsing default port number:  :8001\nServing localhost:8001 for /\nServing localhost:8001 for /favicon.ico\nListing the contents of the KV store!\nServing localhost:8001 for /favicon.ico\nInserting an element to the KV store!\nServing localhost:8001 for /favicon.ico\nInserting an element to the KV store!\nAdd operation failed!\nServing localhost:8001 for /favicon.ico\nInserting an element to the KV store!\nServing localhost:8001 for /favicon.ico\nInserting an element to the KV store!\nSaving /tmp/dataFile.gob\nServing localhost:8001 for /favicon.ico\nInserting an element to the KV store!\nServing localhost:8001 for /favicon.ico\nChanging an element of the KV store!\nServing localhost:8001 for /favicon.ico"}]}]},{"block_type":"element","block":"k6pz2jxk","search_text":"Additionally, what is really interesting is how you can interact with kvWeb.go from a web browser. The home page of the website as defined in home.gohtml is shown in the following screenshot:","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, what is really interesting is how you can interact with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"from a web browser. The home page of the website as defined in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"home.gohtml"}]},{"block_type":"text","content":"is shown in the following screenshot:"}]},{"block_type":"element","block":"k6pz2jxl","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000022.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jxm","search_text":"The static home page of our web application","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The static home page of our web application"}]},{"block_type":"element","block":"k6pz2jxn","search_text":"The following screenshot presents the contents of the key-value store:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot presents the contents of the key-value store:"}]},{"block_type":"element","block":"k6pz2jxo","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000020.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jxp","search_text":"The contents of the key-value store","text_count":35,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The contents of the key-value store"}]},{"block_type":"element","block":"k6pz2jxq","search_text":"The following screenshot shows the appearance of the web page that allows you to add new data to the key-value store, using the web interface of the kvWeb.go web application:","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows the appearance of the web page that allows you to add new data to the key-value store, using the web interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"web application:"}]},{"block_type":"element","block":"k6pz2jxr","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000017.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jxs","search_text":"Adding a new entry to the key-value store","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Adding a new entry to the key-value store"}]},{"block_type":"element","block":"k6pz2jxt","search_text":"The following screenshot shows you how to update the value of an existing key, using the web interface of the kvWeb.go web application:","text_count":135,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following screenshot shows you how to update the value of an existing key, using the web interface of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"web application:"}]},{"block_type":"element","block":"k6pz2jxu","search_text":"","text_count":0,"tag_name":"p","attributes":{"class":"f-center"},"children":[{"block_type":"element","tag_name":"img","attributes":{"src":"https://learnable-static.s3.amazonaws.com/premium/reeedr/books/mastering-go/images/000005.png","class":"lazyload"},"children":[]}]},{"block_type":"element","block":"k6pz2jxv","search_text":"Updating the value of a key in the key-value store","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Updating the value of a key in the key-value store"}]},{"block_type":"element","block":"k6pz2jxw","search_text":"The kvWeb.go web application is far from perfect, so feel free to improve it as an exercise!","text_count":92,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"web application is far from perfect, so feel free to improve it as an exercise!"}]},{"block_type":"element","block":"k6pz2jxx","search_text":"Note This section illustrated how you can develop entire websites and web applications in Go. Although your requirements will undoubtedly vary, the techniques are the same as the ones used in kvWeb.go . Note that custom-made sites are considered more secure than sites created using some popular content management system. ","text_count":323,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section illustrated how you can develop entire websites and web applications in Go. Although your requirements will undoubtedly vary, the techniques are the same as the ones used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":". Note that custom-made sites are considered more secure than sites created using some popular content management system."}]}]},{"block_type":"element","block":"k6pz2jxy","search_text":"HTTP tracing","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"HTTP tracing"}]},{"block_type":"element","block":"k6pz2jxz","search_text":"Go supports HTTP tracing with the help of the net/http/httptrace standard package! This package allows you to trace the phases of an HTTP request. So, the use of the net/http/httptrace standard Go package will be illustrated in httpTrace.go , which will be presented in five parts.","text_count":281,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go supports"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"HTTP tracing"}]},{"block_type":"text","content":"with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"standard package! This&nbsp;package allows you to trace the phases of an HTTP request. So, the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"standard Go package will be illustrated in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":", which will be presented in five parts."}]},{"block_type":"element","block":"k6pz2jy0","search_text":"The first part of httpTrace.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jy1","search_text":"package main import ( \"fmt\" \"io\" \"net/http\" \"net/http/httptrace\" \"os\" ) ","text_count":72,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"net/http\" \n    \"net/http/httptrace\" \n    \"os\" \n)"}]}]},{"block_type":"element","block":"k6pz2jy2","search_text":"As you might expect, you need to import the net/http/httptrace package in order to enable HTTP tracing.","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you might expect, you need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"package in order to enable HTTP tracing."}]},{"block_type":"element","block":"k6pz2jy3","search_text":"The second part of httpTrace.go contains the following Go code:","text_count":63,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jy4","search_text":"func main() { if len(os.Args) != 2 { fmt.Printf(\"Usage: URL\\n\") return } URL := os.Args[1] client := http.Client{} ","text_count":115,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n        fmt.Printf(\"Usage: URL\\n\")\n        return \n    } \n \n    URL := os.Args[1] \n    client := http.Client{}"}]}]},{"block_type":"element","block":"k6pz2jy5","search_text":"In this part, we read the command-line arguments and create a new http.Client variable. As this is the first time you are seeing an http.Client object in action, we will talk a little bit more about it. The http.Client object offers a way to send a request to a server and get a reply. Its Transport field permits you to set various HTTP details instead of using the default values.","text_count":382,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this part, we read the command-line arguments and create a new"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"variable. As this is the first time you are seeing an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"object in action, we will talk a little bit more about it. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"object offers a way to send a request to a server and get a reply. Its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Transport"}]},{"block_type":"text","content":"field permits you to set various HTTP details instead of using the default values."}]},{"block_type":"element","block":"k6pz2jy6","search_text":"Note that you should never use the default values of the http.Client object in production software because these values do not specify request timeouts, which can jeopardize the performance of your programs and your goroutines. Moreover, by design, http.Client objects can be safely used in concurrent programs.","text_count":311,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that you should never use the default values of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"object in production software because these values do not specify request timeouts, which can jeopardize the performance of your programs and your goroutines. Moreover, by design,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"objects can be safely used in concurrent programs."}]},{"block_type":"element","block":"k6pz2jy7","search_text":"The third code segment of httpTrace.go is contained in the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"is contained in the following Go code:"}]},{"block_type":"element","block":"k6pz2jy8","search_text":"req, _ := http.NewRequest(\"GET\", URL, nil) trace := &httptrace.ClientTrace{ GotFirstResponseByte: func() { fmt.Println(\"First response byte!\") }, GotConn: func(connInfo httptrace.GotConnInfo) { fmt.Printf(\"Got Conn: %+v\\n\", connInfo) }, DNSDone: func(dnsInfo httptrace.DNSDoneInfo) { fmt.Printf(\"DNS Info: %+v\\n\", dnsInfo) }, ConnectStart: func(network, addr string) { fmt.Println(\"Dial start\") }, ConnectDone: func(network, addr string, err error) { fmt.Println(\"Dial done\") }, WroteHeaders: func() { fmt.Println(\"Wrote headers\") }, } ","text_count":536,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"req, _ := http.NewRequest(\"GET\", URL, nil) \ntrace := &amp;httptrace.ClientTrace{ \n    GotFirstResponseByte: func() { \n        fmt.Println(\"First response byte!\") \n    }, \n    GotConn: func(connInfo httptrace.GotConnInfo) { \n        fmt.Printf(\"Got Conn: %+v\\n\", connInfo) \n    }, \n    DNSDone: func(dnsInfo httptrace.DNSDoneInfo) { \n        fmt.Printf(\"DNS Info: %+v\\n\", dnsInfo) \n    }, \n    ConnectStart: func(network, addr string) { \n        fmt.Println(\"Dial start\") \n    }, \n    ConnectDone: func(network, addr string, err error) { \n        fmt.Println(\"Dial done\") \n    }, \n    WroteHeaders: func() { \n        fmt.Println(\"Wrote headers\") \n     }, \n}"}]}]},{"block_type":"element","block":"k6pz2jy9","search_text":"The preceding code is all about tracing HTTP requests. The httptrace.ClientTrace object defines the events that interest us. When such an event occurs, the relevant code is executed. You can find more information about the supported events and their purpose in the documentation of the net/http/httptrace package.","text_count":313,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code is all about tracing HTTP requests. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httptrace.ClientTrace"}]},{"block_type":"text","content":"object defines the events that interest us. When such an event occurs, the relevant code is executed. You can find more information about the supported events and their purpose in the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2jya","search_text":"The fourth part of the httpTrace.go utility follows next:","text_count":57,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"utility follows next:"}]},{"block_type":"element","block":"k6pz2jyb","search_text":"req = req.WithContext(httptrace.WithClientTrace(req.Context(), trace)) fmt.Println(\"Requesting data from server!\") _, err := http.DefaultTransport.RoundTrip(req) if err != nil { fmt.Println(err) return } ","text_count":204,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"req = req.WithContext(httptrace.WithClientTrace(req.Context(), trace)) \nfmt.Println(\"Requesting data from server!\") \n_, err := http.DefaultTransport.RoundTrip(req) \nif err != nil { \n    fmt.Println(err) \n    return \n}"}]}]},{"block_type":"element","block":"k6pz2jyc","search_text":"The httptrace.WithClientTrace() function returns a new context, based on the given parent context; while the http.DefaultTransport.RoundTrip() method wraps http.DefaultTransport.RoundTrip in order to tell it to keep track of the current request. Note that Go HTTP tracing is designed so that it can trace the events of a single http.Transport.RoundTrip . However, as you may have multiple URL redirects when serving a single HTTP request, you need to be able to identify the current request.","text_count":491,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httptrace.WithClientTrace()"}]},{"block_type":"text","content":"function returns a new context, based on the given parent context; while the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.DefaultTransport.RoundTrip()"}]},{"block_type":"text","content":"method wraps"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.DefaultTransport.RoundTrip"}]},{"block_type":"text","content":"in order to tell it to keep track of the current request. Note that Go HTTP tracing is designed so that it can trace the events of a single"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport.RoundTrip"}]},{"block_type":"text","content":". However, as you may have multiple URL redirects when serving a single HTTP request, you need to be able to identify the current request."}]},{"block_type":"element","block":"k6pz2jyd","search_text":"The remaining Go code of httpTrace.go is as followss:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"is as followss:"}]},{"block_type":"element","block":"k6pz2jye","search_text":"response, err := client.Do(req) if err != nil { fmt.Println(err) return","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"response, err := client.Do(req) \n    if err != nil { \n        fmt.Println(err) \n        return"}]}]},{"block_type":"element","block":"k6pz2jyf","search_text":"} io.Copy(os.Stdout, response.Body) } ","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} \n \n    io.Copy(os.Stdout, response.Body) \n}"}]}]},{"block_type":"element","block":"k6pz2jyg","search_text":"This last part is about performing the actual request to the web server using Do() , getting the HTTP data, and displaying it on the screen.","text_count":140,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This last part is about performing the actual request to the web server using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Do()"}]},{"block_type":"text","content":", getting the HTTP data, and displaying it on the screen."}]},{"block_type":"element","block":"k6pz2jyh","search_text":"Executing httpTrace.go will generate the following very informative output:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"will generate the following very informative output:"}]},{"block_type":"element","block":"k6pz2jyi","search_text":"$ go run httpTrace.go http://localhost:8001/ Requesting data from server! DNS Info: {Addrs:[{IP:::1 Zone:} {IP:127.0.0.1 Zone:}] Err:<nil> Coalesced:false} Dial start Dial done Got Conn: {Conn:0xc420142000 Reused:false WasIdle:false IdleTime:0s} Wrote headers First response byte! DNS Info: {Addrs:[{IP:::1 Zone:} {IP:127.0.0.1 Zone:}] Err:<nil> Coalesced:false} Dial start Dial done Got Conn: {Conn:0xc420142008 Reused:false WasIdle:false IdleTime:0s} Wrote headers First response byte! Serving: / ","text_count":499,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run httpTrace.go http://localhost:8001/\nRequesting data from server!\nDNS Info: {Addrs:[{IP:::1 Zone:} {IP:127.0.0.1 Zone:}] Err:&lt;nil&gt; Coalesced:false}\nDial start\nDial done\nGot Conn: {Conn:0xc420142000 Reused:false WasIdle:false IdleTime:0s}\nWrote headers\nFirst response byte!\nDNS Info: {Addrs:[{IP:::1 Zone:} {IP:127.0.0.1 Zone:}] Err:&lt;nil&gt; Coalesced:false}\nDial start\nDial done\nGot Conn: {Conn:0xc420142008 Reused:false WasIdle:false IdleTime:0s}\nWrote headers\nFirst response byte!\nServing: /"}]}]},{"block_type":"element","block":"k6pz2jyj","search_text":"Be aware that since httpTrace.go prints the full HTML response from the HTTP server, you might get lots of output when you test it on a real web server, which is the main reason for using the web server developed in www.go here.","text_count":228,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Be aware that since"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"prints the full HTML response from the HTTP server, you might get lots of output when you test it on a real web server, which is the main reason for using the web server developed in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"here."}]},{"block_type":"element","block":"k6pz2jyk","search_text":"Tip If you have the time to look at the source code of the net/http/httptrace package at https://golang.org/src/net/http/httptrace/trace.go , you will immediately realize that net/http/httptrace is a pretty low-level package that uses the context , reflect , and internal/nettrace packages to implement its functionality. ","text_count":322,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you have the time to look at the source code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/src/net/http/httptrace/trace.go"},"children":[{"block_type":"text","content":"https://golang.org/src/net/http/httptrace/trace.go"}]},{"block_type":"text","content":", you will immediately realize that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"is a pretty low-level package that uses the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":",&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reflect"}]},{"block_type":"text","content":", and&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"internal/nettrace"}]},{"block_type":"text","content":"packages to implement its functionality."}]}]},{"block_type":"element","block":"k6pz2jyl","search_text":"Testing HTTP handlers","text_count":21,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Testing HTTP handlers"}]},{"block_type":"element","block":"k6pz2jym","search_text":"In this section, we will learn how to test HTTP handlers in Go, which is a special case of testing in Go. We will begin with the Go code of www.go and modify it where needed.","text_count":174,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, we will&nbsp;learn how to test HTTP handlers in Go, which is a special case of testing in Go. We will begin with the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"and modify it where needed."}]},{"block_type":"element","block":"k6pz2jyn","search_text":"The new version of www.go is called testWWW.go , and it will be presented in three parts. The first code portion of testWWW.go is as follows:","text_count":141,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The new version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"www.go"}]},{"block_type":"text","content":"is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW.go"}]},{"block_type":"text","content":", and it will be presented in three parts. The first code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jyo","search_text":"package main import ( \"fmt\" \"net/http\" \"os\" ) func CheckStatusOK(w http.ResponseWriter, r *http.Request) { w.WriteHeader(http.StatusOK) fmt.Fprintf(w, `Fine!`) } ","text_count":162,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"os\" \n) \n \nfunc CheckStatusOK(w http.ResponseWriter, r *http.Request) { \n    w.WriteHeader(http.StatusOK) \n    fmt.Fprintf(w, `Fine!`) \n}"}]}]},{"block_type":"element","block":"k6pz2jyp","search_text":"The second part of testWWW.go is contained in the following Go code:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW.go"}]},{"block_type":"text","content":"is contained in the following Go code:"}]},{"block_type":"element","block":"k6pz2jyq","search_text":"func StatusNotFound(w http.ResponseWriter, r *http.Request) { w.WriteHeader(http.StatusNotFound) } func MyHandler(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served: %s\\n\", r.Host) } ","text_count":237,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func StatusNotFound(w http.ResponseWriter, r *http.Request) { \n    w.WriteHeader(http.StatusNotFound) \n} \n \nfunc MyHandler(w http.ResponseWriter, r *http.Request) { \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2jyr","search_text":"The remaining Go code of testWWW.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2jys","search_text":"func main() { PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Using default port number: \", PORT) } else { PORT = \":\" + arguments[1] } http.HandleFunc(\"/CheckStatusOK\", CheckStatusOK) http.HandleFunc(\"/StatusNotFound\", StatusNotFound) http.HandleFunc(\"/\", MyHandler) err := http.ListenAndServe(PORT, nil) if err != nil { fmt.Println(err)","text_count":364,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Using default port number: \", PORT) \n    } else { \n        PORT = \":\" + arguments[1] \n    } \n \n    http.HandleFunc(\"/CheckStatusOK\", CheckStatusOK) \n    http.HandleFunc(\"/StatusNotFound\", StatusNotFound) \n    http.HandleFunc(\"/\", MyHandler) \n \n    err := http.ListenAndServe(PORT, nil) \n    if err != nil { \n        fmt.Println(err)"}]}]},{"block_type":"element","block":"k6pz2jyt","search_text":"return } } ","text_count":11,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"return \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jyu","search_text":"We now need to start testing testWWW.go , which means that we should create a testWWW_test.go file. The contents of that file will be presented in four parts.","text_count":158,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We now need to start testing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW.go"}]},{"block_type":"text","content":", which means that we should create a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"file. The contents of that file will be presented in four parts."}]},{"block_type":"element","block":"k6pz2jyv","search_text":"The first part of testWWW_test.go is contained in the following Go code:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"is contained in the following Go code:"}]},{"block_type":"element","block":"k6pz2jyw","search_text":"package main import ( \"fmt\" \"net/http\" \"net/http/httptest\" \"testing\" ) ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"net/http/httptest\" \n    \"testing\" \n)"}]}]},{"block_type":"element","block":"k6pz2jyx","search_text":"Notice that you need to import the net/http/httptest standard Go package in order to test web applications in Go.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Notice that you need to import the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptest"}]},{"block_type":"text","content":"standard Go package in order to test web applications in Go."}]},{"block_type":"element","block":"k6pz2jyy","search_text":"The second code portion of testWWW_test.go contains the following code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2jyz","search_text":"func TestCheckStatusOK(t *testing.T) { req, err := http.NewRequest(\"GET\", \"/CheckStatusOK\", nil) if err != nil { fmt.Println(err) return } rr := httptest.NewRecorder() handler := http.HandlerFunc(CheckStatusOK) handler.ServeHTTP(rr, req) ","text_count":238,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func TestCheckStatusOK(t *testing.T) { \n    req, err := http.NewRequest(\"GET\", \"/CheckStatusOK\", nil) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    rr := httptest.NewRecorder() \n    handler := http.HandlerFunc(CheckStatusOK) \n    handler.ServeHTTP(rr, req)"}]}]},{"block_type":"element","block":"k6pz2jz0","search_text":"The httptest.NewRecorder() function returns an httptest.ResponseRecorder object, and it is used for recording the HTTP response.","text_count":128,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httptest.NewRecorder()"}]},{"block_type":"text","content":"function returns an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httptest.ResponseRecorder"}]},{"block_type":"text","content":"object, and it is used for recording the HTTP response."}]},{"block_type":"element","block":"k6pz2jz1","search_text":"The third part of testWWW_test.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jz2","search_text":"status := rr.Code if status != http.StatusOK { t.Errorf(\"handler returned %v\", status) } expect := `Fine!` if rr.Body.String() != expect {","text_count":138,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"status := rr.Code \n    if status != http.StatusOK { \n        t.Errorf(\"handler returned %v\", status) \n    } \n \n    expect := `Fine!` \n    if rr.Body.String() != expect {"}]}]},{"block_type":"element","block":"k6pz2jz3","search_text":"t.Errorf(\"handler returned %v\", rr.Body.String()) } } ","text_count":54,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"t.Errorf(\"handler returned %v\", rr.Body.String()) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jz4","search_text":"You first check that the response code is as expected, and then you verify that the body of the response is also what you expected.","text_count":131,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You first check that the response code is as expected, and then you verify that the body of the response is also what you expected."}]},{"block_type":"element","block":"k6pz2jz5","search_text":"The remaining Go code of testWWW_test.go is as follows:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jz6","search_text":"func TestStatusNotFound(t *testing.T) { req, err := http.NewRequest(\"GET\", \"/StatusNotFound\", nil) if err != nil { fmt.Println(err) return } rr := httptest.NewRecorder() handler := http.HandlerFunc(StatusNotFound) handler.ServeHTTP(rr, req) status := rr.Code if status != http.StatusNotFound { t.Errorf(\"handler returned %v\", status) } } ","text_count":338,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func TestStatusNotFound(t *testing.T) { \n    req, err := http.NewRequest(\"GET\", \"/StatusNotFound\", nil) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    rr := httptest.NewRecorder() \n    handler := http.HandlerFunc(StatusNotFound) \n    handler.ServeHTTP(rr, req) \n \n    status := rr.Code \n    if status != http.StatusNotFound { \n        t.Errorf(\"handler returned %v\", status) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jz7","search_text":"This test function verifies that the StatusNotFound() function of the main package works as expected.","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This test function verifies that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"StatusNotFound()"}]},{"block_type":"text","content":"function of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"main"}]},{"block_type":"text","content":"package works as expected."}]},{"block_type":"element","block":"k6pz2jz8","search_text":"Executing the two test functions of testWWW_test.go will generate the following output:","text_count":87,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing the two test functions of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"testWWW_test.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2jz9","search_text":"$ go test testWWW.go testWWW_test.go -v === RUN TestCheckStatusOK --- PASS: TestCheckStatusOK (0.00s) === RUN TestStatusNotFound --- PASS: TestStatusNotFound (0.00s) PASS ok command-line-arguments (cached) ","text_count":206,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go test  testWWW.go testWWW_test.go  -v\n=== RUN   TestCheckStatusOK\n--- PASS: TestCheckStatusOK (0.00s)\n=== RUN   TestStatusNotFound\n--- PASS: TestStatusNotFound (0.00s)\nPASS\nok    command-line-arguments  (cached)"}]}]},{"block_type":"element","block":"k6pz2jza","search_text":"Creating a web client in Go","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Creating a web client in Go"}]},{"block_type":"element","block":"k6pz2jzb","search_text":"In this section, you will learn more about developing web clients in Go. The name of the web client utility is webClient.go , and it will be presented in four parts.","text_count":165,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn more about developing web clients in Go. The name of the web client utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2jzc","search_text":"The first part of webClient.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jzd","search_text":"package main import ( \"fmt\" \"io\" \"net/http\" \"os\" \"path/filepath\" ) ","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"net/http\" \n    \"os\" \n    \"path/filepath\" \n)"}]}]},{"block_type":"element","block":"k6pz2jze","search_text":"The second part of webClient.go is where you read the desired URL as a command-line argument:","text_count":93,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":"is where you read the desired URL as a command-line argument:"}]},{"block_type":"element","block":"k6pz2jzf","search_text":"func main() { if len(os.Args) != 2 { fmt.Printf(\"Usage: %s URL\\n\", filepath.Base(os.Args[0])) return } URL := os.Args[1] ","text_count":121,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n        fmt.Printf(\"Usage: %s URL\\n\", filepath.Base(os.Args[0])) \n        return \n    } \n \n    URL := os.Args[1]"}]}]},{"block_type":"element","block":"k6pz2jzg","search_text":"The third code portion of webClient.go , is where the real action takes place:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":", is where the real action takes place:"}]},{"block_type":"element","block":"k6pz2jzh","search_text":"data, err := http.Get(URL) if err != nil { fmt.Println(err) return ","text_count":67,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"data, err := http.Get(URL) \n \nif err != nil { \n    fmt.Println(err) \n    return"}]}]},{"block_type":"element","block":"k6pz2jzi","search_text":"All of the work is done by the http.Get() call, which is pretty convenient when you do not want to deal with parameters and options. However, this type of call gives you no flexibility over the process. Note that http.Get() returns an http.Response variable.","text_count":258,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"All of the work is done by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"call, which is pretty convenient when you do not want to deal with parameters and options. However, this type of call gives you no flexibility over the process. Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"returns an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2jzj","search_text":"The remaining Go code is as follows:","text_count":36,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code is as follows:"}]},{"block_type":"element","block":"k6pz2jzk","search_text":"} else { defer data.Body.Close() _, err := io.Copy(os.Stdout, data.Body) if err != nil { fmt.Println(err) return } } } ","text_count":119,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"} else { \n        defer data.Body.Close() \n        _, err := io.Copy(os.Stdout, data.Body) \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2jzl","search_text":"What the previous code does is to copy the contents of the Body field of the http.Response structure to standard output.","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What the previous code does is to copy the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Body"}]},{"block_type":"text","content":"field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"structure to standard output."}]},{"block_type":"element","block":"k6pz2jzm","search_text":"Executing webClient.go will generate the following type of output:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":"will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2jzn","search_text":"Tip Only a small portion of the output is presented here. ","text_count":58,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Only a small portion of the output is presented here."}]}]},{"block_type":"element","block":"k6pz2jzo","search_text":"$ go run webClient.go http://www.mtsoukalos.eu/ | head -20 <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML+RDFa 1.0//EN\" \"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" version=\"XHTML+RDFa 1.0\" dir=\"ltr\" xmlns:content=\"http://purl.org/rss/1.0/modules/content/\" xmlns:dc=\"http://purl.org/dc/terms/\" xmlns:foaf=\"http://xmlns.com/foaf/0.1/\" xmlns:og=\"http://ogp.me/ns#\" xmlns:rdfs=\"http://www.w3.org/2000/01/rdf-schema#\" xmlns:sioc=\"http://rdfs.org/sioc/ns#\" xmlns:sioct=\"http://rdfs.org/sioc/types#\" xmlns:skos=\"http://www.w3.org/2004/02/skos/core#\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema#\"> <head profile=\"http://www.w3.org/1999/xhtml/vocab\"> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /> <link rel=\"shortcut icon\" href=\"http://www.mtsoukalos.eu/misc/favicon.ico\" type=\"image/vnd.microsoft.icon\" /> <meta name=\"HandheldFriendly\" content=\"true\" /> <meta name=\"MobileOptimized\" content=\"width\" /> <meta name=\"Generator\" content=\"Drupal 7 (http://drupal.org)\" />","text_count":1109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run webClient.go http://www.mtsoukalos.eu/ | head -20\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML+RDFa 1.0//EN\"\n\"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" version=\"XHTML+RDFa 1.0\" dir=\"ltr\"\nxmlns:content=\"http://purl.org/rss/1.0/modules/content/\"\nxmlns:dc=\"http://purl.org/dc/terms/\"\nxmlns:foaf=\"http://xmlns.com/foaf/0.1/\"\nxmlns:og=\"http://ogp.me/ns#\"\nxmlns:rdfs=\"http://www.w3.org/2000/01/rdf-schema#\"\nxmlns:sioc=\"http://rdfs.org/sioc/ns#\"\nxmlns:sioct=\"http://rdfs.org/sioc/types#\"\nxmlns:skos=\"http://www.w3.org/2004/02/skos/core#\"\n      xmlns:xsd=\"http://www.w3.org/2001/XMLSchema#\"&gt;\n    \n&lt;head profile=\"http://www.w3.org/1999/xhtml/vocab\"&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /&gt;\n&lt;link rel=\"shortcut icon\" href=\"http://www.mtsoukalos.eu/misc/favicon.ico\" type=\"image/vnd.microsoft.icon\" /&gt;\n&lt;meta name=\"HandheldFriendly\" content=\"true\" /&gt;\n&lt;meta name=\"MobileOptimized\" content=\"width\" /&gt;\n&lt;meta name=\"Generator\" content=\"Drupal 7 (http://drupal.org)\" /&gt;"}]}]},{"block_type":"element","block":"k6pz2jzp","search_text":"The main problem with webClient.go is that it gives you almost no control over the process—you either get the entire HTML output or nothing at all!","text_count":147,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The main problem with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"webClient.go"}]},{"block_type":"text","content":"is that it gives you almost no control over the process&mdash;you either get the entire HTML output or nothing at all!"}]},{"block_type":"element","block":"k6pz2jzq","search_text":"Making your Go web client more advanced","text_count":39,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Making your Go web client more advanced"}]},{"block_type":"element","block":"k6pz2jzr","search_text":"As the web client of the previous section is relatively simplistic and does not give you any flexibility, in this section you will learn how to read a URL more elegantly without using the http.Get() function and by having more options. The name of the utility is advancedWebClient.go , and it will be presented in five parts.","text_count":325,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As the web client of the previous section is relatively simplistic and does not give you any flexibility, in this section you will learn how to read a URL more elegantly without using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"function and by having more options. The name of the utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":", and it will be presented in five parts."}]},{"block_type":"element","block":"k6pz2jzs","search_text":"The first code segment of advancedWebClient.go contains the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jzt","search_text":"package main import ( \"fmt\" \"net/http\" \"net/http/httputil\" \"net/url\" \"os\" \"path/filepath\" \"strings\" \"time\" ) ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"net/http/httputil\" \n    \"net/url\" \n    \"os\" \n    \"path/filepath\" \n    \"strings\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2jzu","search_text":"The second part of advancedWebClient.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2jzv","search_text":"func main() { if len(os.Args) != 2 { fmt.Printf(\"Usage: %s URL\\n\", filepath.Base(os.Args[0])) return } URL, err := url.Parse(os.Args[1]) if err != nil { fmt.Println(\"Error in parsing:\", err) return } ","text_count":200,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) != 2 { \n        fmt.Printf(\"Usage: %s URL\\n\", filepath.Base(os.Args[0])) \n        return \n   } \n \n   URL, err := url.Parse(os.Args[1]) \n   if err != nil { \n       fmt.Println(\"Error in parsing:\", err) \n       return \n   }"}]}]},{"block_type":"element","block":"k6pz2jzw","search_text":"The third code portion of advancedWebClient.go contains the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2jzx","search_text":"c := &http.Client{ Timeout: 15 * time.Second, } request, err := http.NewRequest(\"GET\", URL.String(), nil) if err != nil { fmt.Println(\"Get:\", err) return } httpData, err := c.Do(request) if err != nil { fmt.Println(\"Error in Do():\", err) return } ","text_count":247,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"c := &amp;http.Client{ \n    Timeout: 15 * time.Second, \n} \nrequest, err := http.NewRequest(\"GET\", URL.String(), nil) \nif err != nil { \n    fmt.Println(\"Get:\", err) \n    return \n} \n \nhttpData, err := c.Do(request) \nif err != nil { \n    fmt.Println(\"Error in Do():\", err) \n    return \n}"}]}]},{"block_type":"element","block":"k6pz2jzy","search_text":"The http.NewRequest() function returns an http.Request object given a method, a URL, and an optional body. The http.Do() function sends an HTTP request ( http.Request ) using an http.Client and gets an HTTP response ( http.Response ). So, http.Do() does the job of http.Get() in a more comprehensive way.","text_count":304,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewRequest()"}]},{"block_type":"text","content":"function returns an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":"object given a method, a URL, and an optional body. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Do()"}]},{"block_type":"text","content":"function sends an HTTP request ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":") using an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"and gets an HTTP response ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":"). So,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Do()"}]},{"block_type":"text","content":"does the job of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"in a more comprehensive way."}]},{"block_type":"element","block":"k6pz2jzz","search_text":"The GET string used in http.NewRequest() can be replaced with http.MethodGet .","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"GET"}]},{"block_type":"text","content":"&nbsp;string used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.NewRequest()"}]},{"block_type":"text","content":"can be replaced with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.MethodGet"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k00","search_text":"The fourth part of advancedWebClient.go is contained in the following Go code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"is contained in the following Go code:"}]},{"block_type":"element","block":"k6pz2k01","search_text":"fmt.Println(\"Status code:\", httpData.Status) header, _ := httputil.DumpResponse(httpData, false) fmt.Print(string(header)) contentType := httpData.Header.Get(\"Content-Type\") characterSet := strings.SplitAfter(contentType, \"charset=\") if len(characterSet) > 1 { fmt.Println(\"Character Set:\", characterSet[1]) } if httpData.ContentLength == -1 { fmt.Println(\"ContentLength is unknown!\") } else { fmt.Println(\"ContentLength:\", httpData.ContentLength) } ","text_count":450,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"fmt.Println(\"Status code:\", httpData.Status) \nheader, _ := httputil.DumpResponse(httpData, false) \nfmt.Print(string(header)) \n \ncontentType := httpData.Header.Get(\"Content-Type\") \ncharacterSet := strings.SplitAfter(contentType, \"charset=\") \nif len(characterSet) &gt; 1 { \n    fmt.Println(\"Character Set:\", characterSet[1]) \n} \n \nif httpData.ContentLength == -1 { \n    fmt.Println(\"ContentLength is unknown!\") \n} else { \n    fmt.Println(\"ContentLength:\", httpData.ContentLength) \n}"}]}]},{"block_type":"element","block":"k6pz2k02","search_text":"In the preceding code, you can see how to start searching the server response in order to find what you want.","text_count":109,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see how to start searching the server response in order to find what you want."}]},{"block_type":"element","block":"k6pz2k03","search_text":"The last part of the advancedWebClient.go utility is as follows:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"utility is as follows:"}]},{"block_type":"element","block":"k6pz2k04","search_text":"length := 0 var buffer [1024]byte r := httpData.Body for { n, err := r.Read(buffer[0:]) if err != nil { fmt.Println(err) break } length = length + n } fmt.Println(\"Calculated response data length:\", length) } ","text_count":209,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"length := 0 \n    var buffer [1024]byte \n    r := httpData.Body \n    for { \n        n, err := r.Read(buffer[0:]) \n        if err != nil { \n               fmt.Println(err) \n               break \n        } \n        length = length + n \n    } \n    fmt.Println(\"Calculated response data length:\", length) \n}"}]}]},{"block_type":"element","block":"k6pz2k05","search_text":"In the preceding code, you can see a technique for discovering the size of the server HTTP response. If you want to display the HTML output on your screen, you can print the contents of the r buffer variable.","text_count":208,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see a technique for discovering the size of the server HTTP response. If you want to display the HTML output on your screen, you can print the contents of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"r"}]},{"block_type":"text","content":"buffer variable."}]},{"block_type":"element","block":"k6pz2k06","search_text":"Using advancedWebClient.go for visiting a web page will generate the following output, which is much richer than before:","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"for visiting a web page will generate the following output, which is much richer than before:"}]},{"block_type":"element","block":"k6pz2k07","search_text":"$ go run advancedWebClient.go http://www.mtsoukalos.eu Status code: 200 OK HTTP/1.1 200 OK Accept-Ranges: bytes Age: 0 Cache-Control: no-cache, must-revalidate Connection: keep-alive Content-Language: en Content-Type: text/html; charset=utf-8 Date: Sat, 24 Mar 2018 18:52:17 GMT Expires: Sun, 19 Nov 1978 05:00:00 GMT Server: Apache/2.4.25 (Debian) PHP/5.6.33-0+deb8u1 mod_wsgi/4.5.11 Python/2.7 Vary: Accept-Encoding Via: 1.1 varnish (Varnish/5.0) X-Content-Type-Options: nosniff X-Frame-Options: SAMEORIGIN X-Generator: Drupal 7 (http://drupal.org) X-Powered-By: PHP/5.6.33-0+deb8u1 X-Varnish: 886025 Character Set: utf-8 ContentLength is unknown! EOF Calculated response data length: 50176 ","text_count":693,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run advancedWebClient.go http://www.mtsoukalos.eu\nStatus code: 200 OK\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nAge: 0\nCache-Control: no-cache, must-revalidate\nConnection: keep-alive\nContent-Language: en\nContent-Type: text/html; charset=utf-8\nDate: Sat, 24 Mar 2018 18:52:17 GMT\nExpires: Sun, 19 Nov 1978 05:00:00 GMT\nServer: Apache/2.4.25 (Debian) PHP/5.6.33-0+deb8u1 mod_wsgi/4.5.11 Python/2.7\nVary: Accept-Encoding\nVia: 1.1 varnish (Varnish/5.0)\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-Generator: Drupal 7 (http://drupal.org)\nX-Powered-By: PHP/5.6.33-0+deb8u1\nX-Varnish: 886025\n    \nCharacter Set: utf-8\nContentLength is unknown!\nEOF\nCalculated response data length: 50176"}]}]},{"block_type":"element","block":"k6pz2k08","search_text":"Executing advancedWebClient.go for visiting a different URL will return a slightly different output:","text_count":100,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"for visiting a different URL will return a slightly different output:"}]},{"block_type":"element","block":"k6pz2k09","search_text":"$ go run advancedWebClient.go http://www.google.com Status code: 200 OK HTTP/1.1 200 OK Cache-Control: private, max-age=0 Content-Type: text/html; charset=ISO-8859-7 Date: Sat, 24 Mar 2018 18:52:38 GMT Expires: -1 P3p: CP=\"This is not a P3P policy! See g.co/p3phelp for more info.\" Server: gws Set-Cookie: 1P_JAR=2018-03-24-18; expires=Mon, 23-Apr-2018 18:52:38 GMT; path=/; domain=.google.gr Set-Cookie: NID=126=csX1_koD30SJcC_ljAfcM2V8kTfRkppmAamLjINLfclracMxuk6JGe4glc0Pjs8uD00bqGaxkSW-J-ZNDJexG2ZX9pNB9E_dRc2y1KZ05V7pk0bOczE2FtS1zb50Uofl; expires=Sun, 23-Sep-2018 18:52:38 GMT; path=/; domain=.google.gr; HttpOnly X-Frame-Options: SAMEORIGIN X-Xss-Protection: 1; mode=block Character Set: ISO-8859-7 ContentLength in unknown! EOF Calculated response data length: 10240 ","text_count":773,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run advancedWebClient.go http://www.google.com\nStatus code: 200 OK\nHTTP/1.1 200 OK\nCache-Control: private, max-age=0\nContent-Type: text/html; charset=ISO-8859-7\nDate: Sat, 24 Mar 2018 18:52:38 GMT\nExpires: -1\nP3p: CP=\"This is not a P3P policy! See g.co/p3phelp for more info.\"\nServer: gws\nSet-Cookie: 1P_JAR=2018-03-24-18; expires=Mon, 23-Apr-2018 18:52:38 GMT; path=/; domain=.google.gr\nSet-Cookie: NID=126=csX1_koD30SJcC_ljAfcM2V8kTfRkppmAamLjINLfclracMxuk6JGe4glc0Pjs8uD00bqGaxkSW-J-ZNDJexG2ZX9pNB9E_dRc2y1KZ05V7pk0bOczE2FtS1zb50Uofl; expires=Sun, 23-Sep-2018 18:52:38 GMT; path=/; domain=.google.gr; HttpOnly\nX-Frame-Options: SAMEORIGIN\nX-Xss-Protection: 1; mode=block\n    \nCharacter Set: ISO-8859-7\nContentLength in unknown!\nEOF\nCalculated response data length: 10240"}]}]},{"block_type":"element","block":"k6pz2k0a","search_text":"If you try to fetch an erroneous URL with advancedWebClient.go , you will get the following output:","text_count":99,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to fetch an erroneous URL with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":", you will get the following output:"}]},{"block_type":"element","block":"k6pz2k0b","search_text":"$ go run advancedWebClient.go http://www.google Error in Do(): Get http://www.google: dial tcp: lookup www.google: no such host $ go run advancedWebClient.go www.google.com Error in Do(): Get www.google.com: unsupported protocol scheme \"\" ","text_count":239,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run advancedWebClient.go http://www.google\nError in Do(): Get http://www.google: dial tcp: lookup www.google: no such host\n$ go run advancedWebClient.go www.google.com\nError in Do(): Get www.google.com: unsupported protocol scheme \"\""}]}]},{"block_type":"element","block":"k6pz2k0c","search_text":"Feel free to make any changes you want to advancedWebClient.go in order to make the output match your requirements!","text_count":115,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Feel free to make any changes you want to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"in order to make the output match your requirements!"}]},{"block_type":"element","block":"k6pz2k0d","search_text":"Timing out HTTP connections","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Timing out HTTP connections"}]},{"block_type":"element","block":"k6pz2k0e","search_text":"This section will present a technique for timing out network connections that take too long to finish. Remember that you already know such a technique from Chapter 10, Go Concurrency – Advanced Topics , when we talked about the context standard Go package. This technique was presented in the useContext.go source code file.","text_count":324,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will present a technique for timing out network connections that take too long to finish. Remember that you already know such a technique from Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go Concurrency&nbsp;&ndash;&nbsp;Advanced Topics"}]},{"block_type":"text","content":", when we talked about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"context"}]},{"block_type":"text","content":"standard Go package. This technique was presented in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"useContext.go"}]},{"block_type":"text","content":"source code file."}]},{"block_type":"element","block":"k6pz2k0f","search_text":"The method that will be presented in this section is much easier to implement. The relevant code is saved in clientTimeOut.go , and it will be presented in four parts. The utility accepts two command-line arguments, which are the URL and the timeout period in seconds. Note that the second parameter is optional.","text_count":312,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The method that will be presented in this section is much easier to implement. The relevant code is saved in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The utility accepts two command-line arguments, which are the URL and the timeout period in seconds. Note that the second parameter is optional."}]},{"block_type":"element","block":"k6pz2k0g","search_text":"The first part code portion of clientTimeOut.go is as follows:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k0h","search_text":"package main import ( \"fmt\" \"io\" \"net\" \"net/http\" \"os\" \"path/filepath\" \"strconv\" \"time\" ) var timeout = time.Duration(time.Second) ","text_count":131,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"net\" \n    \"net/http\" \n    \"os\" \n    \"path/filepath\" \n    \"strconv\" \n    \"time\" \n) \n \nvar timeout = time.Duration(time.Second)"}]}]},{"block_type":"element","block":"k6pz2k0i","search_text":"The second code segment of clientTimeOut.go contains the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k0j","search_text":"func Timeout(network, host string) (net.Conn, error) { conn, err := net.DialTimeout(network, host, timeout) if err != nil { return nil, err } conn.SetDeadline(time.Now().Add(timeout)) return conn, nil } ","text_count":203,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func Timeout(network, host string) (net.Conn, error) { \n    conn, err := net.DialTimeout(network, host, timeout) \n    if err != nil { \n         return nil, err \n    } \n    conn.SetDeadline(time.Now().Add(timeout)) \n    return conn, nil \n}"}]}]},{"block_type":"element","block":"k6pz2k0k","search_text":"You will learn more about the functionality of SetDeadline() in the next subsection. The Timeout() function will be used by the Dial field of a http.Transport variable.","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You will learn more about the functionality of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SetDeadline()"}]},{"block_type":"text","content":"in the next subsection. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Timeout()"}]},{"block_type":"text","content":"function will be used by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Dial"}]},{"block_type":"text","content":"field of a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2k0l","search_text":"The third code portion of clientTimeOut.go is contained in the following code:","text_count":78,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"is contained in the following code:"}]},{"block_type":"element","block":"k6pz2k0m","search_text":"func main() { if len(os.Args) == 1 { fmt.Printf(\"Usage: %s URL TIMEOUT\\n\", filepath.Base(os.Args[0])) return } if len(os.Args) == 3 { temp, err := strconv.Atoi(os.Args[2]) if err != nil { fmt.Println(\"Using Default Timeout!\") } else { timeout = time.Duration(time.Duration(temp) * time.Second) } } URL := os.Args[1] t := http.Transport{ Dial: Timeout, }","text_count":353,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) == 1 { \n        fmt.Printf(\"Usage: %s URL TIMEOUT\\n\", filepath.Base(os.Args[0])) \n        return \n    } \n \n    if len(os.Args) == 3 { \n        temp, err := strconv.Atoi(os.Args[2]) \n        if err != nil { \n               fmt.Println(\"Using Default Timeout!\") \n        } else { \n               timeout = time.Duration(time.Duration(temp) * time.Second) \n        } \n    } \n \n    URL := os.Args[1] \n    t := http.Transport{\n        Dial: Timeout,\n    }"}]}]},{"block_type":"element","block":"k6pz2k0n","search_text":"The remaining Go code of the clientTimeOut.go utility is as follows:","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"utility is as follows:"}]},{"block_type":"element","block":"k6pz2k0o","search_text":"client := http.Client{ Transport: &t, } data, err := client.Get(URL) if err != nil { fmt.Println(err) return } else { defer data.Body.Close() _, err := io.Copy(os.Stdout, data.Body) if err != nil { fmt.Println(err) return } } } ","text_count":228,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"client := http.Client{ \n        Transport: &amp;t, \n    } \n \n    data, err := client.Get(URL) \n    if err != nil { \n        fmt.Println(err) \n         return \n    } else { \n        defer data.Body.Close() \n        _, err := io.Copy(os.Stdout, data.Body) \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k0p","search_text":"The clientTimeOut.go web client will be tested using the slowWWW.go web server developed in Chapter 10, Go Concurrency – Advanced Topics .","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"web client will be tested using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":"web server developed in Chapter 10,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"&nbsp;Go Concurrency&nbsp;&ndash; Advanced Topics"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k0q","search_text":"Executing clientTimeOut.go two times will generate the following output:","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"clientTimeOut.go"}]},{"block_type":"text","content":"two times will generate the following output:"}]},{"block_type":"element","block":"k6pz2k0r","search_text":"$ go run clientTimeOut.go http://localhost:8001 Serving: / Delay: 0 $ go run clientTimeOut.go http://localhost:8001 Get http://localhost:8001: read tcp [::1]:57397->[::1]:8001: i/o timeout ","text_count":189,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run clientTimeOut.go http://localhost:8001\nServing: /\nDelay: 0\n$ go run clientTimeOut.go http://localhost:8001\nGet http://localhost:8001: read tcp [::1]:57397-&gt;[::1]:8001: i/o timeout"}]}]},{"block_type":"element","block":"k6pz2k0s","search_text":"As you can see from the generated output, the first request had no problem connecting to the desired web server. However, the second http.Get() request took longer than expected and therefore timed out!","text_count":202,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you can see from the generated output, the first request had no problem connecting to the desired web server. However, the second"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Get()"}]},{"block_type":"text","content":"request took longer than expected and therefore timed out!"}]},{"block_type":"element","block":"k6pz2k0t","search_text":"More information about SetDeadline","text_count":34,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"More information about SetDeadline"}]},{"block_type":"element","block":"k6pz2k0u","search_text":"The SetDeadline() function is used by the net package to set the read and write deadlines of a given network connection. Due to the way the SetDeadline() function works, you will need to call SetDeadline() before any read or write operations. Keep in mind that Go uses deadlines to implement timeouts, so you do not need to reset it every time your application receives or sends any data.","text_count":388,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SetDeadline()"}]},{"block_type":"text","content":"function is used by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package to set the read and write deadlines of a given network connection. Due to the way the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SetDeadline()"}]},{"block_type":"text","content":"function works, you will need to call"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"SetDeadline()"}]},{"block_type":"text","content":"before any read or write operations. Keep in mind that Go uses deadlines to implement timeouts, so you do not need to reset it every time your application receives or sends any data."}]},{"block_type":"element","block":"k6pz2k0v","search_text":"Setting the timeout period on the server side","text_count":45,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Setting the timeout period on the server side"}]},{"block_type":"element","block":"k6pz2k0w","search_text":"In this subsection, you will learn how to time out a connection on the server side. You need to do this because there are times that clients take much longer than expected to end an HTTP connection. This usually happens for two reasons: the first reason is when there are bugs in the client software, and the second reason is when a server process is experiencing an attack!","text_count":374,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to time out a connection on the server side. You need to do this because there are times that clients take much longer than expected to end an HTTP connection. This usually happens for two reasons: the first reason is when there are bugs in the client software, and the second reason is when a server process is experiencing an attack!"}]},{"block_type":"element","block":"k6pz2k0x","search_text":"The technique will be implemented in the serverTimeOut.go source code file, which will be presented in four parts.","text_count":114,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The technique will be implemented in the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"source code file, which will be presented in four parts."}]},{"block_type":"element","block":"k6pz2k0y","search_text":"The first part of serverTimeOut.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k0z","search_text":"package main import ( \"fmt\" \"net/http\" \"os\" \"time\" ) func myHandler(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served: %s\\n\", r.Host) } ","text_count":191,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/http\" \n    \"os\" \n    \"time\" \n) \n \nfunc myHandler(w http.ResponseWriter, r *http.Request) { \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2k10","search_text":"The second code portion of serverTimeOut.go contains the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k11","search_text":"func timeHandler(w http.ResponseWriter, r *http.Request) { t := time.Now().Format(time.RFC1123) Body := \"The current time is:\" fmt.Fprintf(w, \"<h1 align=\\\"center\">%s</h1>\", Body) fmt.Fprintf(w, \"<h2 align=\\\"center\">%s</h2>n\", t) fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) fmt.Printf(\"Served time for: %s\\n\", r.Host) } ","text_count":319,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func timeHandler(w http.ResponseWriter, r *http.Request) { \n    t := time.Now().Format(time.RFC1123) \n    Body := \"The current time is:\" \n    fmt.Fprintf(w, \"&lt;h1 align=\\\"center\"&gt;%s&lt;/h1&gt;\", Body) \n    fmt.Fprintf(w, \"&lt;h2 align=\\\"center\"&gt;%s&lt;/h2&gt;n\", t) \n    fmt.Fprintf(w, \"Serving: %s\\n\", r.URL.Path) \n    fmt.Printf(\"Served time for: %s\\n\", r.Host) \n}"}]}]},{"block_type":"element","block":"k6pz2k12","search_text":"The third code segment of serverTimeOut.go is shown in the following Go code:","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2k13","search_text":"func main() { PORT := \":8001\" arguments := os.Args if len(arguments) == 1 { fmt.Printf(\"Listening on http://0.0.0.0%s\\n\", PORT) } else { PORT = \":\" + arguments[1] fmt.Printf(\"Listening on http://0.0.0.0%s\\n\", PORT) } m := http.NewServeMux() srv := &http.Server{ Addr: PORT, Handler: m, ReadTimeout: 3 * time.Second, WriteTimeout: 3 * time.Second, } ","text_count":349,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    PORT := \":8001\" \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Printf(\"Listening on http://0.0.0.0%s\\n\", PORT) \n    } else { \n        PORT = \":\" + arguments[1] \n        fmt.Printf(\"Listening on http://0.0.0.0%s\\n\", PORT) \n    } \n \n    m := http.NewServeMux() \n    srv := &amp;http.Server{ \n        Addr:         PORT, \n        Handler:      m, \n        ReadTimeout:  3 * time.Second, \n        WriteTimeout: 3 * time.Second, \n   }"}]}]},{"block_type":"element","block":"k6pz2k14","search_text":"In this case, we are using an http.Server structure that supports two kinds of timeouts with its fields. The first one is called ReadTimeout , and the second one is called WriteTimeout . The value of the ReadTimeout field specifies the maximum duration for reading the entire request, including the body.","text_count":304,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this case, we are using an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Server"}]},{"block_type":"text","content":"structure that supports two kinds of timeouts with its fields. The first one is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ReadTimeout"}]},{"block_type":"text","content":", and the second one is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"WriteTimeout"}]},{"block_type":"text","content":". The value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ReadTimeout"}]},{"block_type":"text","content":"field specifies the maximum duration for reading the entire request, including the body."}]},{"block_type":"element","block":"k6pz2k15","search_text":"The value of the WriteTimeout field specifies the maximum duration before timing out writes of the response. Put simply, this is the time from the end of the request header read to the end of the response write.","text_count":211,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The value of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"WriteTimeout"}]},{"block_type":"text","content":"field specifies the maximum duration before timing out writes of the response. Put simply, this is the time from the end of the request header read to the end of the response write."}]},{"block_type":"element","block":"k6pz2k16","search_text":"The remaining Go code of serverTimeOut.go is as follows:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k17","search_text":"m.HandleFunc(\"/time\", timeHandler) m.HandleFunc(\"/\", myHandler) err := srv.ListenAndServe() if err != nil { fmt.Println(err) return } } ","text_count":136,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"m.HandleFunc(\"/time\", timeHandler) \n    m.HandleFunc(\"/\", myHandler) \n \n    err := srv.ListenAndServe() \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k18","search_text":"We are now going to execute serverTimeOut.go in order to interact with it, using nc(1) :","text_count":88,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We are now going to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":"in order to interact with it, using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2k19","search_text":"$ go run serverTimeOut.go Listening on http://0.0.0.0:8001 ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run serverTimeOut.go\nListening on http://0.0.0.0:8001"}]}]},{"block_type":"element","block":"k6pz2k1a","search_text":"On the nc(1) part, which in this case acts as a dummy HTTP client, you should issue the next command to connect to serverTimeOut.go :","text_count":133,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"part, which in this case acts as a dummy HTTP client, you should issue the next command to connect to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"serverTimeOut.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2k1b","search_text":"$ time nc localhost 8001 real 0m3.012s user 0m0.001s sys 0m0.002s ","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ time nc localhost 8001\n    \nreal  0m3.012s\nuser  0m0.001s\nsys   0m0.002s"}]}]},{"block_type":"element","block":"k6pz2k1c","search_text":"As we did not issue any commands, the HTTP server ended the connection. The output of the time(1) utility verifies the time it took the server to close the connection.","text_count":167,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As we did not issue any commands, the HTTP server ended the connection. The output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"time(1)"}]},{"block_type":"text","content":"utility verifies the time it took the server to close the connection."}]},{"block_type":"element","block":"k6pz2k1d","search_text":"Yet another way to time out!","text_count":28,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Yet another way to time out!"}]},{"block_type":"element","block":"k6pz2k1e","search_text":"This subsection will present yet another way to timeout an HTTP connection from the client side. As you will see, this is the simplest form of timeout, because you will just need to define an http.Client object and set its Timeout field to the desired timeout value!","text_count":266,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This subsection will present yet another way to timeout an HTTP connection from the client side. As you will see, this is the simplest form of timeout, because you will just need to define an"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"object and set its"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Timeout"}]},{"block_type":"text","content":"field to the desired timeout value!"}]},{"block_type":"element","block":"k6pz2k1f","search_text":"The name of the utility that showcases the last type of timeout is anotherTimeOut.go , and it will be presented in four parts.","text_count":126,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility that showcases the last type of timeout is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2k1g","search_text":"The first part of anotherTimeOut.go follows next:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k1h","search_text":"package main import ( \"fmt\" \"io\" \"net/http\" \"os\" \"strconv\" \"time\" ) var timeout = time.Duration(time.Second) ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"io\" \n    \"net/http\" \n    \"os\" \n    \"strconv\" \n    \"time\" \n) \n \nvar timeout = time.Duration(time.Second)"}]}]},{"block_type":"element","block":"k6pz2k1i","search_text":"The second part of anotherTimeOut.go is containing the following Go code:","text_count":73,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":"is containing the following Go code:"}]},{"block_type":"element","block":"k6pz2k1j","search_text":"func main() { if len(os.Args) == 1 { fmt.Println(\"Please provide a URL\") return } if len(os.Args) == 3 { temp, err := strconv.Atoi(os.Args[2]) if err != nil { fmt.Println(\"Using Default Timeout!\") } else { timeout = time.Duration(time.Duration(temp) * time.Second) } } URL := os.Args[1] ","text_count":287,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    if len(os.Args) == 1 { \n        fmt.Println(\"Please provide a URL\") \n        return \n    } \n \n    if len(os.Args) == 3 { \n        temp, err := strconv.Atoi(os.Args[2]) \n        if err != nil { \n            fmt.Println(\"Using Default Timeout!\") \n        } else { \n            timeout = time.Duration(time.Duration(temp) * time.Second) \n        } \n    } \n \n    URL := os.Args[1]"}]}]},{"block_type":"element","block":"k6pz2k1k","search_text":"The third code segment of anotherTimeOut.go contains the following Go code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k1l","search_text":"client := http.Client{ Timeout: timeout, } client.Get(URL) ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"client := http.Client{ \n    Timeout: timeout, \n} \nclient.Get(URL)"}]}]},{"block_type":"element","block":"k6pz2k1m","search_text":"This is the place where the timeout period is defined using the Timeout field of the http.Client variable.","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This is the place where the timeout period is defined using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Timeout"}]},{"block_type":"text","content":"field of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Client"}]},{"block_type":"text","content":"variable."}]},{"block_type":"element","block":"k6pz2k1n","search_text":"The last code portion of anotherTimeOut.go follows next:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k1o","search_text":"data, err := client.Get(URL) if err != nil { fmt.Println(err) return } else { defer data.Body.Close() _, err := io.Copy(os.Stdout, data.Body) if err != nil { fmt.Println(err) return } } } ","text_count":188,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"data, err := client.Get(URL) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } else { \n        defer data.Body.Close() \n        _, err := io.Copy(os.Stdout, data.Body) \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k1p","search_text":"Executing anotherTimeOut.go and interacting with the slowWWW.go web server developed in Chapter 10, Go Concurrency – Advanced Topics, will generate the following output:","text_count":169,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"anotherTimeOut.go"}]},{"block_type":"text","content":"and interacting with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"slowWWW.go"}]},{"block_type":"text","content":"web server developed in Chapter 10,&nbsp;"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Go&nbsp;Concurrency&nbsp;&ndash; Advanced Topics,"}]},{"block_type":"text","content":"&nbsp;will generate the following output:"}]},{"block_type":"element","block":"k6pz2k1q","search_text":"$ go run anotherTimeOut.go http://localhost:8001 Get http://localhost:8001: net/http: request canceled (Client.Timeout exceeded while awaiting headers) $ go run anotherTimeOut.go http://localhost:8001 15 Serving: / Delay: 8 ","text_count":224,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run anotherTimeOut.go http://localhost:8001\nGet http://localhost:8001: net/http: request canceled (Client.Timeout exceeded while awaiting headers)\n$ go run anotherTimeOut.go http://localhost:8001 15\nServing: /\nDelay: 8"}]}]},{"block_type":"element","block":"k6pz2k1r","search_text":"Wireshark and tshark tools","text_count":26,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Wireshark and tshark tools"}]},{"block_type":"element","block":"k6pz2k1s","search_text":"This section will briefly mention the powerful Wireshark and tshark utilities. Wireshark , which is a graphical application, is the dominant tool for analyzing network traffic of almost any kind. Although Wireshark is very powerful, there may be times that you need something lighter that you can execute remotely without a graphical user interface. In such situations, you can use tshark , which is the command-line version of Wireshark.","text_count":438,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This section will briefly mention the powerful Wireshark and tshark utilities."},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Wireshark"}]},{"block_type":"text","content":", which is a graphical application, is the dominant tool for analyzing network traffic of almost any kind. Although Wireshark is very powerful, there may be times that you need something lighter that you can execute remotely without a graphical user interface. In such situations, you can use"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tshark"}]},{"block_type":"text","content":", which is the command-line version of Wireshark."}]},{"block_type":"element","block":"k6pz2k1t","search_text":"Unfortunately, talking more about Wireshark and tshark is beyond the scope of this chapter.","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Unfortunately, talking more about Wireshark and tshark is beyond the scope of this chapter."}]},{"block_type":"element","block":"k6pz2k1u","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2k1v","search_text":"The following resources will definitely broaden your horizons, so please find some time to visit them:","text_count":102,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The following resources will definitely broaden your horizons, so please find some time to visit them:"}]},{"block_type":"element","block":"k6pz2k1w","search_text":"The official web page of the Apache web server is located at http://httpd.apache.org/ . The official web page of the Nginx web server is located at http://nginx.org/ . Should you wish to learn more about the internet, TCP/IP, and its various services, you should start by reading RFC documents. One of the places that you can find such documents is at http://www.rfc-archive.org/ . Visit the website of both Wireshark and tshark at https://www.wireshark.org/ to learn more about them. Visit the documentation page of the net standard Go package, which can be found at https://golang.org/pkg/net/ . This is one of the largest documentation pages in the official Go documentation. Visit the documentation page of the net/http Go package at https://golang.org/pkg/net/http/ . If you want to create a website without writing any Go code, you can try the Hugo utility , which is written in Go! You can learn more about the Hugo framework at https://gohugo.io/ . However, what would really be interesting and educational for every Go programmer is to look at its Go code, which can be found at https://github.com/gohugoio/hugo . You can visit the documentation page of the net/http/httptrace package at https://golang.org/pkg/net/http/httptrace/ . You can find the documentation page of the net/http/pprof package at https://golang.org/pkg/net/http/pprof/ . Visit the manual page of the nc(1) command-line utility to learn more about its capabilities and its various command-line options. The httpstat utility that was developed by Dave Cheney can be found at https://github.com/davecheney/httpstat . It is a good example of the use of the net/http/httptrace Go package for HTTP tracing. You can find more information about ab(1) by visiting its manual page at https://httpd.apache.org/docs/2.4/programs/ab.html ","text_count":1806,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The official web page of the Apache web server is located at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://httpd.apache.org/"},"children":[{"block_type":"text","content":"http://httpd.apache.org/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The official web page of the Nginx web server is located at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://nginx.org/"},"children":[{"block_type":"text","content":"http://nginx.org/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Should you wish to learn more about the internet, TCP/IP, and its various services, you should start by reading"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"RFC"}]},{"block_type":"text","content":"documents. One of the places that you can find such documents is at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"http://www.rfc-archive.org/"},"children":[{"block_type":"text","content":"http://www.rfc-archive.org/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the website of both Wireshark and tshark at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.wireshark.org/"},"children":[{"block_type":"text","content":"https://www.wireshark.org/"}]},{"block_type":"text","content":"to learn more about them."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"standard Go package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/"}]},{"block_type":"text","content":". This is one of the largest documentation pages in the official Go documentation."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http"}]},{"block_type":"text","content":"Go package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/http/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/http/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you want to create a website without writing any Go code, you can try the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Hugo utility"}]},{"block_type":"text","content":", which is written in Go! You can learn more about the Hugo framework at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://gohugo.io/"},"children":[{"block_type":"text","content":"https://gohugo.io/"}]},{"block_type":"text","content":". However, what would really be interesting and educational for every Go programmer is to look at its Go code, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/gohugoio/hugo"},"children":[{"block_type":"text","content":"https://github.com/gohugoio/hugo"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can visit the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/http/httptrace/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/http/httptrace/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find the documentation page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/pprof"}]},{"block_type":"text","content":"package at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/http/pprof/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/http/pprof/"}]},{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Visit the manual page of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"command-line utility to learn more about its capabilities and its various command-line options."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpstat"}]},{"block_type":"text","content":"utility that was developed by Dave Cheney can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/davecheney/httpstat"},"children":[{"block_type":"text","content":"https://github.com/davecheney/httpstat"}]},{"block_type":"text","content":". It is a good example of the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net/http/httptrace"}]},{"block_type":"text","content":"Go package for HTTP tracing."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You can find more information about"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ab(1)"}]},{"block_type":"text","content":"by visiting its manual page at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://httpd.apache.org/docs/2.4/programs/ab.html"},"children":[{"block_type":"text","content":"https://httpd.apache.org/docs/2.4/programs/ab.html"}]}]}]}]},{"block_type":"element","block":"k6pz2k1x","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2k1y","search_text":"Write a web client in Go on your own without looking at the code of this chapter Merge the code of MXrecords.go and NSrecords.go in order to create a single utility that does both jobs based on its command-line arguments Modify the code of MXrecords.go and NSrecords.go to also accept IP addresses as input Modify advancedWebClient.go in order to save the HTML output in an external file Try to create a simple version of ab(1) on your own using goroutines Modify kvWeb.go in order to support the DELETE and the LOOKUP operations found in the original version of the key-value store Modify httpTrace.go in order to have a flag that disables the execution of the io.Copy(os.Stdout, response.Body) statement ","text_count":706,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Write a web client in Go on your own without looking at the code of this chapter"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Merge the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"in order to create a single utility that does both jobs based on its command-line arguments"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify the code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MXrecords.go"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"NSrecords.go"}]},{"block_type":"text","content":"to also accept IP addresses as input"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"advancedWebClient.go"}]},{"block_type":"text","content":"in order to save the HTML output in an external file"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Try to create a simple version of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ab(1)"}]},{"block_type":"text","content":"on your own using goroutines"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvWeb.go"}]},{"block_type":"text","content":"in order to support the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"DELETE"}]},{"block_type":"text","content":"and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"LOOKUP"}]},{"block_type":"text","content":"operations found in the original version of the key-value store"}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"httpTrace.go"}]},{"block_type":"text","content":"in order to have a flag that disables the execution of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Copy(os.Stdout, response.Body)"}]},{"block_type":"text","content":"statement"}]}]}]},{"block_type":"element","block":"k6pz2k1z","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2k20","search_text":"This chapter discussed Go code for programming web clients and web servers as well as creating a website in Go! You also learned about the http.Response , the http.Request , and the http.Transport structures that allow you to define the parameters of an HTTP connection.","text_count":270,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter discussed Go code for programming web clients and web servers as well as creating a website in Go! You also learned about the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Response"}]},{"block_type":"text","content":", the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Request"}]},{"block_type":"text","content":", and the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structures that allow you to define the parameters of an HTTP connection."}]},{"block_type":"element","block":"k6pz2k21","search_text":"Additionally, you learned how to get the network configuration of a Unix machine, using Go code, how to perform DNS lookups in a Go program, including getting the NS and MX records of a domain.","text_count":193,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Additionally, you learned how to get the network configuration of a Unix machine, using Go code, how to perform DNS lookups in a Go program, including getting the NS and MX records of a domain."}]},{"block_type":"element","block":"k6pz2k22","search_text":"Finally, we talked about Wireshark and tshark , which are two very popular utilities that allow you to capture and, most importantly, analyze network traffic. At the beginning of this chapter, we also mentioned the nc(1) utility.","text_count":229,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, we talked about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Wireshark"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"tshark"}]},{"block_type":"text","content":", which are two very popular utilities that allow you to capture and, most importantly, analyze network traffic. At the beginning of this chapter, we also mentioned the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"utility."}]},{"block_type":"element","block":"k6pz2k23","search_text":"In the final chapter of this book, we will continue our discussion of network programming in Go. However, this time, we will present lower-level Go code that allows you to develop TCP clients and servers as well as UDP client and server processes. Additionally, you will learn about creating RCP clients and servers. I hope you'll enjoy it!","text_count":340,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the final chapter of this book, we will continue our discussion of network programming in Go. However, this time, we will present lower-level Go code that allows you to develop TCP clients and servers as well as UDP client and server processes. Additionally, you will learn about creating RCP clients and servers. I hope you'll enjoy it!"}]}]},{"title":"Network Programming &ndash; Building Servers and Clients","author":"Mihalis Tsoukalos","block":"k6pz24ta","number":13,"contents":[{"block_type":"element","block":"k6pz2k24","search_text":"The previous chapter discussed topics related to network programming; including developing web clients, web servers, and web applications; performing DNS lookups; and timing out HTTP connections.","text_count":195,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The previous chapter discussed topics related to network programming; including developing web clients, web servers, and web applications; performing DNS lookups; and timing out HTTP connections."}]},{"block_type":"element","block":"k6pz2k25","search_text":"This chapter will take you to the next level by showing you how to program your own TCP clients and servers as well as your own UDP clients and servers. Additionally, it will showcase how you can program a concurrent TCP server using two examples. The first example will be relatively simple, as the concurrent TCP server will just return numbers of the Fibonacci sequence. However, the second example will use the code of the keyValue.go application from Chapter 4, The Uses of Composite Types, as its foundation and convert the key-value store into a concurrent TCP application that can operate without the need for a web browser!","text_count":632,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter will take you to the next level by showing you how to program your own TCP clients and servers as well as your own UDP clients and servers. Additionally, it will showcase how you can program a concurrent TCP server using two examples. The first example will be relatively simple, as the concurrent TCP server will just return numbers of the Fibonacci sequence. However, the second example will use the code of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"application from Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types,"}]},{"block_type":"text","content":"&nbsp;as its foundation and convert the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"key-value store"}]},{"block_type":"text","content":"into a concurrent TCP application that can operate without the need for a web browser!"}]},{"block_type":"element","block":"k6pz2k26","search_text":"In this chapter of Mastering Go , you will learn the following topics:","text_count":70,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this chapter of"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Mastering Go"}]},{"block_type":"text","content":", you will learn the following topics:"}]},{"block_type":"element","block":"k6pz2k27","search_text":"The net standard Go package Developing TCP clients and TCP servers Developing a concurrent TCP server Developing UDP clients and UDP servers Modifying kvSaveLoad.go from Chapter 8, Telling a Unix System What to Do, so that it can serve requests through TCP connections Creating an RCP client and RCP server ","text_count":307,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"standard Go package"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing TCP clients and TCP servers"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing a concurrent TCP server"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Developing UDP clients and UDP servers"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modifying"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvSaveLoad.go"}]},{"block_type":"text","content":"from Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do,"}]},{"block_type":"text","content":"&nbsp;so that it can serve requests through TCP connections"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Creating an RCP client and RCP server"}]}]},{"block_type":"element","block":"k6pz2k28","search_text":"The net standard Go package","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"The net standard Go package"}]},{"block_type":"element","block":"k6pz2k29","search_text":"You cannot create a TCP or UDP client or server in Go without using the functionality offered by the net package.","text_count":113,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"You cannot create a TCP or UDP client or server in Go without using the functionality offered by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"package."}]},{"block_type":"element","block":"k6pz2k2a","search_text":"The net.Dial() function is used for connecting to a network as a client, whereas the net.Listen() function is used for telling a Go program to accept network connections and thus act as a server. The first parameter of both functions is the network type, but this is where their similarities end. The return value of both the net.Dial() and net.Listen() functions is of the net.Conn type, which implements the io.Reader and io.Writer interfaces.","text_count":445,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"function is used for connecting to a network as a client, whereas the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Listen()"}]},{"block_type":"text","content":"function is used for telling a Go program to accept network connections and thus act as a server. The first parameter of both functions is the network type, but this is where their similarities end. The return value of both the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"&nbsp;and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Listen()"}]},{"block_type":"text","content":"functions is of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Conn"}]},{"block_type":"text","content":"type, which implements the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Reader"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"io.Writer"}]},{"block_type":"text","content":"interfaces."}]},{"block_type":"element","block":"k6pz2k2b","search_text":"A TCP client","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"A TCP client"}]},{"block_type":"element","block":"k6pz2k2c","search_text":"As you already know from the previous chapter, TCP stands for Transmission Control Protocol , and its principal characteristic is that it is a reliable protocol. The TCP header of each packet includes source port and destination port fields. These two fields, plus the source and destination IP addresses, are combined to identify uniquely a single TCP connection. The name of the TCP client that will be developed in this section is TCPclient.go , and it will be presented in four parts. The first part of TCPclient.go is shown in the following Go code:","text_count":554,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As you already know from the previous chapter,"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"TCP"}]},{"block_type":"text","content":"stands for"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Transmission Control Protocol"}]},{"block_type":"text","content":", and its principal characteristic is that it is a reliable protocol. The TCP header of each packet includes"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"source port"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"destination port"}]},{"block_type":"text","content":"fields. These two fields, plus the source and destination IP addresses, are combined to identify uniquely a single TCP connection. The name of the TCP client that will be developed in this section is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"is shown in the following Go code:"}]},{"block_type":"element","block":"k6pz2k2d","search_text":"package main import ( \"bufio\" \"fmt\" \"net\" \"os\" \"strings\" ) ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2k2e","search_text":"The second code segment of TCPclient.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k2f","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide host:port.\") return } CONNECT := arguments[1] c, err := net.Dial(\"tcp\", CONNECT) if err != nil { fmt.Println(err) return } ","text_count":211,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide host:port.\") \n        return \n    } \n \n    CONNECT := arguments[1] \n    c, err := net.Dial(\"tcp\", CONNECT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k2g","search_text":"The net.Dial() function is used for connecting to the remote server. The first parameter of the net.Dial() function defines the network that will be used, while the second parameter defines the server address, which must also include the port number. Valid values for the first parameter are tcp , tcp4 (IPv4-only), tcp6 (IPv6-only), udp , udp4 (IPv4-only), udp6 (IPv6-only), ip , ip4 (IPv4-only), ip6 (IPv6-only), Unix (Unix sockets), Unixgram , and Unixpacket .","text_count":463,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"function is used for connecting to the remote server. The first parameter of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"function defines the network that will be used, while the second parameter defines the server address, which must also include the port number. Valid values for the first parameter are"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tcp"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tcp4"}]},{"block_type":"text","content":"(IPv4-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"tcp6"}]},{"block_type":"text","content":"(IPv6-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"udp"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"udp4"}]},{"block_type":"text","content":"(IPv4-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"udp6"}]},{"block_type":"text","content":"(IPv6-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ip"}]},{"block_type":"text","content":","},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ip4"}]},{"block_type":"text","content":"(IPv4-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ip6"}]},{"block_type":"text","content":"(IPv6-only),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unix"}]},{"block_type":"text","content":"(Unix sockets),"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unixgram"}]},{"block_type":"text","content":", and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Unixpacket"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k2h","search_text":"The third part of TCPclient.go contains the following code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k2i","search_text":"for { reader := bufio.NewReader(os.Stdin) fmt.Print(\">> \") text, _ := reader.ReadString('\\n') fmt.Fprintf(c, text+\"\\n\") ","text_count":120,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n       reader := bufio.NewReader(os.Stdin) \n       fmt.Print(\"&gt;&gt; \") \n       text, _ := reader.ReadString('\\n') \n       fmt.Fprintf(c, text+\"\\n\")"}]}]},{"block_type":"element","block":"k6pz2k2j","search_text":"The preceding code is for getting input from the user, which can be verified using the os.Stdin file for reading. Ignoring the error value returned by reader.ReadString() is not a good practice, but it saves some space here. Certainly, you should never do that on production software.","text_count":284,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code is for getting input from the user, which can be verified using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"os.Stdin"}]},{"block_type":"text","content":"file for reading. Ignoring the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"error"}]},{"block_type":"text","content":"value returned by"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"reader.ReadString()"}]},{"block_type":"text","content":"is not a good practice, but it saves some space here. Certainly, you should never do that on production software."}]},{"block_type":"element","block":"k6pz2k2k","search_text":"The last part of TCPclient.go follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k2l","search_text":"message, _ := bufio.NewReader(c).ReadString('\\n') fmt.Print(\"->: \" + message) if strings.TrimSpace(string(text)) == \"STOP\" { fmt.Println(\"TCP client exiting...\") return } } } ","text_count":175,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"message, _ := bufio.NewReader(c).ReadString('\\n') \n        fmt.Print(\"-&gt;: \" + message) \n        if strings.TrimSpace(string(text)) == \"STOP\" { \n            fmt.Println(\"TCP client exiting...\") \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k2m","search_text":"For testing purposes, TCPclient.go will connect to a TCP server that is implemented using netcat(1) , and it will create the following output:","text_count":142,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For testing purposes,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"will connect to a TCP server that is implemented using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":", and it will create the following output:"}]},{"block_type":"element","block":"k6pz2k2n","search_text":"$ go run TCPclient.go 8001 dial tcp: address 8001: missing port in address $ go run TCPclient.go localhost:8001 >> Hello from TCPclient.go! ->: Hi from nc!","text_count":155,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run TCPclient.go 8001\ndial tcp: address 8001: missing port in address\n$ go run TCPclient.go localhost:8001\n&gt;&gt; Hello from TCPclient.go!\n-&gt;: Hi from nc!"}]}]},{"block_type":"element","block":"k6pz2k2o","search_text":">> STOP ->: TCP client exiting... ","text_count":34,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"&gt;&gt; STOP\n-&gt;:\nTCP client exiting..."}]}]},{"block_type":"element","block":"k6pz2k2p","search_text":"The output of the first command illustrates what will happen if you do not include a host name in the command-line arguments of TCPclient.go . The output of the netcat(1) TCP server, which should be executed first, is as follows:","text_count":229,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the first command illustrates what will happen if you do not include a host name in the command-line arguments of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":". The output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"TCP server, which should be executed first, is as follows:"}]},{"block_type":"element","block":"k6pz2k2q","search_text":"$ nc -l 127.0.0.1 8001 Hello from TCPclient.go! Hi from nc! STOP ","text_count":65,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc -l 127.0.0.1 8001\nHello from TCPclient.go!\n    \nHi from nc!\nSTOP"}]}]},{"block_type":"element","block":"k6pz2k2r","search_text":"Tip Note that a client for a given protocol such as TCP and UDP can be reasonably generic in nature, which means that it can talk to many kinds of servers that support its protocol. As you will soon see, this is not the case with server applications that must implement a prearranged functionality using a prearranged protocol. ","text_count":328,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note that a client for a given protocol such as TCP and UDP can be reasonably generic in nature, which means that it can talk to many kinds of servers that support its protocol. As you will soon see, this is not the case with server applications that must implement a prearranged functionality using a prearranged protocol."}]}]},{"block_type":"element","block":"k6pz2k2s","search_text":"A slightly different version of the TCP client","text_count":46,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A slightly different version of the TCP client"}]},{"block_type":"element","block":"k6pz2k2t","search_text":"Go offers a different family of functions that also allow you to develop TCP clients and servers. In this section, you will learn how to program a TCP client using these functions.","text_count":180,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Go offers a different family of functions that also allow you to develop TCP clients and servers. In this section, you will learn how to program a TCP client using these functions."}]},{"block_type":"element","block":"k6pz2k2u","search_text":"The name of the TCP client will be otherTCPclient.go , and it will be presented in four parts. The first code segment from otherTCPclient.go is as follows:","text_count":155,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the TCP client will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":", and it will be presented in four parts. The first code segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k2v","search_text":"package main import ( \"bufio\" \"fmt\" \"net\" \"os\" \"strings\" ) ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2k2w","search_text":"The second code portion from otherTCPclient.go contains the following code:","text_count":75,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k2x","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a server:port string!\") return } CONNECT := arguments[1] tcpAddr, err := net.ResolveTCPAddr(\"tcp4\", CONNECT) if err != nil { fmt.Println(\"ResolveTCPAddr:\", err.Error()) return } ","text_count":266,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a server:port string!\") \n        return \n    } \n \n    CONNECT := arguments[1] \n \n    tcpAddr, err := net.ResolveTCPAddr(\"tcp4\", CONNECT) \n    if err != nil { \n        fmt.Println(\"ResolveTCPAddr:\", err.Error()) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k2y","search_text":"The net.ResolveTCPAddr() function returns the address of a TCP end point ( type TCPAddr ) and can only be used for TCP networks.","text_count":128,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ResolveTCPAddr()"}]},{"block_type":"text","content":"function returns the address of a TCP end point ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"type TCPAddr"}]},{"block_type":"text","content":") and can only be used for TCP networks."}]},{"block_type":"element","block":"k6pz2k2z","search_text":"The third part of otherTCPclient.go contains the following code:","text_count":64,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k30","search_text":"conn, err := net.DialTCP(\"tcp4\", nil, tcpAddr) if err != nil { fmt.Println(\"DialTCP:\", err.Error()) return } ","text_count":109,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"conn, err := net.DialTCP(\"tcp4\", nil, tcpAddr) \n    if err != nil { \n        fmt.Println(\"DialTCP:\", err.Error()) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k31","search_text":"The net.DialTCP() function is equivalent to net.Dial() for TCP networks.","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.DialTCP()"}]},{"block_type":"text","content":"function is equivalent to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"for TCP networks."}]},{"block_type":"element","block":"k6pz2k32","search_text":"The remaining code of otherTCPclient.go follows next:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k33","search_text":"for { reader := bufio.NewReader(os.Stdin) fmt.Print(\">> \") text, _ := reader.ReadString('\\n') fmt.Fprintf(conn, text+\"\\n\") message, _ := bufio.NewReader(conn).ReadString('\\n') fmt.Print(\"->: \" + message) if strings.TrimSpace(string(text)) == \"STOP\" { fmt.Println(\"TCP client exiting...\") conn.Close() return } } } ","text_count":314,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        reader := bufio.NewReader(os.Stdin) \n        fmt.Print(\"&gt;&gt; \") \n        text, _ := reader.ReadString('\\n') \n        fmt.Fprintf(conn, text+\"\\n\") \n \n        message, _ := bufio.NewReader(conn).ReadString('\\n') \n        fmt.Print(\"-&gt;: \" + message) \n        if strings.TrimSpace(string(text)) == \"STOP\" { \n            fmt.Println(\"TCP client exiting...\") \n            conn.Close() \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k34","search_text":"Executing otherTCPclient.go and interacting with a TCP server will generate the following type of output:","text_count":105,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":"and interacting with a TCP server will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2k35","search_text":"$ go run otherTCPclient.go localhost:8001 >> Hello from otherTCPclient.go! ->: Hi from netcat! >> STOP ->: TCP client exiting... ","text_count":129,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run otherTCPclient.go localhost:8001\n&gt;&gt; Hello from otherTCPclient.go!\n-&gt;: Hi from netcat!\n&gt;&gt; STOP\n-&gt;:\nTCP client exiting..."}]}]},{"block_type":"element","block":"k6pz2k36","search_text":"For this example, the TCP server is supported by the netcat(1) utility, which is executed as follows:","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For this example, the TCP server is supported by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"utility, which is executed as follows:"}]},{"block_type":"element","block":"k6pz2k37","search_text":"$ nc -l 127.0.0.1 8001 Hello from otherTCPclient.go! Hi from netcat! STOP ","text_count":74,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc -l 127.0.0.1 8001\nHello from otherTCPclient.go!\n    \nHi from netcat!\nSTOP"}]}]},{"block_type":"element","block":"k6pz2k38","search_text":"A TCP server","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"A TCP server"}]},{"block_type":"element","block":"k6pz2k39","search_text":"The TCP server that is going to be developed in this section will return the current date and time to the client in a single network packet. In practice, this means that after accepting a client connection, the server will get the time and the date from the Unix system and send this data back to the client.","text_count":308,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The TCP server that is going to be developed in this section will return the current date and time to the client in a single network packet. In practice, this means that after accepting a client connection, the server will get the time and the date from the Unix system and send this data back to the client."}]},{"block_type":"element","block":"k6pz2k3a","search_text":"The name of the utility is TCPserver.go , and it will be presented in four parts.","text_count":81,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2k3b","search_text":"The first part of TCPserver.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k3c","search_text":"package main import ( \"bufio\" \"fmt\" \"net\" \"os\" \"strings\" \"time\" ) ","text_count":66,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2k3d","search_text":"The second code portion of TCPserver.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k3e","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide port number\") return } PORT := \":\" + arguments[1] l, err := net.Listen(\"tcp\", PORT) if err != nil { fmt.Println(err) return } defer l.Close() ","text_count":230,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide port number\") \n        return \n    } \n \n    PORT := \":\" + arguments[1] \n    l, err := net.Listen(\"tcp\", PORT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    defer l.Close()"}]}]},{"block_type":"element","block":"k6pz2k3f","search_text":"The net.Listen() function listens for connections. If the second parameter does not contain an IP address, but only a port number, net.Listen() will listen on all available IP addresses of the local system.","text_count":206,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Listen()"}]},{"block_type":"text","content":"function listens for connections. If the second parameter does not contain an IP address, but only a port number,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Listen()"}]},{"block_type":"text","content":"will listen on all available IP addresses of the local system."}]},{"block_type":"element","block":"k6pz2k3g","search_text":"The third segment from TCPserver.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment from"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k3h","search_text":"c, err := l.Accept() if err != nil { fmt.Println(err) return } ","text_count":63,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"c, err := l.Accept() \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k3i","search_text":"The Accept() function waits for the next connection and returns a generic Conn variable. The only thing that is wrong with this particular TCP server is that it can only serve the first TCP client, which is going to connect to it because the Accept() call is outside the for loop that is coming next.","text_count":300,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Accept()"}]},{"block_type":"text","content":"function waits for the next connection and returns a generic"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Conn"}]},{"block_type":"text","content":"variable. The only thing that is wrong with this particular TCP server is that it can only serve the first TCP client, which is going to connect to it because the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Accept()"}]},{"block_type":"text","content":"call is outside the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop that is coming next."}]},{"block_type":"element","block":"k6pz2k3j","search_text":"The remaining Go code of TCPserver.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k3k","search_text":"for { netData, err := bufio.NewReader(c).ReadString('\\n') if err != nil { fmt.Println(err) return } if strings.TrimSpace(string(netData)) == \"STOP\" { fmt.Println(\"Exiting TCP server!\") return } fmt.Print(\"-> \", string(netData)) t := time.Now() myTime := t.Format(time.RFC3339) + \"\\n\" c.Write([]byte(myTime)) } } ","text_count":312,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        netData, err := bufio.NewReader(c).ReadString('\\n') \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n        if strings.TrimSpace(string(netData)) == \"STOP\" { \n            fmt.Println(\"Exiting TCP server!\") \n            return \n        } \n \n        fmt.Print(\"-&gt; \", string(netData)) \n        t := time.Now() \n        myTime := t.Format(time.RFC3339) + \"\\n\" \n        c.Write([]byte(myTime)) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k3l","search_text":"Executing TCPserver.go and interacting with it using a TCP client application will generate the following type of output:","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"and interacting with it using a TCP client application will generate the following type of output:"}]},{"block_type":"element","block":"k6pz2k3m","search_text":"$ go run TCPserver.go 8001 -> HELLO Exiting TCP server! ","text_count":56,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run TCPserver.go 8001\n-&gt; HELLO\nExiting TCP server!"}]}]},{"block_type":"element","block":"k6pz2k3n","search_text":"On the client side, you will see the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the client side, you will see the following output:"}]},{"block_type":"element","block":"k6pz2k3o","search_text":"$ nc 127.0.0.1 8001 HELLO 2018-04-07T14:40:05+03:00 STOP ","text_count":57,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc 127.0.0.1 8001\nHELLO\n2018-04-07T14:40:05+03:00\nSTOP"}]}]},{"block_type":"element","block":"k6pz2k3p","search_text":"If the TCPserver.go utility attempts to use a TCP port that is already in use by another Unix process, you will get the following error message:","text_count":144,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"utility attempts to use a TCP port that is already in use by another Unix process, you will get the following error message:"}]},{"block_type":"element","block":"k6pz2k3q","search_text":"$ go run TCPserver.go 9000 listen tcp :9000: bind: address already in use ","text_count":74,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run TCPserver.go 9000\nlisten tcp :9000: bind: address already in use"}]}]},{"block_type":"element","block":"k6pz2k3r","search_text":"Finally, if the TCPserver.go utility attempts to use a TCP port in the 1-1024 range that requires root privileges on Unix systems, you will get the following error message:","text_count":172,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, if the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"utility attempts to use a TCP port in the 1-1024 range that requires root privileges on Unix systems, you will get the following error message:"}]},{"block_type":"element","block":"k6pz2k3s","search_text":"$ go run TCPserver.go 80 listen tcp :80: bind: permission denied ","text_count":65,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run TCPserver.go 80\nlisten tcp :80: bind: permission denied"}]}]},{"block_type":"element","block":"k6pz2k3t","search_text":"A slightly different version of the TCP server","text_count":46,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A slightly different version of the TCP server"}]},{"block_type":"element","block":"k6pz2k3u","search_text":"In this section, you will see an alternative implementation of a TCP server in Go. This time, the TCP server implements the Echo service , which basically returns to the client, the data that the client sent. The program is called otherTCPserver.go , and it will be presented in four parts.","text_count":290,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see an alternative implementation of a TCP server in Go. This time, the TCP server implements the"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Echo service"}]},{"block_type":"text","content":", which basically returns to the client, the data that the client sent. The program is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":", and it will be presented in four parts."}]},{"block_type":"element","block":"k6pz2k3v","search_text":"The first part of otherTCPserver.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k3w","search_text":"package main import ( \"fmt\" \"net\" \"os\" \"strings\" ) ","text_count":51,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2k3x","search_text":"The second portion of otherTCPserver.go contains the following Go code:","text_count":71,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k3y","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a port number!\") return } SERVER := \"localhost\" + \":\" + arguments[1] s, err := net.ResolveTCPAddr(\"tcp\", SERVER) if err != nil { fmt.Println(err) return } l, err := net.ListenTCP(\"tcp\", s) if err != nil { fmt.Println(err) return } ","text_count":319,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a port number!\") \n        return \n    }  \n \n    SERVER := \"localhost\" + \":\" + arguments[1] \n \n    s, err := net.ResolveTCPAddr(\"tcp\", SERVER) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    l, err := net.ListenTCP(\"tcp\", s) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k3z","search_text":"The net.ListenTCP() function is equivalent to net.Listen() for TCP networks.","text_count":76,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ListenTCP()"}]},{"block_type":"text","content":"function is equivalent to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Listen()"}]},{"block_type":"text","content":"for TCP networks."}]},{"block_type":"element","block":"k6pz2k40","search_text":"The third segment of otherTCPserver.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k41","search_text":"buffer := make([]byte, 1024) conn, err := l.Accept() if err != nil { fmt.Println(err) return } ","text_count":95,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"buffer := make([]byte, 1024) \n    conn, err := l.Accept() \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k42","search_text":"The remaining code of otherTCPserver.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k43","search_text":"for { n, err := conn.Read(buffer) if err != nil { fmt.Println(err) return } if strings.TrimSpace(string(buffer[0:n])) == \"STOP\" { fmt.Println(\"Exiting TCP server!\") conn.Close() return } fmt.Print(\"> \", string(buffer[0:n-1])) _, err = conn.Write(buffer) if err != nil { fmt.Println(err) return } } } ","text_count":300,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        n, err := conn.Read(buffer) \n        if err != nil { \n             fmt.Println(err) \n             return \n         } \n \n         if strings.TrimSpace(string(buffer[0:n])) == \"STOP\" { \n             fmt.Println(\"Exiting TCP server!\") \n             conn.Close() \n             return \n         } \n \n         fmt.Print(\"&gt; \", string(buffer[0:n-1])) \n         _, err = conn.Write(buffer) \n         if err != nil { \n             fmt.Println(err) \n             return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k44","search_text":"Executing otherTCPserver.go and using a client for interacting with it will generate the following output:","text_count":106,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPserver.go"}]},{"block_type":"text","content":"and using a client for interacting with it will generate the following output:"}]},{"block_type":"element","block":"k6pz2k45","search_text":"$ go run otherTCPserver.go 8001 > 1 > 2 > Hello! > Exiting TCP server! ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run otherTCPserver.go 8001\n&gt; 1\n&gt; 2\n&gt; Hello!\n&gt; Exiting TCP server!"}]}]},{"block_type":"element","block":"k6pz2k46","search_text":"On the client side, which in this case will be otherTCPclient.go , you will see the following output:","text_count":101,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the client side, which in this case will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"otherTCPclient.go"}]},{"block_type":"text","content":", you will see the following output:"}]},{"block_type":"element","block":"k6pz2k47","search_text":"$ go run otherTCPclient.go localhost:8001 >> 1 ->: 1 >> 2 ->: 2 >> Hello! ->: Hello! >> ->: >> STOP ->: TCP client exiting... ","text_count":126,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run otherTCPclient.go localhost:8001\n&gt;&gt; 1\n-&gt;: 1\n&gt;&gt; 2\n-&gt;: 2\n&gt;&gt; Hello!\n-&gt;: Hello!\n&gt;&gt; -&gt;:\n&gt;&gt; STOP\n-&gt;: TCP client exiting..."}]}]},{"block_type":"element","block":"k6pz2k48","search_text":"Finally, I will present a way of finding out the name of the process that listens to a given TCP or UDP port on a Unix machine. So, if you want to discover which process uses TCP port number 8001 , you should execute the following command:","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, I will present a way of finding out the name of the process that listens to a given TCP or UDP port on a Unix machine. So, if you want to discover which process uses TCP port number"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"8001"}]},{"block_type":"text","content":", you should execute the following command:"}]},{"block_type":"element","block":"k6pz2k49","search_text":"$ sudo lsof -n -i :8001 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME TCPserver 86775 mtsouk 3u IPv6 0x98d55014e6c9360f 0t0 TCP *:vcom-tunnel (LISTEN) ","text_count":156,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sudo lsof -n -i :8001\nCOMMAND     PID   USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME\nTCPserver 86775 mtsouk    3u  IPv6 0x98d55014e6c9360f      0t0  TCP *:vcom-tunnel (LISTEN)"}]}]},{"block_type":"element","block":"k6pz2k4a","search_text":"A UDP client","text_count":12,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"A UDP client"}]},{"block_type":"element","block":"k6pz2k4b","search_text":"If you know how to develop a TCP client, then developing a UDP client should be much simpler for you due to the simplicity of the UDP protocol.","text_count":143,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you know how to develop a TCP client, then developing a UDP client should be much simpler for you due to the simplicity of the UDP protocol."}]},{"block_type":"element","block":"k6pz2k4c","search_text":"Tip The biggest difference between UDP and TCP is that UDP is not reliable by design. This also means that in general, UDP is simpler than TCP because UDP does not need to keep the state of a UDP connection. ","text_count":208,"tag_name":"div","attributes":{"class":"box tip"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Tip"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The biggest difference between UDP and TCP is that UDP is not reliable by design. This also means that in general, UDP is simpler than TCP because UDP does not need to keep the state of a UDP connection."}]}]},{"block_type":"element","block":"k6pz2k4d","search_text":"The name of the utility presented for this topic is UDPclient.go , and it will be presented in four code segments. The first part of UDPclient.go is as follows:","text_count":160,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility presented for this topic is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":", and it will be presented in four code segments. The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k4e","search_text":"package main import ( \"bufio\" \"fmt\" \"net\" \"os\" \"strings\" ) ","text_count":59,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n)"}]}]},{"block_type":"element","block":"k6pz2k4f","search_text":"The second segment of UDPclient.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k4g","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a host:port string\") return } CONNECT := arguments[1] s, err := net.ResolveUDPAddr(\"udp4\", CONNECT) c, err := net.DialUDP(\"udp4\", nil, s) if err != nil { fmt.Println(err) return } fmt.Printf(\"The UDP server is %s\\n\", c.RemoteAddr().String()) defer c.Close() ","text_count":346,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a host:port string\") \n        return \n    } \n    CONNECT := arguments[1] \n \n    s, err := net.ResolveUDPAddr(\"udp4\", CONNECT) \n    c, err := net.DialUDP(\"udp4\", nil, s) \n \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    fmt.Printf(\"The UDP server is %s\\n\", c.RemoteAddr().String()) \n    defer c.Close()"}]}]},{"block_type":"element","block":"k6pz2k4h","search_text":"The net.ResolveUDPAddr() function returns an address of a UDP end point as defined by its second parameter. The first parameter ( udp4 ) specifies that the program will support the IPv4 protocol only.","text_count":200,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ResolveUDPAddr()"}]},{"block_type":"text","content":"function returns an address of a UDP end point as defined by its second parameter. The first parameter ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"udp4"}]},{"block_type":"text","content":") specifies that the program will support the IPv4 protocol only."}]},{"block_type":"element","block":"k6pz2k4i","search_text":"The net.DialUDP() function used is like net.Dial() for UDP networks.","text_count":68,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.DialUDP()"}]},{"block_type":"text","content":"function used is like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"for UDP networks."}]},{"block_type":"element","block":"k6pz2k4j","search_text":"The third segment of UDPclient.go contains the following code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k4k","search_text":"for { reader := bufio.NewReader(os.Stdin) fmt.Print(\">> \") text, _ := reader.ReadString('\\n') data := []byte(text + \"\\n\") _, err = c.Write(data) if strings.TrimSpace(string(data)) == \"STOP\" { fmt.Println(\"Exiting UDP client!\") return } ","text_count":236,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        reader := bufio.NewReader(os.Stdin) \n        fmt.Print(\"&gt;&gt; \") \n        text, _ := reader.ReadString('\\n') \n        data := []byte(text + \"\\n\") \n        _, err = c.Write(data) \n        if strings.TrimSpace(string(data)) == \"STOP\" { \n            fmt.Println(\"Exiting UDP client!\") \n             return \n        }"}]}]},{"block_type":"element","block":"k6pz2k4l","search_text":"The preceding code requires that the user types some text, which is sent to the UDP server. The user text is read from standard input, using bufio.NewReader(os.Stdin) . The Write(data) method sends the data over the UDP network connection.","text_count":239,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code requires that the user types some text, which is sent to the UDP server. The user text is read from standard input, using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"bufio.NewReader(os.Stdin)"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Write(data)"}]},{"block_type":"text","content":"method sends the data over the UDP network connection."}]},{"block_type":"element","block":"k6pz2k4m","search_text":"The rest of the Go code is as follows:","text_count":38,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The rest of the Go code is as follows:"}]},{"block_type":"element","block":"k6pz2k4n","search_text":"if err != nil { fmt.Println(err) return } buffer := make([]byte, 1024) n, _, err := c.ReadFromUDP(buffer) if err != nil { fmt.Println(err) return } fmt.Printf(\"Reply: %s\\n\", string(buffer[0:n])) } } ","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"if err != nil { \n            fmt.Println(err) \n            return \n        } \n \n        buffer := make([]byte, 1024) \n        n, _, err := c.ReadFromUDP(buffer) \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n        fmt.Printf(\"Reply: %s\\n\", string(buffer[0:n])) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k4o","search_text":"Once the client data is sent, you must wait for the data the UDP server has to send, which is read using ReadFromUDP() .","text_count":120,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Once the client data is sent, you must wait for the data the UDP server has to send, which is read using"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ReadFromUDP()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k4p","search_text":"Executing UDPclient.go and interacting with the netcat(1) utility that acts as a UDP server will generate the following output:","text_count":127,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":"and interacting with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"utility that acts as a UDP server will generate the following output:"}]},{"block_type":"element","block":"k6pz2k4q","search_text":"$ go run UDPclient.go localhost:8001 The UDP server is 127.0.0.1:8001 >> Hello! Reply: Hi there! >> Have to leave - bye! Reply: OK. >> STOP Exiting UDP client! ","text_count":160,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run UDPclient.go localhost:8001\nThe UDP server is 127.0.0.1:8001\n&gt;&gt; Hello!\nReply: Hi there!\n    \n&gt;&gt; Have to leave - bye!\nReply: OK.\n    \n&gt;&gt; STOP\nExiting UDP client!"}]}]},{"block_type":"element","block":"k6pz2k4r","search_text":"On the UDP server side, the output will be as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the UDP server side, the output will be as follows:"}]},{"block_type":"element","block":"k6pz2k4s","search_text":"$ nc -v -u -l 127.0.0.1 8001 Hello! Hi there! Have to leave - bye! OK. STOP ^C ","text_count":79,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc -v -u -l 127.0.0.1 8001\nHello!\n    \nHi there!\nHave to leave - bye!\n    \nOK.\nSTOP\n    \n^C"}]}]},{"block_type":"element","block":"k6pz2k4t","search_text":"The reason for typing Control + C in order to terminate nc(1) is that nc(1) does not have any code that tells it to terminate when it receives the STOP string as input.","text_count":168,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The reason for typing"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Control&nbsp;"}]},{"block_type":"text","content":"+"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"C"}]},{"block_type":"text","content":"in order to terminate"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"is that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"does not have any code that tells it to terminate when it receives the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"STOP"}]},{"block_type":"text","content":"string as input."}]},{"block_type":"element","block":"k6pz2k4u","search_text":"Developing a UDP server","text_count":23,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Developing a UDP server"}]},{"block_type":"element","block":"k6pz2k4v","search_text":"The purpose of the UDP server that will be developed in this section is to return random numbers from 1 to 1,000 to its UDP clients. The name of the program is UDPserver.go , and it is presented in four segments.","text_count":212,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The purpose of the UDP server that will be developed in this section is to return random numbers from 1 to 1,000 to its UDP clients. The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":", and it is presented in four segments."}]},{"block_type":"element","block":"k6pz2k4w","search_text":"The first part of UDPserver.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k4x","search_text":"package main import ( \"fmt\" \"math/rand\" \"net\" \"os\" \"strconv\" \"strings\" \"time\" ) func random(min, max int) int { return rand.Intn(max-min) + min } ","text_count":146,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math/rand\" \n    \"net\" \n    \"os\" \n    \"strconv\" \n    \"strings\" \n    \"time\" \n) \n \nfunc random(min, max int) int { \n    return rand.Intn(max-min) + min \n}"}]}]},{"block_type":"element","block":"k6pz2k4y","search_text":"The second segment of UDPserver.go is as follows:","text_count":49,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k4z","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a port number!\") return } PORT := \":\" + arguments[1] s, err := net.ResolveUDPAddr(\"udp4\", PORT) if err != nil { fmt.Println(err) return } ","text_count":226,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a port number!\") \n        return \n    } \n    PORT := \":\" + arguments[1] \n \n    s, err := net.ResolveUDPAddr(\"udp4\", PORT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k50","search_text":"The third segment of UDPserver.go contains the following code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k51","search_text":"connection, err := net.ListenUDP(\"udp4\", s) if err != nil { fmt.Println(err) return } defer connection.Close() buffer := make([]byte, 1024) rand.Seed(time.Now().Unix()) ","text_count":169,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"connection, err := net.ListenUDP(\"udp4\", s) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }  \n \n    defer connection.Close() \n    buffer := make([]byte, 1024) \n    rand.Seed(time.Now().Unix())"}]}]},{"block_type":"element","block":"k6pz2k52","search_text":"The net.ListenUDP() function acts like net.ListenTCP() for UDP networks.","text_count":72,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ListenUDP()"}]},{"block_type":"text","content":"function acts like"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ListenTCP()"}]},{"block_type":"text","content":"for UDP networks."}]},{"block_type":"element","block":"k6pz2k53","search_text":"The remaining Go code of UDPserver.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k54","search_text":"for { n, addr, err := connection.ReadFromUDP(buffer) fmt.Print(\"-> \", string(buffer[0:n-1])) if strings.TrimSpace(string(buffer[0:n])) == \"STOP\" { fmt.Println(\"Exiting UDP server!\") return } data := []byte(strconv.Itoa(random(1, 1001))) fmt.Printf(\"data: %s\\n\", string(data)) _, err = connection.WriteToUDP(data, addr) if err != nil { fmt.Println(err) return } } } ","text_count":365,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        n, addr, err := connection.ReadFromUDP(buffer) \n        fmt.Print(\"-&gt; \", string(buffer[0:n-1])) \n \n        if strings.TrimSpace(string(buffer[0:n])) == \"STOP\" { \n            fmt.Println(\"Exiting UDP server!\") \n            return \n        } \n \n        data := []byte(strconv.Itoa(random(1, 1001))) \n        fmt.Printf(\"data: %s\\n\", string(data)) \n        _, err = connection.WriteToUDP(data, addr) \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k55","search_text":"The ReadFromUDP() function allows you to read data from a UDP connection using a buffer, which as expected is a byte slice .","text_count":124,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ReadFromUDP()"}]},{"block_type":"text","content":"function allows you to read data from a UDP connection using a buffer, which as expected is a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"byte slice"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k56","search_text":"Executing UDPserver.go and connecting to it with UDPclient.go will generate the following output:","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPserver.go"}]},{"block_type":"text","content":"and connecting to it with"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"UDPclient.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2k57","search_text":"$ go run UDPserver.go 8001 -> Hello! data: 156 -> Another random number please :) data: 944 -> Leaving... data: 491 -> STOP Exiting UDP server! ","text_count":144,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run UDPserver.go 8001\n-&gt; Hello!\ndata: 156\n-&gt; Another random number please :)\ndata: 944\n-&gt; Leaving...\ndata: 491\n-&gt; STOP\nExiting UDP server!"}]}]},{"block_type":"element","block":"k6pz2k58","search_text":"On the client side, the output will be as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the client side, the output will be as follows:"}]},{"block_type":"element","block":"k6pz2k59","search_text":"$ go run UDPclient.go localhost:8001 The UDP server is 127.0.0.1:8001 >> Hello! Reply: 156 >> Another random number please :) Reply: 944 >> Leaving... Reply: 491 >> STOP Exiting UDP client! ","text_count":190,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run UDPclient.go localhost:8001\nThe UDP server is 127.0.0.1:8001\n&gt;&gt; Hello!\nReply: 156\n&gt;&gt; Another random number please :)\nReply: 944\n&gt;&gt; Leaving...\nReply: 491\n&gt;&gt; STOP\nExiting UDP client!"}]}]},{"block_type":"element","block":"k6pz2k5a","search_text":"A concurrent TCP server","text_count":23,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"A concurrent TCP server"}]},{"block_type":"element","block":"k6pz2k5b","search_text":"In this section, you will learn how to develop a concurrent TCP server , using goroutines. For each incoming connection to the TCP server, the TCP server will start a new goroutine to handle that request. This allows it to accept more requests, which means that a concurrent TCP server can serve multiple clients simultaneously.","text_count":328,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will learn how to develop a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"concurrent TCP server"}]},{"block_type":"text","content":", using goroutines. For each incoming connection to the TCP server, the TCP server will start a new goroutine to handle that request. This allows it to accept more requests, which means that a concurrent TCP server can serve multiple clients simultaneously."}]},{"block_type":"element","block":"k6pz2k5c","search_text":"The job of the TCP concurrent server is to accept a positive integer and return a natural number from the Fibonacci sequence. If there is an error in the input, the return value will be -1 . As the calculation of numbers of the Fibonacci sequence can be slow, we will use an algorithm that was first presented in Chapter 11, Code Testing, Optimization and Profiling , and was included in benchmarkMe.go . Additionally, this time the algorithm used will be explained a bit further.","text_count":480,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The job of the TCP concurrent server is to accept a positive integer and return a natural number from the Fibonacci sequence. If there is an error in the input, the return value will be"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-1"}]},{"block_type":"text","content":". As the calculation of numbers of the Fibonacci sequence can be slow, we will use an algorithm that was first presented in Chapter 11,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Code Testing, Optimization and Profiling"}]},{"block_type":"text","content":", and was included in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"benchmarkMe.go"}]},{"block_type":"text","content":". Additionally, this time the algorithm used will be explained a bit further."}]},{"block_type":"element","block":"k6pz2k5d","search_text":"The name of the program is fiboTCP.go , and its code is presented in five parts. As it is considered good practice to be able to define the port number of a web service as a command-line parameter, fiboTCP.go will do exactly that.","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the program is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":", and its code is presented in five parts. As it is considered good practice to be able to define the port number of a web service as a command-line parameter,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"will do exactly that."}]},{"block_type":"element","block":"k6pz2k5e","search_text":"The first part of fiboTCP.go contains the following Go code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k5f","search_text":"package main import ( \"bufio\" \"fmt\" \"net\" \"os\" \"strconv\" \"strings\" \"time\" ) ","text_count":76,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strconv\" \n    \"strings\" \n    \"time\" \n)"}]}]},{"block_type":"element","block":"k6pz2k5g","search_text":"The second code portion of fiboTCP.go contains the following Go code:","text_count":69,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second code portion of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k5h","search_text":"func f(n int) int { fn := make(map[int]int) for i := 0; i <= n; i++ { var f int if i <= 2 { f = 1 } else { f = fn[i-1] + fn[i-2] } fn[i] = f } return fn[n] } ","text_count":158,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func f(n int) int { \n    fn := make(map[int]int) \n    for i := 0; i &lt;= n; i++ { \n        var f int \n        if i &lt;= 2 { \n            f = 1 \n        } else { \n            f = fn[i-1] + fn[i-2] \n        } \n        fn[i] = f \n    } \n    return fn[n] \n}"}]}]},{"block_type":"element","block":"k6pz2k5i","search_text":"In the preceding code, you can see the implementation of the f() function that generates natural numbers that belong to the Fibonacci sequence. The algorithm used is difficult to understand at first, but it is very efficient and therefore fast. First, the f() function uses a Go map named fn , which is pretty unusual when calculating numbers of the Fibonacci sequence. Second, the f() function uses a for loop, which is also fairly unusual. Finally, the f() function does not use recursion, which is the main reason for the speed of its operation.","text_count":548,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding code, you can see the implementation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f()"}]},{"block_type":"text","content":"function that generates natural numbers that belong to the Fibonacci sequence. The algorithm used is difficult to understand at first, but it is very efficient and therefore fast. First, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f()"}]},{"block_type":"text","content":"function uses a Go map named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fn"}]},{"block_type":"text","content":", which is pretty unusual when calculating numbers of the Fibonacci sequence. Second, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f()"}]},{"block_type":"text","content":"function uses a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop, which is also fairly unusual. Finally, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f()"}]},{"block_type":"text","content":"function does not use recursion, which is the main reason for the speed of its operation."}]},{"block_type":"element","block":"k6pz2k5j","search_text":"The idea behind the algorithm used in f() , which uses a Dynamic Programming technique, is that whenever a Fibonacci number is computed, it is put into the fn map so that it will not be computed again. This simple idea saves a lot of time, especially when large Fibonacci numbers need to be calculated because you do not have to calculate the same Fibonacci number multiple times.","text_count":380,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The idea behind the algorithm used in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"f()"}]},{"block_type":"text","content":", which uses a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Dynamic Programming"}]},{"block_type":"text","content":"technique, is that whenever a Fibonacci number is computed, it is put into the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fn"}]},{"block_type":"text","content":"map so that it will not be computed again. This simple idea saves a lot of time, especially when large Fibonacci numbers need to be calculated because you do not have to calculate the same Fibonacci number multiple times."}]},{"block_type":"element","block":"k6pz2k5k","search_text":"The third code segment of fiboTCP.go is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third code segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k5l","search_text":"func handleConnection(c net.Conn) { for { netData, err := bufio.NewReader(c).ReadString('\\n') if err != nil { fmt.Println(err) os.Exit(100) } temp := strings.TrimSpace(string(netData)) if temp == \"STOP\" { break } fibo := \"-1\\n\" n, err := strconv.Atoi(temp) if err == nil { fibo = strconv.Itoa(f(n)) + \"\\n\" } c.Write([]byte(string(fibo))) } time.Sleep(5 * time.Second) c.Close() } ","text_count":380,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func handleConnection(c net.Conn) { \n    for { \n        netData, err := bufio.NewReader(c).ReadString('\\n') \n        if err != nil { \n            fmt.Println(err) \n            os.Exit(100) \n        } \n \n        temp := strings.TrimSpace(string(netData)) \n        if temp == \"STOP\" { \n            break \n        } \n \n        fibo := \"-1\\n\" \n        n, err := strconv.Atoi(temp) \n        if err == nil { \n            fibo = strconv.Itoa(f(n)) + \"\\n\" \n        } \n        c.Write([]byte(string(fibo))) \n    } \n    time.Sleep(5 * time.Second) \n    c.Close() \n}"}]}]},{"block_type":"element","block":"k6pz2k5m","search_text":"The handleConnection() function deals with each client of the concurrent TCP server.","text_count":84,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleConnection()"}]},{"block_type":"text","content":"function deals with each client of the concurrent TCP server."}]},{"block_type":"element","block":"k6pz2k5n","search_text":"The fourth part of fiboTCP.go follows next:","text_count":43,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"follows next:"}]},{"block_type":"element","block":"k6pz2k5o","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a port number!\") return } PORT := \":\" + arguments[1] l, err := net.Listen(\"tcp4\", PORT) if err != nil { fmt.Println(err) return } defer l.Close() ","text_count":234,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a port number!\") \n        return \n    } \n \n    PORT := \":\" + arguments[1] \n    l, err := net.Listen(\"tcp4\", PORT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    defer l.Close()"}]}]},{"block_type":"element","block":"k6pz2k5p","search_text":"The remaining Go code of fiboTCP.go is as follows:","text_count":50,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k5q","search_text":"for { c, err := l.Accept() if err != nil { fmt.Println(err) return } go handleConnection(c) } } ","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        c, err := l.Accept() \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n        go handleConnection(c) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k5r","search_text":"The concurrency of the program is implemented by the go handleConnection(c) statement, which begins a new goroutine each time a new TCP client comes. The goroutine is executed concurrently, which gives the server the opportunity to serve even more clients!","text_count":256,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The concurrency of the program is implemented by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"go handleConnection(c)"}]},{"block_type":"text","content":"statement, which begins a new goroutine each time a new TCP client comes. The goroutine is executed concurrently, which gives the server the opportunity to serve even more clients!"}]},{"block_type":"element","block":"k6pz2k5s","search_text":"Executing fiboTCP.go and interacting with it using both netcat(1) and TCPclient.go on two different Terminal windows will generate the following output:","text_count":152,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":"and interacting with it using both"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"on two different Terminal windows will generate the following output:"}]},{"block_type":"element","block":"k6pz2k5t","search_text":"$ go run fiboTCP.go 9000 n: 10 fibo: 55 n: 0 fibo: 1 n: -1 fibo: 0 n: 100 fibo: 3736710778780434371 n: 12 fibo: 144 n: 12 fibo: 144 ","text_count":132,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run fiboTCP.go 9000\nn: 10\nfibo: 55\nn: 0\nfibo: 1\nn: -1\nfibo: 0\nn: 100\nfibo: 3736710778780434371\nn: 12\nfibo: 144\nn: 12\nfibo: 144"}]}]},{"block_type":"element","block":"k6pz2k5u","search_text":"The output will be as follows on the TCPclient.go side:","text_count":55,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output will be as follows on the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPclient.go"}]},{"block_type":"text","content":"side:"}]},{"block_type":"element","block":"k6pz2k5v","search_text":"$ go run TCPclient.go localhost:9000 >> 12 ->: 144 >> a ->: -1 >> STOP ->: TCP client exiting...","text_count":96,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run TCPclient.go localhost:9000\n&gt;&gt; 12\n-&gt;: 144\n&gt;&gt; a\n-&gt;: -1\n&gt;&gt; STOP\n-&gt;: TCP client exiting..."}]}]},{"block_type":"element","block":"k6pz2k5w","search_text":"On the netcat(1) side, the output will be as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"On the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"side, the output will be as follows:"}]},{"block_type":"element","block":"k6pz2k5x","search_text":"$ nc localhost 9000 10 55 0 1 -1 0 100 3736710778780434371 ads -1 STOP ","text_count":71,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc localhost 9000\n10\n55\n0\n1\n-1\n0\n100\n3736710778780434371\nads\n-1\nSTOP"}]}]},{"block_type":"element","block":"k6pz2k5y","search_text":"When you send the STOP string to the server process, the goroutine that serves that particular TCP client will terminate, which will cause the connection to end.","text_count":161,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"When you send the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"STOP"}]},{"block_type":"text","content":"string to the server process, the goroutine that serves that particular TCP client will terminate, which will cause the connection to end."}]},{"block_type":"element","block":"k6pz2k5z","search_text":"Finally, the impressive thing here is that both clients are served at the same time, which can be verified by the output of the following command:","text_count":146,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Finally, the impressive thing here is that both clients are served at the same time, which can be verified by the output of the following command:"}]},{"block_type":"element","block":"k6pz2k60","search_text":"$ netstat -anp TCP | grep 9000 tcp4 0 0 127.0.0.1.9000 127.0.0.1.57309 ESTABLISHED tcp4 0 0 127.0.0.1.57309 127.0.0.1.9000 ESTABLISHED tcp4 0 0 127.0.0.1.9000 127.0.0.1.57305 ESTABLISHED tcp4 0 0 127.0.0.1.57305 127.0.0.1.9000 ESTABLISHED tcp4 0 0 *.9000 *.* LISTEN ","text_count":266,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ netstat -anp TCP | grep 9000\ntcp4       0 0 127.0.0.1.9000  127.0.0.1.57309    ESTABLISHED\ntcp4       0 0 127.0.0.1.57309 127.0.0.1.9000     ESTABLISHED\ntcp4       0 0 127.0.0.1.9000  127.0.0.1.57305    ESTABLISHED\ntcp4       0 0 127.0.0.1.57305 127.0.0.1.9000     ESTABLISHED\ntcp4       0 0 *.9000          *.*                LISTEN"}]}]},{"block_type":"element","block":"k6pz2k61","search_text":"The last line of the output of the preceding command tells us that there is a process that listens to port 9000 , which means that you can still connect to port 9000 . The first two lines of the output say that there is a client that uses port 57309 to talk to the server process. The third and fourth lines of the preceding output verify that there is another client that communicates with the server that listens to port 9000 . This client uses the TCP port 57305 .","text_count":467,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The last line of the output of the preceding command tells us that there is a process that listens to port"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"9000"}]},{"block_type":"text","content":", which means that you can still connect to port"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"9000"}]},{"block_type":"text","content":". The first two lines of the output say that there is a client that uses port"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"57309"}]},{"block_type":"text","content":"to talk to the server process. The third and fourth lines of the preceding output verify that there is another client that communicates with the server that listens to port"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"9000"}]},{"block_type":"text","content":". This client uses the TCP port"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"57305"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k62","search_text":"A handy concurrent TCP server","text_count":29,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"A handy concurrent TCP server"}]},{"block_type":"element","block":"k6pz2k63","search_text":"Although the concurrent TCP server from the previous section works fine, it does not serve a practical application. Therefore, in this section, you will learn how to convert the keyValue.go application from Chapter 4, The Uses of Composite Types, into a fully featured concurrent TCP application.","text_count":296,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the concurrent TCP server from the previous section works fine, it does not serve a practical application. Therefore, in this section, you will learn how to convert the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":"application from Chapter 4,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"The Uses of Composite Types,"}]},{"block_type":"text","content":"&nbsp;into a fully featured concurrent TCP application."}]},{"block_type":"element","block":"k6pz2k64","search_text":"We will create our own kind of TCP protocol in order to be able to interact with the key-value store from a network. You will need a keyword for each one of the functions of the key-value store. For reasons of simplicity, each keyword will be followed by the relevant data. The result of most commands will be a success or a failure message.","text_count":341,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"We will create our own kind of TCP protocol in order to be able to interact with the key-value store from a network. You will need a keyword for each one of the functions of the key-value store. For reasons of simplicity, each keyword will be followed by the relevant data. The result of most commands will be a success or a failure message."}]},{"block_type":"element","block":"k6pz2k65","search_text":"Note Designing your own TCP or UDP protocols is not an easy job. This means that you should be particularly specific and careful when designing a new protocol. The key here is to document everything before you start writing production code. ","text_count":241,"tag_name":"div","attributes":{"class":"box note"},"children":[{"block_type":"element","tag_name":"h4","attributes":{},"children":[{"block_type":"text","content":"Note"}]},{"block_type":"element","tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Designing your own TCP or UDP protocols is not an easy job. This means that you should be particularly specific and careful when designing a new protocol. The key here is to document everything before you start writing production code."}]}]},{"block_type":"element","block":"k6pz2k66","search_text":"The name of the utility shown in this topic is kvTCP.go , and it is presented in six parts.","text_count":91,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The name of the utility shown in this topic is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":", and it is presented in six parts."}]},{"block_type":"element","block":"k6pz2k67","search_text":"The first part of kvTCP.go is as follows:","text_count":41,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k68","search_text":"package main import ( \"bufio\" \"encoding/gob\" \"fmt\" \"net\" \"os\" \"strings\" ) type myElement struct { Name string Surname string Id string } const welcome = \"Welcome to the Key-value store!\\n\" var DATA = make(map[string]myElement) var DATAFILE = \"/tmp/dataFile.gob\" ","text_count":262,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"bufio\" \n    \"encoding/gob\" \n    \"fmt\" \n    \"net\" \n    \"os\" \n    \"strings\" \n) \n \ntype myElement struct { \n    Name    string \n    Surname string \n    Id      string \n} \n \nconst welcome = \"Welcome to the Key-value store!\\n\" \n \nvar DATA = make(map[string]myElement) \nvar DATAFILE = \"/tmp/dataFile.gob\""}]}]},{"block_type":"element","block":"k6pz2k69","search_text":"The second part of kvTCP.go contains the following Go code:","text_count":59,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k6a","search_text":"func handleConnection(c net.Conn) { c.Write([]byte(welcome)) for { netData, err := bufio.NewReader(c).ReadString('\\n') if err != nil { fmt.Println(err) return } command := strings.TrimSpace(string(netData)) tokens := strings.Fields(command) switch len(tokens) { case 0: continue case 1: tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 2: tokens = append(tokens, \"\") tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 3: tokens = append(tokens, \"\") tokens = append(tokens, \"\") case 4: tokens = append(tokens, \"\") } switch tokens[0] { case \"STOP\": err = save() if err != nil { fmt.Println(err) } c.Close() return case \"PRINT\": PRINT(c) case \"DELETE\": if !DELETE(tokens[1]) { netData := \"Delete operation failed!\\n\" c.Write([]byte(netData)) } else { netData := \"Delete operation successful!\\n\" c.Write([]byte(netData)) } case \"ADD\": n := myElement{tokens[2], tokens[3], tokens[4]} if !ADD(tokens[1], n) { netData := \"Add operation failed!\\n\" c.Write([]byte(netData)) } else { netData := \"Add operation successful!\\n\" c.Write([]byte(netData)) } err = save() if err != nil { fmt.Println(err) } case \"LOOKUP\": n := LOOKUP(tokens[1]) if n != nil { netData := fmt.Sprintf(\"%v\\n\", *n) c.Write([]byte(netData)) } else { netData := \"Did not find key!\\n\" c.Write([]byte(netData)) } case \"CHANGE\": n := myElement{tokens[2], tokens[3], tokens[4]} if !CHANGE(tokens[1], n) { netData := \"Update operation failed!\\n\" c.Write([]byte(netData)) } else { netData := \"Update operation successful!\\n\" c.Write([]byte(netData)) } err = save() if err != nil { fmt.Println(err) } default: netData := \"Unknown command - please try again!\\n\" c.Write([]byte(netData)) } } } ","text_count":1723,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func handleConnection(c net.Conn) { \n    c.Write([]byte(welcome)) \n    for { \n        netData, err := bufio.NewReader(c).ReadString('\\n') \n        if err != nil { \n            fmt.Println(err) \n            return \n        } \n \n        command := strings.TrimSpace(string(netData)) \n        tokens := strings.Fields(command) \n        switch len(tokens) { \n        case 0: \n               continue \n        case 1: \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n        case 2: \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n        case 3: \n               tokens = append(tokens, \"\") \n               tokens = append(tokens, \"\") \n        case 4: \n               tokens = append(tokens, \"\") \n        } \n \n        switch tokens[0] { \n        case \"STOP\": \n            err = save() \n            if err != nil { \n                     fmt.Println(err) \n            } \n            c.Close() \n            return \n        case \"PRINT\": \n               PRINT(c) \n        case \"DELETE\": \n               if !DELETE(tokens[1]) { \n                     netData := \"Delete operation failed!\\n\" \n                     c.Write([]byte(netData)) \n               } else { \n                     netData := \"Delete operation successful!\\n\" \n                     c.Write([]byte(netData)) \n               } \n        case \"ADD\": \n               n := myElement{tokens[2], tokens[3], tokens[4]} \n               if !ADD(tokens[1], n) { \n                     netData := \"Add operation failed!\\n\" \n                     c.Write([]byte(netData)) \n               } else { \n                     netData := \"Add operation successful!\\n\" \n                     c.Write([]byte(netData)) \n               } \n               err = save() \n               if err != nil { \n                     fmt.Println(err) \n               } \n        case \"LOOKUP\": \n               n := LOOKUP(tokens[1]) \n               if n != nil { \n                     netData := fmt.Sprintf(\"%v\\n\", *n) \n                     c.Write([]byte(netData)) \n               } else { \n                     netData := \"Did not find key!\\n\" \n                     c.Write([]byte(netData)) \n               } \n        case \"CHANGE\": \n               n := myElement{tokens[2], tokens[3], tokens[4]} \n               if !CHANGE(tokens[1], n) { \n                     netData := \"Update operation failed!\\n\" \n                     c.Write([]byte(netData)) \n               } else { \n                     netData := \"Update operation successful!\\n\" \n                     c.Write([]byte(netData)) \n               } \n               err = save() \n               if err != nil { \n                     fmt.Println(err) \n               } \n        default: \n               netData := \"Unknown command - please try again!\\n\" \n               c.Write([]byte(netData)) \n        } \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k6b","search_text":"The handleConnection() function communicates with each TCP client and interprets the client input.","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"handleConnection()"}]},{"block_type":"text","content":"function communicates with each TCP client and interprets the client input."}]},{"block_type":"element","block":"k6pz2k6c","search_text":"The third segment of kvTCP.go contains the following Go code:","text_count":61,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k6d","search_text":"func save() error { fmt.Println(\"Saving\", DATAFILE) err := os.Remove(DATAFILE) if err != nil { fmt.Println(err) } saveTo, err := os.Create(DATAFILE) if err != nil { fmt.Println(\"Cannot create\", DATAFILE) return err } defer saveTo.Close() encoder := gob.NewEncoder(saveTo) err = encoder.Encode(DATA) if err != nil { fmt.Println(\"Cannot save to\", DATAFILE) return err } return nil } func load() error { fmt.Println(\"Loading\", DATAFILE) loadFrom, err := os.Open(DATAFILE) defer loadFrom.Close() if err != nil { fmt.Println(\"Empty key/value store!\") return err } decoder := gob.NewDecoder(loadFrom) decoder.Decode(&DATA) return nil } ","text_count":630,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func save() error { \n   fmt.Println(\"Saving\", DATAFILE) \n   err := os.Remove(DATAFILE) \n   if err != nil { \n         fmt.Println(err) \n   } \n \n   saveTo, err := os.Create(DATAFILE) \n   if err != nil { \n         fmt.Println(\"Cannot create\", DATAFILE) \n         return err \n   } \n   defer saveTo.Close() \n \n   encoder := gob.NewEncoder(saveTo) \n   err = encoder.Encode(DATA) \n   if err != nil { \n         fmt.Println(\"Cannot save to\", DATAFILE) \n         return err \n   } \n   return nil \n} \n \nfunc load() error { \n   fmt.Println(\"Loading\", DATAFILE) \n   loadFrom, err := os.Open(DATAFILE) \n   defer loadFrom.Close() \n   if err != nil { \n         fmt.Println(\"Empty key/value store!\") \n         return err \n   } \n \n   decoder := gob.NewDecoder(loadFrom) \n   decoder.Decode(&amp;DATA) \n   return nil \n}"}]}]},{"block_type":"element","block":"k6pz2k6e","search_text":"The fourth segment of kvTCP.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k6f","search_text":"func ADD(k string, n myElement) bool { if k == \"\" { return false } if LOOKUP(k) == nil { DATA[k] = n return true } return false } func DELETE(k string) bool { if LOOKUP(k) != nil { delete(DATA, k) return true } return false } func LOOKUP(k string) *myElement { _, ok := DATA[k] if ok { n := DATA[k] return &n } else { return nil } } func CHANGE(k string, n myElement) bool { DATA[k] = n return true } ","text_count":401,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func ADD(k string, n myElement) bool { \n   if k == \"\" { \n         return false \n   } \n \n   if LOOKUP(k) == nil { \n         DATA[k] = n \n         return true \n   } \n   return false \n} \n \nfunc DELETE(k string) bool { \n   if LOOKUP(k) != nil { \n         delete(DATA, k) \n         return true \n   } \n   return false \n} \n \nfunc LOOKUP(k string) *myElement { \n   _, ok := DATA[k] \n   if ok { \n         n := DATA[k] \n         return &amp;n \n   } else { \n         return nil \n   } \n} \n \nfunc CHANGE(k string, n myElement) bool { \n   DATA[k] = n \n   return true \n}"}]}]},{"block_type":"element","block":"k6pz2k6g","search_text":"The implementation of the preceding functions is the same as in keyValue.go . None of them talks directly to a TCP client.","text_count":122,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The implementation of the preceding functions is the same as in"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"keyValue.go"}]},{"block_type":"text","content":". None of them talks directly to a TCP client."}]},{"block_type":"element","block":"k6pz2k6h","search_text":"The fifth part of kvTCP.go contains the following Go code:","text_count":58,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fifth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k6i","search_text":"func PRINT(c net.Conn) { for k, d := range DATA { netData := fmt.Sprintf(\"key: %s value: %v\\n\", k, d) c.Write([]byte(netData)) } } ","text_count":131,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func PRINT(c net.Conn) { \n    for k, d := range DATA { \n        netData := fmt.Sprintf(\"key: %s value: %v\\n\", k, d) \n        c.Write([]byte(netData)) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k6j","search_text":"The PRINT() function sends data to a TCP client directly, one line at a time.","text_count":77,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"PRINT()"}]},{"block_type":"text","content":"function sends data to a TCP client directly, one line at a time."}]},{"block_type":"element","block":"k6pz2k6k","search_text":"The remaining Go code of the program is as follows:","text_count":51,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of the program is as follows:"}]},{"block_type":"element","block":"k6pz2k6l","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a port number!\") return } PORT := \":\" + arguments[1] l, err := net.Listen(\"tcp\", PORT) if err != nil { fmt.Println(err) return } defer l.Close() err = load() if err != nil { fmt.Println(err) } for { c, err := l.Accept() if err != nil { fmt.Println(err) os.Exit(100) } go handleConnection(c) } } ","text_count":383,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a port number!\") \n        return \n    } \n \n    PORT := \":\" + arguments[1] \n    l, err := net.Listen(\"tcp\", PORT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    defer l.Close() \n \n    err = load() \n    if err != nil { \n        fmt.Println(err) \n    } \n \n    for { \n        c, err := l.Accept() \n         if err != nil { \n              fmt.Println(err) \n               os.Exit(100) \n        } \n        go handleConnection(c) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k6m","search_text":"Executing kvTCP.go will generate the following output:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"will generate the following output:"}]},{"block_type":"element","block":"k6pz2k6n","search_text":"$ go run kvTCP.go 9000 Loading /tmp/dataFile.gob Empty key/value store! open /tmp/dataFile.gob: no such file or directory Saving /tmp/dataFile.gob remove /tmp/dataFile.gob: no such file or directory Saving /tmp/dataFile.gob Saving /tmp/dataFile.gob ","text_count":249,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run kvTCP.go 9000\nLoading /tmp/dataFile.gob\nEmpty key/value store!\nopen /tmp/dataFile.gob: no such file or directory\nSaving /tmp/dataFile.gob\nremove /tmp/dataFile.gob: no such file or directory\nSaving /tmp/dataFile.gob\nSaving /tmp/dataFile.gob"}]}]},{"block_type":"element","block":"k6pz2k6o","search_text":"For the purposes of this section, the netcat(1) utility will act as the TCP client of kvTCP.go :","text_count":96,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"For the purposes of this section, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"netcat(1)"}]},{"block_type":"text","content":"utility will act as the TCP client of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2k6p","search_text":"$ nc localhost 9000 Welcome to the Key-value store! PRINT LOOKUP 1 Did not find key! ADD 1 2 3 4 Add operation successful! LOOKUP 1 {2 3 4} ADD 4 -1 -2 -3 Add operation successful! PRINT key: 1 value: {2 3 4} key: 4 value: {-1 -2 -3} STOP","text_count":238,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ nc localhost 9000\nWelcome to the Key-value store!\nPRINT\nLOOKUP 1\nDid not find key!\nADD 1 2 3 4\nAdd operation successful!\nLOOKUP 1\n{2 3 4}\nADD 4 -1 -2 -3\nAdd operation successful!\nPRINT\nkey: 1 value: {2 3 4}\nkey: 4 value: {-1 -2 -3}\nSTOP"}]}]},{"block_type":"element","block":"k6pz2k6q","search_text":"The kvTCP.go file is a concurrent application that uses goroutines, and it can serve multiple TCP clients simultaneously. However, all of these TCP clients will share the same data!","text_count":181,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"&nbsp;file is a concurrent application that uses goroutines, and it can serve multiple TCP clients simultaneously. However, all of these TCP clients will share the same data!"}]},{"block_type":"element","block":"k6pz2k6r","search_text":"Remote Procedure Call (RPC)","text_count":27,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Remote Procedure Call (RPC)"}]},{"block_type":"element","block":"k6pz2k6s","search_text":"Remote Procedure Call ( RPC ) is a client-server mechanism for Interprocess communication that uses TCP/IP. Both the RPC client and the RPC server to be developed will use the following package, which is named sharedRPC.go :","text_count":224,"tag_name":"p","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"Remote Procedure Call"}]},{"block_type":"text","content":"("},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"RPC"}]},{"block_type":"text","content":") is a client-server mechanism for Interprocess communication that uses TCP/IP. Both the RPC client and the RPC server to be developed will use the following package, which is named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sharedRPC.go"}]},{"block_type":"text","content":":"}]},{"block_type":"element","block":"k6pz2k6t","search_text":"package sharedRPC type MyFloats struct { A1, A2 float64 } type MyInterface interface { Multiply(arguments *MyFloats, reply *float64) error Power(arguments *MyFloats, reply *float64) error } ","text_count":190,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package sharedRPC \n \ntype MyFloats struct { \n    A1, A2 float64 \n} \n \ntype MyInterface interface { \n    Multiply(arguments *MyFloats, reply *float64) error \n    Power(arguments *MyFloats, reply *float64) error \n}"}]}]},{"block_type":"element","block":"k6pz2k6u","search_text":"The sharedRPC package defines one interface called MyInterface and one structure called MyFloats , which will be used by both the client and the server. However, only the RPC server will need to implement that interface.","text_count":220,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sharedRPC"}]},{"block_type":"text","content":"package defines one interface called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MyInterface"}]},{"block_type":"text","content":"and one structure called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"MyFloats"}]},{"block_type":"text","content":", which will be used by both the client and the server. However, only the RPC server will need to implement that interface."}]},{"block_type":"element","block":"k6pz2k6v","search_text":"After this, you will need to install the sharedRPC.go package by executing the following commands:","text_count":98,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"After this, you will need to install the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sharedRPC.go"}]},{"block_type":"text","content":"package by executing the following commands:"}]},{"block_type":"element","block":"k6pz2k6w","search_text":"$ mkdir -p ~/go/src/sharedRPC $ cp sharedRPC.go ~/go/src/sharedRPC/ $ go install sharedRPC ","text_count":91,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ mkdir -p ~/go/src/sharedRPC\n$ cp sharedRPC.go ~/go/src/sharedRPC/\n$ go install sharedRPC"}]}]},{"block_type":"element","block":"k6pz2k6x","search_text":"The RPC client","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The RPC client"}]},{"block_type":"element","block":"k6pz2k6y","search_text":"In this section, you will see the Go code of the RPC client, which will be saved as RPCclient.go and presented in four parts.","text_count":125,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this section, you will see the Go code of the RPC client, which will be saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"and presented in four parts."}]},{"block_type":"element","block":"k6pz2k6z","search_text":"The first part of RPCclient.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k70","search_text":"package main import ( \"fmt\" \"net/rpc\" \"os\" \"sharedRPC\" ) ","text_count":57,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net/rpc\" \n    \"os\" \n    \"sharedRPC\" \n)"}]}]},{"block_type":"element","block":"k6pz2k71","search_text":"The second segment of RPCclient.go contains the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k72","search_text":"func main() { arguments := os.Args if len(arguments) == 1 { fmt.Println(\"Please provide a host:port string!\") return } CONNECT := arguments[1] c, err := rpc.Dial(\"tcp\", CONNECT) if err != nil { fmt.Println(err) return } ","text_count":220,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    arguments := os.Args \n    if len(arguments) == 1 { \n        fmt.Println(\"Please provide a host:port string!\") \n        return \n    } \n \n    CONNECT := arguments[1] \n    c, err := rpc.Dial(\"tcp\", CONNECT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k73","search_text":"Note the use of the rpc.Dial() function for connecting to the RPC server instead of the net.Dial() function, even though the RCP server uses TCP.","text_count":145,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Note the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rpc.Dial()"}]},{"block_type":"text","content":"function for connecting to the RPC server instead of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.Dial()"}]},{"block_type":"text","content":"function, even though the RCP server uses TCP."}]},{"block_type":"element","block":"k6pz2k74","search_text":"The third segment of RPCclient.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k75","search_text":"args := sharedRPC.MyFloats{16, -0.5} var reply float64 err = c.Call(\"MyInterface.Multiply\", args, &reply) if err != nil { fmt.Println(err) return } fmt.Printf(\"Reply (Multiply): %f\\n\", reply) ","text_count":192,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"args := sharedRPC.MyFloats{16, -0.5} \n    var reply float64 \n \n    err = c.Call(\"MyInterface.Multiply\", args, &amp;reply) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    fmt.Printf(\"Reply (Multiply): %f\\n\", reply)"}]}]},{"block_type":"element","block":"k6pz2k76","search_text":"What is being exchanged between the RPC client and the RPC server with the help of the Call() function are function names, their arguments, and the results of the function calls, as the RPC client knows nothing about the actual implementation of the functions.","text_count":260,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What is being exchanged between the RPC client and the RPC server with the help of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Call()"}]},{"block_type":"text","content":"function are function names, their arguments, and the results of the function calls, as the RPC client knows nothing about the actual implementation of the functions."}]},{"block_type":"element","block":"k6pz2k77","search_text":"The remaining Go code of RPCclient.go is as follows:","text_count":52,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k78","search_text":"err = c.Call(\"MyInterface.Power\", args, &reply) if err != nil { fmt.Println(err) return } fmt.Printf(\"Reply (Power): %f\\n\", reply) } ","text_count":133,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err = c.Call(\"MyInterface.Power\", args, &amp;reply) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    fmt.Printf(\"Reply (Power): %f\\n\", reply) \n}"}]}]},{"block_type":"element","block":"k6pz2k79","search_text":"If you try to execute RPCclient.go without having a RPC server running, you will get the following type of error message:","text_count":121,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"If you try to execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"without having a RPC server running, you will get the following type of error message:"}]},{"block_type":"element","block":"k6pz2k7a","search_text":"$ go run RPCclient.go localhost:1234 dial tcp [::1]:1234: connect: connection refused","text_count":85,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run RPCclient.go localhost:1234\ndial tcp [::1]:1234: connect: connection refused"}]}]},{"block_type":"element","block":"k6pz2k7b","search_text":"The RPC server","text_count":14,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"The RPC server"}]},{"block_type":"element","block":"k6pz2k7c","search_text":"The RPC server will be saved as RPCserver.go , and it will be presented in five parts.","text_count":86,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The RPC server will be saved as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":", and it will be presented in five parts."}]},{"block_type":"element","block":"k6pz2k7d","search_text":"The first part of RPCserver.go is as follows:","text_count":45,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k7e","search_text":"package main import ( \"fmt\" \"math\" \"net\" \"net/rpc\" \"os\" \"sharedRPC\" ) ","text_count":70,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"math\" \n    \"net\" \n    \"net/rpc\" \n    \"os\" \n    \"sharedRPC\" \n)"}]}]},{"block_type":"element","block":"k6pz2k7f","search_text":"The second segment of RPCserver.go contains the following Go code:","text_count":66,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k7g","search_text":"type MyInterface struct{} func Power(x, y float64) float64 { return math.Pow(x, y) } func (t *MyInterface) Multiply(arguments *sharedRPC.MyFloats, reply *float64) error { *reply = arguments.A1 * arguments.A2 return nil } func (t *MyInterface) Power(arguments *sharedRPC.MyFloats, reply *float64) error { *reply = Power(arguments.A1, arguments.A2) return nil } ","text_count":360,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"type MyInterface struct{} \n \nfunc Power(x, y float64) float64 { \n    return math.Pow(x, y) \n} \n \nfunc (t *MyInterface) Multiply(arguments *sharedRPC.MyFloats, reply *float64) error { \n    *reply = arguments.A1 * arguments.A2 \n    return nil \n} \n \nfunc (t *MyInterface) Power(arguments *sharedRPC.MyFloats, reply *float64) error { \n    *reply = Power(arguments.A1, arguments.A2) \n    return nil \n}"}]}]},{"block_type":"element","block":"k6pz2k7h","search_text":"In the preceding Go code, the RPC server implements the desired interface as well as a helper function named Power() .","text_count":118,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In the preceding Go code, the RPC server implements the desired interface as well as a helper function named"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Power()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k7i","search_text":"The third segment of RPCserver.go is as follows:","text_count":48,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k7j","search_text":"func main() { PORT := \":1234\" arguments := os.Args if len(arguments) != 1 { PORT = \":\" + arguments[1] } ","text_count":104,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    PORT := \":1234\" \n    arguments := os.Args \n    if len(arguments) != 1 { \n        PORT = \":\" + arguments[1] \n    }"}]}]},{"block_type":"element","block":"k6pz2k7k","search_text":"The fourth part of RPCserver.go contains the following code:","text_count":60,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The fourth part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":"contains the following code:"}]},{"block_type":"element","block":"k6pz2k7l","search_text":"myInterface := new(MyInterface) rpc.Register(myInterface) t, err := net.ResolveTCPAddr(\"tcp4\", PORT) if err != nil { fmt.Println(err) return } l, err := net.ListenTCP(\"tcp4\", t) if err != nil { fmt.Println(err) return } ","text_count":220,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"myInterface := new(MyInterface) \n    rpc.Register(myInterface) \n    t, err := net.ResolveTCPAddr(\"tcp4\", PORT) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    l, err := net.ListenTCP(\"tcp4\", t) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k7m","search_text":"What makes this program an RPC server is the use of the rpc.Register() function. However, as the RPC server uses TCP, it still needs to make function calls to net.ResolveTCPAddr() and net.ListenTCP() .","text_count":201,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"What makes this program an RPC server is the use of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rpc.Register()"}]},{"block_type":"text","content":"function. However, as the RPC server uses TCP, it still needs to make function calls to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ResolveTCPAddr()"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ListenTCP()"}]},{"block_type":"text","content":"."}]},{"block_type":"element","block":"k6pz2k7n","search_text":"The rest of the Go code of RPCclient.go is as follows:","text_count":54,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The rest of the Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k7o","search_text":"for { c, err := l.Accept() if err != nil { continue } fmt.Printf(\"%s\\n\", c.RemoteAddr()) rpc.ServeConn(c) } } ","text_count":110,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        c, err := l.Accept() \n        if err != nil { \n               continue \n        } \n        fmt.Printf(\"%s\\n\", c.RemoteAddr()) \n        rpc.ServeConn(c) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k7p","search_text":"The RemoteAddr() function returns the IP address and the port number used for communicating with the RPC client. The rpc.ServeConn() function serves the RPC client.","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RemoteAddr()"}]},{"block_type":"text","content":"function returns the IP address and the port number used for communicating with the RPC client. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"rpc.ServeConn()"}]},{"block_type":"text","content":"function serves the RPC client."}]},{"block_type":"element","block":"k6pz2k7q","search_text":"Executing RPCserver.go and waiting for RPCclient.go will create the following output:","text_count":85,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCserver.go"}]},{"block_type":"text","content":"and waiting for"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2k7r","search_text":"$ go run RPCserver.go 127.0.0.1:52289 ","text_count":38,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run RPCserver.go\n127.0.0.1:52289"}]}]},{"block_type":"element","block":"k6pz2k7s","search_text":"Executing RPCclient.go will create the following output:","text_count":56,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"RPCclient.go"}]},{"block_type":"text","content":"will create the following output:"}]},{"block_type":"element","block":"k6pz2k7t","search_text":"$ go run RPCclient.go localhost:1234 Reply (Multiply): -8.000000 Reply (Power): 0.250000 ","text_count":89,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ go run RPCclient.go localhost:1234\nReply (Multiply): -8.000000\nReply (Power): 0.250000"}]}]},{"block_type":"element","block":"k6pz2k7u","search_text":"Doing low-level network programming","text_count":35,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Doing low-level network programming"}]},{"block_type":"element","block":"k6pz2k7v","search_text":"Although the http.Transport structure allows you to modify the various low-level parameters of a network connection, you can write Go code that permits you to read the raw data of network packets. There are two tricky points here:","text_count":230,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Although the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.Transport"}]},{"block_type":"text","content":"structure allows you to modify the various low-level parameters of a network connection, you can write Go code that permits you to read the raw data of network packets. There are two tricky points here:"}]},{"block_type":"element","block":"k6pz2k7w","search_text":"Network packets come in binary format, which requires you to look for specific kinds of network packets and not just any type of network packet. Put simply, when reading network packets, you should specify the protocol or protocols that you will support in your applications in advance. In order to send a network packet, you will have to construct it on your own. ","text_count":365,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Network packets come in binary format, which requires you to look for specific kinds of network packets and not just any type of network packet. Put simply, when reading network packets, you should specify the protocol or protocols that you will support in your applications in advance."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"In order to send a network packet, you will have to construct it on your own."}]}]},{"block_type":"element","block":"k6pz2k7x","search_text":"The next utility to be shown is called lowLevel.go , and it will be presented in three parts. Note that lowLevel.go captures ICMP packets, which use the IPv4 protocol and prints their contents. Also note that working with raw network data requires root privileges for security reasons.","text_count":285,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The next utility to be shown is called"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":", and it will be presented in three parts. Note that"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"captures ICMP packets, which use the IPv4 protocol and prints their contents. Also note that working with raw network data requires root privileges for security reasons."}]},{"block_type":"element","block":"k6pz2k7y","search_text":"The first segment of lowLevel.go is as follows:","text_count":47,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k7z","search_text":"package main import ( \"fmt\" \"net\" ) ","text_count":36,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"net\" \n)"}]}]},{"block_type":"element","block":"k6pz2k80","search_text":"The second part of lowLevel.go contains the following Go code:","text_count":62,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k81","search_text":"func main() { netaddr, err := net.ResolveIPAddr(\"ip4\", \"127.0.0.1\") if err != nil { fmt.Println(err) return } conn, err := net.ListenIP(\"ip4:icmp\", netaddr) if err != nil { fmt.Println(err) return } ","text_count":199,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    netaddr, err := net.ResolveIPAddr(\"ip4\", \"127.0.0.1\") \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n    conn, err := net.ListenIP(\"ip4:icmp\", netaddr) \n    if err != nil { \n        fmt.Println(err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k82","search_text":"The ICMP protocol is specified in the second part of the first parameter ( ip4:icmp ) of net.ListenIP() . Moreover, the ip4 part tells the utility to capture IPv4 traffic only.","text_count":176,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The ICMP protocol is specified in the second part of the first parameter ("},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ip4:icmp"}]},{"block_type":"text","content":") of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net.ListenIP()"}]},{"block_type":"text","content":". Moreover, the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ip4"}]},{"block_type":"text","content":"part tells the utility to capture IPv4 traffic only."}]},{"block_type":"element","block":"k6pz2k83","search_text":"The remaining part of lowLevel.go contains the following Go code:","text_count":65,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k84","search_text":"buffer := make([]byte, 1024) n, _, err := conn.ReadFrom(buffer) if err != nil { fmt.Println(err) return } fmt.Printf(\"% X\\n\", buffer[0:n]) } ","text_count":141,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"buffer := make([]byte, 1024) \n    n, _, err := conn.ReadFrom(buffer) \n    if err != nil { \n        fmt.Println(err) \n        return \n    } \n \n    fmt.Printf(\"% X\\n\", buffer[0:n]) \n}"}]}]},{"block_type":"element","block":"k6pz2k85","search_text":"The preceding code tells lowLevel.go to read just a single network packet because there is no for loop.","text_count":103,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The preceding code tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"to read just a single network packet because there is no"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop."}]},{"block_type":"element","block":"k6pz2k86","search_text":"The ICMP protocol is used by the ping(1) and traceroute(1) utilities, so one way to create ICMP traffic is to use one of these two tools. The network traffic will be generated using the following commands on both Unix machines while lowLevel.go is already running:","text_count":264,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The ICMP protocol is used by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ping(1)"}]},{"block_type":"text","content":"and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceroute(1)"}]},{"block_type":"text","content":"utilities, so one way to create ICMP traffic is to use one of these two tools. The network traffic will be generated using the following commands on both Unix machines while"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"is already running:"}]},{"block_type":"element","block":"k6pz2k87","search_text":"$ ping -c 5 localhost PING localhost (127.0.0.1): 56 data bytes 64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.037 ms 64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.038 ms 64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.117 ms 64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.052 ms 64 bytes from 127.0.0.1: icmp_seq=4 ttl=64 time=0.049 ms --- localhost ping statistics --- 5 packets transmitted, 5 packets received, 0.0% packet loss round-trip min/avg/max/stddev = 0.037/0.059/0.117/0.030 ms $ traceroute localhost traceroute to localhost (127.0.0.1), 64 hops max, 52 byte packets 1 localhost (127.0.0.1) 0.255 ms 0.048 ms 0.067 ms","text_count":641,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ ping -c 5 localhost\nPING localhost (127.0.0.1): 56 data bytes\n64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.037 ms\n64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.038 ms\n64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.117 ms\n64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.052 ms\n64 bytes from 127.0.0.1: icmp_seq=4 ttl=64 time=0.049 ms\n    \n--- localhost ping statistics ---\n5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 0.037/0.059/0.117/0.030 ms\n$ traceroute localhost\ntraceroute to localhost (127.0.0.1), 64 hops max, 52 byte packets\n1  localhost (127.0.0.1)  0.255 ms  0.048 ms  0.067 ms"}]}]},{"block_type":"element","block":"k6pz2k88","search_text":"Executing lowLevel.go on a macOS High Sierra machine with root privileges will produce the following output:","text_count":108,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine with root privileges will produce the following output:"}]},{"block_type":"element","block":"k6pz2k89","search_text":"$ sudo go run lowLevel.go 03 03 CD DA 00 00 00 00 45 00 34 00 B4 0F 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 B4 0E 82 9B 00 20 00 00 $ sudo go run lowLevel.go 00 00 0B 3B 20 34 00 00 5A CB 5C 15 00 04 32 A9 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37","text_count":351,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sudo go run lowLevel.go\n03 03 CD DA 00 00 00 00 45 00 34 00 B4 0F 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 B4 0E 82 9B 00 20 00 00\n$ sudo go run lowLevel.go\n00 00 0B 3B 20 34 00 00 5A CB 5C 15 00 04 32 A9 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37"}]}]},{"block_type":"element","block":"k6pz2k8a","search_text":"The first output example is generated by the ping(1) command, whereas the second output example is generated by the traceroute(1) command.","text_count":138,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first output example is generated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ping(1)"}]},{"block_type":"text","content":"command, whereas the second output example is generated by the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"traceroute(1)"}]},{"block_type":"text","content":"command."}]},{"block_type":"element","block":"k6pz2k8b","search_text":"Running lowLevel.go on a Debian Linux machine will generate the following output:","text_count":81,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"lowLevel.go"}]},{"block_type":"text","content":"on a Debian Linux machine will generate the following output:"}]},{"block_type":"element","block":"k6pz2k8c","search_text":"$ uname -a Linux mail 4.14.12-x86_64-linode92 #1 SMP Fri Jan 5 15:34:44 UTC 2018 x86_64 GNU/Linux # go run lowLevel.go 08 00 61 DD 3F BA 00 01 9A 5D CB 5A 00 00 00 00 26 DC 0B 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 # go run lowLevel.go 03 03 BB B8 00 00 00 00 45 00 00 3C CD 8D 00 00 01 11 EE 21 7F 00 00 01 7F 00 00 01 CB 40 82 9A 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F ","text_count":536,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ uname -a\nLinux mail 4.14.12-x86_64-linode92 #1 SMP Fri Jan 5 15:34:44 UTC 2018 x86_64 GNU/Linux\n# go run lowLevel.go\n08 00 61 DD 3F BA 00 01 9A 5D CB 5A 00 00 00 00 26 DC 0B 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n# go run lowLevel.go\n03 03 BB B8 00 00 00 00 45 00 00 3C CD 8D 00 00 01 11 EE 21 7F 00 00 01 7F 00 00 01 CB 40 82 9A 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F"}]}]},{"block_type":"element","block":"k6pz2k8d","search_text":"The output of the uname(1) command prints useful information about the Linux system. Note that on modern Linux machines you should execute ping(1) with the -4 flag in order to tell it to use the IPv4 protocol.","text_count":209,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The output of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"uname(1)"}]},{"block_type":"text","content":"command prints useful information about the Linux system. Note that on modern Linux machines you should execute"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"ping(1)"}]},{"block_type":"text","content":"with the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"-4"}]},{"block_type":"text","content":"flag in order to tell it to use the IPv4 protocol."}]},{"block_type":"element","block":"k6pz2k8e","search_text":"Grabbing raw ICMP network data","text_count":30,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Grabbing raw ICMP network data"}]},{"block_type":"element","block":"k6pz2k8f","search_text":"In this subsection, you will learn how to use the syscall package to capture raw ICMP network data and syscall.SetsockoptInt() in order to set the options of a socket. Keep in mind that sending raw ICMP data is much more difficult, as you will have to construct the raw network packets on your own. The name of the utility is syscallNet.go , and it will be shown in four parts.","text_count":377,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"In this subsection, you will learn how to use the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall"}]},{"block_type":"text","content":"package to capture raw ICMP network data and"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SetsockoptInt()"}]},{"block_type":"text","content":"in order to set the options of a socket. Keep in mind that sending raw ICMP data is much more difficult, as you will have to construct the raw network packets on your own. The name of the utility is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":", and it will be shown in four parts."}]},{"block_type":"element","block":"k6pz2k8g","search_text":"The first part of syscallNet.go is as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The first part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k8h","search_text":"package main import ( \"fmt\" \"os\" \"syscall\" ) ","text_count":45,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"package main \n \nimport ( \n    \"fmt\" \n    \"os\" \n    \"syscall\" \n)"}]}]},{"block_type":"element","block":"k6pz2k8i","search_text":"The second segment of syscallNet.go contains the following Go code:","text_count":67,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The second segment of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"contains the following Go code:"}]},{"block_type":"element","block":"k6pz2k8j","search_text":"func main() { fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_ICMP) if err != nil { fmt.Println(\"Error in syscall.Socket:\", err) return } f := os.NewFile(uintptr(fd), \"captureICMP\") if f == nil { fmt.Println(\"Error in os.NewFile:\", err) return } ","text_count":275,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"func main() { \n    fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_ICMP) \n    if err != nil { \n        fmt.Println(\"Error in syscall.Socket:\", err) \n        return \n    } \n \n    f := os.NewFile(uintptr(fd), \"captureICMP\") \n    if f == nil { \n        fmt.Println(\"Error in os.NewFile:\", err) \n        return \n   }"}]}]},{"block_type":"element","block":"k6pz2k8k","search_text":"The syscall.AF_INET parameter tells syscall.Socket() that you want to work with IPv4. The syscall.SOCK_RAW parameter is what makes the generated socket a raw socket. The last parameter, which is syscall.IPPROTO_ICMP , tells syscall.Socket() that you are interested in ICMP traffic only.","text_count":286,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.AF_INET"}]},{"block_type":"text","content":"parameter tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Socket()"}]},{"block_type":"text","content":"that you want to work with IPv4. The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SOCK_RAW"}]},{"block_type":"text","content":"parameter is what makes the generated socket a raw socket. The last parameter, which is"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.IPPROTO_ICMP"}]},{"block_type":"text","content":", tells"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.Socket()"}]},{"block_type":"text","content":"that you are interested in ICMP traffic only."}]},{"block_type":"element","block":"k6pz2k8l","search_text":"The third part of syscallNet.go is as follows:","text_count":46,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The third part of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k8m","search_text":"err = syscall.SetsockoptInt(fd, syscall.SOL_SOCKET, syscall.SO_RCVBUF, 256) if err != nil { fmt.Println(\"Error in syscall.Socket:\", err) return } ","text_count":146,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"err = syscall.SetsockoptInt(fd, syscall.SOL_SOCKET, syscall.SO_RCVBUF, 256) \n    if err != nil { \n        fmt.Println(\"Error in syscall.Socket:\", err) \n        return \n    }"}]}]},{"block_type":"element","block":"k6pz2k8n","search_text":"The call to syscall.SetsockoptInt() sets the size of the receive buffer of the socket to 256 . The syscall.SOL_SOCKET parameter is for stating that you want to work on the socket layer level.","text_count":191,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The call to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SetsockoptInt()"}]},{"block_type":"text","content":"sets the size of the receive buffer of the socket to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"256"}]},{"block_type":"text","content":". The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscall.SOL_SOCKET"}]},{"block_type":"text","content":"parameter is for stating that you want to work on the socket layer level."}]},{"block_type":"element","block":"k6pz2k8o","search_text":"The remaining Go code of syscallNet.go is as follows:","text_count":53,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The remaining Go code of"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"is as follows:"}]},{"block_type":"element","block":"k6pz2k8p","search_text":"for { buf := make([]byte, 1024) numRead, err := f.Read(buf) if err != nil { fmt.Println(err) } fmt.Printf(\"% X\\n\", buf[:numRead]) } } ","text_count":134,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"for { \n        buf := make([]byte, 1024) \n        numRead, err := f.Read(buf) \n        if err != nil { \n            fmt.Println(err) \n        } \n        fmt.Printf(\"% X\\n\", buf[:numRead]) \n    } \n}"}]}]},{"block_type":"element","block":"k6pz2k8q","search_text":"Due to the for loop, syscallNet.go will keep capturing ICMP network packets until you terminate it manually.","text_count":108,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Due to the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop,"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"will keep capturing ICMP network packets until you terminate it manually."}]},{"block_type":"element","block":"k6pz2k8r","search_text":"Executing syscallNet.go on a macOS High Sierra machine will produce the following type of output:","text_count":97,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Executing"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"on a macOS High Sierra machine will produce the following type of output:"}]},{"block_type":"element","block":"k6pz2k8s","search_text":"$ sudo go run syscallNet.go 45 00 40 00 BC B6 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 3F 36 71 45 00 00 5A CB 6A 90 00 0B 9F 1A 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 40 00 62 FB 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 31 EF 71 45 00 01 5A CB 6A 91 00 0B AC 5F 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 40 00 9A 5F 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 1D D6 71 45 00 02 5A CB 6A 92 00 0B C0 76 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 40 00 6E 0D 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 09 CF 71 45 00 03 5A CB 6A 93 00 0B D4 7B 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 40 00 3A 07 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 FE 9C 71 45 00 04 5A CB 6A 94 00 0B DF AB 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 24 00 45 55 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 12 00 00 00 00 45 00 34 00 C5 73 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9B 00 20 00 00 45 00 24 00 E8 1E 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 10 00 00 00 00 45 00 34 00 C5 74 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9C 00 20 00 00 45 00 24 00 2A 4B 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 0E 00 00 00 00 45 00 34 00 C5 75 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9D 00 20 00 00 ","text_count":1792,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"$ sudo go run syscallNet.go\n45 00 40 00 BC B6 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 3F 36 71 45 00 00 5A CB 6A 90 00 0B 9F 1A 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 40 00 62 FB 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 31 EF 71 45 00 01 5A CB 6A 91 00 0B AC 5F 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 40 00 9A 5F 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 1D D6 71 45 00 02 5A CB 6A 92 00 0B C0 76 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 40 00 6E 0D 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 09 CF 71 45 00 03 5A CB 6A 93 00 0B D4 7B 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 40 00 3A 07 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 00 00 FE 9C 71 45 00 04 5A CB 6A 94 00 0B DF AB 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 24 00 45 55 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 12 00 00 00 00 45 00 34 00 C5 73 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9B 00 20 00 00\n45 00 24 00 E8 1E 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 10 00 00 00 00 45 00 34 00 C5 74 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9C 00 20 00 00\n45 00 24 00 2A 4B 00 00 40 01 00 00 7F 00 00 01 7F 00 00 01 03 03 AB 0E 00 00 00 00 45 00 34 00 C5 75 00 00 01 11 00 00 7F 00 00 01 7F 00 00 01 C5 72 82 9D 00 20 00 00"}]}]},{"block_type":"element","block":"k6pz2k8t","search_text":"Running syscallNet.go on a Debian Linux machine will generate the following output:","text_count":83,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Running"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"syscallNet.go"}]},{"block_type":"text","content":"on a Debian Linux machine will generate the following output:"}]},{"block_type":"element","block":"k6pz2k8u","search_text":"# go run syscallNet.go 45 00 00 54 7F E9 40 00 40 01 BC BD 7F 00 00 01 7F 00 00 01 08 00 6F 07 53 E3 00 01 FA 6A CB 5A 00 00 00 00 AA 7B 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 7F EA 00 00 40 01 FC BC 7F 00 00 01 7F 00 00 01 00 00 77 07 53 E3 00 01 FA 6A CB 5A 00 00 00 00 AA 7B 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 C0 00 44 68 54 00 00 34 01 8B 8E 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 40 4F 40 00 34 06 74 6A 6D 4A C1 FD 86 77 DC 57 B0 B8 DD 96 00 00 00 00 52 F1 AB DA 50 14 00 00 90 9E 00 00 45 00 00 54 80 4E 40 00 40 01 BC 58 7F 00 00 01 7F 00 00 01 08 00 7E 01 53 E3 00 02 FB 6A CB 5A 00 00 00 00 9A 80 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 80 4F 00 00 40 01 FC 57 7F 00 00 01 7F 00 00 01 00 00 86 01 53 E3 00 02 FB 6A CB 5A 00 00 00 00 9A 80 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 80 9B 40 00 40 01 BC 0B 7F 00 00 01 7F 00 00 01 08 00 93 EC 53 E3 00 03 FC 6A CB 5A 00 00 00 00 83 94 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 80 9C 00 00 40 01 FC 0A 7F 00 00 01 7F 00 00 01 00 00 9B EC 53 E3 00 03 FC 6A CB 5A 00 00 00 00 83 94 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 C0 00 44 68 55 00 00 34 01 8B 8D 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 40 D1 40 00 34 06 73 E8 6D 4A C1 FD 86 77 DC 57 8E 8E DD 96 00 00 00 00 6C 6E D3 36 50 14 00 00 71 EF 00 00 45 00 00 54 80 F8 40 00 40 01 BB AE 7F 00 00 01 7F 00 00 01 08 00 F2 E7 53 E3 00 04 FD 6A CB 5A 00 00 00 00 23 98 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 80 F9 00 00 40 01 FB AD 7F 00 00 01 7F 00 00 01 00 00 FA E7 53 E3 00 04 FD 6A CB 5A 00 00 00 00 23 98 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 82 0D 40 00 40 01 BA 99 7F 00 00 01 7F 00 00 01 08 00 4A 82 53 E3 00 05 FE 6A CB 5A 00 00 00 00 CA FC 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 00 00 54 82 0E 00 00 40 01 FA 98 7F 00 00 01 7F 00 00 01 00 00 52 82 53 E3 00 05 FE 6A CB 5A 00 00 00 00 CA FC 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 45 C0 00 44 68 56 00 00 34 01 8B 8C 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 41 74 40 00 34 06 73 45 6D 4A C1 FD 86 77 DC 57 2E 9B DD 96 00 00 00 00 C3 D6 44 57 50 14 00 00 09 5A 00 00 45 C0 00 44 68 57 00 00 34 01 8B 8B 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 44 27 40 00 33 06 71 92 6D 4A C1 FD 86 77 DC 57 C5 C2 DD 96 00 00 00 00 CF DD DB BE 50 14 00 00 CE C3 00 00 45 C0 00 58 94 B4 00 00 40 01 E7 2E 7F 00 00 01 7F 00 00 01 03 03 F1 DA 00 00 00 00 45 00 00 3C 85 E1 00 00 01 11 35 CE 7F 00 00 01 7F 00 00 01 95 1E 82 9A 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 B5 00 00 40 01 E7 2D 7F 00 00 01 7F 00 00 01 03 03 F9 EA 00 00 00 00 45 00 00 3C 85 E2 00 00 01 11 35 CD 7F 00 00 01 7F 00 00 01 8D 0D 82 9B 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 B6 00 00 40 01 E7 2C 7F 00 00 01 7F 00 00 01 03 03 D2 EB 00 00 00 00 45 00 00 3C 85 E3 00 00 01 11 35 CC 7F 00 00 01 7F 00 00 01 B4 0B 82 9C 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 B7 00 00 40 01 E7 2B 7F 00 00 01 7F 00 00 01 03 03 D6 AC 00 00 00 00 45 00 00 3C 85 E4 00 00 02 11 34 CB 7F 00 00 01 7F 00 00 01 B0 49 82 9D 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 B8 00 00 40 01 E7 2A 7F 00 00 01 7F 00 00 01 03 03 F1 B4 00 00 00 00 45 00 00 3C 85 E5 00 00 02 11 34 CA 7F 00 00 01 7F 00 00 01 95 40 82 9E 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 B9 00 00 40 01 E7 29 7F 00 00 01 7F 00 00 01 03 03 CD 43 00 00 00 00 45 00 00 3C 85 E6 00 00 02 11 34 C9 7F 00 00 01 7F 00 00 01 B9 B0 82 9F 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BA 00 00 40 01 E7 28 7F 00 00 01 7F 00 00 01 03 03 9D 8F 00 00 00 00 45 00 00 3C 85 E7 00 00 03 11 33 C8 7F 00 00 01 7F 00 00 01 E9 63 82 A0 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BB 00 00 40 01 E7 27 7F 00 00 01 7F 00 00 01 03 03 A3 13 00 00 00 00 45 00 00 3C 85 E8 00 00 03 11 33 C7 7F 00 00 01 7F 00 00 01 E3 DE 82 A1 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BC 00 00 40 01 E7 26 7F 00 00 01 7F 00 00 01 03 03 D4 66 00 00 00 00 45 00 00 3C 85 E9 00 00 03 11 33 C6 7F 00 00 01 7F 00 00 01 B2 8A 82 A2 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BD 00 00 40 01 E7 25 7F 00 00 01 7F 00 00 01 03 03 A6 8D 00 00 00 00 45 00 00 3C 85 EA 00 00 04 11 32 C5 7F 00 00 01 7F 00 00 01 E0 62 82 A3 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BE 00 00 40 01 E7 24 7F 00 00 01 7F 00 00 01 03 03 F1 C6 00 00 00 00 45 00 00 3C 85 EB 00 00 04 11 32 C4 7F 00 00 01 7F 00 00 01 95 28 82 A4 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 BF 00 00 40 01 E7 23 7F 00 00 01 7F 00 00 01 03 03 A3 FE 00 00 00 00 45 00 00 3C 85 EC 00 00 04 11 32 C3 7F 00 00 01 7F 00 00 01 E2 EF 82 A5 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 C0 00 00 40 01 E7 22 7F 00 00 01 7F 00 00 01 03 03 B9 AA 00 00 00 00 45 00 00 3C 85 ED 00 00 05 11 31 C2 7F 00 00 01 7F 00 00 01 CD 42 82 A6 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 C1 00 00 40 01 E7 21 7F 00 00 01 7F 00 00 01 03 03 B3 B7 00 00 00 00 45 00 00 3C 85 EE 00 00 05 11 31 C1 7F 00 00 01 7F 00 00 01 D3 34 82 A7 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 C2 00 00 40 01 E7 20 7F 00 00 01 7F 00 00 01 03 03 F2 62 00 00 00 00 45 00 00 3C 85 EF 00 00 05 11 31 C0 7F 00 00 01 7F 00 00 01 94 88 82 A8 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 45 C0 00 58 94 C3 00 00 40 01 E7 1F 7F 00 00 01 7F 00 00 01 03 03 DD BE 00 00 00 00 45 00 00 3C 85 F0 00 00 06 11 30 BF 7F 00 00 01 7F 00 00 01 A9 2B 82 A9 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F","text_count":7582,"tag_name":"pre","attributes":{},"children":[{"block_type":"element","tag_name":"code","attributes":{"language":"python"},"children":[{"block_type":"text","content":"# go run syscallNet.go\n45 00 00 54 7F E9 40 00 40 01 BC BD 7F 00 00 01 7F 00 00 01 08 00 6F 07 53 E3 00 01 FA 6A CB 5A 00 00 00 00 AA 7B 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 7F EA 00 00 40 01 FC BC 7F 00 00 01 7F 00 00 01 00 00 77 07 53 E3 00 01 FA 6A CB 5A 00 00 00 00 AA 7B 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 C0 00 44 68 54 00 00 34 01 8B 8E 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 40 4F 40 00 34 06 74 6A 6D 4A C1 FD 86 77 DC 57 B0 B8 DD 96 00 00 00 00 52 F1 AB DA 50 14 00 00 90 9E 00 00\n45 00 00 54 80 4E 40 00 40 01 BC 58 7F 00 00 01 7F 00 00 01 08 00 7E 01 53 E3 00 02 FB 6A CB 5A 00 00 00 00 9A 80 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 80 4F 00 00 40 01 FC 57 7F 00 00 01 7F 00 00 01 00 00 86 01 53 E3 00 02 FB 6A CB 5A 00 00 00 00 9A 80 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 80 9B 40 00 40 01 BC 0B 7F 00 00 01 7F 00 00 01 08 00 93 EC 53 E3 00 03 FC 6A CB 5A 00 00 00 00 83 94 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 80 9C 00 00 40 01 FC 0A 7F 00 00 01 7F 00 00 01 00 00 9B EC 53 E3 00 03 FC 6A CB 5A 00 00 00 00 83 94 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 C0 00 44 68 55 00 00 34 01 8B 8D 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 40 D1 40 00 34 06 73 E8 6D 4A C1 FD 86 77 DC 57 8E 8E DD 96 00 00 00 00 6C 6E D3 36 50 14 00 00 71 EF 00 00\n45 00 00 54 80 F8 40 00 40 01 BB AE 7F 00 00 01 7F 00 00 01 08 00 F2 E7 53 E3 00 04 FD 6A CB 5A 00 00 00 00 23 98 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 80 F9 00 00 40 01 FB AD 7F 00 00 01 7F 00 00 01 00 00 FA E7 53 E3 00 04 FD 6A CB 5A 00 00 00 00 23 98 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 82 0D 40 00 40 01 BA 99 7F 00 00 01 7F 00 00 01 08 00 4A 82 53 E3 00 05 FE 6A CB 5A 00 00 00 00 CA FC 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 00 00 54 82 0E 00 00 40 01 FA 98 7F 00 00 01 7F 00 00 01 00 00 52 82 53 E3 00 05 FE 6A CB 5A 00 00 00 00 CA FC 06 00 00 00 00 00 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37\n45 C0 00 44 68 56 00 00 34 01 8B 8C 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 41 74 40 00 34 06 73 45 6D 4A C1 FD 86 77 DC 57 2E 9B DD 96 00 00 00 00 C3 D6 44 57 50 14 00 00 09 5A 00 00\n45 C0 00 44 68 57 00 00 34 01 8B 8B 86 77 DC 57 6D 4A C1 FD 03 0A 8F 27 00 00 00 00 45 00 00 28 44 27 40 00 33 06 71 92 6D 4A C1 FD 86 77 DC 57 C5 C2 DD 96 00 00 00 00 CF DD DB BE 50 14 00 00 CE C3 00 00\n45 C0 00 58 94 B4 00 00 40 01 E7 2E 7F 00 00 01 7F 00 00 01 03 03 F1 DA 00 00 00 00 45 00 00 3C 85 E1 00 00 01 11 35 CE 7F 00 00 01 7F 00 00 01 95 1E 82 9A 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 B5 00 00 40 01 E7 2D 7F 00 00 01 7F 00 00 01 03 03 F9 EA 00 00 00 00 45 00 00 3C 85 E2 00 00 01 11 35 CD 7F 00 00 01 7F 00 00 01 8D 0D 82 9B 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 B6 00 00 40 01 E7 2C 7F 00 00 01 7F 00 00 01 03 03 D2 EB 00 00 00 00 45 00 00 3C 85 E3 00 00 01 11 35 CC 7F 00 00 01 7F 00 00 01 B4 0B 82 9C 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 B7 00 00 40 01 E7 2B 7F 00 00 01 7F 00 00 01 03 03 D6 AC 00 00 00 00 45 00 00 3C 85 E4 00 00 02 11 34 CB 7F 00 00 01 7F 00 00 01 B0 49 82 9D 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 B8 00 00 40 01 E7 2A 7F 00 00 01 7F 00 00 01 03 03 F1 B4 00 00 00 00 45 00 00 3C 85 E5 00 00 02 11 34 CA 7F 00 00 01 7F 00 00 01 95 40 82 9E 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 B9 00 00 40 01 E7 29 7F 00 00 01 7F 00 00 01 03 03 CD 43 00 00 00 00 45 00 00 3C 85 E6 00 00 02 11 34 C9 7F 00 00 01 7F 00 00 01 B9 B0 82 9F 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BA 00 00 40 01 E7 28 7F 00 00 01 7F 00 00 01 03 03 9D 8F 00 00 00 00 45 00 00 3C 85 E7 00 00 03 11 33 C8 7F 00 00 01 7F 00 00 01 E9 63 82 A0 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BB 00 00 40 01 E7 27 7F 00 00 01 7F 00 00 01 03 03 A3 13 00 00 00 00 45 00 00 3C 85 E8 00 00 03 11 33 C7 7F 00 00 01 7F 00 00 01 E3 DE 82 A1 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BC 00 00 40 01 E7 26 7F 00 00 01 7F 00 00 01 03 03 D4 66 00 00 00 00 45 00 00 3C 85 E9 00 00 03 11 33 C6 7F 00 00 01 7F 00 00 01 B2 8A 82 A2 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BD 00 00 40 01 E7 25 7F 00 00 01 7F 00 00 01 03 03 A6 8D 00 00 00 00 45 00 00 3C 85 EA 00 00 04 11 32 C5 7F 00 00 01 7F 00 00 01 E0 62 82 A3 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BE 00 00 40 01 E7 24 7F 00 00 01 7F 00 00 01 03 03 F1 C6 00 00 00 00 45 00 00 3C 85 EB 00 00 04 11 32 C4 7F 00 00 01 7F 00 00 01 95 28 82 A4 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 BF 00 00 40 01 E7 23 7F 00 00 01 7F 00 00 01 03 03 A3 FE 00 00 00 00 45 00 00 3C 85 EC 00 00 04 11 32 C3 7F 00 00 01 7F 00 00 01 E2 EF 82 A5 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 C0 00 00 40 01 E7 22 7F 00 00 01 7F 00 00 01 03 03 B9 AA 00 00 00 00 45 00 00 3C 85 ED 00 00 05 11 31 C2 7F 00 00 01 7F 00 00 01 CD 42 82 A6 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 C1 00 00 40 01 E7 21 7F 00 00 01 7F 00 00 01 03 03 B3 B7 00 00 00 00 45 00 00 3C 85 EE 00 00 05 11 31 C1 7F 00 00 01 7F 00 00 01 D3 34 82 A7 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 C2 00 00 40 01 E7 20 7F 00 00 01 7F 00 00 01 03 03 F2 62 00 00 00 00 45 00 00 3C 85 EF 00 00 05 11 31 C0 7F 00 00 01 7F 00 00 01 94 88 82 A8 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F\n45 C0 00 58 94 C3 00 00 40 01 E7 1F 7F 00 00 01 7F 00 00 01 03 03 DD BE 00 00 00 00 45 00 00 3C 85 F0 00 00 06 11 30 BF 7F 00 00 01 7F 00 00 01 A9 2B 82 A9 00 28 FE 3B 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F"}]}]},{"block_type":"element","block":"k6pz2k8v","search_text":"Where to go next?","text_count":17,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Where to go next?"}]},{"block_type":"element","block":"k6pz2k8w","search_text":"Philosophically speaking, no programming book can ever be perfect and neither is this one! Did I leave some Go topics out? Absolutely yes! Why? Because there are always more topics to cover in a book, so if I tried to cover everything, the book would never be ready for publication! This situation is somehow analogous to the specifications of a program—you can always add new and exciting features, but if you do not freeze its specifications, the program will always be in development and it will never be ready for your intended audience! Some of the Go topics I missed might even appear in the second edition of this book!","text_count":626,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Philosophically speaking, no programming book can ever be perfect and neither is this one! Did I leave some Go topics out? Absolutely yes! Why? Because there are always more topics to cover in a book, so if I tried to cover everything, the book would never be ready for publication! This situation is somehow analogous to the specifications of a program&mdash;you can always add new and exciting features, but if you do not freeze its specifications, the program will always be in development and it will never be ready for your intended audience! Some of the Go topics I missed might even appear in the second edition of this book!"}]},{"block_type":"element","block":"k6pz2k8x","search_text":"The good thing is that after reading this book, you will be ready to learn on your own, which is the biggest benefit that you can get from any good computer programming book. The main purpose of this book is to help you learn how to program in Go and gain some experience in doing so. However, there is no substitute for trying things out on your own, and failing often becomes the only way to learn a programming language, so you must keep developing nontrivial things.","text_count":470,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"The good thing is that after reading this book, you will be ready to learn on your own, which is the biggest benefit that you can get from any good computer programming book. The main purpose of this book is to help you learn how to program in Go and gain some experience in doing so. However, there is no substitute for trying things out on your own, and failing often becomes the only way to learn a programming language, so you must keep developing nontrivial things."}]},{"block_type":"element","block":"k6pz2k8y","search_text":"So, this is the end of yet another Go book for me, but the beginning of a journey for you! Thanks for buying this book. You are now ready to start writing your own software in Go and learning new things!","text_count":203,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"So, this is the end of yet another Go book for me, but the beginning of a journey for you! Thanks for buying this book. You are now ready to start writing your own software in Go and learning new things!"}]},{"block_type":"element","block":"k6pz2k8z","search_text":"Additional resources","text_count":20,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Additional resources"}]},{"block_type":"element","block":"k6pz2k90","search_text":"Take a look at the following resources:","text_count":39,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Take a look at the following resources:"}]},{"block_type":"element","block":"k6pz2k91","search_text":"Visit the documentation of the net standard Go package, which can be found at https://golang.org/pkg/net/ . This is one of the biggest documentation found in the Go documentation. Although this book talked about RPC , it did not talk about gRPC , which is an open source, high-performance RPC framework. A package with the Go language implementation of gRPC can be found at https://github.com/grpc/grpc-go . The ICMP protocol for IPv4 is defined in RFC 792. It can be found in many places, including https://tools.ietf.org/html/rfc792 . WebSocket is a protocol for two-way communication between a client and a remote host. There is a WebSocket implementation for Go at https://github.com/gorilla/websocket . You can learn more about WebSocket at http://www.rfc-editor.org/rfc/rfc6455.txt . If you are really into network programming and you want to be able to work with RAW TCP packets, you mind find interesting and helpful information and tools in the gopacket library, which can be found at https://github.com/google/gopacket . The raw package, which is located at https://github.com/mdlayher/raw allows you to read and write data at the device driver level for a network device. ","text_count":1183,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Visit the documentation of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"net"}]},{"block_type":"text","content":"standard Go package, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"language":"://golang.org/pkg/net/"},"children":[{"block_type":"text","content":"https://golang.org/pkg/net/"}]},{"block_type":"text","content":". This is one of the biggest documentation found in the Go documentation."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Although this book talked about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"RPC"}]},{"block_type":"text","content":", it did not talk about"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"gRPC"}]},{"block_type":"text","content":", which is an open source, high-performance RPC framework. A package with the Go language implementation of gRPC can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/grpc/grpc-go"},"children":[{"block_type":"text","content":"https://github.com/grpc/grpc-go"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The ICMP protocol for IPv4 is defined in RFC 792. It can be found in many places, including&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://tools.ietf.org/html/rfc792"},"children":[{"block_type":"text","content":"https://tools.ietf.org/html/rfc792"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"WebSocket"}]},{"block_type":"text","content":"is a protocol for two-way communication between a client and a remote host. There is a WebSocket implementation for Go at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/gorilla/websocket"},"children":[{"block_type":"text","content":"https://github.com/gorilla/websocket"}]},{"block_type":"text","content":". You can learn more about WebSocket at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://www.rfc-editor.org/rfc/rfc6455.txt"},"children":[{"block_type":"text","content":"http://www.rfc-editor.org/rfc/rfc6455.txt"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"If you are really into network programming and you want to be able to work with RAW TCP packets, you mind find interesting and helpful information and tools in the gopacket library, which can be found at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/google/gopacket"},"children":[{"block_type":"text","content":"https://github.com/google/gopacket"}]},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"."}]}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"The"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"raw"}]},{"block_type":"text","content":"package, which is located at&nbsp;"},{"block_type":"element","tag_name":"a","attributes":{"href":"https://github.com/mdlayher/raw"},"children":[{"block_type":"text","content":"https://github.com/mdlayher/raw"}]},{"block_type":"text","content":"&nbsp;allows you to read and write data at the device driver level for a network device."}]}]},{"block_type":"element","block":"k6pz2k92","search_text":"Exercises","text_count":9,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Exercises"}]},{"block_type":"element","block":"k6pz2k93","search_text":"Develop a FTP client in Go. Next try to develop a FTP server in Go. Is it more difficult to implement the FTP client or the FTP server? Why? Try to implement a Go version of the nc(1) utility. The secret when programming such fairly complex utilities is to start with a version that implements the basic functionality of the original utility before trying to support every possible option. Modify TCPserver.go so that it returns the date in one network packet and the time in another. Modify TCPserver.go so that it can serve multiple clients in a sequential way. Note that this is not the same as being able to serve multiple requests concurrently. Put simply, use a for loop so that the Accept() call can be executed multiple times. TCP servers, such as fiboTCP.go , tend to terminate when they receive a given signal, so add signal handling code to fiboTCP.go , as you learned in Chapter 8, Telling a Unix System What to Do . Modify kvTCP.go so that the save() function is protected using sync.Mutex . Is this required? Develop your own small web server in Go using a plain TCP instead of using the http.ListenAndServe() function. ","text_count":1134,"tag_name":"ul","attributes":{},"children":[{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop a"},{"block_type":"element","tag_name":"strong","attributes":{},"children":[{"block_type":"text","content":"FTP client"}]},{"block_type":"text","content":"in Go."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Next try to develop a FTP server in Go. Is it more difficult to implement the FTP client or the FTP server? Why?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Try to implement a Go version of the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"nc(1)"}]},{"block_type":"text","content":"utility. The secret when programming such fairly complex utilities is to start with a version that implements the basic functionality of the original utility before trying to support every possible option."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"so that it returns the date in one network packet and the time in another."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"TCPserver.go"}]},{"block_type":"text","content":"so that it can serve multiple clients in a sequential way. Note that this is not the same as being able to serve multiple requests concurrently. Put simply, use a"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"for"}]},{"block_type":"text","content":"loop so that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"Accept()"}]},{"block_type":"text","content":"call can be executed multiple times."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"TCP servers, such as"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":", tend to terminate when they receive a given signal, so add signal handling code to"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"fiboTCP.go"}]},{"block_type":"text","content":", as you learned in Chapter 8,"},{"block_type":"element","tag_name":"em","attributes":{},"children":[{"block_type":"text","content":"Telling a Unix System What to Do"}]},{"block_type":"text","content":"."}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Modify"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"kvTCP.go"}]},{"block_type":"text","content":"so that the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"save()"}]},{"block_type":"text","content":"function is protected using&nbsp;"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"sync.Mutex"}]},{"block_type":"text","content":". Is this required?"}]},{"block_type":"element","tag_name":"li","attributes":{},"children":[{"block_type":"text","content":"Develop your own small web server in Go using a plain TCP instead of using the"},{"block_type":"element","tag_name":"kbd","attributes":{},"children":[{"block_type":"text","content":"http.ListenAndServe()"}]},{"block_type":"text","content":"function."}]}]},{"block_type":"element","block":"k6pz2k94","search_text":"Summary","text_count":7,"tag_name":"h2","attributes":{},"children":[{"block_type":"text","content":"Summary"}]},{"block_type":"element","block":"k6pz2k95","search_text":"This chapter addressed many interesting things including developing UDP and TCP clients and servers, which are applications that work over TCP/IP computer networks.","text_count":164,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"This chapter addressed many interesting things including developing UDP and TCP clients and servers, which are applications that work over TCP/IP computer networks."}]},{"block_type":"element","block":"k6pz2k96","search_text":"As this is the last chapter of this book, I would like to congratulate and thank you for choosing this book. I hope that you found it useful and that you will continue using it as a reference throughout your Go journey.","text_count":219,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"As this is the last chapter of this book, I would like to congratulate and thank you for choosing this book. I hope that you found it useful and that you will continue using it as a reference throughout your Go journey."}]},{"block_type":"element","block":"k6pz2k97","search_text":"Leave a review - let other readers know what you think","text_count":54,"tag_name":"h3","attributes":{},"children":[{"block_type":"text","content":"Leave a review - let other readers know what you think"}]},{"block_type":"element","block":"k6pz2k98","search_text":"Please share your thoughts on this book with others by leaving a review on the site that you bought it from. If you purchased the book from Amazon, please leave us an honest review on this book's Amazon page. This is vital so that other potential readers can see and use your unbiased opinion to make purchasing decisions, we can understand what our customers think about our products, and our authors can see your feedback on the title that they have worked with Packt to create. It will only take a few minutes of your time, but is valuable to other potential customers, our authors, and Packt. Thank you!","text_count":607,"tag_name":"p","attributes":{},"children":[{"block_type":"text","content":"Please share your thoughts on this book with others by leaving a review on the site that you bought it from. If you purchased the book from Amazon, please leave us an honest review on this book's Amazon page. This is vital so that other potential readers can see and use your unbiased opinion to make purchasing decisions, we can understand what our customers think about our products, and our authors can see your feedback on the title that they have worked with Packt to create. It will only take a few minutes of your time, but is valuable to other potential customers, our authors, and Packt. Thank you!"}]}]}]}